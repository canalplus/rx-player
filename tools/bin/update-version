#!/bin/bash
set -e

version=$1

sed -i.bak -e "s/``v[0-9]\+\.[0-9]\+\.[0-9]\+\(-\w\+[0-9]\)\?``/``v${version}``/g" README.md && rm README.md.bak;
sed -i.bak -e "s/\/\\*PLAYER_VERSION\\*\/\"\(.*\)\";/\/*PLAYER_VERSION*\/\"${version}\";/" src/core/api/index.ts && rm src/core/api/index.ts.bak
sed -E -i.bak -e "s/^  \"version\": \"\d+\.\d+\.\d+\",/  \"version\": \"${version}\",/" package-lock.json && rm package-lock.json.bak
echo $version > VERSION

npm run build
npm run build:min
