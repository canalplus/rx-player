/*! For license information please see rx-player.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.RxPlayer=t():e.RxPlayer=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=217)}([function(e,t,n){"use strict";var r=n(42),i=new(function(){function e(){this.error=r.a,this.warn=r.a,this.info=r.a,this.debug=r.a,this._levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},this._currentLevel="NONE"}var t=e.prototype;return t.setLevel=function(e){var t,n=this._levels[e];"number"==typeof n?(t=n,this._currentLevel=e):(t=0,this._currentLevel="NONE"),this.error=t>=this._levels.ERROR?console.error.bind(console):r.a,this.warn=t>=this._levels.WARNING?console.warn.bind(console):r.a,this.info=t>=this._levels.INFO?console.info.bind(console):r.a,this.debug=t>=this._levels.DEBUG?console.log.bind(console):r.a},t.getLevel=function(){return this._currentLevel},e}());t.a=i},function(e,t,n){"use strict";function r(){for(var e,t=arguments.length,n=-1,r=0;++n<t;)r+="number"==typeof(e=n<0||arguments.length<=n?void 0:arguments[n])?e:e.length;var i=new Uint8Array(r),a=0;for(n=-1;++n<t;)"number"==typeof(e=n<0||arguments.length<=n?void 0:arguments[n])?a+=e:e.length>0&&(i.set(e,a),a+=e.length);return i}function i(e,t){return(e[t+0]<<8)+(e[t+1]<<0)}function a(e,t){return 65536*e[t+0]+256*e[t+1]+e[t+2]}function o(e,t){return 16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3]}function s(e,t){return 4294967296*(16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3])+16777216*e[t+4]+65536*e[t+5]+256*e[t+6]+e[t+7]}function u(e){return new Uint8Array([e>>>8&255,255&e])}function c(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}function l(e){var t=e%4294967296,n=(e-t)/4294967296;return new Uint8Array([n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t])}function d(e,t){return(e[t+0]<<0)+(e[t+1]<<8)}function f(e,t){return e[t+0]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]}function p(e){return new Uint8Array([255&e,e>>>8&255,e>>>16&255,e>>>24&255])}function h(e,t){var n=new DataView(e),r=n.byteLength;if(r!==t.length)return!1;for(var i=0;i<r;i++)if(n.getUint8(i)!==t[i])return!1;return!0}function v(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer)}n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return h})),n.d(t,"m",(function(){return v}))},function(e,t,n){"use strict";function r(e){return"string"==typeof e&&e.length>0}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){return null==e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";t.a={DEFAULT_UNMUTED_VOLUME:.1,DEFAULT_REQUEST_TIMEOUT:3e4,DEFAULT_TEXT_TRACK_MODE:"native",DEFAULT_MANUAL_BITRATE_SWITCHING_MODE:"seamless",DEFAULT_ENABLE_FAST_SWITCHING:!0,DEFAULT_AUDIO_TRACK_SWITCHING_MODE:"seamless",DELTA_POSITION_AFTER_RELOAD:{bitrateSwitch:-.1,trackSwitch:{audio:-.7,video:-.1,other:0}},DEFAULT_CODEC_SWITCHING_BEHAVIOR:"continue",DEFAULT_AUTO_PLAY:!1,DEFAULT_SHOW_NATIVE_SUBTITLE:!0,DEFAULT_STOP_AT_END:!0,DEFAULT_WANTED_BUFFER_AHEAD:30,DEFAULT_MAX_BUFFER_AHEAD:1/0,DEFAULT_MAX_BUFFER_BEHIND:1/0,MAXIMUM_MAX_BUFFER_AHEAD:{text:18e3},MAXIMUM_MAX_BUFFER_BEHIND:{text:18e3},DEFAULT_INITIAL_BITRATES:{audio:0,video:0,other:0},DEFAULT_MIN_BITRATES:{audio:0,video:0,other:0},DEFAULT_MAX_BITRATES:{audio:1/0,video:1/0,other:1/0},INACTIVITY_DELAY:6e4,DEFAULT_THROTTLE_WHEN_HIDDEN:!1,DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN:!1,DEFAULT_LIMIT_VIDEO_WIDTH:!1,DEFAULT_LIVE_GAP:{DEFAULT:10,LOW_LATENCY:3},BUFFER_DISCONTINUITY_THRESHOLD:.2,BITRATE_REBUFFERING_RATIO:1.5,BUFFER_GC_GAPS:{CALM:240,BEEFY:30},DEFAULT_MAX_MANIFEST_REQUEST_RETRY:4,DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR:4,DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE:1/0,INITIAL_BACKOFF_DELAY_BASE:{REGULAR:200,LOW_LATENCY:50},MAX_BACKOFF_DELAY_BASE:{REGULAR:3e3,LOW_LATENCY:1e3},SAMPLING_INTERVAL_MEDIASOURCE:1e3,SAMPLING_INTERVAL_LOW_LATENCY:250,SAMPLING_INTERVAL_NO_MEDIASOURCE:500,ABR_MINIMUM_TOTAL_BYTES:15e4,ABR_MINIMUM_CHUNK_SIZE:16e3,ABR_STARVATION_FACTOR:{DEFAULT:.72,LOW_LATENCY:.72},ABR_REGULAR_FACTOR:{DEFAULT:.8,LOW_LATENCY:.8},ABR_STARVATION_GAP:{DEFAULT:5,LOW_LATENCY:5},OUT_OF_STARVATION_GAP:{DEFAULT:7,LOW_LATENCY:7},ABR_STARVATION_DURATION_DELTA:.1,ABR_FAST_EMA:2,ABR_SLOW_EMA:10,RESUME_GAP_AFTER_SEEKING:{DEFAULT:1.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_NOT_ENOUGH_DATA:{DEFAULT:.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_BUFFERING:{DEFAULT:5,LOW_LATENCY:.5},STALL_GAP:{DEFAULT:.5,LOW_LATENCY:.2},MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT:.15,MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:.4,MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE:.3,MINIMUM_SEGMENT_SIZE:.005,APPEND_WINDOW_SECURITIES:{START:.2,END:.1},MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL:50,TEXT_TRACK_SIZE_CHECKS_INTERVAL:250,BUFFER_PADDING:{audio:1,video:3,other:1},SEGMENT_PRIORITIES_STEPS:[2,4,8,12,18,25],MAX_HIGH_PRIORITY_LEVEL:1,MIN_CANCELABLE_PRIORITY:3,EME_DEFAULT_WIDEVINE_ROBUSTNESSES:["HW_SECURE_ALL","HW_SECURE_DECODE","HW_SECURE_CRYPTO","SW_SECURE_DECODE","SW_SECURE_CRYPTO"],EME_KEY_SYSTEMS:{clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.microsoft.playready","com.chromecast.playready","com.youtube.playready"],fairplay:["com.apple.fps.1_0"]},MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE:10,MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE:200,MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY:300,OUT_OF_SYNC_MANIFEST_REFRESH_DELAY:3e3,FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY:3e3,DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0:3,EME_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS:50,EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION:1e3,FORCED_ENDED_THRESHOLD:.001,ADAPTATION_SWITCH_BUFFER_PADDINGS:{video:{before:2,after:2.5},audio:{before:2,after:2.5},text:{before:0,after:0},image:{before:0,after:0}},SOURCE_BUFFER_FLUSHING_INTERVAL:500,CONTENT_REPLACEMENT_PADDING:2,CACHE_LOAD_DURATION_THRESHOLDS:{video:50,audio:10},STREAM_EVENT_EMITTER_POLL_INTERVAL:250}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(41),i=n(108),a=n.n(i),o=n(28),s=n(31);!function(){if(!s.a&&null!=window.WebKitSourceBuffer&&void 0===window.WebKitSourceBuffer.prototype.addEventListener){var e=window.WebKitSourceBuffer.prototype;for(var t in o.a.prototype)o.a.prototype.hasOwnProperty(t)&&(e[t]=o.a.prototype[t]);e._listeners=[],e._emitUpdate=function(e,t){var n=this;a()((function(){n.trigger(e,t),n.updating=!1,n.trigger("updateend")}))},e.appendBuffer=function(e){if(this.updating)throw new Error("updating");this.trigger("updatestart"),this.updating=!0;try{this.append(e)}catch(e){return void this._emitUpdate("error",e)}this._emitUpdate("update")}}}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),i=n(66),a=n(94),o=n(26),s=n(83),u=n(49),c=n(70),l=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=a.a;break;case 1:if(!n){o.destination=a.a;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new d(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new d(o,n,r,i)}return o}return r.a(t,e),t.prototype[s.a]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(o.a),d=function(e){function t(t,n,r,o){var s,u=e.call(this)||this;u._parentSubscriber=t;var c=u;return Object(i.a)(n)?s=n:n&&(s=n.next,r=n.error,o=n.complete,n!==a.a&&(c=Object.create(n),Object(i.a)(c.unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=r,u._complete=o,u}return r.a(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;u.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=u.a.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):Object(c.a)(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;Object(c.a)(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};u.a.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),u.a.useDeprecatedSynchronousErrorHandling)throw e;Object(c.a)(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!u.a.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return u.a.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(Object(c.a)(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(l)},function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.includes)return e.includes(t,n);var r=e.length>>>0;if(0===r)return!1;for(var i,a,o=0|n,s=o>=0?Math.min(o,r-1):Math.max(r+o,0);s<r;){if((i=e[s])===(a=t)||"number"==typeof i&&"number"==typeof a&&isNaN(i)&&isNaN(a))return!0;s++}return!1}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return f}));var r=n(0),i=n(55);function a(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint8Array(t),r=0;r<n.length;r+=2){var i=e.charCodeAt(r/2);n[r]=255&i,n[r+1]=i>>8&255}return n}function o(e){if("function"==typeof window.TextDecoder)try{return new TextDecoder("utf-16le").decode(e)}catch(e){r.a.warn("Utils: could not use TextDecoder to parse UTF-16LE, fallbacking to another implementation",e)}for(var t="",n=0;n<e.length;n+=2)t+=String.fromCharCode((e[n+1]<<8)+e[n]);return t}function s(e){if("function"==typeof window.TextEncoder)try{return(new TextEncoder).encode(e)}catch(e){r.a.warn("Utils: could not use TextEncoder to encode string into UTF-8, fallbacking to another implementation",e)}var t,n=encodeURIComponent(e);if("function"==typeof unescape)t=unescape(n);else{var i=/[0-9a-fA-F]/,a=n.length;t="";for(var o=0;o<n.length;o++){var s=!1;if("%"===n[o])if(o<=a-6&&"u"===n[o+1]&&i.test(n[o+2])&&i.test(n[o+3])&&i.test(n[o+4])&&i.test(n[o+5])){var u=parseInt(n.substring(o+1,o+6),16);t+=String.fromCharCode(u),s=!0,o+=5}else if(o<=a-3&&i.test(n[o+1])&&i.test(n[o+2])){var c=parseInt(n.substring(o+1,o+3),16);t+=String.fromCharCode(c),s=!0,o+=2}s||(t+=n[o])}}for(var l=new Uint8Array(t.length),d=0;d<t.length;d++)l[d]=255&t.charCodeAt(d);return l}function u(e,t){var n=e.toString(16);return n.length>=t?n:new Array(t-n.length+1).join("0")+n}function c(e){if("function"==typeof window.TextDecoder)try{return(new TextDecoder).decode(e)}catch(e){r.a.warn("Utils: could not use TextDecoder to parse UTF-8, fallbacking to another implementation",e)}var t=e;239===t[0]&&187===t[1]&&191===t[2]&&(t=t.subarray(3));var n,i=function(e){for(var t="",n=0;n<e.length;n+=16e3){var r=e.subarray(n,n+16e3);t+=String.fromCharCode.apply(null,r)}return t}(t);if("function"==typeof escape)n=escape(i);else{var a=/[A-Za-z0-9*_\+-\.\/]/;n="";for(var o=0;o<i.length;o++)if(a.test(i[o]))n+=i[o];else{var s=i.charCodeAt(o);n+=s>=256?"%u"+u(s,4):"%"+u(s,2)}}return decodeURIComponent(n)}function l(e){for(var t=e.length,n=new Uint8Array(t/2),r=0,i=0;r<t;r+=2,i++)n[i]=255&parseInt(e.substring(r,r+2),16);return n}function d(e,t){void 0===t&&(t="");for(var n="",r=0;r<e.byteLength;r++)n+=(e[r]>>>4).toString(16),n+=(15&e[r]).toString(16),t.length>0&&r<e.byteLength-1&&(n+=t);return n}function f(e){Object(i.b)(16===e.length,"GUID length should be 16");var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],c=e[7],l=new Uint8Array(16);return l[0]=a,l[1]=r,l[2]=n,l[3]=t,l[4]=s,l[5]=o,l[6]=c,l[7]=u,l.set(e.subarray(8,16),8),l}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(9);var i=n(83),a=n(94);var o=n(62),s=n(110);function u(e){return 0===e.length?s.a:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var c=n(49),l=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var o=this.operator,s=function(e,t,n){if(e){if(e instanceof r.a)return e;if(e[i.a])return e[i.a]()}return e||t||n?new r.a(e,t,n):new r.a(a.a)}(e,t,n);if(o?s.add(o.call(s,this.source)):s.add(this.source||c.a.useDeprecatedSynchronousErrorHandling&&!s.syncErrorThrowable?this._subscribe(s):this._trySubscribe(s)),c.a.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable&&(s.syncErrorThrowable=!1,s.syncErrorThrown))throw s.syncErrorValue;return s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){c.a.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),!function(e){for(;e;){var t=e,n=t.closed,i=t.destination,a=t.isStopped;if(n||a)return!1;e=i&&i instanceof r.a?i:null}return!0}(e)?console.warn(t):e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=d(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[o.a]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:u(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=d(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function d(e){if(e||(e=c.a.Promise||Promise),!e)throw new Error("no Promise impl found");return e}},function(e,t,n){"use strict";t.a="function"==typeof Object.assign?Object.assign:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=0;n<(arguments.length<=1?0:arguments.length-1);n++){var r=n+1<1||arguments.length<=n+1?void 0:arguments[n+1];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}},function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.find)return e.find(t,n);for(var r=e.length>>>0,i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return a}}n.d(t,"a",(function(){return r}))},function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return h})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"k",(function(){return u})),n.d(t,"l",(function(){return s}));var r=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,i=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,a=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,o=/^(\d*\.?\d*)f$/,s=/^(\d*\.?\d*)t$/,u=/^(?:(\d*\.?\d*)h)?(?:(\d*\.?\d*)m)?(?:(\d*\.?\d*)s)?(?:(\d*\.?\d*)ms)?$/,c=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,l=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/,d=/^#([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})$/,f=/^#([0-9A-f])([0-9A-f])([0-9A-f])([0-9A-f])$/,p=/^rgb\( *(\d+) *, *(\d+) *, *(\d+) *\)/,h=/^rgba\( *(\d+) *, *(\d+) *, *(\d+) *, *(\d+) *\)/},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);function i(){for(var e=0,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(var a=n.length;e<a;){var o=n[e];if(!Object(r.a)(o))return o;e++}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return c}));var r,i=n(31),a=!i.a&&!!window.MSInputMethodContext&&!!document.documentMode,o=!i.a&&("Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/(Trident|Edge)\//.test(navigator.userAgent)),s=!i.a&&-1!==navigator.userAgent.toLowerCase().indexOf("edg/"),u=!i.a&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),c=!i.a&&/SamsungBrowser/.test(navigator.userAgent),l=!i.a&&(Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>=0||"[object SafariRemoteNotification]"===(null===(r=window.safari)||void 0===r?void 0:r.pushNotification.toString())),d=!i.a&&"string"==typeof navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},function(e,t,n){"use strict";function r(e,t,n){var r,i=e.repeatCount;return i>=0?i:(r=null!=t?t.start:null!=n?n:Number.MAX_VALUE,Math.ceil((r-e.start)/e.duration)-1)}function i(e,t,n){var i=e.start,a=e.duration;return a<=0?i:i+(r(e,t,n)+1)*a}function a(e,t){var n;return e*t.timescale+(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0)}function o(e,t){var n;return(e-(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0))/t.timescale}function s(e,t,n){return[e*n,(e+t)*n]}function u(e,t,n){var r=e.timeline,s=a(t,e);if(s<0)return null;var u=function(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;e[i].start<=t?n=i+1:r=i}return n-1}(r,s);if(u<0||u>=r.length-1)return null;var c=r[u];if(c.duration<=0)return null;var l=r[u+1];if(void 0===l)return null;var d=l.start;return s>=i(c,l,n)&&s<d?o(d,e):null}n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return u}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(10),i=[];function a(e){Object(r.a)(i,e)||(console.warn(e),i.push(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return _})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return s})),n.d(t,"k",(function(){return o})),n.d(t,"l",(function(){return y}));function r(e,t){return Math.abs(e-t)<.016666666666666666}function i(e,t){return{start:Math.min(e.start,t.start),end:Math.max(e.end,t.end)}}function a(e,t){return e.end<=t.start}function o(e,t){for(var n=0;n<e.length;n++)if(s(e[n],t))return!0;return!1}function s(e,t){var n=e.start,r=e.end;return n<=t&&t<r}function u(e,t){return s(e,t.start)||e.start<t.end&&t.end<e.end||s(t,e.start)}function c(e,t){return r(t.start,e.end)||r(t.end,e.start)}function l(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function d(e,t){for(var n=e.length-1;n>=0;n--){var r=e.start(n);if(t>=r){var i=e.end(n);if(t<i)return{start:r,end:i}}}return null}function f(e,t){for(var n=e.length,r=0;r<n;r++){var i=e.start(r);if(t<i)return i-t}return 1/0}function p(e,t){for(var n=null,r=[],i=0;i<e.length;i++){var a=e.start(i),o=e.end(i);t<a||t>=o?r.push({start:a,end:o}):n={start:a,end:o}}return{outerRanges:r,innerRange:n}}function h(e,t){var n=d(e,t);return null!==n?n.end-n.start:0}function v(e,t){var n=d(e,t);return null!==n?t-n.start:0}function m(e,t){var n=d(e,t);return null!==n?n.end-t:1/0}function b(e,t){if(t.start===t.end)return e;for(var n=t,r=0;r<e.length;r++){var o=e[r],s=u(n,o),l=c(n,o);if(s||l)n=i(n,o),e.splice(r--,1);else if(0===r){if(a(n,e[0]))break}else if(a(e[r-1],n)&&a(n,o))break}return e.splice(r,0,n),function(e){for(var t=1;t<e.length;t++){var n=e[t-1],r=e[t];if(c(n,r)){var a=i(n,r);e.splice(--t,2,a)}}return e}(function(e){for(var t=0;t<e.length;t++){var n=e[t];n.start===n.end&&e.splice(t--,1)}return e}(e))}function g(e,t){for(var n=[],r=0;r<t.length;r++)u(e,t[r])&&n.push(t[r]);return n}function y(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],a=g(i,t);if(a.length>0)for(var o=0;o<a.length;o++){var s=a[o];n.push({start:Math.max(i.start,s.start),end:Math.min(i.end,s.end)})}}return n}function _(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],a=[],o=g(i,t);if(o.length>0)for(var s=0;s<o.length;s++){var u=o[s];a.push({start:Math.max(i.start,u.start),end:Math.min(i.end,u.end)})}if(0===a.length)n.push(i);else{for(var c=i.start,l=0;l<a.length;l++)a[l].start>c&&n.push({start:c,end:a[l].start}),c=a[l].end;c<i.end&&n.push({start:c,end:i.end})}}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c}));var r=n(5),i=n(9),a=n(12),o=n(90),s=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return r.a(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(i.a),u=(i.a,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.a(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(i.a));i.a;function c(e,t){if(!t.closed)return e instanceof a.a?e.subscribe(t):Object(o.a)(e)(t)}},function(e,t,n){"use strict";var r=n(33);t.a=r.a},function(e,t,n){"use strict";var r=n(178),i=n.n(r);t.a="function"==typeof Promise?Promise:i.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(61),i=n(109),a=n(66),o=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),s=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}var t;return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,s=n._parentOrParents,c=n._ctorUnsubscribe,l=n._unsubscribe,d=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof e)s.remove(this);else if(null!==s)for(var f=0;f<s.length;++f){s[f].remove(this)}if(Object(a.a)(l)){c&&(this._unsubscribe=void 0);try{l.call(this)}catch(e){t=e instanceof o?u(e.errors):[e]}}if(Object(r.a)(d)){f=-1;for(var p=d.length;++f<p;){var h=d[f];if(Object(i.a)(h))try{h.unsubscribe()}catch(e){t=t||[],e instanceof o?t=t.concat(u(e.errors)):t.push(e)}}}if(t)throw new o(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var a=this._subscriptions;return null===a?this._subscriptions=[n]:a.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=((t=new e).closed=!0,t),e}();function u(e){return e.reduce((function(e,t){return e.concat(t instanceof o?t.errors:t)}),[])}},function(e,t,n){"use strict";var r=n(12),i=n(69),a=n(30),o=n(3);t.a=function(e){if(e instanceof r.a)return e;if(!Object(o.a)(e)&&"function"==typeof e.subscribe){var t=e;return new r.a((function(e){var n=t.subscribe((function(t){e.next(t)}),(function(t){e.error(t)}),(function(){e.complete()}));return function(){Object(o.a)(n)||"function"!=typeof n.dispose?Object(o.a)(n)||"function"!=typeof n.unsubscribe||n.unsubscribe():n.dispose()}}))}return Object(o.a)(e)||"function"!=typeof e.then?Object(a.a)(e):Object(i.a)(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(12),i=n(0),a=n(3),o=function(){function e(){this._listeners={}}var t=e.prototype;return t.addEventListener=function(e,t){var n=this._listeners[e];Array.isArray(n)?n.push(t):this._listeners[e]=[t]},t.removeEventListener=function(e,t){if(Object(a.a)(e))this._listeners={};else{var n=this._listeners[e];if(Array.isArray(n))if(Object(a.a)(t))delete this._listeners[e];else{var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&delete this._listeners[e]}}},t.trigger=function(e,t){var n=this._listeners[e];Array.isArray(n)&&n.slice().forEach((function(e){try{e(t)}catch(e){i.a.error(e,e instanceof Error?e.stack:null)}}))},e}();function s(e,t){return new r.a((function(n){function r(e){n.next(e)}return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}}))}},function(e,t,n){"use strict";var r=n(12),i=n(4),a=n(145),o=n(2),s=n(3),u=i.a.DEFAULT_REQUEST_TIMEOUT;var c=function(e){var t={url:e.url,headers:e.headers,responseType:Object(s.a)(e.responseType)?"json":e.responseType,timeout:Object(s.a)(e.timeout)?u:e.timeout};return new r.a((function(n){var r=t.url,i=t.headers,u=t.responseType,c=t.timeout,l=new XMLHttpRequest;if(l.open("GET",r,!0),c>=0&&(l.timeout=c),l.responseType=u,"document"===l.responseType&&l.overrideMimeType("text/xml"),!Object(s.a)(i)){var d=i;for(var f in d)d.hasOwnProperty(f)&&l.setRequestHeader(f,d[f])}var p=performance.now();return l.onerror=function(){n.error(new a.a(r,l.status,"ERROR_EVENT",l))},l.ontimeout=function(){n.error(new a.a(r,l.status,"TIMEOUT",l))},!0===e.sendProgressEvents&&(l.onprogress=function(e){var t=performance.now();n.next({type:"progress",value:{url:r,duration:t-p,sendingTime:p,currentTime:t,size:e.loaded,totalSize:e.total}})}),l.onload=function(e){if(4===l.readyState)if(l.status>=200&&l.status<300){var t,i=performance.now(),u=l.response instanceof ArrayBuffer?l.response.byteLength:e.total,c=l.status,d=l.responseType,f=Object(o.a)(l.responseURL)?l.responseURL:r;if(t="json"===d?"object"==typeof l.response?l.response:function(e){try{return JSON.parse(e)}catch(e){return null}}(l.responseText):l.response,Object(s.a)(t))return void n.error(new a.a(r,l.status,"PARSE_ERROR",l));n.next({type:"data-loaded",value:{status:c,url:f,responseType:d,sendingTime:p,receivedTime:i,duration:i-p,size:u,responseData:t}}),n.complete()}else n.error(new a.a(r,l.status,"ERROR_HTTP_CODE",l))},l.send(),function(){Object(s.a)(l)||4===l.readyState||l.abort()}}))};t.a=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(56),i=n(76),a=n(87);function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return Object(r.a)(n)?(e.pop(),Object(a.a)(e,n)):Object(i.a)(e)}},function(e,t,n){"use strict";var r="undefined"==typeof window;t.a=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v}));var r=n(4),i=n(0),a=n(166),o=n(18),s=r.a.MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE,u=r.a.MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE,c=r.a.MINIMUM_SEGMENT_SIZE,l=function(){function e(){this._inventory=[]}var t=e.prototype;return t.reset=function(){this._inventory.length=0},t.synchronizeBuffered=function(e){for(var t=this._inventory,n=0,r=t[0],a=null==r?void 0:r.infos.adaptation.type,s=e.length,u=0;u<s;u++){if(void 0===r)return;var l=e.start(u),d=e.end(u);if(d-l<c)i.a.warn("SI: skipped TimeRange when synchronizing because it was too small",a,l,d);else{for(var f=n;void 0!==r&&Object(o.a)(r.bufferedEnd,r.end)-l<c;)r=t[++n];var v=null,m=n-f;if(m>0){var b=t[f+m-1];v={end:Object(o.a)(b.bufferedEnd,b.end),precizeEnd:b.precizeEnd},i.a.debug("SI: "+m+" segments GCed.",a),t.splice(f,m),n=f}if(void 0===r)return;if(d-Object(o.a)(r.bufferedStart,r.start)>=c){if(p(r,l,v,a),n===t.length-1)return void h(r,d,a);r=t[++n];for(var g=Object(o.a)(r.bufferedStart,r.start),y=Object(o.a)(r.bufferedEnd,r.end),_=u<s-1?e.start(u+1):void 0;void 0!==r&&d-g>=c&&(void 0===_||d-g>=y-_);){var O=t[n-1];void 0===O.bufferedEnd&&(O.bufferedEnd=r.precizeStart?r.start:O.end,i.a.debug("SI: calculating buffered end of contiguous segment",a,O.bufferedEnd,O.end)),r.bufferedStart=O.bufferedEnd,void 0!==(r=t[++n])&&(g=Object(o.a)(r.bufferedStart,r.start),y=Object(o.a)(r.bufferedEnd,r.end))}}var T=t[n-1];void 0!==T&&h(T,d,a)}}null!=r&&(i.a.debug("SI: last segments have been GCed",a,n,t.length),t.splice(n,t.length-n)),void 0!==a&&"DEBUG"===i.a.getLevel()&&i.a.debug("SI: current "+a+" inventory timeline:\n"+function(e){var t=1/60,n={},r=[],i=null,a=null;function o(e){var t=String.fromCharCode(r.length+65);return r.push({letter:t,periodId:e.period.id,representationId:e.representation.id,bitrate:e.representation.bitrate}),t}for(var s="",u=0;u<e.length;u++){var c=e[u];if(void 0!==c.bufferedStart&&void 0!==c.bufferedEnd){var l,d=c.infos.period.id,f=c.infos.representation.id,p=n[d],h=void 0;if(void 0===p)h=o(c.infos),n[d]=((l={})[f]=h,l);else void 0===p[f]?(h=o(c.infos),p[f]=h):h=p[f];null===i?s+=c.bufferedStart.toFixed(2)+"|"+h+"|":a===h?i.bufferedEnd+t<c.bufferedStart&&(s+=i.bufferedEnd.toFixed(2)+" ~ "+c.bufferedStart.toFixed(2)+"|"+h+"|"):s+=i.bufferedEnd.toFixed(2)+" ~ "+c.bufferedStart.toFixed(2)+"|"+h+"|",i=c,a=h}}null!==i&&(s+=String(i.end.toFixed(2)));return r.forEach((function(e){var t;s+="\n["+e.letter+"] P: "+e.periodId+" || R: "+e.representationId+"("+(null!==(t=e.bitrate)&&void 0!==t?t:"unknown bitrate")+")"})),s}(this._inventory))},t.insertChunk=function(e){var t=e.period,n=e.adaptation,r=e.representation,a=e.segment,o=e.start,s=e.end;if(!a.isInit){var u=n.type;if(o>=s)i.a.warn("SI: Invalid chunked inserted: starts before it ends",u,o,s);else{for(var c=this._inventory,l={partiallyPushed:!0,estimatedStart:o,start:o,end:s,precizeStart:!1,precizeEnd:!1,bufferedStart:void 0,bufferedEnd:void 0,infos:{segment:a,period:t,adaptation:n,representation:r}},d=c.length-1;d>=0;d--){var f=c[d];if(f.start<=o){if(f.end<=o){for(i.a.debug("SI: Pushing segment strictly after previous one.",u,o,f.end),this._inventory.splice(d+1,0,l),d+=2;d<c.length&&c[d].start<l.end;){if(c[d].end>l.end)return i.a.debug("SI: Segment pushed updates the start of the next one",u,l.end,c[d].start),c[d].start=l.end,c[d].bufferedStart=void 0,void(c[d].precizeStart=c[d].precizeStart&&l.precizeEnd);i.a.debug("SI: Segment pushed removes the next one",u,o,s,c[d].start,c[d].end),c.splice(d,1)}return}if(f.start===o){if(f.end<=s){for(i.a.debug("SI: Segment pushed replace another one",u,o,s,f.end),this._inventory.splice(d,1,l),d+=1;d<c.length&&c[d].start<l.end;){if(c[d].end>l.end)return i.a.debug("SI: Segment pushed updates the start of the next one",u,l.end,c[d].start),c[d].start=l.end,c[d].bufferedStart=void 0,void(c[d].precizeStart=c[d].precizeStart&&l.precizeEnd);i.a.debug("SI: Segment pushed removes the next one",u,o,s,c[d].start,c[d].end),c.splice(d,1)}return}return i.a.debug("SI: Segment pushed ends before another with the same start",u,o,s,f.end),c.splice(d,0,l),f.start=l.end,f.bufferedStart=void 0,void(f.precizeStart=f.precizeStart&&l.precizeEnd)}if(f.end<=l.end){for(i.a.debug("SI: Segment pushed updates end of previous one",u,o,s,f.start,f.end),this._inventory.splice(d+1,0,l),f.end=l.start,f.bufferedEnd=void 0,f.precizeEnd=f.precizeEnd&&l.precizeStart,d+=2;d<c.length&&c[d].start<l.end;){if(c[d].end>l.end)return i.a.debug("SI: Segment pushed updates the start of the next one",u,l.end,c[d].start),c[d].start=l.end,c[d].bufferedStart=void 0,void(c[d].precizeStart=c[d].precizeStart&&l.precizeEnd);i.a.debug("SI: Segment pushed removes the next one",u,o,s,c[d].start,c[d].end),c.splice(d,1)}return}i.a.debug("SI: Segment pushed is contained in a previous one",u,o,s,f.start,f.end);var p={partiallyPushed:f.partiallyPushed,start:l.end,end:f.end,precizeStart:f.precizeStart&&f.precizeEnd&&l.precizeEnd,precizeEnd:f.precizeEnd,bufferedStart:void 0,bufferedEnd:f.end,infos:f.infos};return f.end=l.start,f.bufferedEnd=void 0,f.precizeEnd=f.precizeEnd&&l.precizeStart,c.splice(d+1,0,l),void c.splice(d+2,0,p)}}var h=this._inventory[0];if(void 0===h)return i.a.debug("SI: first segment pushed",u,o,s),void this._inventory.push(l);if(!(h.start>=s)){if(h.end<=s){for(i.a.debug("SI: Segment pushed starts before and completely recovers the previous first one",u,o,s,h.start,h.end),this._inventory.splice(0,1,l);c.length>1&&c[1].start<l.end;){if(c[1].end>l.end)return i.a.debug("SI: Segment pushed updates the start of the next one",u,l.end,c[1].start),c[1].start=l.end,c[1].bufferedStart=void 0,void(c[1].precizeStart=l.precizeEnd);i.a.debug("SI: Segment pushed removes the next one",u,o,s,c[1].start,c[1].end),c.splice(1,1)}return}return i.a.debug("SI: Segment pushed start of the next one",u,o,s,h.start,h.end),h.start=s,h.bufferedStart=void 0,h.precizeStart=l.precizeEnd,void this._inventory.splice(0,0,l)}i.a.debug("SI: Segment pushed comes before all previous ones",u,o,s,h.start),this._inventory.splice(0,0,l)}}},t.completeSegment=function(e){if(!e.segment.isInit){for(var t=this._inventory,n=!1,r=0;r<t.length;r++)if(Object(a.a)(t[r].infos,e)){n&&i.a.warn("SI: Completed Segment is splitted.",e),n=!0;var o=r;for(r+=1;r<t.length&&Object(a.a)(t[r].infos,e);)r++;var s=r-1,u=s-o,c=t[s].end,l=t[s].bufferedEnd;u>0&&(this._inventory.splice(o+1,u),r-=u),this._inventory[o].partiallyPushed=!1,this._inventory[o].end=c,this._inventory[o].bufferedEnd=l}n||i.a.warn("SI: Completed Segment not found",e)}},t.getInventory=function(){return this._inventory},e}();function d(e){if(void 0===e.bufferedStart||e.partiallyPushed)return!1;var t=e.start,n=e.end-t;return Math.abs(t-e.bufferedStart)<=s&&(void 0===e.bufferedEnd||e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-n)<=Math.min(u,n/3))}function f(e){if(void 0===e.bufferedEnd||e.partiallyPushed)return!1;var t=e.start,n=e.end,r=n-t;return Math.abs(n-e.bufferedEnd)<=s&&null!=e.bufferedStart&&e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-r)<=Math.min(u,r/3)}function p(e,t,n,r){void 0!==e.bufferedStart?(e.bufferedStart<t&&(i.a.debug("SI: Segment partially GCed at the start",r,e.bufferedStart,t),e.bufferedStart=t),!e.precizeStart&&d(e)&&(e.start=e.bufferedStart,e.precizeStart=!0)):e.precizeStart?(i.a.debug("SI: buffered start is precize start",r,e.start),e.bufferedStart=e.start):null!==n&&n.end>t&&(n.precizeEnd||e.start-n.end<=s)?(i.a.debug("SI: buffered start is end of previous segment",r,t,e.start,n.end),e.bufferedStart=n.end,d(e)&&(e.start=n.end,e.precizeStart=!0)):e.start-t<=s?(i.a.debug("SI: found true buffered start",r,t,e.start),e.bufferedStart=t,d(e)&&(e.start=t,e.precizeStart=!0)):t<e.start?i.a.debug("SI: range start too far from expected start",r,t,e.start):(i.a.debug("SI: Segment appears immediately garbage collected at the start",r,e.bufferedStart,t),e.bufferedStart=t)}function h(e,t,n){void 0!==e.bufferedEnd?(e.bufferedEnd>t&&(i.a.debug("SI: Segment partially GCed at the end",n,e.bufferedEnd,t),e.bufferedEnd=t),!e.precizeEnd&&t-e.end<=s&&f(e)&&(e.precizeEnd=!0,e.end=t)):e.precizeEnd?(i.a.debug("SI: buffered end is precize end",n,e.end),e.bufferedEnd=e.end):t-e.end<=s?(i.a.debug("SI: found true buffered end",n,t,e.end),e.bufferedEnd=t,f(e)&&(e.end=t,e.precizeEnd=!0)):t>e.end?(i.a.debug("SI: range end too far from expected end",n,t,e.end),e.bufferedEnd=e.end):(i.a.debug("SI: Segment appears immediately garbage collected at the end",n,e.bufferedEnd,t),e.bufferedEnd=t)}var v,m=function(){function e(){this._segmentInventory=new l}var t=e.prototype;return t.synchronizeInventory=function(){this._segmentInventory.synchronizeBuffered(this.getBufferedRanges())},t.getInventory=function(){return this._segmentInventory.getInventory()},t.getPendingOperations=function(){return[]},e}();!function(e){e[e.Push=0]="Push",e[e.Remove=1]="Remove",e[e.EndOfSegment=2]="EndOfSegment"}(v||(v={}))},function(e,t,n){"use strict";t.a={directfile:null,emeManager:null,htmlTextTracksBuffer:null,htmlTextTracksParsers:{},imageBuffer:null,imageParser:null,nativeTextTracksBuffer:null,nativeTextTracksParsers:{},transports:{}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return s}));var r=n(60),i=n(3),a=n(31).a?{}:window,o=a.HTMLElement,s=Object(i.a)(a.VTTCue)?a.TextTrackCue:a.VTTCue,u=Object(i.a)(a.MediaSource)?Object(i.a)(a.MozMediaSource)?Object(i.a)(a.WebKitMediaSource)?a.MSMediaSource:a.WebKitMediaSource:a.MozMediaSource:a.MediaSource,c=Object(i.a)(a.MediaKeys)?Object(i.a)(a.MozMediaKeys)?function(){return function(){var e=function(){throw new r.a("MEDIA_KEYS_NOT_SUPPORTED","No `MediaKeys` implementation found in the current browser.")};this.create=e,this.createSession=e,this.isTypeSupported=e,this.setServerCertificate=e}}():a.MozMediaKeys:a.MediaKeys,l={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u}));var r=n(0),i=n(1);function a(e,t){var n=s(e,t);return null!==n?e.subarray(n[1],n[2]):null}function o(e,t){var n=s(e,t);return null!==n?e.subarray(n[0],n[2]):null}function s(e,t){for(var n,r,a=e.length,o=0,s=0;o+8<=a;){if(r=o,s=Object(i.c)(e,r),r+=4,n=Object(i.c)(e,r),r+=4,0===s)s=a-o;else if(1===s){if(r+8>a)return null;s=Object(i.d)(e,r),r+=8}if(s<0)throw new Error("ISOBMFF: Size out of range");if(n===t)return 1970628964===t&&(r+=16),[o,r,o+s];o+=s}return null}function u(e,t,n,r,a){for(var o,s=e.length,u=0;u<s;u+=o){var c=u;o=Object(i.c)(e,c),c+=4;var l=Object(i.c)(e,c);if(c+=4,0===o)o=s-u;else if(1===o){if(c+8>s)return;o=Object(i.d)(e,c),c+=8}if(1970628964===l&&c+16<=s&&Object(i.c)(e,c)===t&&Object(i.c)(e,c+4)===n&&Object(i.c)(e,c+8)===r&&Object(i.c)(e,c+12)===a)return c+=16,e.subarray(c,u+o)}}function c(e){var t=e.length;if(t<8)return r.a.warn("ISOBMFF: box inferior to 8 bytes, cannot find offsets"),null;var n=0,a=Object(i.c)(e,n);n+=4;var o=Object(i.c)(e,n);if(n+=4,0===a)a=t;else if(1===a){if(n+8>t)return r.a.warn("ISOBMFF: box too short, cannot find offsets"),null;a=Object(i.d)(e,n),n+=8}if(a<0)throw new Error("ISOBMFF: Size out of range");return 1970628964===o&&(n+=16),[0,n,a]}},function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t,n);for(var r=e.length>>>0,i=0;i<r;i++)if(t.call(n,e[i],i,e))return i;return-1}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(e,t))}}var o=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.project,this.thisArg))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return r.a(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(i.a)},function(e,t,n){"use strict";var r={loaded:function(e){return{type:"loaded",value:{segmentBuffersStore:e}}},decipherabilityUpdate:function(e){return{type:"decipherabilityUpdate",value:e}},manifestReady:function(e){return{type:"manifestReady",value:{manifest:e}}},manifestUpdate:function(){return{type:"manifestUpdate",value:null}},nullRepresentation:function(e,t){return{type:"representationChange",value:{type:e,representation:null,period:t}}},reloadingMediaSource:function(){return{type:"reloading-media-source",value:void 0}},stalled:function(e){return{type:"stalled",value:e}},unstalled:function(){return{type:"unstalled",value:null}},warning:function(e){return{type:"warning",value:e}}};t.a=r},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(204),i=n(161),a=n(205),o=n(206);function s(t){var n="function"==typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!a(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return o(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},function(e,t,n){"use strict";n.r(t),n.d(t,"isActive",(function(){return z})),n.d(t,"isVideoVisible",(function(){return H})),n.d(t,"videoWidth$",(function(){return W})),n.d(t,"onPlayPause$",(function(){return J})),n.d(t,"onTextTrackChanges$",(function(){return ee})),n.d(t,"onLoadedMetadata$",(function(){return G})),n.d(t,"onSeeking$",(function(){return Y})),n.d(t,"onSeeked$",(function(){return q})),n.d(t,"onEnded$",(function(){return X})),n.d(t,"onTimeUpdate$",(function(){return Q})),n.d(t,"onFullscreenChange$",(function(){return Z})),n.d(t,"onSourceOpen$",(function(){return te})),n.d(t,"onUpdate$",(function(){return ne})),n.d(t,"onRemoveSourceBuffers$",(function(){return re})),n.d(t,"onEncrypted$",(function(){return ie})),n.d(t,"onKeyMessage$",(function(){return ae})),n.d(t,"onKeyAdded$",(function(){return oe})),n.d(t,"onKeyError$",(function(){return se})),n.d(t,"onKeyStatusesChange$",(function(){return ue})),n.d(t,"onPictureInPictureEvent$",(function(){return $}));var r=n(227),i=n(12),a=n(59),o=new i.a(a.a);var s=n(105),u=n(82),c=n(30),l=n(233),d=n(228),f=n(37),p=n(185),h=n(186),v=n(141),m=n(5),b=n(51),g=n(115),y=n(9),_=n(86);function O(e,t){void 0===t&&(t=b.a);var n=Object(g.a)(e)?+e-t.now():Math.abs(e);return function(e){return e.lift(new T(n,t))}}var T=function(){function e(e,t){this.delay=e,this.scheduler=t}return e.prototype.call=function(e,t){return t.subscribe(new E(e,this.delay,this.scheduler))},e}(),E=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.delay=n,i.scheduler=r,i.queue=[],i.active=!1,i.errored=!1,i}return m.a(t,e),t.dispatch=function(e){for(var t=e.source,n=t.queue,r=e.scheduler,i=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(i);if(n.length>0){var a=Math.max(0,n[0].time-r.now());this.schedule(e,a)}else this.unsubscribe(),t.active=!1},t.prototype._schedule=function(e){this.active=!0,this.destination.add(e.schedule(t.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))},t.prototype.scheduleNotification=function(e){if(!0!==this.errored){var t=this.scheduler,n=new w(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}},t.prototype._next=function(e){this.scheduleNotification(_.a.createNext(e))},t.prototype._error=function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.scheduleNotification(_.a.createComplete()),this.unsubscribe()},t}(y.a),w=function(){return function(e,t){this.time=e,this.notification=t}}(),S=n(187),j=n(23),k={leading:!0,trailing:!1};j.b;var A=function(){function e(e,t,n,r){this.duration=e,this.scheduler=t,this.leading=n,this.trailing=r}return e.prototype.call=function(e,t){return t.subscribe(new x(e,this.duration,this.scheduler,this.leading,this.trailing))},e}(),x=function(e){function t(t,n,r,i,a){var o=e.call(this,t)||this;return o.duration=n,o.scheduler=r,o.leading=i,o.trailing=a,o._hasTrailingValue=!1,o._trailingValue=null,o}return m.a(t,e),t.prototype._next=function(e){this.throttled?this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(I,this.duration,{subscriber:this})),this.leading?this.destination.next(e):this.trailing&&(this._trailingValue=e,this._hasTrailingValue=!0))},t.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},t.prototype.clearThrottle=function(){var e=this.throttled;e&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),e.unsubscribe(),this.remove(e),this.throttled=null)},t}(y.a);function I(e){e.subscriber.clearThrottle()}var M=n(4),R=n(2),C=n(34),N=n(31),P=n(116),D=["","webkit","moz","ms"],L=M.a.INACTIVITY_DELAY,B=N.a||null==window.devicePixelRatio||0===window.devicePixelRatio?1:window.devicePixelRatio;function U(e,t){return t.filter((function(t){return function(e,t){var n=document.createElement(e.tagName),r="on"+t;return r in n||(n.setAttribute(r,"return;"),"function"==typeof n[r])}(e,t)}))[0]}function F(e,t){var n,i=function(e,t){return e.reduce((function(e,n){return e.concat((null==t?D:t).map((function(e){return e+n})))}),[])}(e,t);return function(e){return e instanceof C.a?(void 0===n&&(n=U(e,i)),Object(R.a)(n)?Object(r.a)(e,n):o):s.a.apply(void 0,i.map((function(t){return Object(r.a)(e,t)})))}}function V(){var e,t=document;null!=t.hidden?e="":null!=t.mozHidden?e="moz":null!=t.msHidden?e="ms":null!=t.webkitHidden&&(e="webkit");var n=Object(R.a)(e)?e+"Hidden":"hidden",i=Object(R.a)(e)?e+"visibilitychange":"visibilitychange";return Object(u.a)((function(){var e=document[n];return Object(r.a)(document,i).pipe(Object(f.a)((function(){return!document[n]})),Object(p.a)(!e),Object(h.a)())}))}function z(){return V().pipe(Object(v.a)((function(e){return e?Object(c.a)(e):Object(c.a)(e).pipe(O(L))})))}function K(e,t){var n=t.width,r=t.height/(e.clientHeight/e.clientWidth);return Math.min(n,r)}function $(e){return Object(u.a)((function(){if(e.webkitSupportsPresentationMode&&"function"==typeof e.webkitSetPresentationMode){var t="picture-in-picture"===e.webkitPresentationMode;return Object(r.a)(e,"webkitpresentationmodechanged").pipe(Object(f.a)((function(){return{isEnabled:"picture-in-picture"===e.webkitPresentationMode,pipWindow:null}})),Object(p.a)({isEnabled:t,pipWindow:null}))}var n={isEnabled:document.pictureInPictureElement&&document.pictureInPictureElement===e,pipWindow:null};return Object(s.a)(Object(r.a)(e,"enterpictureinpicture").pipe(Object(f.a)((function(e){return{isEnabled:!0,pipWindow:e.pictureInPictureWindow}}))),Object(r.a)(e,"leavepictureinpicture").pipe(Object(S.a)({isEnabled:!1,pipWindow:null}))).pipe(Object(p.a)(n))}))}function H(e){return Object(l.a)([V(),e]).pipe(Object(v.a)((function(e){var t=e[0];return e[1].isEnabled||t?Object(c.a)(!0):Object(c.a)(!1).pipe(O(L))})),Object(h.a)())}function W(e,t){return Object(l.a)([t,Object(d.a)(2e4).pipe(Object(p.a)(null)),Object(r.a)(window,"resize").pipe((n=500,void 0===i&&(i=b.a),void 0===a&&(a=k),function(e){return e.lift(new A(n,i,a.leading,a.trailing))}),Object(p.a)(null))]).pipe(Object(v.a)((function(t){var n=t[0];if(n.isEnabled){if(null!=n.pipWindow){var i=n.pipWindow,a=K(e,i);return Object(r.a)(i,"resize").pipe(Object(p.a)(a*B),Object(f.a)((function(){return K(e,i)*B})))}return Object(c.a)(1/0)}return Object(c.a)(e.clientWidth*B)})),Object(h.a)());var n,i,a}var G=F(["loadedmetadata"]),Y=F(["seeking"]),q=F(["seeked"]),X=F(["ended"]),Q=F(["timeupdate"]),Z=F(["fullscreenchange","FullscreenChange"],D.concat("MS")),J=function(e){return Object(s.a)(F(["play"])(e),F(["pause"])(e))},ee=function(e){return Object(s.a)(F(["addtrack"])(e),F(["removetrack"])(e))},te=F(["sourceopen","webkitsourceopen"]),ne=F(["update"]),re=F(["onremovesourcebuffer"]),ie=F(Object(P.a)()?["needkey"]:["encrypted","needkey"]),ae=F(["keymessage","message"]),oe=F(["keyadded","ready"]),se=F(["keyerror","error"]),ue=F(["keystatuseschange"])},function(e,t,n){"use strict";t.a=function(){}},,function(e,t,n){"use strict";function r(e,t){if(e.length!==t.length)return!1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return!1;return!0}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(97);function i(e,t){try{return e(t)}catch(e){return Object(r.a)(e)}}},function(e,t,n){"use strict";var r=new WeakMap;t.a={setState:function(e,t){r.set(e,t)},getState:function(e){var t=r.get(e);return void 0===t?null:t},clearState:function(e){r.set(e,null)}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r={NETWORK_ERROR:"NETWORK_ERROR",MEDIA_ERROR:"MEDIA_ERROR",ENCRYPTED_MEDIA_ERROR:"ENCRYPTED_MEDIA_ERROR",OTHER_ERROR:"OTHER_ERROR"},i={TIMEOUT:"TIMEOUT",ERROR_EVENT:"ERROR_EVENT",ERROR_HTTP_CODE:"ERROR_HTTP_CODE",PARSE_ERROR:"PARSE_ERROR"},a={PIPELINE_LOAD_ERROR:"PIPELINE_LOAD_ERROR",PIPELINE_PARSE_ERROR:"PIPELINE_PARSE_ERROR",INTEGRITY_ERROR:"INTEGRITY_ERROR",MANIFEST_PARSE_ERROR:"MANIFEST_PARSE_ERROR",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"MANIFEST_INCOMPATIBLE_CODECS_ERROR",MANIFEST_UPDATE_ERROR:"MANIFEST_UPDATE_ERROR",MANIFEST_UNSUPPORTED_ADAPTATION_TYPE:"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE",MEDIA_STARTING_TIME_NOT_FOUND:"MEDIA_STARTING_TIME_NOT_FOUND",MEDIA_TIME_BEFORE_MANIFEST:"MEDIA_TIME_BEFORE_MANIFEST",MEDIA_TIME_AFTER_MANIFEST:"MEDIA_TIME_AFTER_MANIFEST",MEDIA_TIME_NOT_FOUND:"MEDIA_TIME_NOT_FOUND",NO_PLAYABLE_REPRESENTATION:"NO_PLAYABLE_REPRESENTATION",MEDIA_IS_ENCRYPTED_ERROR:"MEDIA_IS_ENCRYPTED_ERROR",CREATE_MEDIA_KEYS_ERROR:"CREATE_MEDIA_KEYS_ERROR",KEY_ERROR:"KEY_ERROR",KEY_STATUS_CHANGE_ERROR:"KEY_STATUS_CHANGE_ERROR",KEY_UPDATE_ERROR:"KEY_UPDATE_ERROR",KEY_LOAD_ERROR:"KEY_LOAD_ERROR",KEY_LOAD_TIMEOUT:"KEY_LOAD_TIMEOUT",KEY_GENERATE_REQUEST_ERROR:"KEY_GENERATE_REQUEST_ERROR",INCOMPATIBLE_KEYSYSTEMS:"INCOMPATIBLE_KEYSYSTEMS",INVALID_ENCRYPTED_EVENT:"INVALID_ENCRYPTED_EVENT",INVALID_KEY_SYSTEM:"INVALID_KEY_SYSTEM",LICENSE_SERVER_CERTIFICATE_ERROR:"LICENSE_SERVER_CERTIFICATE_ERROR",MULTIPLE_SESSIONS_SAME_INIT_DATA:"MULTIPLE_SESSIONS_SAME_INIT_DATA",BUFFER_APPEND_ERROR:"BUFFER_APPEND_ERROR",BUFFER_FULL_ERROR:"BUFFER_FULL_ERROR",BUFFER_TYPE_UNKNOWN:"BUFFER_TYPE_UNKNOWN",MEDIA_ERR_BLOCKED_AUTOPLAY:"MEDIA_ERR_BLOCKED_AUTOPLAY",MEDIA_ERR_PLAY_NOT_ALLOWED:"MEDIA_ERR_PLAY_NOT_ALLOWED",MEDIA_ERR_NOT_LOADED_METADATA:"MEDIA_ERR_NOT_LOADED_METADATA",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_UNKNOWN:"MEDIA_ERR_UNKNOWN",MEDIA_SOURCE_NOT_SUPPORTED:"MEDIA_SOURCE_NOT_SUPPORTED",MEDIA_KEYS_NOT_SUPPORTED:"MEDIA_KEYS_NOT_SUPPORTED",DISCONTINUITY_ENCOUNTERED:"DISCONTINUITY_ENCOUNTERED",NONE:"NONE"}},function(e,t,n){"use strict";function r(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e[n],t&=t;return t}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=!1,i={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack;r=e},get useDeprecatedSynchronousErrorHandling(){return r}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=n(37),a=n(69),o=n(23);function s(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?function(r){return r.pipe(s((function(n,r){return Object(a.a)(e(n,r)).pipe(Object(i.a)((function(e,i){return t(n,e,r,i)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new u(e,n))})}var u=function(){function e(e,t){void 0===t&&(t=Number.POSITIVE_INFINITY),this.project=e,this.concurrent=t}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.project,this.concurrent))},e}(),c=function(e){function t(t,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=e.call(this,t)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return r.a(t,e),t.prototype._next=function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.active++,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new o.a(this),n=this.destination;n.add(t);var r=Object(o.c)(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyComplete=function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},t}(o.b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(92),i=new(n(91).a)(r.a)},function(e,t,n){"use strict";function r(e){var t=e[0],n=e[1];return n===1/0?"bytes="+t+"-":"bytes="+t+"-"+n}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));var r=n(0),i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],a=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function o(e){if(e>=a.length)throw new Error("Unable to parse base64 string.");var t=a[e];if(255===t)throw new Error("Unable to parse base64 string.");return t}function s(e){var t,n="",r=e.length;for(t=2;t<r;t+=3)n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4|e[t-1]>>4],n+=i[(15&e[t-1])<<2|e[t]>>6],n+=i[63&e[t]];return t===r+1&&(n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4],n+="=="),t===r&&(n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4|e[t-1]>>4],n+=i[(15&e[t-1])<<2],n+="="),n}function u(e){var t=e.length%4,n=e;0!==t&&(r.a.warn("base64ToBytes: base64 given miss padding"),n+=3===t?"=":2===t?"==":"===");var i=n.indexOf("=");if(-1!==i&&i<n.length-2)throw new Error("Unable to parse base64 string.");for(var a,s=n.endsWith("==")?2:n.endsWith("=")?1:0,u=n.length,c=new Uint8Array(u/4*3),l=0,d=0;l<u;l+=4,d+=3)a=o(n.charCodeAt(l))<<18|o(n.charCodeAt(l+1))<<12|o(n.charCodeAt(l+2))<<6|o(n.charCodeAt(l+3)),c[d]=a>>16,c[d+1]=a>>8&255,c[d+2]=255&a;return c.subarray(0,c.length-s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(188);function i(e){throw new r.a("Unreachable path taken")}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}));var r=n(188),i=n(3);function a(e,t){if(!e)throw new r.a(void 0===t?"invalid assertion":t)}function o(e,t,n){for(var r in void 0===n&&(n="object"),a(!Object(i.a)(e),n+" should be an object"),t)t.hasOwnProperty(r)&&a(typeof e[r]===t[r],n+" should have property "+r+" as a "+t[r])}},function(e,t,n){"use strict";function r(e){return e&&"function"==typeof e.schedule}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(5),i=n(12),a=n(9),o=n(26),s=n(65),u=n(117),c=n(83),l=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return r.a(t,e),t}(a.a),d=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return r.a(t,e),t.prototype[c.a]=function(){return new l(this)},t.prototype.lift=function(e){var t=new f(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new s.a;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new s.a;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new s.a;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new s.a;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new s.a;return this.hasError?(e.error(this.thrownError),o.a.EMPTY):this.isStopped?(e.complete(),o.a.EMPTY):(this.observers.push(e),new u.a(this,e))},t.prototype.asObservable=function(){var e=new i.a;return e.source=this,e},t.create=function(e,t){return new f(e,t)},t}(i.a),f=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return r.a(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):o.a.EMPTY},t}(d)},function(e,t,n){"use strict";var r=n(107);t.a=r.a},function(e,t,n){"use strict";function r(){}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=n.n(s),c=n(47),l=n(74),d=function(e){function t(n,r){var a;return a=e.call(this)||this,Object.setPrototypeOf(i()(a),t.prototype),a.name="MediaError",a.type=c.b.MEDIA_ERROR,a.code=n,a.message=Object(l.a)(a.name,a.code,r),a.fatal=!1,a}return o()(t,e),t}(u()(Error))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){return Array.isArray||function(e){return e&&"number"==typeof e.length}}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(12),i=new r.a((function(e){return e.complete()}));function a(e){return e?function(e){return new r.a((function(t){return e.schedule((function(){return t.complete()}))}))}(e):i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(82),i=n(37),a=n(157);function o(e,t){return function(n){return Object(r.a)((function(){return n.pipe(Object(i.a)(e),Object(a.a)((function(e){return e!==t})))}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}()},function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=/^(?:[a-z]+:)?\/\//i,i=/\/\.{1,2}\//;function a(e){if(!i.test(e))return e;for(var t=[],n=e.split("/"),r=0,a=n.length;r<a;r++)if(".."===n[r])t.pop();else{if("."===n[r])continue;t.push(n[r])}return t.join("/")}function o(){var e=arguments.length;if(0===e)return"";for(var t="",n=0;n<e;n++){var i=n<0||arguments.length<=n?void 0:arguments[n];"string"==typeof i&&""!==i&&(r.test(i)?t=i:("/"===i[0]&&(i=i.substring(1)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t=t+"/"+i))}return a(t)}function s(e){var t=e.lastIndexOf("/");if(t<0)return e;if(r.test(e)){var n=e.indexOf("/");if(n>=0&&t===n+1)return e}var i=e.indexOf("?");return i>=0&&i<t?s(e.substring(0,i)):e.substring(0,t+1)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(2);function i(e){for(var t=0;t<e.length;){if(""===e[t])return t+1;t++}return t}function a(e,t){return"string"==typeof e[t]&&/^STYLE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}function o(e,t){var n=e[t];if(void 0===n||""===n||a(e,t)||function(e,t){return"string"==typeof e[t]&&/^REGION( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}(e,t)||function(e,t){return"string"==typeof e[t]&&/^NOTE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}(e,t))return!1;if(n.indexOf("--\x3e")>=0)return!0;var r=e[t+1];return void 0!==r&&r.indexOf("--\x3e")>=0}function s(e,t){for(var n=t+1;Object(r.a)(e[n]);)n++;return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(12),i=n(90),a=n(26),o=n(62);var s=n(87),u=n(75);var c=n(114),l=n(112);function d(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[o.a]}(e))return function(e,t){return new r.a((function(n){var r=new a.a;return r.add(t.schedule((function(){var i=e[o.a]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(Object(c.a)(e))return function(e,t){return new r.a((function(n){var r=new a.a;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(Object(l.a)(e))return Object(s.a)(e,t);if(function(e){return e&&"function"==typeof e[u.a]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new r.a((function(n){var r,i=new a.a;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[u.a](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}function f(e,t){return t?d(e,t):e instanceof r.a?e:new r.a(Object(i.a)(e))}},function(e,t,n){"use strict";function r(e){setTimeout((function(){throw e}),0)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r;if(n.d(t,"a",(function(){return r})),!n(31).a){var i=window.WebKitMediaKeys;void 0!==i&&"function"==typeof i.isTypeSupported&&"function"==typeof i.prototype.createSession&&"function"==typeof HTMLMediaElement.prototype.webkitSetMediaKeys&&(r=i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(14),i=n(10),a=n(2),o=n(101);function s(e,t,n,o){for(var s={},u=e.slice(),c=0;c<=t.length-1;c++){var l=t[c];if(void 0!==l){var d=function(){var e=void 0,t=void 0;if(l.nodeType===Node.ELEMENT_NODE)for(var c=l,d=0;d<=c.attributes.length-1;d++){var f=c.attributes[d],p=f.name;if("style"===p)e=f.value;else if("region"===p)t=f.value;else{var h=p.substring(4);if(Object(i.a)(u,h)&&(s[h]=f.value,u.splice(d,1),0===u.length))return{v:s}}}if(Object(a.a)(e)){var v=Object(r.a)(n,(function(t){return t.id===e}));if(void 0!==v)for(var m=0;m<=u.length-1;m++){var b=u[m];if(!Object(a.a)(s[b])&&Object(a.a)(v.style[b])){if(s[b]=v.style[b],u.splice(m,1),0===u.length)return{v:s};m--}}}if(Object(a.a)(t)){var g=Object(r.a)(o,(function(e){return e.id===t}));if(void 0!==g)for(var y=0;y<=u.length-1;y++){var _=u[y];if(!Object(a.a)(s[_])&&Object(a.a)(g.style[_])){if(s[_]=g.style[_],u.splice(y,1),0===u.length)return{v:s};y--}}}}();if("object"==typeof d)return d.v}}return s}function u(e){if(e.nodeType!==Node.ELEMENT_NODE)return{};for(var t=e,n={},r=0;r<=t.attributes.length-1;r++){var i=t.attributes[r];if(Object(o.a)(i.name,"tts"))n[i.name.substring(4)]=i.value}return n}},function(e,t,n){"use strict";var r=n(15),i=n.n(r),a=n(44),o=n(14),s=n(1),u=n(28),c=n(85),l=n(21),d=n(60),f=n(0),p=n(10),h=n(3),v=n(58);var m="undefined"!=typeof window&&"function"==typeof window.Set?function(e){return Array.from(new Set(e))}:function(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))},b=n(167),g=function(){function e(e,t){this.id=e.id,this.bitrate=e.bitrate,this.codec=e.codecs,null!=e.height&&(this.height=e.height),null!=e.width&&(this.width=e.width),null!=e.mimeType&&(this.mimeType=e.mimeType),void 0!==e.contentProtections&&(this.contentProtections=e.contentProtections),null!=e.frameRate&&(this.frameRate=e.frameRate),this.index=e.index,this.isSupported="audio"!==t.type&&"video"!==t.type||Object(b.a)(this.getMimeTypeString())}var t=e.prototype;return t.getMimeTypeString=function(){var e,t;return(null!==(e=this.mimeType)&&void 0!==e?e:"")+';codecs="'+(null!==(t=this.codec)&&void 0!==t?t:"")+'"'},t.getProtectionsInitializationData=function(){var e=this.contentProtections;return void 0===e?[]:Object.keys(e.initData).reduce((function(t,n){var r=e.initData[n];if(void 0===r||0===r.length)return t;var i=s.e.apply(void 0,r.map((function(e){return e.data})));return t.push({type:n,data:i}),t}),[])},t._addProtectionData=function(e,t,n){var r={systemId:t,data:n};if(void 0!==this.contentProtections){var i=this.contentProtections.initData[e];if(void 0!==i){for(var o=i.length-1;o>=0;o--)if(i[o].systemId===t){if(Object(a.a)(i[o].data,n))return;f.a.warn("Manifest: Two PSSH for the same system ID")}i.push(r)}else this.contentProtections.initData[e]=[r]}else{var s;this.contentProtections={keyIds:[],initData:(s={},s[e]=[r],s)}}},e}(),y=["audio","video","text","image"];var _,O=function(){function e(e,t){void 0===t&&(t={});var n,r=t,i=r.representationFilter,a=r.isManuallyAdded;if(this.parsingErrors=[],this.id=e.id,n=e.type,!Object(p.a)(y,n))throw f.a.info("Manifest: Not supported adaptation type",e.type),new d.a("MANIFEST_UNSUPPORTED_ADAPTATION_TYPE",'"'+e.type+'" is not a valid Adaptation type.');this.type=e.type,void 0!==e.language&&(this.language=e.language,this.normalizedLanguage=Object(v.a)(e.language)),void 0!==e.closedCaption&&(this.isClosedCaption=e.closedCaption),void 0!==e.audioDescription&&(this.isAudioDescription=e.audioDescription),void 0!==e.isDub&&(this.isDub=e.isDub),void 0!==e.isSignInterpreted&&(this.isSignInterpreted=e.isSignInterpreted);for(var o=e.representations,s=[],u=!1,c=!1,l=0;l<o.length;l++){var m=new g(o[l],{type:this.type});(Object(h.a)(i)||i(m,{bufferType:this.type,language:this.language,normalizedLanguage:this.normalizedLanguage,isClosedCaption:this.isClosedCaption,isDub:this.isDub,isAudioDescription:this.isAudioDescription,isSignInterpreted:this.isSignInterpreted}))&&(s.push(m),!1===u&&!1!==m.decipherable&&(u=m.decipherable),!c&&m.isSupported&&(c=!0))}if(s.sort((function(e,t){return e.bitrate-t.bitrate})),this.representations=s,this.decipherable=u,this.isSupported=c,this.manuallyAdded=!0===a,this.representations.length>0&&!c){f.a.warn("Incompatible codecs for adaptation",e);var b=new d.a("MANIFEST_INCOMPATIBLE_CODECS_ERROR","An Adaptation contains only incompatible codecs.");this.parsingErrors.push(b)}}var t=e.prototype;return t.getAvailableBitrates=function(){for(var e=[],t=0;t<this.representations.length;t++){var n=this.representations[t];!1!==n.decipherable&&e.push(n.bitrate)}return m(e)},t.getPlayableRepresentations=function(){return this.representations.filter((function(e){return e.isSupported&&!1!==e.decipherable}))},t.getRepresentation=function(e){return Object(o.a)(this.representations,(function(t){var n=t.id;return e===n}))},e}(),T=n(182),E=n(78),w=function(){function e(e,t){var n=this;if(this.parsingErrors=[],this.id=e.id,this.adaptations=Object.keys(e.adaptations).reduce((function(r,i){var a=e.adaptations[i];if(null==a)return r;var o=a.map((function(e){var r,i=null;try{i=new O(e,{representationFilter:t})}catch(e){if(Object(T.a)(e)&&"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE"===e.code)return n.parsingErrors.push(e),null;throw e}return(r=n.parsingErrors).push.apply(r,i.parsingErrors),i})).filter((function(e){return null!==e&&e.representations.length>0}));if(o.every((function(e){return!e.isSupported}))&&a.length>0&&("video"===i||"audio"===i))throw new d.a("MANIFEST_PARSE_ERROR","No supported "+i+" adaptations");return o.length>0&&(r[i]=o),r}),{}),!Array.isArray(this.adaptations.video)&&!Array.isArray(this.adaptations.audio))throw new d.a("MANIFEST_PARSE_ERROR","No supported audio and video tracks.");this.duration=e.duration,this.start=e.start,null!=this.duration&&null!=this.start&&(this.end=this.start+this.duration),this.streamEvents=void 0===e.streamEvents?[]:e.streamEvents}var t=e.prototype;return t.getAdaptations=function(){var e=this.adaptations;return Object(E.a)(e).reduce((function(e,t){return null!=t?e.concat(t):e}),[])},t.getAdaptationsForType=function(e){var t=this.adaptations[e];return null==t?[]:t},t.getAdaptation=function(e){return Object(o.a)(this.getAdaptations(),(function(t){var n=t.id;return e===n}))},t.getPlayableAdaptations=function(e){if(void 0===e)return this.getAdaptations().filter((function(e){return e.isSupported&&!1!==e.decipherable}));var t=this.adaptations[e];return void 0===t?[]:t.filter((function(e){return e.isSupported&&!1!==e.decipherable}))},e}(),S=function(){function e(e){this._mediaURLs=e.media}var t=e.prototype;return t.getInitSegment=function(){return null},t.getSegments=function(){return[{id:"0",isInit:!1,number:0,mediaURLs:[this._mediaURLs],time:0,end:Number.MAX_VALUE,duration:Number.MAX_VALUE,timescale:1}]},t.getFirstPosition=function(){},t.getLastPosition=function(){},t.shouldRefresh=function(){return!1},t.checkDiscontinuity=function(){return null},t.areSegmentsChronologicallyGenerated=function(){return!0},t.isSegmentStillAvailable=function(){return!0},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){return!0},t.isInitialized=function(){return!0},t._replace=function(){f.a.warn("Tried to replace a static RepresentationIndex")},t._update=function(){f.a.warn("Tried to update a static RepresentationIndex")},e}();!function(e){e[e.Full=0]="Full",e[e.Partial=1]="Partial"}(_||(_={}));var j=n(36);function k(e,t,n){e.start=t.start,e.end=t.end,e.duration=t.duration;for(var r=e.getAdaptations(),i=t.getAdaptations(),a=function(e){var t=r[e],a=Object(o.a)(i,(function(e){return e.id===t.id}));if(void 0===a)f.a.warn('Manifest: Adaptation "'+r[e].id+'" not found when merging.');else for(var s=r[e].representations,u=a.representations,c=function(e){var t=s[e],r=Object(o.a)(u,(function(e){return e.id===t.id}));void 0===r?f.a.warn('Manifest: Representation "'+s[e].id+'" not found when merging.'):n===_.Full?t.index._replace(r.index):t.index._update(r.index)},l=0;l<s.length;l++)c(l)},s=0;s<r.length;s++)a(s)}var A=Object(c.a)(),x=Object(c.a)(),I=function(e){function t(t,n){var r,i;r=e.call(this)||this;var a=n.supplementaryTextTracks,o=void 0===a?[]:a,s=n.supplementaryImageTracks,u=void 0===s?[]:s,c=n.representationFilter;return r.parsingErrors=[],r.id=x(),r.expired=null!==(i=t.expired)&&void 0!==i?i:null,r.transport=t.transportType,r.clockOffset=t.clockOffset,r.periods=t.periods.map((function(e){var t,n=new w(e,c);return(t=r.parsingErrors).push.apply(t,n.parsingErrors),n})).sort((function(e,t){return e.start-t.start})),r.adaptations=void 0===r.periods[0]?{}:r.periods[0].adaptations,r._timeBounds=t.timeBounds,r.isDynamic=t.isDynamic,r.isLive=t.isLive,r.uris=void 0===t.uris?[]:t.uris,r.lifetime=t.lifetime,r.suggestedPresentationDelay=t.suggestedPresentationDelay,r.availabilityStartTime=t.availabilityStartTime,u.length>0&&r._addSupplementaryImageAdaptations(u),o.length>0&&r._addSupplementaryTextAdaptations(o),r}i()(t,e);var n=t.prototype;return n.getPeriod=function(e){return Object(o.a)(this.periods,(function(t){return e===t.id}))},n.getPeriodForTime=function(e){return Object(o.a)(this.periods,(function(t){return e>=t.start&&(void 0===t.end||t.end>e)}))},n.getNextPeriod=function(e){return Object(o.a)(this.periods,(function(t){return t.start>e}))},n.getPeriodAfter=function(e){var t=e.end;if(void 0===t)return null;var n=Object(o.a)(this.periods,(function(e){return void 0===e.end||t<e.end}));return void 0===n?null:n},n.getUrl=function(){return this.uris[0]},n.replace=function(e){this._performUpdate(e,_.Full)},n.update=function(e){this._performUpdate(e,_.Partial)},n.getMinimumPosition=function(){var e,t,n=this._timeBounds;if(null===n.timeshiftDepth)return null!==(e=n.absoluteMinimumTime)&&void 0!==e?e:0;var r,i=n.maximumTimeData;if(n.maximumTimeData.isLinear){var a=performance.now()-i.time;r=i.value+a/1e3}else r=i.value;var o=r-n.timeshiftDepth;return Math.max(null!==(t=n.absoluteMinimumTime)&&void 0!==t?t:0,o)},n.getMaximumPosition=function(){var e=this._timeBounds.maximumTimeData;if(!e.isLinear)return e.value;var t=performance.now()-e.time;return e.value+t/1e3},n.addUndecipherableKIDs=function(e){var t=M(this,(function(t){if(!1===t.decipherable||void 0===t.contentProtections)return!0;for(var n=t.contentProtections.keyIds,r=0;r<n.length;r++)for(var i=n[r],a=0;a<e.length;a++)if(Object(s.f)(e[a],i.keyId))return!1;return!0}));t.length>0&&this.trigger("decipherabilityUpdate",t)},n.addUndecipherableProtectionData=function(e,t){var n=M(this,(function(n){if(!1===n.decipherable)return!0;for(var r=n.getProtectionsInitializationData(),i=0;i<r.length;i++)if(r[i].type===e&&Object(a.a)(t,r[i].data))return!1;return!0}));n.length>0&&this.trigger("decipherabilityUpdate",n)},n.getAdaptations=function(){Object(l.a)("manifest.getAdaptations() is deprecated. Please use manifest.period[].getAdaptations() instead");var e=this.periods[0];if(void 0===e)return[];var t=e.adaptations,n=[];for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n.push.apply(n,i)}return n},n.getAdaptationsForType=function(e){Object(l.a)("manifest.getAdaptationsForType(type) is deprecated. Please use manifest.period[].getAdaptationsForType(type) instead");var t=this.periods[0];if(void 0===t)return[];var n=t.adaptations[e];return void 0===n?[]:n},n.getAdaptation=function(e){return Object(l.a)("manifest.getAdaptation(id) is deprecated. Please use manifest.period[].getAdaptation(id) instead"),Object(o.a)(this.getAdaptations(),(function(t){var n=t.id;return e===n}))},n._addSupplementaryImageAdaptations=function(e){var t=this,n=(Array.isArray(e)?e:[e]).map((function(e){var n,r=e.mimeType,i=e.url,a="gen-image-ada-"+A(),o="gen-image-rep-"+A(),s=new O({id:a,type:"image",representations:[{bitrate:0,id:o,mimeType:r,index:new S({media:i})}]},{isManuallyAdded:!0});return(n=t.parsingErrors).push.apply(n,s.parsingErrors),s}));if(n.length>0&&this.periods.length>0){var r=this.periods[0].adaptations;r.image=null!=r.image?r.image.concat(n):n}},n._addSupplementaryTextAdaptations=function(e){var t=this,n=(Array.isArray(e)?e:[e]).reduce((function(e,n){var r=n.mimeType,i=n.codecs,a=n.url,o=n.language,s=n.languages,u=n.closedCaption,c=null!=o?[o]:null!=s?s:[];return e.concat(c.map((function(e){var n,o="gen-text-ada-"+A(),s="gen-text-rep-"+A(),c=new O({id:o,type:"text",language:e,closedCaption:u,representations:[{bitrate:0,id:s,mimeType:r,codecs:i,index:new S({media:a})}]},{isManuallyAdded:!0});return(n=t.parsingErrors).push.apply(n,c.parsingErrors),c})))}),[]);if(n.length>0&&this.periods.length>0){var r=this.periods[0].adaptations;r.text=null!=r.text?r.text.concat(n):n}},n._performUpdate=function(e,t){if(this.availabilityStartTime=e.availabilityStartTime,this.expired=e.expired,this.isDynamic=e.isDynamic,this.isLive=e.isLive,this.lifetime=e.lifetime,this.parsingErrors=e.parsingErrors,this.suggestedPresentationDelay=e.suggestedPresentationDelay,this.transport=e.transport,t===_.Full)this._timeBounds=e._timeBounds,this.uris=e.uris,function(e,t){for(var n=0,r=0;r<t.length;r++){for(var i=t[r],a=n,o=e[a];null!=o&&o.id!==i.id;)o=e[++a];if(null!=o){k(o,i,_.Full);var s=t.slice(n,r),u=a-n;e.splice.apply(e,[n,u].concat(s)),n=r+1}}if(n>e.length)f.a.error("Manifest: error when updating Periods");else{n<e.length&&e.splice(n,e.length-n);var c=t.slice(n,t.length);c.length>0&&e.push.apply(e,c)}}(this.periods,e.periods);else{this._timeBounds.maximumTimeData=e._timeBounds.maximumTimeData,function(e,t){if(0!==e.length){if(0!==t.length){var n=e[e.length-1];if(n.start<t[0].start){if(n.end!==t[0].start)throw new d.a("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");e.push.apply(e,t)}else{var r=Object(j.a)(e,(function(e){return e.id===t[0].id}));if(r<0)throw new d.a("MANIFEST_UPDATE_ERROR","Cannot perform partial update: incoherent data");k(e[r],t[0],_.Partial);for(var i=r+1,a=1;a<t.length;a++){for(var o=t[a],s=-1,u=i;u<e.length;u++)if(o.id===e[u].id){s=u;break}if(s<0)return void e.splice.apply(e,[i,e.length-i].concat(t.slice(a,t.length)));s>i&&(e.splice(i,s-i),s=i),k(e[s],o,_.Full),i++}i<e.length&&e.splice(i,e.length-i)}}}else e.splice.apply(e,[0,0].concat(t))}(this.periods,e.periods);for(var n=this.getMinimumPosition();this.periods.length>0;){var r=this.periods[0];if(void 0===r.end||r.end>n)break;this.periods.shift()}}this.adaptations=void 0===this.periods[0]?{}:this.periods[0].adaptations,this.trigger("manifestUpdate",null)},t}(u.a);function M(e,t){for(var n=[],r=0;r<e.periods.length;r++)for(var i=e.periods[r],a=i.getAdaptations(),o=0;o<a.length;o++)for(var s=a[o],u=s.representations,c=0;c<u.length;c++){var l=u[c];t(l)||(n.push({manifest:e,period:i,adaptation:s,representation:l}),l.decipherable=!1)}return n}t.a=I},function(e,t,n){"use strict";function r(e,t,n){return e+" ("+t+") "+n}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(t,"a",(function(){return i}));var i=r()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),i=n(113),a=n(87);function o(e,t){return t?Object(a.a)(e,t):new r.a(Object(i.a)(e))}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){"use strict";t.a="function"==typeof Object.values?Object.values:function(e){return Object.keys(e).map((function(t){return e[t]}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(5),i=1,a=function(){return Promise.resolve()}(),o={};function s(e){return e in o&&(delete o[e],!0)}var u=function(e){var t=i++;return o[t]=!0,a.then((function(){return s(t)&&e()})),t},c=function(e){s(e)},l=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.a(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t.scheduled||(t.scheduled=u(t.flush.bind(t,null))))},t.prototype.recycleAsyncId=function(t,n,r){if(void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);0===t.actions.length&&(c(n),t.scheduled=void 0)},t}(n(92).a),d=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.a(t,e),t.prototype.flush=function(e){this.active=!0,this.scheduled=void 0;var t,n=this.actions,r=-1,i=n.length;e=e||n.shift();do{if(t=e.execute(e.state,e.delay))break}while(++r<i&&(e=n.shift()));if(this.active=!1,t){for(;++r<i&&(e=n.shift());)e.unsubscribe();throw t}},t}(n(91).a))(l),f=d,p=n(12),h=n(84),v=function(e){function t(t,n,r){void 0===n&&(n=0),void 0===r&&(r=f);var i=e.call(this)||this;return i.source=t,i.delayTime=n,i.scheduler=r,(!Object(h.a)(n)||n<0)&&(i.delayTime=0),r&&"function"==typeof r.schedule||(i.scheduler=f),i}return r.a(t,e),t.create=function(e,n,r){return void 0===n&&(n=0),void 0===r&&(r=f),new t(e,n,r)},t.dispatch=function(e){var t=e.source,n=e.subscriber;return this.add(t.subscribe(n))},t.prototype._subscribe=function(e){var n=this.delayTime,r=this.source;return this.scheduler.schedule(t.dispatch,n,{source:r,subscriber:e})},t}(p.a);var m=function(){function e(e,t){this.scheduler=e,this.delay=t}return e.prototype.call=function(e,t){return new v(t,this.delay,this.scheduler).subscribe(e)},e}();function b(){return function(e){return e.pipe((t=d,void 0===n&&(n=0),function(e){return e.lift(new m(t,n))}));var t,n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=n.n(s),c=n(47),l=n(74),d=function(e){function t(n,r){var a;return a=e.call(this)||this,Object.setPrototypeOf(i()(a),t.prototype),a.name="OtherError",a.type=c.b.OTHER_ERROR,a.code=n,a.message=Object(l.a)(a.name,a.code,r),a.fatal=!1,a}return o()(t,e),t}(u()(Error))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e,t){for(var n=e.length,i=0;i+8<=n;){var a=Object(r.c)(e,i);if(0===a)a=n-i;else if(1===a){if(i+16>n)return-1;a=Object(r.d)(e,i+8)}if(isNaN(a)||a<=0)return-1;if(Object(r.c)(e,i+4)===t)return i+a<=n?i:-1;i+=a}return-1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),i=n(69),a=n(63);function o(e){return new r.a((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?Object(i.a)(n):Object(a.b)()).subscribe(t)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(61);function i(e){return!Object(r.a)(e)&&e-parseFloat(e)+1>=0}},function(e,t,n){"use strict";function r(){var e="",t=-1;return function(){return++t>=Number.MAX_SAFE_INTEGER&&(e+="0",t=0),e+String(t)}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,i=n(63),a=n(30),o=n(97);r||(r={});var s=function(){function e(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}return e.prototype.observe=function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}},e.prototype.do=function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}},e.prototype.accept=function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)},e.prototype.toObservable=function(){switch(this.kind){case"N":return Object(a.a)(this.value);case"E":return Object(o.a)(this.error);case"C":return Object(i.b)()}throw new Error("unexpected notification kind value")},e.createNext=function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification},e.createError=function(t){return new e("E",void 0,t)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(12),i=n(26);function a(e,t){return new r.a((function(n){var r=new i.a,a=0;return r.add(t.schedule((function(){a!==e.length?(n.next(e[a++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.a(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(n(9).a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(22),i=function(){function e(){this._ranges=[],this.length=0}var t=e.prototype;return t.insert=function(e,t){Object(r.i)(this._ranges,{start:e,end:t}),this.length=this._ranges.length},t.remove=function(e,t){var n=[];e>0&&n.push({start:0,end:e}),t<1/0&&n.push({start:t,end:1/0}),this._ranges=Object(r.l)(this._ranges,n),this.length=this._ranges.length},t.start=function(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].start},t.end=function(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].end},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(113),i=n(70),a=n(75),o=n(62),s=n(112),u=n(114),c=n(109),l=function(e){if(e&&"function"==typeof e[o.a])return l=e,function(e){var t=l[o.a]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(Object(s.a)(e))return Object(r.a)(e);if(Object(u.a)(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,i.a),e};if(e&&"function"==typeof e[a.a])return t=e,function(e){for(var n=t[a.a]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,l,d=Object(c.a)(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+d+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=function(){function e(t,n){void 0===n&&(n=e.now),this.SchedulerAction=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.SchedulerAction(this,e).schedule(n,t)},e.now=function(){return Date.now()},e}(),a=function(e){function t(n,r){void 0===r&&(r=i.now);var a=e.call(this,n,(function(){return t.delegate&&t.delegate!==a?t.delegate.now():r()}))||this;return a.actions=[],a.active=!1,a.scheduled=void 0,a}return r.a(t,e),t.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),t.delegate&&t.delegate!==this?t.delegate.schedule(n,r,i):e.prototype.schedule.call(this,n,r,i)},t.prototype.flush=function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),i=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return r.a(t,e),t.prototype.schedule=function(e,t){if(void 0===t&&(t=0),this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(e){n=!0,r=!!e&&e||new Error(e)}if(n)return this.unsubscribe(),r},t.prototype._unsubscribe=function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null},t}(function(e){function t(t,n){return e.call(this)||this}return r.a(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(26).a))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return r.a(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(n(9).a),a=n(90),o=n(12);function s(e,t,n,r,s){if(void 0===s&&(s=new i(e,n,r)),!s.closed)return t instanceof o.a?t.subscribe(s):Object(a.a)(t)(s)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(49),i=n(70),a={closed:!0,next:function(e){},error:function(e){if(r.a.useDeprecatedSynchronousErrorHandling)throw e;Object(i.a)(e)},complete:function(){}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return m}));var r=n(154),i=n.n(r),a=n(183),o=n.n(a),s=n(12),u=n(4),c=n(145),l=n(47),d=n(0),f=n(3),p=u.a.DEFAULT_REQUEST_TIMEOUT,h="function"==typeof Headers?Headers:null,v="function"==typeof AbortController?AbortController:null;function m(){return"function"==typeof window.fetch&&!Object(f.a)(v)&&!Object(f.a)(h)}t.a=function(e){var t;if(!Object(f.a)(e.headers))if(Object(f.a)(h))t=e.headers;else{t=new h;for(var n=Object.keys(e.headers),r=0;r<n.length;r++){var a=n[r];t.append(a,e.headers[a])}}return new s.a((function(n){d.a.debug("Fetch: Called with URL",e.url);var r=!1,a=!1,s=!1,u=performance.now(),h=Object(f.a)(v)?null:new v;function m(){if(!s){if(!Object(f.a)(h))return void h.abort();d.a.warn("Fetch: AbortController API not available.")}}var b=Object(f.a)(e.timeout)?p:e.timeout,g=window.setTimeout((function(){a=!0,m()}),b);return fetch(e.url,{headers:t,method:"GET",signal:Object(f.a)(h)?void 0:h.signal}).then((function(e){if(Object(f.a)(g)||clearTimeout(g),e.status>=300)return d.a.warn("Fetch: Request HTTP Error",e),void n.error(new c.a(e.url,e.status,l.c.ERROR_HTTP_CODE));if(!Object(f.a)(e.body)){var t=e.headers.get("Content-Length"),r=Object(f.a)(t)||isNaN(+t)?void 0:+t,a=e.body.getReader(),p=0;return h()}function h(){return v.apply(this,arguments)}function v(){return(v=o()(i.a.mark((function t(){var o,c,l,d,v;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.read();case 2:if((o=t.sent).done||Object(f.a)(o.value)){t.next=11;break}return p+=o.value.byteLength,c=performance.now(),l={type:"data-chunk",value:{url:e.url,currentTime:c,duration:c-u,sendingTime:u,chunkSize:o.value.byteLength,chunk:o.value.buffer,size:p,totalSize:r}},n.next(l),t.abrupt("return",h());case 11:o.done&&(d=performance.now(),v=d-u,s=!0,n.next({type:"data-complete",value:{duration:v,receivedTime:d,sendingTime:u,size:p,status:e.status,url:e.url}}),n.complete());case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}n.error(new c.a(e.url,e.status,l.c.PARSE_ERROR))})).catch((function(t){if(r)d.a.debug("Fetch: Request aborted.");else{if(a)return d.a.warn("Fetch: Request timeouted."),void n.error(new c.a(e.url,0,l.c.TIMEOUT));d.a.warn("Fetch: Request Error",t instanceof Error?t.toString():""),n.error(new c.a(e.url,0,l.c.ERROR_EVENT))}})),function(){r=!0,m()}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(19);function a(e){if(i.b){for(var t=e.textTracks,n=0;n<t.length;n++)t[n].mode="disabled";if(e.hasChildNodes())for(var a=e.childNodes,o=a.length-1;o>=0;o--)if("track"===a[o].nodeName)try{e.removeChild(a[o])}catch(e){r.a.warn("Compat: Could not remove text track child from element.")}}e.src="",e.removeAttribute("src")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(12);function i(e,t){return t?new r.a((function(n){return t.schedule(a,0,{error:e,subscriber:n})})):new r.a((function(t){return t.error(e)}))}function a(e){var t=e.error;e.subscriber.error(t)}},function(e,t,n){"use strict";function r(e,t){return"function"==typeof Array.prototype.flatMap?e.flatMap(t):e.reduce((function(e,n){var r=t(n);return Array.isArray(r)?(e.push.apply(e,r),e):(e.push(r),e)}),[])}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=Math.pow(2,32)-1},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(80),i=n(81);function a(e,t){if(t){if(Object(i.a)(e,1718909296)<0)throw new r.a("INTEGRITY_ERROR","Incomplete `ftyp` box");if(Object(i.a)(e,1836019574)<0)throw new r.a("INTEGRITY_ERROR","Incomplete `moov` box")}else{if(Object(i.a)(e,1836019558)<0)throw new r.a("INTEGRITY_ERROR","Incomplete `moof` box");if(Object(i.a)(e,1835295092)<0)throw new r.a("INTEGRITY_ERROR","Incomplete `mdat` box")}}},function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof String.prototype.startsWith)return e.startsWith(t,n);var r="number"==typeof n?Math.max(n,0):0;return e.substring(r,r+t.length)===t}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(5),i=n(57),a=n(12),o=n(9),s=n(26),u=n(132),c=function(e){function t(t,n){var r=e.call(this)||this;return r.source=t,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return r.a(t,e),t.prototype._subscribe=function(e){return this.getSubject().subscribe(e)},t.prototype.getSubject=function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject},t.prototype.connect=function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new s.a).add(this.source.subscribe(new d(this.getSubject(),this))),e.closed&&(this._connection=null,e=s.a.EMPTY)),e},t.prototype.refCount=function(){return Object(u.a)()(this)},t}(a.a),l=function(){var e=c.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),d=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.a(t,e),t.prototype._error=function(t){this._unsubscribe(),e.prototype._error.call(this,t)},t.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}},t}(i.b);o.a;function f(e,t){return function(n){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new p(r,t));var i=Object.create(n,l);return i.source=n,i.subjectFactory=r,i}}var p=function(){function e(e,t){this.subjectFactory=e,this.selector=t}return e.prototype.call=function(e,t){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(e);return i.add(t.subscribe(r)),i},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(177);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(i.a)()(r.a.apply(void 0,e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=n.n(s),c=n(47),l=n(74),d=function(e){function t(n,r){var a;return a=e.call(this)||this,Object.setPrototypeOf(i()(a),t.prototype),a.name="EncryptedMediaError",a.type=c.b.ENCRYPTED_MEDIA_ERROR,a.code=n,a.message=Object(l.a)(a.name,a.code,r),a.fatal=!1,a}return o()(t,e),t}(u()(Error))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),i=n(56),a=n(111),o=n(76);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Number.POSITIVE_INFINITY,s=null,u=e[e.length-1];return Object(i.a)(u)?(s=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(n=e.pop())):"number"==typeof u&&(n=e.pop()),null===s&&1===e.length&&e[0]instanceof r.a?e[0]:Object(a.a)(n)(Object(o.a)(e,s))}},function(e,t,n){"use strict";function r(e){if(!a()){var t=e;"function"==typeof t.requestFullscreen?t.requestFullscreen():"function"==typeof t.msRequestFullscreen?t.msRequestFullscreen():"function"==typeof t.mozRequestFullScreen?t.mozRequestFullScreen():"function"==typeof t.webkitRequestFullscreen&&t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}}function i(){if(a()){var e=document;"function"==typeof e.exitFullscreen?e.exitFullscreen():"function"==typeof e.msExitFullscreen?e.msExitFullscreen():"function"==typeof e.mozCancelFullScreen?e.mozCancelFullScreen():"function"==typeof e.webkitExitFullscreen&&e.webkitExitFullscreen()}}function a(){var e=document;return null!=e.fullscreenElement||null!=e.mozFullScreenElement||null!=e.webkitFullscreenElement||null!=e.msFullscreenElement}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(2),i=n(3),a={aa:"aar",ab:"abk",ae:"ave",af:"afr",ak:"aka",am:"amh",an:"arg",ar:"ara",as:"asm",av:"ava",ay:"aym",az:"aze",ba:"bak",be:"bel",bg:"bul",bi:"bis",bm:"bam",bn:"ben",bo:"bod",br:"bre",bs:"bos",ca:"cat",ce:"che",ch:"cha",co:"cos",cr:"cre",cs:"ces",cu:"chu",cv:"chv",cy:"cym",da:"dan",de:"deu",dv:"div",dz:"dzo",ee:"ewe",el:"ell",en:"eng",eo:"epo",es:"spa",et:"est",eu:"eus",fa:"fas",ff:"ful",fi:"fin",fj:"fij",fo:"fao",fr:"fra",fy:"fry",ga:"gle",gd:"gla",gl:"glg",gn:"grn",gu:"guj",gv:"glv",ha:"hau",he:"heb",hi:"hin",ho:"hmo",hr:"hrv",ht:"hat",hu:"hun",hy:"hye",hz:"her",ia:"ina",id:"ind",ie:"ile",ig:"ibo",ii:"iii",ik:"ipk",io:"ido",is:"isl",it:"ita",iu:"iku",ja:"jpn",jv:"jav",ka:"kat",kg:"kon",ki:"kik",kj:"kua",kk:"kaz",kl:"kal",km:"khm",kn:"kan",ko:"kor",kr:"kau",ks:"kas",ku:"kur",kv:"kom",kw:"cor",ky:"kir",la:"lat",lb:"ltz",lg:"lug",li:"lim",ln:"lin",lo:"lao",lt:"lit",lu:"lub",lv:"lav",mg:"mlg",mh:"mah",mi:"mri",mk:"mkd",ml:"mal",mn:"mon",mr:"mar",ms:"msa",mt:"mlt",my:"mya",na:"nau",nb:"nob",nd:"nde",ne:"nep",ng:"ndo",nl:"nld",nn:"nno",no:"nor",nr:"nbl",nv:"nav",ny:"nya",oc:"oci",oj:"oji",om:"orm",or:"ori",os:"oss",pa:"pan",pi:"pli",pl:"pol",ps:"pus",pt:"por",qu:"que",rm:"roh",rn:"run",ro:"ron",ru:"rus",rw:"kin",sa:"san",sc:"srd",sd:"snd",se:"sme",sg:"sag",si:"sin",sk:"slk",sl:"slv",sm:"smo",sn:"sna",so:"som",sq:"sqi",sr:"srp",ss:"ssw",st:"sot",su:"sun",sv:"swe",sw:"swa",ta:"tam",te:"tel",tg:"tgk",th:"tha",ti:"tir",tk:"tuk",tl:"tgl",tn:"tsn",to:"ton",tr:"tur",ts:"tso",tt:"tat",tw:"twi",ty:"tah",ug:"uig",uk:"ukr",ur:"urd",uz:"uzb",ve:"ven",vi:"vie",vo:"vol",wa:"wln",wo:"wol",xh:"xho",yi:"yid",yo:"yor",za:"zha",zh:"zho",zu:"zul"},o={alb:"sqi",arm:"hye",baq:"eus",bur:"mya",chi:"zho",cze:"ces",dut:"nld",fre:"fra",geo:"kat",ger:"deu",gre:"ell",ice:"isl",mac:"mkd",mao:"mri",may:"msa",per:"fas",slo:"slk",rum:"ron",tib:"bod",wel:"cym"};function s(e){if(Object(i.a)(e)||""===e)return"";var t=function(e){var t;switch(e.length){case 2:t=a[e];break;case 3:t=o[e]}return t}((""+e).toLowerCase().split("-")[0]);return Object(r.a)(t)?t:e}function u(e){if(!Object(i.a)(e)){var t,n=!1;return"string"==typeof e?t=e:(t=e.language,!0===e.closedCaption&&(n=!0)),{language:t,closedCaption:n,normalized:s(t)}}return e}function c(e){if(Object(i.a)(e))return e;if("string"==typeof e)return{language:e,audioDescription:!1,normalized:s(e)};var t={language:e.language,audioDescription:!0===e.audioDescription,normalized:s(s(e.language))};return!0===e.isDub&&(t.isDub=!0),t}t.a=s},function(e,t,n){"use strict";(function(t,n){var r=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},i=function(e){var t,n,i=document.createTextNode(""),a=0;return new e((function(){var e;if(t)n&&(t=n.concat(t));else{if(!n)return;t=n}if(n=t,t=null,"function"==typeof n)return e=n,n=null,void e();for(i.data=a=++a%2;n;)e=n.shift(),n.length||(n=null),e()})).observe(i,{characterData:!0}),function(e){r(e),t?"function"==typeof t?t=[t,e]:t.push(e):(t=e,i.data=a=++a%2)}};e.exports=function(){if("object"==typeof t&&t&&"function"==typeof t.nextTick)return t.nextTick;if("function"==typeof queueMicrotask)return function(e){queueMicrotask(r(e))};if("object"==typeof document&&document){if("function"==typeof MutationObserver)return i(MutationObserver);if("function"==typeof WebKitMutationObserver)return i(WebKitMutationObserver)}return"function"==typeof n?function(e){n(r(e))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(e){setTimeout(r(e),0)}:null}()}).call(this,n(159),n(160).setImmediate)},function(e,t,n){"use strict";function r(e){return null!==e&&"object"==typeof e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){return e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(50),i=n(110);function a(e){return void 0===e&&(e=Number.POSITIVE_INFINITY),Object(r.a)(i.a,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}}},function(e,t,n){"use strict";function r(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e){return e instanceof Date&&!isNaN(+e)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),i=n(71);function a(){return r.e&&void 0!==i.a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5),i=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return r.a(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(n(26).a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),i=n(11),a=Object(r.c)(Object(i.e)("pssh"),0)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));function r(e){return e*(.3*(2*Math.random()-1)+1)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(82),i=n(30),a=n(192),o=n(193),s=n(0),u=n(46);function c(e){return Object(r.a)((function(){var t=u.a.getState(e);if(null===t)return Object(i.a)(null);s.a.info("EME: Disposing of the current MediaKeys");var n=t.loadedSessionsStore;return u.a.clearState(e),n.closeAllSessions().pipe(Object(a.a)(Object(o.b)(e,null)))}))}},function(e,t,n){"use strict";function r(e,t,n,r){for(var i=0;i<t.length;i++){var a=t[i],o=(a.start-r)/n;if(o>e.time)return!1;if(o===e.time)return a.duration/n===e.duration&&(null==a.range?null==e.range:null!=e.range&&a.range[0]===e.range[0]&&a.range[1]===e.range[1]);if(a.repeatCount>=0&&null!=a.duration){var s=(o-a.start)/a.duration-1;return s%1==0&&s<=a.repeatCount}}return!1}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(60),i=n(0),a=n(20);function o(e,t){var n=e.length;if(0!==e.length){if(0!==t.length){var o=t[0].start,s=e[n-1];if(Object(a.d)(s,t[0])<o)throw new r.a("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");for(var u=n-1;u>=0;u--){var c=e[u].start;if(c===o)return void e.splice.apply(e,[u,n-u].concat(t));if(c<o){var l=e[u];if(l.start+l.duration>o)return i.a.warn("RepresentationIndex: Manifest update removed previous segments"),void e.splice.apply(e,[u,n-u].concat(t));if(void 0===l.repeatCount||l.repeatCount<=0)return l.repeatCount<0&&(l.repeatCount=Math.floor((o-l.start)/l.duration)-1),void e.splice.apply(e,[u+1,n-(u+1)].concat(t));if(l.start+l.duration*(l.repeatCount+1)<=o)return void e.splice.apply(e,[u+1,n-(u+1)].concat(t));var d=(o-l.start)/l.duration-1;if(d%1==0&&l.duration===t[0].duration){var f=t[0].repeatCount<0?-1:t[0].repeatCount+d+1;return e.splice.apply(e,[u,n-u].concat(t)),e[u].start=l.start,void(e[u].repeatCount=f)}return i.a.warn("RepresentationIndex: Manifest update removed previous segments"),e[u].repeatCount=Math.floor(d),void e.splice.apply(e,[u+1,n-(u+1)].concat(t))}}var p=e[e.length-1],h=t[t.length-1];if(void 0!==p.repeatCount&&p.repeatCount<0)return p.start>h.start?void i.a.warn("RepresentationIndex: The new index is older than the previous one"):(i.a.warn('RepresentationIndex: The new index is "bigger" than the previous one'),void e.splice.apply(e,[0,n].concat(t)));p.start+p.duration*(p.repeatCount+1)>=h.start+h.duration*(h.repeatCount+1)?i.a.warn("RepresentationIndex: The new index is older than the previous one"):(i.a.warn('RepresentationIndex: The new index is "bigger" than the previous one'),e.splice.apply(e,[0,n].concat(t)))}}else e.splice.apply(e,[0,n].concat(t))}},function(e,t,n){"use strict";function r(e,t){for(;e.length>0;){var n=e[0];if(n.start>=t)return;if(n.repeatCount<=0)e.shift();else{var r=e[1];if(null!=r&&r.start<=t)e.shift();else{if(n.duration<=0)return;for(var i=n.start+n.duration,a=1;i<t&&a<=n.repeatCount;)i+=n.duration,a++;if(!(a>n.repeatCount)){var o=n.repeatCount-a;return n.start=i,void(n.repeatCount=o)}e.shift()}}}}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(30),i=n(103);function a(e,t){var n=r.a.apply(void 0,e.parsingErrors.map((function(e){return{type:"warning",value:e}})));return Object(i.a)(n,Object(r.a)({type:"parsed",value:{manifest:e,url:t}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(68);function a(e,t){for(var n=[],a=t;a<e.length;a++)if(Object(i.c)(e,a)){var o=Object(i.a)(e,a);n.push(e.slice(a,o)),a=o}else if(Object(r.a)(e[a]))for(;Object(r.a)(e[a]);)a++;return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(34);function a(e,t,n){if(null==i.e)throw new Error("VTT cues not supported in your target");return e>=t?(r.a.warn("Compat: Invalid cue times: "+e+" - "+t),null):new i.e(e,t,n)}},function(e,t,n){"use strict";function r(e,t){if(!(e.parentNode instanceof Element))return[];return function e(n){var r=[];n.tagName.toLowerCase()===t.toLowerCase()&&r.push(n);var i=n.parentNode;return i instanceof Element&&r.push.apply(r,e(i)),r}(e.parentNode)}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(103),i=n(30),a=n(157),o=n(144),s=n(187),u=n(155),c=n(156),l=n(191),d=n(50),f=n(150),p=n(130),h=n(151),v=n(152),m=n(0);function b(e){var t=e.clock$,n=e.mediaElement,b=e.startTime,g=e.mustAutoPlay,y=e.isDirectfile,_=Object(v.a)(n).pipe(Object(o.a)(1),Object(c.a)((function(){m.a.info("Init: Set initial time",b),n.currentTime="function"==typeof b?b():b})),Object(l.a)({refCount:!0})),O=_.pipe(Object(d.a)((function(){return function(e,t,n){var u=e.pipe(Object(a.a)((function(e){var r=e.seeking,i=e.stalled,a=e.readyState,o=e.currentRange;return!r&&null===i&&(Object(f.a)(n,t.hasAttribute("playsinline"))?(a>=4||3===a&&null!==o)&&(!Object(p.a)()||t.duration>0):a>=1&&t.duration>0)})),Object(o.a)(1),Object(s.a)("can-play"));return Object(p.a)()&&0===t.duration?Object(r.a)(Object(i.a)("not-loaded-metadata"),u):u}(t,n,y).pipe(Object(c.a)((function(){return m.a.info("Init: Can begin to play content")})),Object(d.a)((function(e){return"can-play"===e?g?function(e){return Object(h.a)(e).pipe(Object(s.a)("autoplay"),Object(u.a)((function(e){if(e instanceof Error&&"NotAllowedError"===e.name)return m.a.warn("Init: Media element can't play. It may be due to browser auto-play policies."),Object(i.a)("autoplay-blocked");throw e})))}(n):Object(i.a)("loaded"):Object(i.a)(e)})))})),Object(l.a)({refCount:!0}));return{seek$:_,load$:O}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return r.g}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(105),i=n(30),a=n(37),o=n(8),s=n(153),u=n(104),c=n(24),l=n(0),d=o.a.onEncrypted$;function f(e,t,n){var o=Object(r.a)(d(e),n);return null==c.a.emeManager?Object(r.a)(o.pipe(Object(a.a)((function(){throw l.a.error("Init: Encrypted event but EME feature not activated"),new u.a("MEDIA_IS_ENCRYPTED_ERROR","EME feature not activated.")}))),Object(i.a)({type:"eme-disabled"})):0===t.length?Object(r.a)(o.pipe(Object(a.a)((function(){throw l.a.error("Init: Ciphered media and no keySystem passed"),new u.a("MEDIA_IS_ENCRYPTED_ERROR","Media is encrypted and no `keySystems` given")}))),Object(i.a)({type:"eme-disabled"})):Object(s.a)()?(l.a.debug("Init: Creating EMEManager"),c.a.emeManager(e,t,n)):Object(r.a)(o.pipe(Object(a.a)((function(){throw l.a.error("Init: Encrypted event but no EME API available"),new u.a("MEDIA_IS_ENCRYPTED_ERROR","Encryption APIs not found.")}))),Object(i.a)({type:"eme-disabled"}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(){return function(e){return e.lift(new o(e))}}var o=function(){function e(e){this.connectable=e}return e.prototype.call=function(e,t){var n=this.connectable;n._refCount++;var r=new s(e,n),i=t.subscribe(r);return r.closed||(r.connection=n.connect()),i},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.connectable=n,r}return r.a(t,e),t.prototype._unsubscribe=function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(227),i=n(50),a=n(60);function o(e){return Object(r.a)(e,"error").pipe(Object(i.a)((function(){switch(null==e.error?0:e.error.code){case 1:throw new a.a("MEDIA_ERR_ABORTED","The fetching of the associated resource was aborted by the user's request.");case 2:throw new a.a("MEDIA_ERR_NETWORK","A network error occurred which prevented the media from being successfully fetched");case 3:throw new a.a("MEDIA_ERR_DECODE","An error occurred while trying to decode the media resource");case 4:throw new a.a("MEDIA_ERR_SRC_NOT_SUPPORTED","The media resource has been found to be unsuitable.");default:throw new a.a("MEDIA_ERR_UNKNOWN","The HTMLMediaElement errored due to an unknown reason.")}})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(30),i=n(82),a=n(37),o=n(185),s=n(186),u=n(141),c=n(156),l=n(0);function d(e,t,n,d){var f=d.pauseWhenStalled;return(void 0===f||f?n.pipe(Object(a.a)((function(e){return null!==e.stalled})),Object(o.a)(!1),Object(s.a)()):Object(r.a)(!1)).pipe(Object(u.a)((function(n){return n?Object(i.a)((function(){return l.a.info("Init: Pause playback to build buffer"),e.playbackRate=0,Object(r.a)(0)})):t.pipe(Object(c.a)((function(t){l.a.info("Init: Resume playback speed",t),e.playbackRate=t})))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(14),i=n(2),a=n(13),o=n(0),s=/(\d+) (\d+)/;var u=n(128),c=n(72);var l=n(36),d=n(10);var f=["align","backgroundColor","color","direction","display","displayAlign","extent","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","opacity","origin","overflow","padding","textAlign","textDecoration","textOutline","unicodeBidi","visibility","wrapOption","writingMode"];function p(e,t){var n=[],p=(new DOMParser).parseFromString(e,"text/xml");if(null!=p){var h=p.getElementsByTagName("tt")[0];if(void 0===h)throw new Error("invalid XML");for(var v=function(e){return e.getElementsByTagName("body")[0]}(h),m=function(e){return e.getElementsByTagName("style")}(h),b=function(e){return e.getElementsByTagName("region")}(h),g=function(e){return e.getElementsByTagName("p")}(h),y=function(e){var t=e.getAttribute("ttp:frameRate"),n=e.getAttribute("ttp:subFramRate"),r=e.getAttribute("ttp:tickRate"),a=e.getAttribute("ttp:frameRateMultiplier"),u=e.getAttribute("xml:space"),c=e.getAttribute("ttp:cellResolution"),l={columns:32,rows:15};if(null!==c){var d=s.exec(c);if(null===d||d.length<3)o.a.warn("TTML Parser: Invalid cellResolution");else{var f=parseInt(d[1],10),p=parseInt(d[2],10);isNaN(f)||isNaN(p)?o.a.warn("TTML Parser: Invalid cellResolution"):l={columns:f,rows:p}}}if(Object(i.a)(u)&&"default"!==u&&"preserve"!==u)throw new Error("Invalid spacing style");var h=Number(t);(isNaN(h)||h<=0)&&(h=30);var v=Number(n);(isNaN(v)||v<=0)&&(v=1);var m=Number(r);(isNaN(m)||m<=0)&&(m=void 0);var b=h,g=null!=v?v:1,y=null!==u?u:"default",_=void 0!==m?m:h*v;if(null!==a){var O=/^(\d+) (\d+)$/g.exec(a);null!==O&&(b=h*(Number(O[1])/Number(O[2])))}return{cellResolution:l,tickRate:_,frameRate:b,subFrameRate:g,spaceStyle:y}}(h),_=[],O=0;O<=m.length-1;O++){var T=m[O];if(T instanceof Element){var E=T.getAttribute("xml:id");if(null!==E){var w=T.getAttribute("style"),S=null===w?[]:w.split(" ");_.push({id:E,style:Object(c.b)(T),extendsStyles:S})}}}!function(e){var t=[];function n(r,i){t.push(i);for(var s=function(i){var s=r.extendsStyles[i],u=Object(l.a)(e,(function(e){return e.id===s}));if(u<0)o.a.warn("TTML Parser: unknown style inheritance: "+s);else{var c=e[u];Object(d.a)(t,u)?o.a.warn("TTML Parser: infinite style inheritance loop avoided"):n(c,u),r.style=Object(a.a)({},c.style,r.style)}},u=0;u<r.extendsStyles.length;u++)s(u);r.extendsStyles.length=0}for(var r=0;r<e.length;r++)n(e[r],r),t.length=0}(_);for(var j=[],k=0;k<=b.length-1;k++){var A=b[k];if(A instanceof Element){var x=A.getAttribute("xml:id");null!==x&&function(){var e=Object(c.b)(A),t=A.getAttribute("style");if(Object(i.a)(t)){var n=Object(r.a)(_,(function(e){return e.id===t}));void 0!==n&&(e=Object(a.a)({},n.style,e))}j.push({id:x,style:e,extendsStyles:[]})}()}}for(var I=Object(c.a)(f,null!==v?[v]:[],_,j),M="default"===(null!==v?v.getAttribute("xml:space"):void 0)||"default"===y.spaceStyle,R=0;R<g.length;R++){var C=g[R];if(C instanceof Element){var N=Object(u.a)(C,"div"),P=Object(a.a)({},I,Object(c.a)(f,[C].concat(N),_,j)),D=C.getAttribute("xml:space"),L=Object(i.a)(D)?"default"===D:M,B={paragraph:C,timeOffset:t,idStyles:_,regionStyles:j,body:v,paragraphStyle:P,ttParams:y,shouldTrimWhiteSpace:L};null!==B&&n.push(B)}}}return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function i(e,t){for(var n=t+1;Object(r.a)(e[n]);)n++;return n}function a(e){for(var t=[],n=0;n<e.length;n++)if(Object(r.a)(e[n])){var a=i(e,n),o=e.slice(n,a);o.length>0&&(1===o.length?o[0].indexOf("--\x3e")>=0&&t.push(o):(o[1].indexOf("--\x3e")>=0||o[0].indexOf("--\x3e")>=0)&&t.push(o)),n=a}return t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function i(e){var t=e.split(":");if(Object(r.a)(t[2])){var n=parseInt(t[0],10),i=parseInt(t[1],10),a=parseFloat(t[2].replace(",","."));if(isNaN(n)||isNaN(i)||isNaN(a))return;return 60*n*60+60*i+a}}function a(e,t){if(0===e.length)return null;var n,a,o=[];if(Object(r.a)(e[1])&&-1!==e[1].indexOf("--\x3e")){var s=e[1].split("--\x3e").map((function(e){return e.trim()}));n=s[0],a=s[1],o=e.slice(2,e.length)}if(!Object(r.a)(n)||!Object(r.a)(a)){var u=e[0].split("--\x3e").map((function(e){return e.trim()}));n=u[0],a=u[1],o=e.slice(1,e.length)}if(!Object(r.a)(n)||!Object(r.a)(a))return null;var c=i(n),l=i(a);return void 0===c||void 0===l?null:{start:c+t,end:l+t,payload:o}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(3),i=n(29),a=n(12);function o(e){var t=e.url;if(void 0===t)throw new Error("Cannot perform HTTP(s) request. URL not known");return Object(i.a)({url:t,responseType:"text"})}function s(e){var t=e.customManifestLoader;return Object(r.a)(t)?o:function(e,t){return function(n){return new a.a((function(r){var i=n.url,a=Date.now()-performance.now(),o=!1,s=!1,u=e(i,{reject:function(e){s||(o=!0,r.error(e))},resolve:function(e){if(!s){o=!0;var t=void 0!==e.receivingTime?e.receivingTime-a:void 0,n=void 0!==e.sendingTime?e.sendingTime-a:void 0;r.next({type:"data-loaded",value:{responseData:e.data,size:e.size,duration:e.duration,url:e.url,receivedTime:t,sendingTime:n}}),r.complete()}},fallback:function(){s=!0,t(n).subscribe(r)}});return function(){o||s||"function"!=typeof u||u()}}))}}(t,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2);function i(e){var t=e.split(":").reverse();if(Object(r.a)(t[2])||Object(r.a)(t[1])){var n=Object(r.a)(t[2])?parseInt(t[2],10):0,i=parseInt(t[1],10),a=parseFloat(t[0].replace(",","."));if(isNaN(n)||isNaN(i)||isNaN(a))return;return 60*n*60+60*i+a}}function a(e,t){var n,r,a,o=/-->/;if(o.test(e[0]))n=e[0],r=e.slice(1,e.length);else{if(!o.test(e[1]))return null;a=e[0],n=e[1],r=e.slice(2,e.length)}var s=function(e){var t=/^([\d:.]+)[ |\t]+-->[ |\t]+([\d:.]+)[ |\t]*(.*)$/.exec(e);if(null===t)return null;var n=i(t[1]),r=i(t[2]);return null==n||null==r?null:{start:n,end:r,settings:t[3].split(/ |\t/).reduce((function(e,t){var n=t.split(":");return 2===n.length&&(e[n[0]]=n[1]),e}),{})}}(n);return null===s?null:{start:s.start+t,end:s.end+t,settings:s.settings,payload:r,header:a}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(16);function a(e,t){var n=e.exec(t);if(null===n||""===n[0])return null;var r=Number(n[1]);isNaN(r)&&(r=0);var i=Number(n[2]);isNaN(i)&&(i=0);var a=Number(n[3]);isNaN(a)&&(a=0);var o=Number(n[4]);return isNaN(o)&&(o=0),o/1e3+a+60*i+3600*r}var o=function(e,t){return i.h.test(e)?function(e,t){var n=i.h.exec(t),r=Number(n[1]),a=Number(n[2]),o=Number(n[3]),s=Number(n[4]),u=Number(n[5]);isNaN(u)&&(u=0);return s+=u/e.subFrameRate,(o+=s/e.frameRate)+60*a+3600*r}(t,e):i.g.test(e)?a(i.g,e):i.i.test(e)?a(i.i,e):i.j.test(e)?function(e,t){var n=i.j.exec(t);return Number(n[1])/e.frameRate}(t,e):i.l.test(e)?function(e,t){var n=i.l.exec(t);return Number(n[1])/e.tickRate}(t,e):i.k.test(e)?a(i.k,e):void 0};function s(e,t){var n=e.getAttribute("begin"),i=e.getAttribute("dur"),a=e.getAttribute("end"),s=Object(r.a)(n)?o(n,t):null,u=Object(r.a)(i)?o(i,t):null,c=Object(r.a)(a)?o(a,t):null;if(null==s||null==c&&null==u)throw new Error("Invalid text cue");return{start:s,end:null==c?s+u:c}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=n(37),a=n(69),o=n(23);function s(e,t){return"function"==typeof t?function(n){return n.pipe(s((function(n,r){return Object(a.a)(e(n,r)).pipe(Object(i.a)((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new u(e))}}var u=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.project))},e}(),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return r.a(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new o.a(this),r=this.destination;r.add(n),this.innerSubscription=Object(o.c)(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(o.b)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o}));var r=n(35);function i(e){var t=Object(r.b)(e,1836019558);return null===t?null:Object(r.b)(t,1953653094)}function a(e){return Object(r.b)(e,1835295092)}function o(e){var t=Object(r.b)(e,1836019574);if(null===t)return null;var n=Object(r.b)(t,1953653099);return null===n?null:Object(r.b)(n,1835297121)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(){return function(e){return e.lift(new o)}}var o=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new s(e))},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.a(t,e),t.prototype._next=function(e){},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=n(9),a=n(118),o=n(63);function s(e){return function(t){return 0===e?Object(o.b)():t.lift(new u(e))}}var u=function(){function e(e){if(this.total=e,this.total<0)throw new a.a}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.total))},e}(),c=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.count=0,r}return r.a(t,e),t.prototype._next=function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=function(e){function t(n,r,a,o){var s;return s=e.call(this)||this,Object.setPrototypeOf(i()(s),t.prototype),s.name="RequestError",s.url=n,s.xhr=o,s.status=r,s.type=a,s.message=a,s}return o()(t,e),t}(n.n(s)()(Error))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t),n.d(t,"clearEMESession",(function(){return r.a})),n.d(t,"disposeEME",(function(){return i.a})),n.d(t,"getCurrentKeySystem",(function(){return We.a}));var r=n(163),i=n(164),a=n(105),o=n(97),s=n(30),u=n(63),c=n(103),l=n(191),d=n(157),f=n(144),p=n(156),h=n(50),v=n(37),m=n(155),b=n(143),g=n(8),y=n(236),_=n(238),O=n(4),T=n(104),E=n(0),w=n(10),S=n(54),j=n(64),k=n(3);var A=n(82),x=n(187),I=n(185);var M=n(237);function R(e){if(""===e.sessionId)return!1;var t=e.keyStatuses,n=[];return t.forEach((function(e){n.push(e)})),n.length<=0?(E.a.debug("EME: isSessionUsable: MediaKeySession given has an empty keyStatuses",e),!1):Object(w.a)(n,"expired")?(E.a.debug("EME: isSessionUsable: MediaKeySession given has an expired key",e.sessionId),!1):Object(w.a)(n,"internal-error")?(E.a.debug("EME: isSessionUsable: MediaKeySession given has a key with an internal-error",e.sessionId),!1):(E.a.debug("EME: isSessionUsable: MediaKeySession is usable",e.sessionId),!0)}function C(e,t,n){return Object(A.a)((function(){var r=e.loadedSessionsStore,i=e.persistentSessionsStore;return"temporary"===n?N(r,t):null===i?(E.a.warn("EME: Cannot create persistent MediaKeySession, PersistentSessionsStore not created."),N(r,t)):function(e,t,n){return Object(A.a)((function(){E.a.info("EME: Creating persistent MediaKeySession");var r=e.createSession(n,"persistent-license"),i=t.getAndReuse(n);if(null===i)return Object(s.a)({type:"created-session",value:{mediaKeySession:r,sessionType:"persistent-license"}});var a=function(){return E.a.info("EME: Removing previous persistent session."),null!==t.get(n)&&t.delete(n),e.closeSession(n).pipe(Object(v.a)((function(){return{type:"created-session",value:{mediaKeySession:e.createSession(n,"persistent-license"),sessionType:"persistent-license"}}})))};return Object(M.a)(r,i.sessionId).pipe(Object(h.a)((function(e){return e?e&&R(r)?(t.add(n,r),E.a.info("EME: Succeeded to load persistent session."),Object(s.a)({type:"loaded-persistent-session",value:{mediaKeySession:r,sessionType:"persistent-license"}})):(E.a.warn("EME: Previous persistent session not usable anymore."),a()):(E.a.warn("EME: No data stored for the loaded session"),t.delete(n),Object(s.a)({type:"created-session",value:{mediaKeySession:r,sessionType:"persistent-license"}}))})),Object(m.a)((function(e){return E.a.warn("EME: Unable to load persistent session: "+(e instanceof Error?e.toString():"Unknown Error")),a()})))}))}(r,i,t)}))}function N(e,t){return Object(A.a)((function(){E.a.info("EME: Creating a new temporary session");var n=e.createSession(t,"temporary");return Object(s.a)({type:"created-session",value:{mediaKeySession:n,sessionType:"temporary"}})}))}var P=O.a.EME_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS;function D(e,t,n){return Object(A.a)((function(){var r=null,i=t.loadedSessionsStore,o=t.persistentSessionsStore,l=i.getAndReuse(e);if(null!==l){if(R(r=l.mediaKeySession))return E.a.info("EME: Reuse loaded session",r.sessionId),Object(s.a)({type:"loaded-open-session",value:{mediaKeySession:r,sessionType:l.sessionType,initializationData:e}});null!==o&&o.delete(e)}return(null!=r?i.closeSession(e):Object(s.a)(null)).pipe(Object(h.a)((function(){return Object(c.a)(function(e,t){if(t<0||t>=e.getLength())return u.a;for(var n=[],r=e.getAll().slice(),i=r.length-t,o=0;o<i;o++){var s=r[o],c=e.closeSession(s.initializationData).pipe(Object(x.a)({type:"cleaned-old-session",value:s}),Object(I.a)({type:"cleaning-old-session",value:s}));n.push(c)}return a.a.apply(void 0,n)}(i,P-1),C(t,e,n).pipe(Object(v.a)((function(t){return{type:t.type,value:{mediaKeySession:t.value.mediaKeySession,sessionType:t.value.sessionType,initializationData:e}}}))))})))}))}var L=n(184),B=n(193),U=n(46);var F=n(27),V=n(45),z=n(162),K=n(98),$=O.a.EME_DEFAULT_WIDEVINE_ROBUSTNESSES,H=O.a.EME_KEY_SYSTEMS;function W(e,t){return Object(A.a)((function(){E.a.info("EME: Searching for compatible MediaKeySystemAccess");var n=U.a.getState(e);if(null!=n){var r=function(e,t,n){var r=t.getConfiguration();if(Object(z.a)()||null==r)return null;var i=e.filter((function(e){return e.type===n.type&&(!0!==e.persistentLicense&&!0!==e.persistentStateRequired||"required"===r.persistentState)&&(!0!==e.distinctiveIdentifierRequired||"required"===r.distinctiveIdentifier)}))[0];return null!=i?{keySystemOptions:i,keySystemAccess:t}:null}(t,n.mediaKeySystemAccess,n.keySystemOptions);if(null!==r)return E.a.info("EME: Found cached compatible keySystem",r),Object(s.a)({type:"reuse-media-key-system-access",value:{mediaKeySystemAccess:r.keySystemAccess,options:r.keySystemOptions}})}var i=t.reduce((function(e,t){var n,r=H[t.type];null!=r?n=r.map((function(e){return{keyName:t.type,keyType:e,keySystemOptions:t}})):n=[{keyName:function(e){for(var t=0,n=Object.keys(H);t<n.length;t++){var r=n[t];if(Object(w.a)(H[r],e))return r}}(t.type),keyType:t.type,keySystemOptions:t}];return e.concat(n)}),[]);return function e(t){if(t>=i.length){var n=new T.a("INCOMPATIBLE_KEYSYSTEMS","No key system compatible with your wanted configuration has been found in the current browser.");return Object(o.a)(n)}if(null==B.a){var r=Error("requestMediaKeySystemAccess is not implemented in your browser.");return Object(o.a)(r)}var a=i[t],s=a.keyName,u=a.keyType,c=a.keySystemOptions,l=function(e,t){var n=["temporary"],r="optional",i="optional";!0===t.persistentLicense&&(r="required",n.push("persistent-license")),!0===t.persistentStateRequired&&(r="required"),!0===t.distinctiveIdentifierRequired&&(i="required");var a=null!=t.videoRobustnesses?t.videoRobustnesses:"widevine"===e?$:[],o=null!=t.audioRobustnesses?t.audioRobustnesses:"widevine"===e?$:[];return 0===a.length&&a.push(void 0),0===o.length&&o.push(void 0),[{initDataTypes:["cenc"],videoCapabilities:Object(K.a)(a,(function(e){return[{contentType:'video/mp4;codecs="avc1.4d401e"',robustness:e},{contentType:'video/mp4;codecs="avc1.42e01e"',robustness:e},{contentType:'video/webm;codecs="vp8"',robustness:e}]})),audioCapabilities:Object(K.a)(o,(function(e){return[{contentType:'audio/mp4;codecs="mp4a.40.2"',robustness:e},{contentType:"audio/webm;codecs=opus",robustness:e}]})),distinctiveIdentifier:i,persistentState:r,sessionTypes:n}]}(s,c);return E.a.debug("EME: Request keysystem access "+u+","+(t+1)+" of "+i.length,l),Object(B.a)(u,l).pipe(Object(v.a)((function(e){return E.a.info("EME: Found compatible keysystem",u,l),{type:"create-media-key-system-access",value:{options:c,mediaKeySystemAccess:e}}})),Object(m.a)((function(){return E.a.debug("EME: Rejected access to keysystem",u,l),e(t+1)})))}(0)}))}var G=n(48),Y=new WeakMap,q=function(e){Y.set(e,null)},X=function(e,t){var n=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer),r=Object(G.a)(n);Y.set(e,{hash:r,serverCertificate:n})},Q=function(e){var t=Y.get(e);return void 0!==t&&(null!==t||void 0)},Z=function(e,t){var n=Y.get(e);if(null==n)return!1;var r=n.hash,i=n.serverCertificate,a=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer);if(Object(G.a)(a)!==r||i.length!==a.length)return!1;for(var o=0;o<i.length;o++)if(i[o]!==a[o])return!1;return!0},J=n(235),ee=n(44),te=function(){function e(){this._storage=[]}var t=e.prototype;return t.getAll=function(){return this._storage.map((function(e){return e.value}))},t.getLength=function(){return this._storage.length},t.get=function(e){var t=Object(G.a)(e.data),n=this._findIndex(e,t);return n>=0?this._storage[n].value:void 0},t.getAndReuse=function(e){var t=Object(G.a)(e.data),n=this._findIndex(e,t);if(-1!==n){var r=this._storage.splice(n,1)[0];return this._storage.push(r),r.value}},t.store=function(e,t){var n=Object(G.a)(e.data),r=this._findIndex(e,n);r>=0&&this._storage.splice(r,1),this._storage.push({initData:e.data,initDataType:e.type,initDataHash:n,value:t})},t.storeIfNone=function(e,t){var n=Object(G.a)(e.data);return!(this._findIndex(e,n)>=0)&&(this._storage.push({initData:e.data,initDataType:e.type,initDataHash:n,value:t}),!0)},t.remove=function(e){var t=Object(G.a)(e.data),n=this._findIndex(e,t);if(-1!==n)return this._storage.splice(n,1)[0].value},t._findIndex=function(e,t){for(var n=e.type,r=e.data,i=this._storage.length-1;i>=0;i--){var a=this._storage[i];if(t===a.initDataHash&&n===a.initDataType&&Object(ee.a)(r,a.initData))return i}return-1},e}(),ne=function(){function e(e){this._mediaKeys=e,this._storage=new te}var t=e.prototype;return t.get=function(e){var t=this._storage.get(e);return void 0===t?null:{mediaKeySession:t.mediaKeySession,sessionType:t.sessionType}},t.getAndReuse=function(e){var t=this._storage.getAndReuse(e);return void 0===t?null:{mediaKeySession:t.mediaKeySession,sessionType:t.sessionType}},t.createSession=function(e,t){var n=this;if(void 0!==this._storage.get(e))throw new T.a("MULTIPLE_SESSIONS_SAME_INIT_DATA","This initialization data was already stored.");var r=this._mediaKeys.createSession(t),i={mediaKeySession:r,sessionType:t,initializationData:e};return Object(k.a)(r.closed)||r.closed.then((function(){var t=n._storage.get(e);void 0!==t&&t.mediaKeySession===r&&n._storage.remove(e)})).catch((function(e){E.a.warn("EME-LSS: MediaKeySession.closed rejected: "+e)})),E.a.debug("EME-LSS: Add MediaKeySession",i),this._storage.store(e,i),r},t.closeSession=function(e){var t=this;return Object(A.a)((function(){var n=t._storage.remove(e);return void 0===n?(E.a.warn("EME-LSS: No MediaKeySession found with the given initData and initDataType"),u.a):re(n.mediaKeySession)}))},t.getLength=function(){return this._storage.getLength()},t.getAll=function(){return this._storage.getAll()},t.closeAllSessions=function(){var e=this;return Object(A.a)((function(){var t=e._storage.getAll().map((function(e){return re(e.mediaKeySession)}));return E.a.debug("EME-LSS: Closing all current MediaKeySessions",t.length),e._storage=new te,Object(c.a)(a.a.apply(void 0,t).pipe(Object(b.a)()),Object(s.a)(null))}))},e}();function re(e){return E.a.debug("EME-LSS: Close MediaKeySession",e),Object(J.a)(e).pipe(Object(m.a)((function(e){return E.a.error("EME-LSS: Could not close MediaKeySession: "+(e instanceof Error?e.toString():"Unknown error")),Object(s.a)(null)})))}var ie=n(55),ae=n(53),oe=n(2);var se=function(){function e(e){this.initData=e}return e.prototype.toJSON=function(){return Object(ae.b)(this.initData)},e.decode=function(e){return Object(ae.a)(e)},e}(),ue=function(){function e(e){!function(e){Object(ie.a)(e,{save:"function",load:"function"},"licenseStorage")}(e),this._entries=[],this._storage=e;try{this._entries=this._storage.load(),Array.isArray(this._entries)||(this._entries=[])}catch(e){E.a.warn("EME-PSS: Could not get entries from license storage",e),this.dispose()}}var t=e.prototype;return t.getLength=function(){return this._entries.length},t.getAll=function(){return this._entries},t.get=function(e){var t=this._getIndex(e);return-1===t?null:this._entries[t]},t.getAndReuse=function(e){var t=this._getIndex(e);if(-1===t)return null;var n=this._entries.splice(t,1)[0];return this._entries.push(n),n},t.add=function(e,t){if(!Object(k.a)(t)&&Object(oe.a)(t.sessionId)){var n=t.sessionId,r=this.get(e);if(null===r||r.sessionId!==n){null!==r&&this.delete(e);var i=Object(G.a)(e.data);E.a.info("EME-PSS: Add new session",n,t),this._entries.push({version:2,sessionId:n,initData:new se(e.data),initDataHash:i,initDataType:e.type}),this._save()}}else E.a.warn("EME-PSS: Invalid Persisten Session given.")},t.delete=function(e){var t=this._getIndex(e);if(-1!==t){var n=this._entries[t];E.a.warn("EME-PSS: Delete session from store",n),this._entries.splice(t,1),this._save()}else E.a.warn("EME-PSS: initData to delete not found.")},t.deleteOldSessions=function(e){E.a.info("EME-PSS: Deleting last "+e+" sessions."),e<=0||(e<=this._entries.length?this._entries.splice(0,e):(E.a.warn("EME-PSS: Asked to remove more information that it contains",e,this._entries.length),this._entries=[]),this._save())},t.dispose=function(){this._entries=[],this._save()},t._getIndex=function(e){for(var t=Object(G.a)(e.data),n=0;n<this._entries.length;n++){var r=this._entries[n];if(r.initDataType===e.type)if(2===r.version){if(r.initDataHash===t)try{var i="string"==typeof r.initData?se.decode(r.initData):r.initData.initData;if(Object(ee.a)(i,e.data))return n}catch(e){E.a.warn("EME-PSS: Could not decode initialization data.",e)}}else if(1===r.version){if(r.initDataHash===t){if(void 0===r.initData.length)return n;if(Object(ee.a)(r.initData,e.data))return n}}else if(r.initData===t)return n}return-1},t._save=function(){try{this._storage.save(this._entries)}catch(e){E.a.warn("EME-PSS: Could not save licenses in localStorage")}},e}();function ce(e,t){return W(e,t).pipe(Object(h.a)((function(t){var n=t.value,r=n.options,i=n.mediaKeySystemAccess,a=U.a.getState(e),o=function(e){if(!0!==e.persistentLicense)return null;var t=e.licenseStorage;if(null==t)throw new T.a("INVALID_KEY_SYSTEM","No license storage found for persistent license.");return E.a.debug("EME: Set the given license storage"),new ue(t)}(r);if(null!==a&&"reuse-media-key-system-access"===t.type){var u=a.mediaKeys,c=a.loadedSessionsStore;if(!1===Q(u)||!Object(k.a)(r.serverCertificate)&&Z(u,r.serverCertificate))return Object(s.a)({mediaKeys:u,mediaKeySystemAccess:i,stores:{loadedSessionsStore:c,persistentSessionsStore:o},options:r})}return function(e){return E.a.info("EME: Calling createMediaKeys on the MediaKeySystemAccess"),Object(V.a)((function(){return Object(F.a)(e.createMediaKeys())}),void 0).pipe(Object(m.a)((function(e){var t=e instanceof Error?e.message:"Unknown error when creating MediaKeys.";throw new T.a("CREATE_MEDIA_KEYS_ERROR",t)})))}(i).pipe(Object(v.a)((function(e){E.a.info("EME: MediaKeys created with success",e);var t=new ne(e);return{mediaKeys:e,mediaKeySystemAccess:i,stores:{loadedSessionsStore:t,persistentSessionsStore:o},options:r}})))})))}function le(e,t){return ce(e,t).pipe(Object(h.a)((function(t){var n=t.mediaKeys,r=t.mediaKeySystemAccess,i=t.stores,a=t.options,o=new L.a(1),u=null!==e.mediaKeys&&void 0!==e.mediaKeys&&n!==e.mediaKeys?function(e){return Object(A.a)((function(){return U.a.setState(e,null),Object(B.b)(e,null)}))}(e):Object(s.a)(null);return E.a.debug("EME: Disabling old MediaKeys"),u.pipe(Object(h.a)((function(){return E.a.debug("EME: Disabled old MediaKeys. Waiting to attach new MediaKeys"),o.pipe(Object(h.a)((function(){var t={loadedSessionsStore:i.loadedSessionsStore,mediaKeySystemAccess:r,mediaKeys:n,keySystemOptions:a};return function(e,t){var n=t.keySystemOptions,r=t.loadedSessionsStore,i=t.mediaKeySystemAccess,a=t.mediaKeys;return Object(A.a)((function(){var t=U.a.getState(e);return(null!==t&&t.loadedSessionsStore!==r?t.loadedSessionsStore.closeAllSessions():Object(s.a)(null)).pipe(Object(h.a)((function(){return U.a.setState(e,{keySystemOptions:n,mediaKeySystemAccess:i,mediaKeys:a,loadedSessionsStore:r}),e.mediaKeys===a?Object(s.a)(null):(E.a.info("EME: Attaching MediaKeys to the media element"),Object(B.b)(e,a).pipe(Object(p.a)((function(){E.a.info("EME: MediaKeys attached with success")}))))})))}))}(e,t)})),Object(f.a)(1),Object(x.a)({type:"attached-media-keys",value:{mediaKeySystemAccess:r,mediaKeys:n,stores:i,options:a}}),Object(I.a)({type:"created-media-keys",value:{mediaKeySystemAccess:r,mediaKeys:n,stores:i,options:a,attachMediaKeys$:o}}))})))})))}var de=n(39),fe=n.n(de),pe=n(15),he=n.n(pe),ve=n(40),me=n.n(ve),be=n(57),ge=n(110),ye=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),_e=n(51),Oe=n(5),Te=n(115),Ee=n(23);var we=function(){function e(e,t,n,r){this.waitFor=e,this.absoluteTimeout=t,this.withObservable=n,this.scheduler=r}return e.prototype.call=function(e,t){return t.subscribe(new Se(e,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),Se=function(e){function t(t,n,r,i,a){var o=e.call(this,t)||this;return o.absoluteTimeout=n,o.waitFor=r,o.withObservable=i,o.scheduler=a,o.scheduleTimeout(),o}return Oe.a(t,e),t.dispatchTimeout=function(e){var t=e.withObservable;e._unsubscribeAndRecycle(),e.add(Object(Ee.c)(t,new Ee.a(e)))},t.prototype.scheduleTimeout=function(){var e=this.action;e?this.action=e.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(t.dispatchTimeout,this.waitFor,this))},t.prototype._next=function(t){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,t)},t.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},t}(Ee.b);function je(e,t){return void 0===t&&(t=_e.a),function(e,t,n){return void 0===n&&(n=_e.a),function(r){var i=Object(Te.a)(e),a=i?+e-n.now():Math.abs(e);return r.lift(new we(a,i,t,n))}}(e,Object(o.a)(new ye),t)}var ke=n(234),Ae=n(190),xe=n(120);var Ie=n(11),Me=n(19);var Re="expired",Ce="internal-error",Ne="output-restricted";function Pe(e,t,n){var r=[],i=[],a=t.fallbackOn,o=void 0===a?{}:a,s=t.throwOnLicenseExpiration;return e.keyStatuses.forEach((function(e,t){var a="string"==typeof e?[e,t]:[t,e],u=a[0],c=function(e,t){return-1!==e.indexOf("playready")&&(Me.d||Me.a)?Object(Ie.b)(t):t}(n,new Uint8Array(a[1]));switch(u){case Re:var l=new T.a("KEY_STATUS_CHANGE_ERROR","A decryption key expired");if(!1!==s)throw l;r.push({type:"warning",value:l});break;case Ce:var d=new T.a("KEY_STATUS_CHANGE_ERROR","An invalid key status has been encountered: "+u);if(!0!==o.keyInternalError)throw d;r.push({type:"warning",value:d}),i.push(c);break;case Ne:var f=new T.a("KEY_STATUS_CHANGE_ERROR","An invalid key status has been encountered: "+u);if(!0!==o.keyOutputRestricted)throw f;r.push({type:"warning",value:f}),i.push(c)}})),[r,i]}var De=g.a.onKeyError$,Le=g.a.onKeyMessage$,Be=g.a.onKeyStatusesChange$,Ue=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf(fe()(r),t.prototype),r.sessionError=n,r}return he()(t,e),t}(me()(Error));function Fe(e,t,n,r){E.a.info("EME: Binding session events",e);var i,o,l=new be.a,d=t.getLicenseConfig,f=void 0===d?{}:d,b=De(e).pipe(Object(v.a)((function(e){throw new T.a("KEY_ERROR",e.type)}))),g=Be(e).pipe(Object(h.a)((function(r){return function(e,t,n,r){E.a.info("EME: keystatuseschange event received",e,r);var i=Object(A.a)((function(){return"function"!=typeof t.onKeyStatusesChange?u.a:Object(F.a)(t.onKeyStatusesChange(r,e))})).pipe(Object(v.a)((function(t){return{type:"key-status-change-handled",value:{session:e,license:t}}})),Object(m.a)((function(e){var t=new T.a("KEY_STATUS_CHANGE_ERROR","Unknown `onKeyStatusesChange` error");throw!Object(k.a)(e)&&Object(oe.a)(e.message)&&(t.message=e.message),t})));return Object(c.a)(Ve(e,t,n),i)}(e,t,n,r)}))),y=Le(e).pipe(Object(h.a)((function(n){var i=new Uint8Array(n.message),a=Object(oe.a)(n.messageType)?n.messageType:"license-request";E.a.info("EME: Received message event, type "+a,e,n);var o,s,u,c,d,p,b,g,y=Object(A.a)((function(){var e=t.getLicense(i,a),n=Object(k.a)(f.timeout)?1e4:f.timeout;return Object(F.a)(e).pipe(n>=0?je(n):ge.a)})),_=function(e,t){return{totalRetry:null!=t?t:2,baseDelay:200,maxDelay:3e3,shouldRetry:function(e){return e instanceof ye||Object(k.a)(e)||!0!==e.noRetry},onRetry:function(t){return e.next({type:"warning",value:ze(t)})}}}(l,f.retry);return(o=y,s=_,u=s.baseDelay,c=s.maxDelay,d=s.totalRetry,p=s.shouldRetry,b=s.onRetry,g=0,o.pipe(Object(m.a)((function(e,t){if(!Object(k.a)(p)&&!p(e)||g++>=d)throw e;"function"==typeof b&&b(e,g);var n=Math.min(u*Math.pow(2,g-1),c),r=Object(xe.a)(n);return Object(Ae.a)(r).pipe(Object(h.a)((function(){return t})))})))).pipe(Object(v.a)((function(t){return{type:"key-message-handled",value:{session:e,license:t}}})),Object(m.a)((function(e){var t=ze(e);if(!Object(k.a)(e)&&!0===e.fallbackOnLastTry)throw E.a.warn("EME: Last `getLicense` attempt failed. Blacklisting the current session."),new Ue(t);throw t})),Object(I.a)({type:"session-message",value:{messageType:a,initializationData:r}}))}))),_=Object(a.a)(y,g).pipe((i=function(t){switch(t.type){case"key-message-handled":case"key-status-change-handled":return function(e,t,n){return Object(k.a)(t)?(E.a.info("EME: No message given, skipping session.update"),Object(s.a)({type:"no-update",value:{initializationData:n}})):(E.a.info("EME: Updating MediaKeySession with message"),Object(F.a)(e.update(t)).pipe(Object(m.a)((function(e){var t=e instanceof Error?e.toString():"`session.update` failed";throw new T.a("KEY_UPDATE_ERROR",t)})),Object(p.a)((function(){E.a.info("EME: MediaKeySession update succeeded.")})),Object(x.a)({type:"session-updated",value:{session:e,license:t,initializationData:n}})))}(e,t.value.license,r);default:return Object(s.a)(t)}},Object(h.a)(i,o,1))),O=Object(a.a)(Ve(e,t,n),_,b,l);return Object(k.a)(e.closed)?O:O.pipe(Object(ke.a)(Object(F.a)(e.closed)))}function Ve(e,t,n){return Object(A.a)((function(){var r=Pe(e,t,n),i=r[0],a=r[1],o=i.length>0?s.a.apply(void 0,i):u.a,l=a.length>0?Object(s.a)({type:"blacklist-keys",value:a}):u.a;return Object(c.a)(o,l)}))}function ze(e){if(e instanceof ye)return new T.a("KEY_LOAD_TIMEOUT","The license server took too much time to respond.");var t=new T.a("KEY_LOAD_ERROR","An error occured when calling `getLicense`.");return!Object(k.a)(e)&&Object(oe.a)(e.message)&&(t.message=e.message),t}function Ke(e,t){return Object(A.a)((function(){return"function"!=typeof e.setServerCertificate?(E.a.warn("EME: Could not set the server certificate. mediaKeys.setServerCertificate is not a function"),u.a):!0===Q(e)?(E.a.info("EME: The MediaKeys already has a server certificate, skipping..."),u.a):(E.a.info("EME: Setting server certificate on the MediaKeys"),q(e),function(e,t){return Object(A.a)((function(){return Object(V.a)((function(){return Object(F.a)(e.setServerCertificate(t))}),void 0).pipe(Object(m.a)((function(e){E.a.warn("EME: mediaKeys.setServerCertificate returned an error",e);var t=e instanceof Error?e.toString():"`setServerCertificate` error";throw new T.a("LICENSE_SERVER_CERTIFICATE_ERROR",t)})))}))}(e,t).pipe(Object(p.a)((function(){X(e,t)})),Object(b.a)(),Object(m.a)((function(e){return Object(s.a)({type:"warning",value:e})}))))}))}var $e=O.a.EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION,He=g.a.onEncrypted$;var We=n(165);t.default=function(e,t,n){E.a.debug("EME: Starting EMEManager logic.");var r=new te,i=new te,g=le(e,t).pipe(Object(l.a)()),O=g.pipe(Object(d.a)((function(e){return"attached-media-keys"===e.type})),Object(f.a)(1)),A=He(e).pipe(Object(p.a)((function(e){E.a.debug("EME: Encrypted event received from media element.",e)})),Object(j.a)((function(e){var t=Object(y.a)(e),n=t.initData,r=t.initDataType;return null===n?null:{type:r,data:n}}),null),Object(l.a)({refCount:!0})),x=n.pipe(Object(p.a)((function(e){E.a.debug("EME: Encrypted event received from Player",e)}))),I=Object(a.a)(x,A).pipe(Object(h.a)((function(e){return O.pipe(Object(v.a)((function(t){return[e,t]})))})),Object(h.a)((function(e,t){var n=e[0],l=e[1].value,d=l.mediaKeys,f=l.mediaKeySystemAccess,v=l.stores,g=l.options,y=i.get(n);if(void 0!==y){if(void 0===n.type){E.a.error("EME: The current session has already been blacklisted but the current content is not known. Throwing.");var O=y.sessionError;return O.fatal=!0,Object(o.a)(O)}return E.a.warn("EME: The current session has already been blacklisted. Blacklisting content."),Object(s.a)({type:"blacklist-protection-data",value:n})}if(!r.storeIfNone(n,!0))return E.a.debug("EME: Init data already received. Skipping it."),Object(s.a)({type:"init-data-ignored",value:{initializationData:n}});var j,A=g.serverCertificate,x=0!==t||Object(k.a)(A)?u.a:Ke(d,A);return!function(e){var t=e.getConfiguration().sessionTypes;return void 0!==t&&Object(w.a)(t,"persistent-license")}(f)?(E.a.warn('EME: Cannot create "persistent-license" session: not supported'),j="temporary"):j="persistent-license",Object(c.a)(x,D(n,v,j)).pipe(Object(h.a)((function(e){switch(e.type){case"warning":return Object(s.a)(e);case"cleaning-old-session":return r.remove(n),u.a;case"cleaned-old-session":return u.a;case"created-session":case"loaded-open-session":case"loaded-persistent-session":break;default:Object(S.a)(e)}var t=e.value,o=t.mediaKeySession,c=t.sessionType,l="created-session"!==e.type?u.a:Object(_.a)(o,n).pipe(Object(p.a)((function(){var e=v.persistentSessionsStore;"persistent-license"===c&&null!==e&&(!function(e,t){if(!(isNaN(t)||t<0||t>=e.getLength())){var n=e.getLength(),r=n-t;E.a.info("EME: Too many stored persistent sessions, removing some.",n,r),e.deleteOldSessions(r)}}(e,$e-1),e.add(n,o))})),Object(m.a)((function(e){throw new T.a("KEY_GENERATE_REQUEST_ERROR",e instanceof Error?e.toString():"Unknown error")})),Object(b.a)());return Object(a.a)(Fe(o,g,f.keySystem,n),l).pipe(Object(m.a)((function(e){if(!(e instanceof Ue))throw e;i.store(n,e);var t=e.sessionError;if(void 0===n.type)throw E.a.error("EME: Current session blacklisted and content not known. Throwing."),t.fatal=!0,t;return E.a.warn("EME: Current session blacklisted. Blacklisting content."),Object(s.a)({type:"warning",value:t},{type:"blacklist-protection-data",value:n})})))})))})));return Object(a.a)(g,A.pipe(Object(v.a)((function(e){return{type:"encrypted-event-received",value:e}}))),I)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return r.c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),i=n(0),a=n(96);function o(e,t){return new r.a((function(n){return i.a.info("Setting URL to Element",t,e),e.src=t,n.next(void 0),function(){Object(a.a)(e)}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(e,t){return!e||!r.f||t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(82),i=n(27),a=n(45);function o(e){return Object(r.a)((function(){return Object(a.a)((function(){return Object(i.a)(e.play())}),void 0)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(30),i=n(144),a=n(34),o=n(41);function s(e){return e.readyState>=a.d.HAVE_METADATA?Object(r.a)(null):Object(o.onLoadedMetadata$)(e).pipe(Object(i.a)(1))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(193);function i(){return"function"==typeof r.a}},function(e,t,n){e.exports=n(210)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(23);function a(e){return function(t){var n=new o(e),r=t.lift(n);return n.caught=r}}var o=function(){function e(e){this.selector=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.selector,this.caught))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.selector=n,i.caught=r,i}return r.a(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught)}catch(t){return void e.prototype.error.call(this,t)}this._unsubscribeAndRecycle();var r=new i.a(this);this.add(r);var a=Object(i.c)(n,r);a!==r&&this.add(a)}},t}(i.b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(5),i=n(9),a=n(59),o=n(66);function s(e,t,n){return function(r){return r.lift(new u(e,t,n))}}var u=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new c(e,this.nextOrObserver,this.error,this.complete))},e}(),c=function(e){function t(t,n,r,i){var s=e.call(this,t)||this;return s._tapNext=a.a,s._tapError=a.a,s._tapComplete=a.a,s._tapError=r||a.a,s._tapComplete=i||a.a,Object(o.a)(n)?(s._context=s,s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||a.a,s._tapError=n.error||a.a,s._tapComplete=n.complete||a.a),s}return r.a(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(e,t){return function(n){return n.lift(new o(e,t))}}var o=function(){function e(e,t){this.predicate=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.predicate,this.thisArg))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return r.a(t,e),t.prototype._next=function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}t&&this.destination.next(e)},t}(i.a)},,function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(203),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(146))},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return r.c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(82),i=n(63),a=n(143),o=n(148),s=n(0),u=n(121),c=n(46);function l(e){return Object(r.a)((function(){if(s.a.info("EME: Clearing-up EME session."),Object(o.a)())return s.a.info("EME: disposing current MediaKeys."),Object(u.a)(e).pipe(Object(a.a)());var t=c.a.getState(e);return null!==t&&!0===t.keySystemOptions.closeSessionsOnStop?(s.a.info("EME: closing all current sessions."),t.loadedSessionsStore.closeAllSessions().pipe(Object(a.a)())):(s.a.info("EME: Nothing to clear. Returning right away. No state =",null===t),i.a)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(42),i=n(121);function a(e){Object(i.a)(e).subscribe(r.a)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(46);function i(e){var t=r.a.getState(e);return null==t?null:t.keySystemOptions.type}},function(e,t,n){"use strict";function r(e,t){return e.segment.id===t.segment.id&&e.representation.id===t.representation.id&&e.adaptation.id===t.adaptation.id&&e.period.id===t.period.id}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(34);function i(e){return null!=r.c&&("function"!=typeof r.c.isTypeSupported||r.c.isTypeSupported(e))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(){return!r.d}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(e,t){var n,i,a,o,s="subtitles";if(r.d){var u=e.textTracks.length;(a=u>0?e.textTracks[u-1]:e.addTextTrack(s)).mode=t?null!==(n=a.HIDDEN)&&void 0!==n?n:"hidden":null!==(i=a.SHOWING)&&void 0!==i?i:"showing"}else o=document.createElement("track"),e.appendChild(o),a=o.track,o.kind=s,a.mode=t?"hidden":"showing";return{track:a,trackElement:o}}},function(e,t,n){"use strict";function r(e){return"function"==typeof window.VTTCue&&e instanceof window.VTTCue}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(82),i=n(12),a=n(228),o=n(185),s=n(37),u=n(186),c=n(0),l=n(31).a?void 0:window.ResizeObserver;function d(e,t){return Object(r.a)((function(){if(void 0!==l){var n=-1,r=-1;return new i.a((function(t){var i=new l((function(e){if(0!==e.length){var i=e[0].contentRect,a=i.height,o=i.width;a===n&&o===r||(n=a,r=o,t.next({height:a,width:o}))}else c.a.error("Compat: Resized but no observed element.")}));return i.observe(e),function(){i.disconnect()}}))}return Object(a.a)(t).pipe(Object(o.a)(null),Object(s.a)((function(){var t=e.getBoundingClientRect();return{height:t.height,width:t.width}})),Object(u.a)((function(e,t){return e.height===t.height&&e.width===t.width})))}))}},function(e,t,n){"use strict";var r;function i(e,t){(void 0===r&&(r=void 0!==e.classList&&"function"==typeof e.classList.add),r)?e.classList.add(t):(" "+e.className+" ").indexOf(" "+t+" ")<0&&(e.className+=" "+t)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";function r(){return!1===navigator.onLine}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0);function i(e,t){if("function"==typeof e.changeType){try{e.changeType(t)}catch(e){return r.a.warn("Could not call 'changeType' on the given SourceBuffer:",e),!1}return!0}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(19);function i(e,t,n,i){return r.b&&i&&"timeupdate"===n&&null!=t&&t.end-e>10}},function(e,t,n){"use strict";function r(e){return null===e||e.indexOf("widevine")<0}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(111);function i(){return Object(r.a)(1)}},function(e,t,n){"use strict";(function(t,n){var r,i="pending",a="settled",o="fulfilled",s="rejected",u=function(){},c=void 0!==t&&void 0!==t.process&&"function"==typeof t.process.emit,l=void 0===n?setTimeout:n,d=[];function f(){for(var e=0;e<d.length;e++)d[e][0](d[e][1]);d=[],r=!1}function p(e,t){d.push([e,t]),r||(r=!0,l(f,0))}function h(e){var t=e.owner,n=t._state,r=t._data,i=e[n],a=e.then;if("function"==typeof i){n=o;try{r=i(r)}catch(e){g(a,e)}}v(a,r)||(n===o&&m(a,r),n===s&&g(a,r))}function v(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var r=t.then;if("function"==typeof r)return r.call(t,(function(r){n||(n=!0,t===r?b(e,r):m(e,r))}),(function(t){n||(n=!0,g(e,t))})),!0}}catch(t){return n||g(e,t),!0}return!1}function m(e,t){e!==t&&v(e,t)||b(e,t)}function b(e,t){e._state===i&&(e._state=a,e._data=t,p(_,e))}function g(e,t){e._state===i&&(e._state=a,e._data=t,p(O,e))}function y(e){e._then=e._then.forEach(h)}function _(e){e._state=o,y(e)}function O(e){e._state=s,y(e),!e._handled&&c&&t.process.emit("unhandledRejection",e._data,e)}function T(e){t.process.emit("rejectionHandled",e)}function E(e){if("function"!=typeof e)throw new TypeError("Promise resolver "+e+" is not a function");if(this instanceof E==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(e,t){function n(e){g(t,e)}try{e((function(e){m(t,e)}),n)}catch(e){n(e)}}(e,this)}E.prototype={constructor:E,_state:i,_then:null,_data:void 0,_handled:!1,then:function(e,t){var n={owner:this,then:new this.constructor(u),fulfilled:e,rejected:t};return!t&&!e||this._handled||(this._handled=!0,this._state===s&&c&&p(T,this)),this._state===o||this._state===s?p(h,n):this._then.push(n),n.then},catch:function(e){return this.then(null,e)}},E.all=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.all().");return new E((function(t,n){var r=[],i=0;function a(e){return i++,function(n){r[e]=n,--i||t(r)}}for(var o,s=0;s<e.length;s++)(o=e[s])&&"function"==typeof o.then?o.then(a(s),n):r[s]=o;i||t(r)}))},E.race=function(e){if(!Array.isArray(e))throw new TypeError("You must pass an array to Promise.race().");return new E((function(t,n){for(var r,i=0;i<e.length;i++)(r=e[i])&&"function"==typeof r.then?r.then(t,n):t(r)}))},E.resolve=function(e){return e&&"object"==typeof e&&e.constructor===E?e:new E((function(t){t(e)}))},E.reject=function(e){return new E((function(t,n){n(e)}))},e.exports=E}).call(this,n(146),n(160).setImmediate)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(77),i=n.n(r),a=n(25),o=function(){function e(e,t,n){this._keyType=e,this._mediaKeys=t,this._configuration=n}var t=e.prototype;return t.createMediaKeys=function(){var e=this;return new a.a((function(t){return t(e._mediaKeys)}))},t.getConfiguration=function(){return this._configuration},i()(e,[{key:"keySystem",get:function(){return this._keyType}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=n.n(s),c=n(47),l=n(74),d=function(e){function t(n,r){var a;return a=e.call(this)||this,Object.setPrototypeOf(i()(a),t.prototype),a.name="NetworkError",a.type=c.b.NETWORK_ERROR,a.xhr=void 0===r.xhr?null:r.xhr,a.url=r.url,a.status=r.status,a.errorType=r.type,a.code=n,a.message=Object(l.a)(a.name,a.code,r.message),a.fatal=!1,a}return o()(t,e),t.prototype.isHttpError=function(e){return this.errorType===c.c.ERROR_HTTP_CODE&&this.status===e},t}(u()(Error))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var r=n(1),i=n(11),a=n(99),o={};function s(e){if(null!=o[e])return o[e];var t=Object(i.e)(e);return o[e]=t,t}function u(e,t){var n=t.length+8;return n<=a.a?Object(r.e)(Object(r.h)(n),s(e),t):Object(r.e)(Object(r.h)(1),s(e),Object(r.i)(n+8),t)}function c(e,t){return u(e,r.e.apply(void 0,t))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(104),i=n(47),a=n(60),o=n(180),s=n(80);function u(e){return(e instanceof r.a||e instanceof a.a||e instanceof s.a||e instanceof o.a)&&Object.keys(i.b).indexOf(e.type)>=0}},function(e,t){function n(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var o=e.apply(t,r);function s(e){n(o,i,a,s,u,"next",e)}function u(e){n(o,i,a,s,u,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(5),i=n(57),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return r.a(t,e),t.prototype.schedule=function(t,n){return void 0===n&&(n=0),n>0?e.prototype.schedule.call(this,t,n):(this.delay=n,this.state=t,this.scheduler.flush(this),this)},t.prototype.execute=function(t,n){return n>0||this.closed?e.prototype.execute.call(this,t,n):this._execute(t,n)},t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?e.prototype.requestAsyncId.call(this,t,n,r):t.flush(this)},t}(n(92).a),o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.a(t,e),t}(n(91).a))(a),s=n(26),u=n(9),c=n(86);var l=function(e){function t(t,n,r){void 0===r&&(r=0);var i=e.call(this,t)||this;return i.scheduler=n,i.delay=r,i}return r.a(t,e),t.dispatch=function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()},t.prototype.scheduleMessage=function(e){this.destination.add(this.scheduler.schedule(t.dispatch,this.delay,new d(e,this.destination)))},t.prototype._next=function(e){this.scheduleMessage(c.a.createNext(e))},t.prototype._error=function(e){this.scheduleMessage(c.a.createError(e)),this.unsubscribe()},t.prototype._complete=function(){this.scheduleMessage(c.a.createComplete()),this.unsubscribe()},t}(u.a),d=function(){return function(e,t){this.notification=e,this.destination=t}}(),f=n(65),p=n(117),h=function(e){function t(t,n,r){void 0===t&&(t=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=e.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=t<1?1:t,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return r.a(t,e),t.prototype.nextInfiniteTimeWindow=function(t){if(!this.isStopped){var n=this._events;n.push(t),n.length>this._bufferSize&&n.shift()}e.prototype.next.call(this,t)},t.prototype.nextTimeWindow=function(t){this.isStopped||(this._events.push(new v(this._getNow(),t)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,a=r.length;if(this.closed)throw new f.a;if(this.isStopped||this.hasError?t=s.a.EMPTY:(this.observers.push(e),t=new p.a(this,e)),i&&e.add(e=new l(e,i)),n)for(var o=0;o<a&&!e.closed;o++)e.next(r[o]);else for(o=0;o<a&&!e.closed;o++)e.next(r[o].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t},t.prototype._getNow=function(){return(this.scheduler||o).now()},t.prototype._trimBufferThenGetEvents=function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,a=0;a<i&&!(e-r[a].time<n);)a++;return i>t&&(a=Math.max(a,i-t)),a>0&&r.splice(0,a),r},t}(i.a),v=function(){return function(e,t){this.time=e,this.value=t}}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(103),i=n(56);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return Object(i.a)(n)?(e.pop(),function(t){return Object(r.a)(e,t,n)}):function(t){return Object(r.a)(e,t)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(e,t){return function(n){return n.lift(new o(e,t))}}var o=function(){function e(e,t){this.compare=e,this.keySelector=t}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.compare,this.keySelector))},e}(),s=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.keySelector=r,i.hasKey=!1,"function"==typeof n&&(i.compare=n),i}return r.a(t,e),t.prototype.compare=function(e,t){return e===t},t.prototype._next=function(e){var t;try{var n=this.keySelector;t=n?n(e):e}catch(e){return this.destination.error(e)}var r=!1;if(this.hasKey)try{r=(0,this.compare)(this.key,t)}catch(e){return this.destination.error(e)}else this.hasKey=!0;r||(this.key=t,this.destination.next(e))},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(e){return function(t){return t.lift(new o(e))}}var o=function(){function e(e){this.value=e}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.value))},e}(),s=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return r.a(t,e),t.prototype._next=function(e){this.destination.next(this.value)},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(39),i=n.n(r),a=n(15),o=n.n(a),s=n(40),u=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf(i()(r),t.prototype),r.name="AssertionError",r.message=n,r}return o()(t,e),t}(n.n(s)()(Error))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(5),i=n(61),a=n(76),o=n(88),s=n(93);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){if(!Object(i.a)(e[0]))return e[0];e=e[0]}return Object(a.a)(e,void 0).lift(new c)}var c=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new l(e))},e}(),l=function(e){function t(t){var n=e.call(this,t)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return r.a(t,e),t.prototype._next=function(e){this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=e[n],i=Object(s.a)(this,r,void 0,n);this.subscriptions&&this.subscriptions.push(i),this.add(i)}this.observables=null}},t.prototype.notifyNext=function(e,t,n){if(!this.hasFirst){this.hasFirst=!0;for(var r=0;r<this.subscriptions.length;r++)if(r!==n){var i=this.subscriptions[r];i.unsubscribe(),this.remove(i)}this.subscriptions=null}this.destination.next(t)},t}(o.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),i=n(51),a=n(84),o=n(56);function s(e,t,n){void 0===e&&(e=0);var s=-1;return Object(a.a)(t)?s=Number(t)<1?1:Number(t):Object(o.a)(t)&&(n=t),Object(o.a)(n)||(n=i.a),new r.a((function(t){var r=Object(a.a)(e)?e:+e-n.now();return n.schedule(u,r,{index:0,period:s,subscriber:t})}))}function u(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(184);function i(e,t,n){var i;return i=e&&"object"==typeof e?e:{bufferSize:e,windowTime:t,refCount:!1,scheduler:n},function(e){return e.lift(function(e){var t,n,i=e.bufferSize,a=void 0===i?Number.POSITIVE_INFINITY:i,o=e.windowTime,s=void 0===o?Number.POSITIVE_INFINITY:o,u=e.refCount,c=e.scheduler,l=0,d=!1,f=!1;return function(e){var i;l++,!t||d?(d=!1,t=new r.a(a,s,c),i=t.subscribe(this),n=e.subscribe({next:function(e){t.next(e)},error:function(e){d=!0,t.error(e)},complete:function(){f=!0,n=void 0,t.complete()}})):i=t.subscribe(this),this.add((function(){l--,i.unsubscribe(),n&&!f&&u&&0===l&&(n.unsubscribe(),n=void 0,t=void 0)}))}}(i))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(50);function i(e,t,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof t?Object(r.a)((function(){return e}),t,n):("number"==typeof t&&(n=t),Object(r.a)((function(){return e}),n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return D})),n.d(t,"b",(function(){return K}));var r,i=n(97),a=n(30),o=n(82),s=n(27),u=n(34),c=n(19),l=n(31),d=n(116),f=n(179);if(!l.a){var p=window.MSMediaKeys;void 0!==p&&void 0!==p.prototype&&"function"==typeof p.isTypeSupported&&"function"==typeof p.prototype.createSession&&(r=p)}var h=n(77),v=n.n(h),m=n(15),b=n.n(m),g=n(57),y=n(105),_=n(234),O=n(28),T=n(25),E=n(41),w=function(e){function t(t){var n;return(n=e.call(this)||this).expiration=NaN,n.keyStatuses=new Map,n._mk=t,n._closeSession$=new g.a,n.closed=new T.a((function(e){n._closeSession$.subscribe(e)})),n.update=function(e){return new T.a((function(t,r){if(void 0===n._ss)return r("MediaKeySession not set.");try{t(n._ss.update(e,""))}catch(e){r(e)}}))},n}b()(t,e);var n=t.prototype;return n.generateRequest=function(e,t){var n=this;return new T.a((function(e){n._ss=n._mk.createSession("video/mp4",t),Object(y.a)(E.onKeyMessage$(n._ss),E.onKeyAdded$(n._ss),E.onKeyError$(n._ss)).pipe(Object(_.a)(n._closeSession$)).subscribe((function(e){return n.trigger(e.type,e)})),e()}))},n.close=function(){var e=this;return new T.a((function(t){null!=e._ss&&(e._ss.close(),e._ss=void 0),e._closeSession$.next(),e._closeSession$.complete(),t()}))},n.load=function(){return T.a.resolve(!1)},n.remove=function(){return T.a.resolve()},v()(t,[{key:"sessionId",get:function(){var e,t;return null!==(t=null===(e=this._ss)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}}]),t}(O.a),S=function(){function e(e){if(void 0===r)throw new Error("No MSMediaKeys API.");this._mediaKeys=new r(e)}var t=e.prototype;return t._setVideo=function(e){if(this._videoElement=e,void 0!==this._videoElement.msSetMediaKeys)return this._videoElement.msSetMediaKeys(this._mediaKeys)},t.createSession=function(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new w(this._mediaKeys)},t.setServerCertificate=function(){throw new Error("Server certificate is not implemented in your browser")},e}();var j=n(53),k=n(11);function A(e){return"function"==typeof e.webkitGenerateKeyRequest}var x=function(e){function t(t,n){var r;return(r=e.call(this)||this)._closeSession$=new g.a,r._vid=t,r._key=n,r.sessionId="",r.closed=new T.a((function(e){r._closeSession$.subscribe(e)})),r.keyStatuses=new Map,r.expiration=NaN,Object(y.a)(E.onKeyMessage$(t),E.onKeyAdded$(t),E.onKeyError$(t)).pipe(Object(_.a)(r._closeSession$)).subscribe((function(e){return r.trigger(e.type,e)})),r.update=function(e){return new T.a((function(t,n){try{if(r._key.indexOf("clearkey")>=0){var i=e instanceof ArrayBuffer?new Uint8Array(e):e,a=JSON.parse(Object(k.g)(i)),o=Object(j.a)(a.keys[0].k),s=Object(j.a)(a.keys[0].kid);t(r._vid.webkitAddKey(r._key,o,s,""))}else t(r._vid.webkitAddKey(r._key,e,null,""))}catch(e){n(e)}}))},r}b()(t,e);var n=t.prototype;return n.generateRequest=function(e,t){var n=this;return new T.a((function(e){n._vid.webkitGenerateKeyRequest(n._key,t),e()}))},n.close=function(){var e=this;return new T.a((function(t){e._closeSession$.next(),e._closeSession$.complete(),t()}))},n.load=function(){return T.a.resolve(!1)},n.remove=function(){return T.a.resolve()},t}(O.a),I=function(){function e(e){this._keySystem=e}var t=e.prototype;return t._setVideo=function(e){if(!A(e))throw new Error("Video not attached to the MediaKeys");this._videoElement=e},t.createSession=function(){if(null==this._videoElement)throw new Error("Video not attached to the MediaKeys");return new x(this._videoElement,this._keySystem)},t.setServerCertificate=function(){throw new Error("Server certificate is not implemented in your browser")},e}();var M=n(1);var R=n(71);function C(e,t){if(void 0===e.webkitSetMediaKeys)throw new Error("No webKitMediaKeys API.");return e.webkitSetMediaKeys(t)}var N=function(e){function t(t,n,r){var i;return(i=e.call(this)||this)._serverCertificate=r,i._closeSession$=new g.a,i._videoElement=t,i._keyType=n,i.closed=new T.a((function(e){i._closeSession$.subscribe(e)})),i.keyStatuses=new Map,i.expiration=NaN,i.update=function(e){return new T.a((function(t,n){if(void 0===i._nativeSession||void 0===i._nativeSession.update||"function"!=typeof i._nativeSession.update)return n("Unavailable WebKit key session.");try{t(i._nativeSession.update(e))}catch(e){n(e)}}))},i}b()(t,e);var n=t.prototype;return n.listenEvent=function(e){var t=this;Object(y.a)(E.onKeyMessage$(e),E.onKeyAdded$(e),E.onKeyError$(e)).pipe(Object(_.a)(this._closeSession$)).subscribe((function(e){t.trigger(e.type,e)}))},n.generateRequest=function(e,t){var n=this;return new T.a((function(e){if(void 0===n._videoElement.webkitKeys||void 0===n._videoElement.webkitKeys.createSession)throw new Error("No WebKitMediaKeys API.");var r,i;if("com.apple.fps.1_0"===(i=n._keyType)||"com.apple.fps.2_0"===i){if(void 0===n._serverCertificate)throw new Error("A server certificate is needed for creating fairplay session.");r=function(e,t){var n=e instanceof Uint8Array?e:new Uint8Array(e),r=t instanceof Uint8Array?t:new Uint8Array(t);if(Object(M.l)(n,0)+4!==n.length)throw new Error("Unsupported WebKit initData.");var i=Object(k.f)(n),a=i.indexOf("skd://"),o=a>-1?i.substring(a+6):i,s=Object(k.d)(o),u=0,c=new Uint8Array(n.byteLength+4+s.byteLength+4+r.byteLength);return c.set(n),u+=n.length,c.set(Object(M.j)(s.byteLength),u),u+=4,c.set(s,u),u+=s.byteLength,c.set(Object(M.j)(r.byteLength),u),u+=4,c.set(r,u),c}(t,n._serverCertificate)}else r=t;var a=n._videoElement.webkitKeys.createSession("video/mp4",r);if(null==a)throw new Error("Impossible to get the key sessions");n.listenEvent(a),n._nativeSession=a,e()}))},n.close=function(){var e=this;return new T.a((function(t,n){e._closeSession$.next(),e._closeSession$.complete(),void 0===e._nativeSession&&n("No session to close."),e._nativeSession.close(),t()}))},n.load=function(){return T.a.resolve(!1)},n.remove=function(){return T.a.resolve()},v()(t,[{key:"sessionId",get:function(){var e,t;return null!==(t=null===(e=this._nativeSession)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}}]),t}(O.a),P=function(){function e(e){if(void 0===R.a)throw new Error("No WebKitMediaKeys API.");this._keyType=e,this._mediaKeys=new R.a(e)}var t=e.prototype;return t._setVideo=function(e){if(this._videoElement=e,void 0===this._videoElement)throw new Error("Video not attached to the MediaKeys");return C(this._videoElement,this._mediaKeys)},t.createSession=function(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new N(this._videoElement,this._keyType,this._serverCertificate)},t.setServerCertificate=function(e){return this._serverCertificate=e,T.a.resolve()},e}();var D=null,L=function(e,t){return"function"==typeof e.setMediaKeys?e.setMediaKeys(t):e.webkitSetMediaKeys?e.webkitSetMediaKeys(t):e.mozSetMediaKeys?e.mozSetMediaKeys(t):e.msSetMediaKeys&&null!==t?e.msSetMediaKeys(t):void 0};if(l.a||null!=navigator.requestMediaKeySystemAccess&&!Object(d.a)())D=function(e,t){return Object(s.a)(navigator.requestMediaKeySystemAccess(e,t))};else{var B=function(e){if(void 0===u.b.isTypeSupported)throw new Error("No isTypeSupported on MediaKeys.");return u.b.isTypeSupported(e)},U=function(e){return new u.b(e)};if(A(HTMLVideoElement.prototype)){var F={isTypeSupported:function(e){var t=document.querySelector("video");return null==t&&(t=document.createElement("video")),null!=t&&"function"==typeof t.canPlayType&&!!t.canPlayType("video/mp4",e)},createCustomMediaKeys:function(e){return new I(e)},setMediaKeys:function(e,t){if(null!==t){if(!(t instanceof I))throw new Error("Custom setMediaKeys is supposed to be called with old webkit custom MediaKeys.");return t._setVideo(e)}}};B=F.isTypeSupported,U=F.createCustomMediaKeys,L=F.setMediaKeys}else if(void 0!==R.a){var V=function(){if(void 0===R.a)throw new Error("No WebKitMediaKeys API.");return{isTypeSupported:R.a.isTypeSupported,createCustomMediaKeys:function(e){return new P(e)},setMediaKeys:function(e,t){if(null===t)return C(e,t);if(!(t instanceof P))throw new Error("Custom setMediaKeys is supposed to be called with webkit custom MediaKeys.");return t._setVideo(e)}}}();B=V.isTypeSupported,U=V.createCustomMediaKeys,L=V.setMediaKeys}else if(c.c&&void 0!==r){var z={isTypeSupported:function(e,t){if(void 0===r)throw new Error("No MSMediaKeys API.");return void 0!==t?r.isTypeSupported(e,t):r.isTypeSupported(e)},createCustomMediaKeys:function(e){return new S(e)},setMediaKeys:function(e,t){if(null!==t){if(!(t instanceof S))throw new Error("Custom setMediaKeys is supposed to be called with IE11 custom MediaKeys.");return t._setVideo(e)}}};B=z.isTypeSupported,U=z.createCustomMediaKeys,L=z.setMediaKeys}D=function(e,t){if(!B(e))return Object(i.a)(void 0);for(var n=0;n<t.length;n++){var r=t[n],o=r.videoCapabilities,s=r.audioCapabilities,u=r.initDataTypes,c=r.distinctiveIdentifier,l=!0;if(l=(l=l&&(null==u||u.some((function(e){return"cenc"===e}))))&&"required"!==c){var d={videoCapabilities:o,audioCapabilities:s,initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"required",sessionTypes:["temporary","persistent-license"]},p=U(e);return Object(a.a)(new f.a(e,p,d))}}return Object(i.a)(void 0)}}function K(e,t){return Object(o.a)((function(){return Object(s.a)(L(e,t))}))}},,,,,,,,,,function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i,a,o,s,u=1,c={},l=!1,d=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){h(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){h(e.data)},r=function(e){a.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,r=function(e){var t=d.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):r=function(e){setTimeout(h,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&h(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),r=function(t){e.postMessage(o+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[u]=i,r(u),u++},f.clearImmediate=p}function p(e){delete c[e]}function h(e){if(l)setTimeout(h,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(146),n(159))},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,n){var r=n(161),i=n(207);function a(t,n,o){return i()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a},a.apply(null,arguments)}e.exports=a},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(11);t.default=function(e){var t=0,n=e.length,a=Object(i.g)(e.subarray(t+1,t+8));if(t+=8,137!==e[0]||"BIF\r\n\n"!==a)throw new Error("Invalid BIF file");var o=e[t],s=e[t+=1],u=e[t+=1],c=e[t+=1];t+=1;var l=[o,s,u,c].join(".");if(s>0)throw new Error("Unhandled version: "+s);var d=Object(r.l)(e,t);t+=4;var f=Object(r.l)(e,t);t+=4;var p=Object(i.g)(e.subarray(t,t+4));t+=4;var h=Object(r.k)(e,t);t+=2;var v=Object(r.k)(e,t),m=[e[t+=2],e[t+1]].join(":"),b=1===e[t+=2];t=64;var g=[];if(0===d)throw new Error("bif: no images to parse");for(var y=0,_=null;t<n;){var O=Object(r.l)(e,t);t+=4;var T=Object(r.l)(e,t);if(t+=4,null!==_){var E=_.timestamp*f,w=f,S=e.slice(_.offset,T);g.push({index:y,duration:w,ts:E,data:S}),y++}if(4294967295===O)break;_={timestamp:O,offset:T}}return{fileFormat:"BIF",version:l,imageCount:d,timescale:1e3,format:p,width:h,height:v,aspectRatio:m,isVod:b,thumbs:g}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(53),i=n(1),a=n(11);function o(e){var t=Object(i.k)(e,8),n=Object(a.f)(e.subarray(10,t+10)),o=(new DOMParser).parseFromString(n,"application/xml").querySelector("KID");if(null===o)throw new Error("Cannot parse PlayReady private data: invalid XML");var s=null===o.textContent?"":o.textContent,u=Object(a.b)(Object(r.a)(s));return Object(a.a)(u).toLowerCase()}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,a=Object.create(i.prototype),o=new A(r||[]);return a._invoke=function(e,t,n){var r=d;return function(i,a){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===i)throw a;return I()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var u=l(e,t,n);if("normal"===u.type){if(r=n.done?h:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=h,n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",v={};function m(){}function b(){}function g(){}var y={};y[a]=function(){return this};var _=Object.getPrototypeOf,O=_&&_(_(x([])));O&&O!==n&&r.call(O,a)&&(y=O);var T=g.prototype=m.prototype=Object.create(y);function E(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function n(i,a,o,s){var u=l(e[i],e,a);if("throw"!==u.type){var c=u.arg,d=c.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(d).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(u.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(j,this),this.reset(!0)}function x(e){if(e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:I}}function I(){return{value:t,done:!0}}return b.prototype=T.constructor=g,g.constructor=b,b.displayName=u(g,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(T),e},e.awrap=function(e){return{__await:e}},E(w.prototype),w.prototype[o]=function(){return this},e.AsyncIterator=w,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new w(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(T),u(T,s,"Generator"),T[a]=function(){return this},T.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(k),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:x(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";n.r(t);var r=n(127),i=n(2),a=/&#([0-9]+);/g,o=/<br>/gi,s=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,u=/\s*<p (?:class=([^>]+))?>(.*)/i,c=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function l(e,t){var n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}t.default=function(e,t,n){var d,f,p=/<sync[ >]/gi,h=/<sync[ >]|<\/body>/gi,v=[],m=s.exec(e),b=null!==m?m[1]:"";h.exec(e);var g,y=function(e){for(var t=/\.(\S+)\s*{([^}]*)}/gi,n={},r=t.exec(e);Array.isArray(r);){var i=r[1],a=l(r[2],"lang");null!=i&&null!=a&&(n[a]=i),r=t.exec(e)}return n}(b);if(Object(i.a)(n)&&void 0===(g=y[n]))throw new Error("sami: could not find lang "+n+" in CSS");for(;d=p.exec(e),f=h.exec(e),null!==d||null!==f;){if(null===d||null===f||d.index>=f.index)throw new Error("parse error");var _=e.slice(d.index,f.index),O=c.exec(_);if(null===O)throw new Error("parse error (sync time attribute)");var T=+O[1];if(isNaN(T))throw new Error("parse error (sync time attribute NaN)");E(_.split("\n"),T/1e3)}return function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n],o=a.start,s=a.end,u=a.text;if(Object(i.a)(u)&&null!=s){var c=Object(r.a)(o,s,u);null!=c&&t.push(c)}}return t}(v);function E(e,n){for(var r,i,s=e.length;--s>=0;)if(null!==(r=u.exec(e[s]))){var c=r,l=c[1],d=c[2];g===l&&("&nbsp;"===d?v[v.length-1].end=n:v.push({text:(i=d,i.replace(o,"\n").replace(a,(function(e,t){return String.fromCharCode(t)}))),start:n+t}))}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return o}));var r=n(127),i=n(136),a=n(137);function o(e,t){for(var n,o,s,u,c,l=e.split(/\r\n|\n|\r/),d=Object(i.a)(l),f=[],p=0;p<d.length;p++){var h=Object(a.a)(d[p],t);if(null!==h){var v=(o=void 0,s=void 0,u=void 0,c=void 0,o=(n=h).start,s=n.end,u=n.payload,c=u.join("\n"),Object(r.a)(o,s,c));null!==v&&f.push(v)}}return f}},function(e,t,n){"use strict";n.r(t);var r=n(2),i=/&#([0-9]+);/g,a=/<br>/gi,o=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,s=/\s*<p (?:class=([^>]+))?>(.*)/i,u=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function c(e,t){var n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}t.default=function(e,t,n){var l,d,f=/<sync[ >]/gi,p=/<sync[ >]|<\/body>/gi,h=[],v=o.exec(e),m=Array.isArray(v)?v[1]:"";p.exec(e);var b,g=function(e){for(var t=/\.(\S+)\s*{([^}]*)}/gi,n={},r=t.exec(e);null!==r;){var i=r[1],a=c(r[2],"lang");null!=i&&null!=a&&(n[a]=i),r=t.exec(e)}return n}(m),y=function(e){var t=/p\s*{([^}]*)}/gi.exec(e);return null===t?"":t[1]}(m);if(Object(r.a)(n)&&void 0===(b=g[n]))throw new Error("sami: could not find lang "+n+" in CSS");for(;l=f.exec(e),d=p.exec(e),null!==l||null!==d;){if(null===l||null===d||l.index>=d.index)throw new Error("parse error");var _=e.slice(l.index,d.index),O=u.exec(_);if(!Array.isArray(O))throw new Error("parse error (sync time attribute)");var T=+O[1];if(isNaN(T))throw new Error("parse error (sync time attribute NaN)");E(_.split("\n"),T/1e3)}return h;function E(e,n){for(var o=e.length;--o>=0;){var u=s.exec(e[o]);if(Array.isArray(u)){var c=u[1],l=u[2];if(b===c)if("&nbsp;"===l)h[h.length-1].end=n;else{var d=document.createElement("DIV");d.className="rxp-texttrack-region";var f=document.createElement("DIV");f.className="rxp-texttrack-div",f.style.position="absolute",f.style.bottom="0",f.style.width="100%",f.style.color="#fff",f.style.textShadow="-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000";var p=document.createElement("div");p.className="rxp-texttrack-p",Object(r.a)(y)&&(p.style.cssText=y);for(var v=l.split(a),m=0;m<v.length;m++){0!==m&&p.appendChild(document.createElement("BR"));var g=document.createElement("SPAN");g.className="rxp-texttrack-span",g.textContent=v[m].replace(i,(function(e,t){return String.fromCharCode(t)})),p.appendChild(g)}f.appendChild(p),d.appendChild(f),h.push({element:d,start:n+t,end:-1})}}}}}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(136),i=n(137);function a(e,t){for(var n=e.split(/\r\n|\n|\r/),a=Object(r.a)(n),s=[],u=0;u<a.length;u++){var c=Object(i.a)(a[u],t);if(null!=c){var l=o(c);null!=l&&s.push(l)}}return s}function o(e){var t=e.start,n=e.end,r=e.payload,i=document.createElement("div");i.className="rxp-texttrack-p",i.style.fontSize="28px",i.style.position="absolute",i.style.bottom="5%",i.style.width="100%",i.style.textAlign="center",i.style.color="#fff",i.style.textShadow="-1px -1px 2px #000,1px -1px 2px #000,-1px 1px 2px #000,1px 1px 2px #000";for(var a=0;a<r.length;a++){0!==a&&i.appendChild(document.createElement("br"));var o=s(r[a]);i.appendChild(o)}return{start:t,end:n,element:i}}function s(e){var t=document.createElement("div");t.innerHTML=e;return function e(t){var n=t.childNodes,r=document.createElement("span");r.className="rxp-texttrack-span";for(var i=0;i<n.length;i++){var a=n[i];if("#text"===a.nodeName){for(var o=a.wholeText.split("\n"),s=0;s<o.length;s++)if(0!==s&&r.appendChild(document.createElement("br")),o[s].length>0){var u=document.createTextNode(o[s]);r.appendChild(u)}}else if("B"===a.nodeName){var c=e(a);c.style.fontWeight="bold",r.appendChild(c)}else if("I"===a.nodeName){var l=e(a);l.style.fontStyle="italic",r.appendChild(l)}else if("U"===a.nodeName){var d=e(a);d.style.textDecoration="underline",r.appendChild(d)}else if("FONT"===a.nodeName&&null!=a.color){var f=e(a);f.style.color=a.color,r.appendChild(f)}else{var p=e(a);r.appendChild(p)}}return r}(t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r=n(63),i=n(30),a=n(105),o=n(50),s=n(229),u=n(143),c=n(37),l=n(157),d=n(144),f=n(192),p=n(96),h=n(149),v=n(60),m=n(0),b=n(79),g=n(131),y=n(38),_=n(129),O=n(133),T=n(134);function E(e){var t=e.autoPlay,n=e.clock$,E=e.keySystems,w=e.mediaElement,S=e.speed$,j=e.startAt,k=e.url;if(Object(p.a)(w),null==k)throw new Error("No URL for a DirectFile content");var A=Object(h.a)(w,k);m.a.debug("Init: Calculating initial time");var x=function(){return function(e,t){if(null==t)return 0;if(null!=t.position)return t.position;if(null!=t.wallClockTime)return t.wallClockTime;if(null!=t.fromFirstPosition)return t.fromFirstPosition;var n=e.duration;if(null==n||!isFinite(n))return m.a.warn("startAt.fromLastPosition set but no known duration, beginning at 0."),0;if("number"==typeof t.fromLastPosition)return Math.max(0,n+t.fromLastPosition);if(null!=t.percentage){var r=t.percentage;return r>=100?n:r<=0?0:n*(+r/100)}return 0}(w,j)};m.a.debug("Init: Initial time calculated:",x);var I=Object(_.a)({clock$:n,mediaElement:w,startTime:x,mustAutoPlay:t,isDirectfile:!0}),M=I.seek$,R=I.load$,C=A.pipe(Object(o.a)((function(){return Object(g.a)(w,E,r.a)})),Object(b.a)(),Object(s.a)()),N=Object(O.a)(w),P=Object(T.a)(w,S,n,{pauseWhenStalled:!0}).pipe(Object(u.a)()),D=n.pipe(Object(c.a)((function(e){return null===e.stalled?y.a.unstalled():y.a.stalled(e.stalled)}))),L=C.pipe(Object(l.a)((function(e){return"created-media-keys"===e.type?(e.value.attachMediaKeys$.next(),!0):"eme-disabled"===e.type||"attached-media-keys"===e.type})),Object(d.a)(1),Object(f.a)(R),Object(o.a)((function(e){if("autoplay-blocked"===e){var t=new v.a("MEDIA_ERR_BLOCKED_AUTOPLAY","Cannot trigger auto-play automatically: your browser does not allow it.");return Object(i.a)(y.a.warning(t),y.a.loaded(null))}if("not-loaded-metadata"===e){var n=new v.a("MEDIA_ERR_NOT_LOADED_METADATA","Cannot load automatically: your browser falsely announced having loaded the content.");return Object(i.a)(y.a.warning(n))}return Object(i.a)(y.a.loaded(null))}))),B=M.pipe(Object(u.a)());return Object(a.a)(L,B,C,N,P,D)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return d}));var r=n(15),i=n.n(r),a=n(28),o=n(58);function s(e,t){var n;if(t.length!==e.length)return!0;for(var r=0;r<t.length;r++)if(t[r].nativeTrack!==(null===(n=e[r])||void 0===n?void 0:n.nativeTrack))return!0;return!1}function u(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],s=""===a.language?"nolang":a.language,u=null!==(t=r[s])&&void 0!==t?t:1,c="gen_audio_"+s+"_"+u.toString();r[s]=u+1;var l={language:a.language,id:c,normalized:Object(o.a)(a.language),audioDescription:!1,representations:[]};n.push({track:l,nativeTrack:a})}return n}function c(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],s=""===a.language?"nolang":a.language,u=null!==(t=r[s])&&void 0!==t?t:1,c="gen_text_"+s+"_"+u.toString();r[s]=u+1;var l={language:a.language,id:c,normalized:Object(o.a)(a.language),closedCaption:"captions"===a.kind};n.push({track:l,nativeTrack:a})}return n}function l(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],o=""===a.language?"nolang":a.language,s=null!==(t=r[o])&&void 0!==t?t:1,u="gen_video_"+o+"_"+s.toString();r[o]=s+1,n.push({track:{id:u,representations:[]},nativeTrack:a})}return n}var d=function(e){function t(t){var n,r,i,a;return(n=e.call(this)||this)._preferredAudioTracks=[],n._preferredTextTracks=[],n._preferredVideoTracks=[],n._nativeAudioTracks=t.audioTracks,n._nativeVideoTracks=t.videoTracks,n._nativeTextTracks=t.textTracks,n._audioTracks=void 0!==n._nativeAudioTracks?u(n._nativeAudioTracks):[],n._videoTracks=void 0!==n._nativeVideoTracks?l(n._nativeVideoTracks):[],n._textTracks=void 0!==n._nativeTextTracks?c(n._nativeTextTracks):[],n._lastEmittedNativeAudioTrack=null===(r=n._getPrivateChosenAudioTrack())||void 0===r?void 0:r.nativeTrack,n._lastEmittedNativeVideoTrack=null===(i=n._getPrivateChosenVideoTrack())||void 0===i?void 0:i.nativeTrack,n._lastEmittedNativeTextTrack=null===(a=n._getPrivateChosenTextTrack())||void 0===a?void 0:a.nativeTrack,n._handleNativeTracksCallbacks(),n}i()(t,e);var n=t.prototype;return n.setPreferredAudioTracks=function(e,t){this._preferredAudioTracks=e,t&&this._applyAudioPreferences()},n.setPreferredTextTracks=function(e,t){this._preferredTextTracks=e,t&&this._applyTextPreferences()},n.setPreferredVideoTracks=function(e,t){this._preferredVideoTracks=e,t&&this._applyVideoPreferences()},n.setAudioTrackById=function(e){for(var t=0;t<this._audioTracks.length;t++){var n=this._audioTracks[t],r=n.track,i=n.nativeTrack;if(r.id===e)return i.enabled=!0,void(this._audioTrackLockedOn=i)}throw new Error("Audio track not found.")},n.disableTextTrack=function(){f(this._textTracks),this._textTrackLockedOn=null},n.setTextTrackById=function(e){for(var t=!1,n=0;n<this._textTracks.length;n++){var r=this._textTracks[n],i=r.track,a=r.nativeTrack;i.id===e?(a.mode="showing",t=!0,this._textTrackLockedOn=a):"showing"!==a.mode&&"hidden"!==a.mode||(a.mode="disabled")}if(!t)throw new Error("Text track not found.")},n.disableVideoTrack=function(){h(this._videoTracks),this._videoTrackLockedOn=null},n.setVideoTrackById=function(e){for(var t=0;t<this._videoTracks.length;t++){var n=this._videoTracks[t],r=n.track,i=n.nativeTrack;if(r.id===e)return i.selected=!0,void(this._videoTrackLockedOn=i)}throw new Error("Video track not found.")},n.getChosenAudioTrack=function(){var e=this._getPrivateChosenAudioTrack();return null!=e?e.track:e},n.getChosenTextTrack=function(){var e=this._getPrivateChosenTextTrack();return null!=e?e.track:e},n.getChosenVideoTrack=function(){var e=this._getPrivateChosenVideoTrack();return null!=e?e.track:e},n.getAvailableAudioTracks=function(){return this._audioTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,language:t.language,normalized:t.normalized,audioDescription:t.audioDescription,active:n.enabled,representations:t.representations}}))},n.getAvailableTextTracks=function(){return this._textTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,language:t.language,normalized:t.normalized,closedCaption:t.closedCaption,active:"showing"===n.mode}}))},n.getAvailableVideoTracks=function(){return this._videoTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,representations:t.representations,active:n.selected}}))},n.dispose=function(){void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onchange=null,this._nativeVideoTracks.onaddtrack=null,this._nativeVideoTracks.onremovetrack=null),void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onchange=null,this._nativeAudioTracks.onaddtrack=null,this._nativeAudioTracks.onremovetrack=null),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onchange=null,this._nativeTextTracks.onaddtrack=null,this._nativeTextTracks.onremovetrack=null),this.removeEventListener()},n._getPrivateChosenAudioTrack=function(){if(void 0!==this._nativeAudioTracks){for(var e=0;e<this._audioTracks.length;e++){var t=this._audioTracks[e];if(t.nativeTrack.enabled)return t}return null}},n._getPrivateChosenVideoTrack=function(){if(void 0!==this._nativeVideoTracks){for(var e=0;e<this._videoTracks.length;e++){var t=this._videoTracks[e];if(t.nativeTrack.selected)return t}return null}},n._getPrivateChosenTextTrack=function(){if(void 0!==this._nativeTextTracks){for(var e=0;e<this._textTracks.length;e++){var t=this._textTracks[e];if("showing"===t.nativeTrack.mode)return t}return null}},n._setOptimalAudioTrack=function(){if(void 0!==this._audioTrackLockedOn)for(var e=0;e<this._audioTracks.length;e++){var t=this._audioTracks[e].nativeTrack;if(t===this._audioTrackLockedOn)return void(t.enabled=!0)}this._applyAudioPreferences()},n._applyAudioPreferences=function(){this._audioTrackLockedOn=void 0;for(var e=this._preferredAudioTracks,t=0;t<e.length;t++){var n=e[t];if(null!==n&&void 0!==n.language)for(var r=Object(o.a)(n.language),i=0;i<this._audioTracks.length;i++){var a=this._audioTracks[i];if(a.track.normalized===r&&a.track.audioDescription===n.audioDescription)return void(a.nativeTrack.enabled=!0)}}},n._setOptimalTextTrack=function(){if(null!==this._textTrackLockedOn){if(void 0!==this._textTrackLockedOn)for(var e=0;e<this._textTracks.length;e++){var t=this._textTracks[e].nativeTrack;if(t===this._textTrackLockedOn)return p(this._textTracks,t),void("showing"!==t.mode&&(t.mode="showing"))}this._applyTextPreferences()}else f(this._textTracks)},n._applyTextPreferences=function(){this._textTrackLockedOn=void 0;for(var e=this._preferredTextTracks,t=0;t<e.length;t++){var n=e[t];if(null===n)return void f(this._textTracks);for(var r=Object(o.a)(n.language),i=0;i<this._textTracks.length;i++){var a=this._textTracks[i];if(a.track.normalized===r&&a.track.closedCaption===n.closedCaption)return p(this._textTracks,a.nativeTrack),void("showing"!==a.nativeTrack.mode&&(a.nativeTrack.mode="showing"))}}f(this._textTracks)},n._setOptimalVideoTrack=function(){if(null!==this._videoTrackLockedOn){if(void 0!==this._videoTrackLockedOn)for(var e=0;e<this._videoTracks.length;e++){var t=this._videoTracks[e].nativeTrack;if(t===this._videoTrackLockedOn)return void(t.selected=!0)}this._applyVideoPreferences()}else h(this._videoTracks)},n._applyVideoPreferences=function(){this._videoTrackLockedOn=void 0,this._preferredVideoTracks.some((function(e){return null===e}))&&h(this._videoTracks)},n._handleNativeTracksCallbacks=function(){var e=this;void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeAudioTracks){var r=u(e._nativeAudioTracks);if(s(e._audioTracks,r)){e._audioTracks=r,e._setOptimalAudioTrack(),e.trigger("availableAudioTracksChange",e.getAvailableAudioTracks());var i=e._getPrivateChosenAudioTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeAudioTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeAudioTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeAudioTracks){var r=u(e._nativeAudioTracks);if(s(e._audioTracks,r)){e._audioTracks=r,e.trigger("availableAudioTracksChange",e.getAvailableAudioTracks());var i=e._getPrivateChosenAudioTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeAudioTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeAudioTracks.onchange=function(){if(void 0!==e._audioTracks)for(var t=0;t<e._audioTracks.length;t++){var n=e._audioTracks[t],r=n.track,i=n.nativeTrack;if(i.enabled)return void(i!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",r),e._lastEmittedNativeAudioTrack=i))}null!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null),e._lastEmittedNativeAudioTrack=null)}),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeTextTracks){var r=c(e._nativeTextTracks);if(s(e._textTracks,r)){e._textTracks=r,e._setOptimalTextTrack(),e.trigger("availableTextTracksChange",e.getAvailableTextTracks());var i=e._getPrivateChosenTextTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeTextTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeTextTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeTextTracks){var r=c(e._nativeTextTracks);if(s(e._textTracks,r)){e._textTracks=r,e._setOptimalTextTrack(),e.trigger("availableTextTracksChange",e.getAvailableTextTracks());var i=e._getPrivateChosenTextTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeTextTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeTextTracks.onchange=function(){if(void 0!==e._textTracks)for(var t=0;t<e._textTracks.length;t++){var n=e._textTracks[t],r=n.track,i=n.nativeTrack;if("showing"===i.mode)return void(i!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",r),e._lastEmittedNativeTextTrack=i))}null!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null),e._lastEmittedNativeTextTrack=null)}),void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeVideoTracks){var r=l(e._nativeVideoTracks);if(s(e._videoTracks,r)){e._videoTracks=r,e._setOptimalVideoTrack(),e.trigger("availableVideoTracksChange",e.getAvailableVideoTracks());var i=e._getPrivateChosenVideoTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeVideoTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeVideoTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeVideoTracks){var r=l(e._nativeVideoTracks);if(s(e._videoTracks,r)){e._videoTracks=r,e._setOptimalVideoTrack(),e.trigger("availableVideoTracksChange",e.getAvailableVideoTracks());var i=e._getPrivateChosenVideoTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeVideoTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeVideoTracks.onchange=function(){if(void 0!==e._videoTracks)for(var t=0;t<e._videoTracks.length;t++){var n=e._videoTracks[t],r=n.track,i=n.nativeTrack;if(i.selected)return void(i!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",r),e._lastEmittedNativeVideoTrack=i))}null!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null),e._lastEmittedNativeVideoTrack=null)})},t}(a.a);function f(e){for(var t=0;t<e.length;t++){e[t].nativeTrack.mode="disabled"}}function p(e,t){for(var n=0;n<e.length;n++){var r=e[n].nativeTrack;r===t||"showing"!==r.mode&&"hidden"!==r.mode||(r.mode="disabled")}}function h(e){for(var t=0;t<e.length;t++){e[t].nativeTrack.selected=!1}}},function(e,t,n){"use strict";n.r(t);var r=n(77),i=n.n(r),a=n(15),o=n.n(a),s=n(57),u=n(184),c=n(5),l=n(65),d=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return c.a(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new l.a;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(s.a),f=n(105),p=n(63),h=n(233),v=n(103),m=n(30),b=n(234),g=n(37),y=n(186),_=n(144),O=n(102);function T(e){return e?Object(O.a)((function(){return new s.a}),e):Object(O.a)(new s.a)}var E=n(157),w=n(229),S=n(185),j=n(187),k=n(9);var A=function(){function e(e){this.predicate=e}return e.prototype.call=function(e,t){return t.subscribe(new x(e,this.predicate))},e}(),x=function(e){function t(t,n){var r=e.call(this,t)||this;return r.predicate=n,r.skipping=!0,r.index=0,r}return c.a(t,e),t.prototype._next=function(e){var t=this.destination;this.skipping&&this.tryCallPredicate(e),this.skipping||t.next(e)},t.prototype.tryCallPredicate=function(e){try{var t=this.predicate(e,this.index++);this.skipping=Boolean(t)}catch(e){this.destination.error(e)}},t}(k.a),I=n(242),M=n(192),R=n(8),C=n(106),N=n(19),P=n(0);function D(){var e,t;if(!N.b)return!0;var n=function(){if(!N.b)return P.a.warn("Compat: Can't access Firefox version on no firefox browser."),null;var e=navigator.userAgent,t=/Firefox\/([0-9]+)\./.exec(e);if(null===t)return-1;var n=parseInt(t[1],10);return isNaN(n)?-1:n}();return null===n||n<67||void 0!==(null===(t=null===(e=HTMLVideoElement)||void 0===e?void 0:e.prototype)||void 0===t?void 0:t.requirePictureInPicture)}var L=n(4),B=n(60),U=n(182),F=n(80);function V(e,t){var n=t.defaultCode,r=t.defaultReason;if(Object(U.a)(e))return e;var i=e instanceof Error?e.toString():r;return new F.a(n,i)}var z=n(47),K=n(24),$=n(44),H=n(28),W=n(3),G=n(42),Y=n(13),q=n(25),X=n(22),Q=n(21),Z=n(164),J=n(165),ee=n(163),te=n(50),ne=n(191),re=n(69),ie=n(23);function ae(e,t){return t?function(n){return n.pipe(ae((function(n,r){return Object(re.a)(e(n,r)).pipe(Object(g.a)((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new oe(e))}}var oe=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new se(e,this.project))},e}(),se=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.hasSubscription=!1,r.hasCompleted=!1,r.index=0,r}return c.a(t,e),t.prototype._next=function(e){this.hasSubscription||this.tryNext(e)},t.prototype.tryNext=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this.hasSubscription=!0,this._innerSub(t)},t.prototype._innerSub=function(e){var t=new ie.a(this),n=this.destination;n.add(t);var r=Object(ie.c)(e,t);r!==t&&n.add(r)},t.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},t}(ie.b),ue=n(156),ce=n(143),le=n(26);function de(e){return function(t){return t.lift(new fe(e))}}var fe=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new pe(e,this.callback))},e}(),pe=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new le.a(n)),r}return c.a(t,e),t}(k.a),he=n(141),ve=n(176),me=n(73),be=n(79),ge=n(64),ye=n(12);var _e=n(18),Oe=function(){function e(e){this._alpha=Math.exp(Math.log(.5)/e),this._lastEstimate=0,this._totalWeight=0}var t=e.prototype;return t.addSample=function(e,t){var n=Math.pow(this._alpha,e),r=t*(1-n)+n*this._lastEstimate;isNaN(r)||(this._lastEstimate=r,this._totalWeight+=e)},t.getEstimate=function(){var e=1-Math.pow(this._alpha,this._totalWeight);return this._lastEstimate/e},e}(),Te=L.a.ABR_MINIMUM_TOTAL_BYTES,Ee=L.a.ABR_MINIMUM_CHUNK_SIZE,we=L.a.ABR_FAST_EMA,Se=L.a.ABR_SLOW_EMA,je=function(){function e(){this._fastEWMA=new Oe(we),this._slowEWMA=new Oe(Se),this._bytesSampled=0}var t=e.prototype;return t.addSample=function(e,t){if(!(t<Ee)){var n=8e3*t/e,r=e/1e3;this._bytesSampled+=t,this._fastEWMA.addSample(r,n),this._slowEWMA.addSample(r,n)}},t.getEstimate=function(){if(!(this._bytesSampled<Te))return Math.min(this._fastEWMA.getEstimate(),this._slowEWMA.getEstimate())},t.reset=function(){this._fastEWMA=new Oe(we),this._slowEWMA=new Oe(Se),this._bytesSampled=0},e}();var ke=n(82),Ae=n(88),xe=n(93);function Ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n;"function"==typeof e[e.length-1]&&(n=e.pop());var r=e;return t.lift(new Me(r,n))}}var Me=function(){function e(e,t){this.observables=e,this.project=t}return e.prototype.call=function(e,t){return t.subscribe(new Re(e,this.observables,this.project))},e}(),Re=function(e){function t(t,n,r){var i=e.call(this,t)||this;i.observables=n,i.project=r,i.toRespond=[];var a=n.length;i.values=new Array(a);for(var o=0;o<a;o++)i.toRespond.push(o);for(o=0;o<a;o++){var s=n[o];i.add(Object(xe.a)(i,s,void 0,o))}return i}return c.a(t,e),t.prototype.notifyNext=function(e,t,n){this.values[n]=t;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},t.prototype.notifyComplete=function(){},t.prototype._next=function(e){if(0===this.toRespond.length){var t=[e].concat(this.values);this.project?this._tryProject(t):this.destination.next(t)}},t.prototype._tryProject=function(e){var t;try{t=this.project.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(Ae.a);function Ce(e){var t=e.map((function(t){return Math.log(t/e[0])})),n=t.map((function(e){return e-t[0]+1})),r=(n[n.length-1]-1)/(2*e.length+10),i=1/r;return e.map((function(t,a){return function(t){if(0===t)return 0;var a=Math.min(Math.max(1,t),e.length-1);return i*(r+(e[a]*n[a-1]-e[a-1]*n[a])/(e[a]-e[a-1]))+4}(a)}))}var Ne=n(36);function Pe(e,t){var n=Ce(t);return P.a.debug("ABR: Steps for buffer based chooser.",n.map((function(e,n){return{bufferLevel:e,bitrate:t[n]}}))),e.pipe(Object(g.a)((function(e){return function(e,t,n){var r=e.bufferGap,i=e.currentBitrate,a=e.currentScore,o=e.speed;if(null==i)return t[0];var s,u=Object(Ne.a)(t,(function(e){return e===i}));if(u<0||t.length!==n.length)return P.a.error("ABR: Current Bitrate not found in the calculated levels"),t[0];if(null!=a&&(s=0===o?a:a/o),null!=s&&s>1){var c=n[u],l=function(){for(var e=u+1;e<n.length;e++)if(n[e]>c)return e}();if(null!=l&&r>=n[l])return t[l]}if((null==s||s<1.15)&&r<n[u]){for(var d=u-1;d>=0;d--)if(t[d]<i)return t[d];return i}return i}(e,t,n)})))}var De=L.a.CACHE_LOAD_DURATION_THRESHOLDS;function Le(){var e=!1;return function(t,n){var r=t.adaptation.type;if("text"===r||"image"===r)return!1;var i=function(e,t){return t<De[e]}(r,n);return!(!i||!e)||(i||e||(e=!0),!1)}}var Be=n(14);var Ue=L.a.ABR_REGULAR_FACTOR,Fe=L.a.ABR_STARVATION_DURATION_DELTA,Ve=L.a.ABR_STARVATION_FACTOR,ze=L.a.ABR_STARVATION_GAP,Ke=L.a.OUT_OF_STARVATION_GAP;function $e(e){if(!(e.progress.length<5)){for(var t=new Oe(2),n=e.progress,r=1;r<n.length;r++){var i=n[r].size-n[r-1].size,a=n[r].timestamp-n[r-1].timestamp,o=8*i/(a/1e3);t.addSample(a/1e3,o)}return t.getEstimate()}}function He(e,t){var n=8*(e.totalSize-e.size);return Math.max(n/t,0)}function We(e,t,n,r){var i=function(e,t){var n=Object(Ne.a)(e,(function(e){return!(e.duration<=0)&&e.time+e.duration>t&&Math.abs(t-e.time)<-.3}));if(n<0)return[];for(var r=e[n],i=r.time,a=[r],o=n+1;o<e.length&&e[o].time===i;o++)a.push(e[o]);return a}(e,t.position+t.bufferGap);if(1===i.length){var a=i[0],o=a.duration,s=performance.now(),u=a.progress.length>0?a.progress[a.progress.length-1]:void 0,c=$e(a);if(void 0!==u&&void 0!==c){var l=He(u,c);if((s-u.timestamp)/1e3<=l)if(l-t.bufferGap/t.speed>2e3)return c}var d=(s-a.requestTimestamp)/1e3,f=d<=(1.5*o+2)/t.speed;if(null!=n&&!f){var p=o/d,h=n.bitrate*Math.min(.7,p);return void 0===r||h<r?h:void 0}}}var Ge=function(){function e(e,t){this._initialBitrate=e,this._inStarvationMode=!1,this._config=t?{starvationGap:ze.LOW_LATENCY,outOfStarvationGap:Ke.LOW_LATENCY,starvationBitrateFactor:Ve.LOW_LATENCY,regularBitrateFactor:Ue.LOW_LATENCY}:{starvationGap:ze.DEFAULT,outOfStarvationGap:Ke.DEFAULT,starvationBitrateFactor:Ve.DEFAULT,regularBitrateFactor:Ue.DEFAULT}}var t=e.prototype;return t.getBandwidthEstimate=function(e,t,n,r,i){var a,o,s=this._config,u=e.bufferGap,c=e.position,l=e.duration;return isNaN(l)||u+c<l-Fe?!this._inStarvationMode&&u<=s.starvationGap?(P.a.info("ABR: enter starvation mode."),this._inStarvationMode=!0):this._inStarvationMode&&u>=s.outOfStarvationGap&&(P.a.info("ABR: exit starvation mode."),this._inStarvationMode=!1):this._inStarvationMode&&(P.a.info("ABR: exit starvation mode."),this._inStarvationMode=!1),this._inStarvationMode&&null!=(o=We(r,e,n,i))&&(P.a.info("ABR: starvation mode emergency estimate:",o),t.reset(),a=null==n?o:Math.min(o,n.bitrate)),null==a&&(a=null!=(o=t.getEstimate())?o*(this._inStarvationMode?s.starvationBitrateFactor:s.regularBitrateFactor):null!=i?i*(this._inStarvationMode?s.starvationBitrateFactor:s.regularBitrateFactor):this._initialBitrate),e.speed>1&&(a/=e.speed),{bandwidthEstimate:o,bitrateChosen:a}},t.isUrgent=function(e,t,n,r){return null===t||e!==t.bitrate&&(e>t.bitrate?!this._inStarvationMode:function(e,t){var n=e.position+e.bufferGap,r=Object(Be.a)(t,(function(e){return e.duration>0&&e.time+e.duration>n}));if(void 0===r)return!0;var i=performance.now(),a=r.progress.length>0?r.progress[r.progress.length-1]:void 0,o=$e(r);if(void 0===a||void 0===o)return!0;var s=He(a,o);return(i-a.timestamp)/1e3>1.2*s||s-e.bufferGap/e.speed>-1.5}(r,n))},e}(),Ye=n(78),qe=function(){function e(){this._currentRequests={}}var t=e.prototype;return t.add=function(e){var t=e.id,n=e.time,r=e.duration,i=e.requestTimestamp;this._currentRequests[t]={time:n,duration:r,requestTimestamp:i,progress:[]}},t.addProgress=function(e){var t=this._currentRequests[e.id];null!=t?t.progress.push(e):P.a.warn("ABR: progress for a request not added")},t.remove=function(e){null==this._currentRequests[e]&&P.a.warn("ABR: can't remove unknown request"),delete this._currentRequests[e]},t.getRequests=function(){return Object(Ye.a)(this._currentRequests).filter((function(e){return null!=e})).sort((function(e,t){return e.time-t.time}))},e}(),Xe=function(){function e(){this._currentRepresentationData=null,this._lastRepresentationWithGoodScore=null}var t=e.prototype;return t.addSample=function(e,t,n){var r,i=n/t,a=this._getEWMA(e);null!=a?(r=a,a.addSample(t,i)):((r=new Oe(5)).addSample(t,i),this._currentRepresentationData={representation:e,ewma:r}),r.getEstimate()>1&&this._lastRepresentationWithGoodScore!==e&&(P.a.debug("ABR: New last stable representation",e),this._lastRepresentationWithGoodScore=e)},t.getEstimate=function(e){var t=this._getEWMA(e);if(null!=t)return t.getEstimate()},t.getLastStableRepresentation=function(){return this._lastRepresentationWithGoodScore},t._getEWMA=function(e){return null!=this._currentRepresentationData&&this._currentRepresentationData.representation.id===e.id?this._currentRepresentationData.ewma:null},e}();function Qe(e,t,n,r){var i=t<=n?n:t>=r?r:t,a=Object(Ne.a)(e,(function(e){return e.bitrate>i}));return-1===a?e[e.length-1]:0===a?e[0]:e[a-1]}function Ze(e,t){var n=e;return null!=t.bitrate&&(n=function(e,t){if(0===e.length)return[];e.sort((function(e,t){return e.bitrate-t.bitrate}));var n=e[0].bitrate,r=Math.max(t,n),i=Object(Ne.a)(e,(function(e){return e.bitrate>r}));return-1===i?e:e.slice(0,i)}(n,t.bitrate)),null!=t.width&&(n=function(e,t){var n=e.slice().sort((function(e,t){return Object(_e.a)(e.width,0)-Object(_e.a)(t.width,0)})),r=Object(Be.a)(n,(function(e){return"number"==typeof e.width&&e.width>=t}));if(void 0===r)return e;var i="number"==typeof r.width?r.width:0;return e.filter((function(e){return"number"!=typeof e.width||e.width<=i}))}(n,t.width)),n}function Je(e){var t=e.bandwidthEstimator,n=e.clock$,r=e.filters$,i=e.initialBitrate,a=e.lowLatencyMode,o=e.manualBitrate$,s=e.minAutoBitrate$,u=e.maxAutoBitrate$,c=e.representations,l=e.streamEvents$,d=new Xe,p=new Ge(null==i?0:i,a),v=new qe,b=Le();var y=l.pipe(Object(E.a)((function(e){return"metrics"===e.type})),Object(ue.a)((function(e){return function(e){var n=e.duration,r=e.size,i=e.content;if(!b(i,n)){t.addSample(n,r);var a=n/1e3,o=i.segment.duration,s=i.representation;d.addSample(s,a,o)}}(e.value)})),Object(ce.a)()),_=l.pipe(Object(ue.a)((function(e){switch(e.type){case"requestBegin":v.add(e.value);break;case"requestEnd":v.remove(e.value.id);break;case"progress":v.addProgress(e.value)}})),Object(ce.a)()),O=l.pipe(Object(E.a)((function(e){return"representationChange"===e.type})),Object(g.a)((function(e){return e.value.representation})),Object(S.a)(null)),T=Object(ke.a)((function(){if(0===c.length)throw new Error("ABRManager: no representation choice given");return 1===c.length?Object(m.a)({bitrate:void 0,representation:c[0],manual:!1,urgent:!0,knownStableBitrate:void 0}):o.pipe(Object(he.a)((function(e){if(e>=0){var i=Qe(c,e,0,1/0);return Object(m.a)({representation:i,bitrate:void 0,knownStableBitrate:void 0,manual:!0,urgent:!0})}var a,o=!0,f=Pe(l.pipe(Object(E.a)((function(e){return"added-segment"===e.type})),Ie(n),Object(g.a)((function(e){var t=e[0].value,n=e[1],r=n.speed,i=n.position,a=t.buffered,o=Object(X.d)(a,i),s=t.content.representation,u=d.getEstimate(s);return{bufferGap:o,currentBitrate:s.bitrate,currentScore:u,speed:r}}))),c.map((function(e){return e.bitrate}))).pipe(Object(S.a)(void 0));return Object(h.a)([n,s,u,r,f]).pipe(Ie(O),Object(g.a)((function(e){var n=e[0],r=n[0],i=n[1],s=n[2],u=n[3],l=n[4],f=e[1],h=Ze(c,u),m=v.getRequests(),b=p.getBandwidthEstimate(r,t,f,m,a),g=b.bandwidthEstimate,y=b.bitrateChosen;a=g;var _=d.getLastStableRepresentation(),O=null==_?void 0:_.bitrate/(r.speed>0?r.speed:1),T=r.bufferGap;!o&&T<=5?o=!0:o&&Number.isFinite(T)&&T>10&&(o=!1);var E=Qe(h,y,i,s);if(o)return P.a.debug("ABR: Choosing representation with bandwidth estimation.",E),{bitrate:g,representation:E,urgent:p.isUrgent(E.bitrate,f,m,r),manual:!1,knownStableBitrate:O};if(null==l||E.bitrate>=l)return P.a.debug("ABR: Choosing representation with bandwidth estimation.",E),{bitrate:g,representation:E,urgent:p.isUrgent(E.bitrate,f,m,r),manual:!1,knownStableBitrate:O};var w=Qe(h,l,i,s);return l<=s&&P.a.debug("ABR: Choosing representation with buffer based bitrate ceiling.",w),{bitrate:g,representation:w,urgent:p.isUrgent(l,f,m,r),manual:!1,knownStableBitrate:O}})))})))}));return Object(f.a)(y,_,T)}var et=function(){function e(e){this._manualBitrates=e.manualBitrates,this._minAutoBitrates=e.minAutoBitrates,this._maxAutoBitrates=e.maxAutoBitrates,this._initialBitrates=e.initialBitrates,this._throttlers=e.throttlers,this._bandwidthEstimators={},this._lowLatencyMode=e.lowLatencyMode}var t=e.prototype;return t.get$=function(e,t,n,r){var i,a,o,s,u=this._getBandwidthEstimator(e),c=Object(_e.a)(this._manualBitrates[e],Object(m.a)(-1)),l=Object(_e.a)(this._minAutoBitrates[e],Object(m.a)(0)),d=Object(_e.a)(this._maxAutoBitrates[e],Object(m.a)(1/0)),f=Object(_e.a)(this._initialBitrates[e],0);return Je({bandwidthEstimator:u,streamEvents$:r,clock$:n,filters$:(i=this._throttlers.limitWidth[e],a=this._throttlers.throttleBitrate[e],o=this._throttlers.throttle[e],s=[],null!=i&&s.push(i.pipe(Object(g.a)((function(e){return{width:e}})))),null!=o&&s.push(o.pipe(Object(g.a)((function(e){return{bitrate:e}})))),null!=a&&s.push(a.pipe(Object(g.a)((function(e){return{bitrate:e}})))),s.length>0?Object(h.a)(s).pipe(Object(g.a)((function(e){return Y.a.apply(void 0,[{}].concat(e))}))):Object(m.a)({})),initialBitrate:f,manualBitrate$:c,minAutoBitrate$:l,maxAutoBitrate$:d,representations:t,lowLatencyMode:this._lowLatencyMode})},t._getBandwidthEstimator=function(e){var t=this._bandwidthEstimators[e];if(null==t){P.a.debug("ABR: Creating new BandwidthEstimator for ",e);var n=new je;return this._bandwidthEstimators[e]=n,n}return t},e}(),tt=n(155),nt=n(45),rt=n(145),it=n(180);function at(e){return e instanceof rt.a?new it.a("PIPELINE_LOAD_ERROR",e):V(e,{defaultCode:"PIPELINE_LOAD_ERROR",defaultReason:"Unknown error when fetching the Manifest"})}var ot,st=n(190),ut=n(173),ct=n(120);function lt(e){return e instanceof rt.a&&function(e){return e.type===z.c.ERROR_EVENT&&Object(ut.a)()}(e)?ot.Offline:ot.Regular}function dt(e,t,n){var r=n.baseDelay,i=n.maxDelay,a=n.maxRetryRegular,o=n.maxRetryOffline,s=0,u=ot.None,c=e.slice();return 0===c.length?(P.a.warn("Fetchers: no URL given to `tryURLsWithBackoff`."),p.a):function e(n,l){return t(n).pipe(Object(g.a)((function(e){return{type:"response",value:e}})),Object(tt.a)((function(t){if(!function(e){return e instanceof rt.a?e.type===z.c.ERROR_HTTP_CODE?e.status>=500||404===e.status||415===e.status||412===e.status:e.type===z.c.TIMEOUT||e.type===z.c.ERROR_EVENT:Object(U.a)(e)&&"INTEGRITY_ERROR"===e.code}(t)){if(c.length<=1)throw t;c.splice(l,1);var n=l>=c.length-1?0:l;return e(c[n],n).pipe(Object(S.a)({type:"retry",value:t}))}var d=lt(t),f=d===ot.Offline?o:a;if(d!==u&&(s=0,u=d),l<c.length-1){var p=l+1;return e(c[p],p).pipe(Object(S.a)({type:"retry",value:t}))}if(++s>f)throw t;var h=Math.min(r*Math.pow(2,s-1),i),v=Object(ct.a)(h),m=c[0];return Object(st.a)(v).pipe(Object(te.a)((function(){return e(m,0)})),Object(S.a)({type:"retry",value:t}))})))}(c[0],0)}function ft(e,t){return dt([null],(function(){return e}),t)}!function(e){e[e.None=0]="None",e[e.Regular=1]="Regular",e[e.Offline=2]="Offline"}(ot||(ot={}));var pt=L.a.DEFAULT_MAX_MANIFEST_REQUEST_RETRY,ht=L.a.DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE,vt=L.a.INITIAL_BACKOFF_DELAY_BASE,mt=L.a.MAX_BACKOFF_DELAY_BASE;var bt=function(){function e(e,t,n){var r,i,a,o;this._manifestUrl=e,this._pipelines=t.manifest,this._backoffOptions=(i=(r=n).maxRetryRegular,a=r.maxRetryOffline,{baseDelay:(o=r.lowLatencyMode)?vt.LOW_LATENCY:vt.REGULAR,maxDelay:o?mt.LOW_LATENCY:mt.REGULAR,maxRetryRegular:void 0!==i?i:pt,maxRetryOffline:void 0!==a?a:ht})}var t=e.prototype;return t.fetch=function(e){var t,n=this,r=null!=e?e:this._manifestUrl,i=null!==(t=this._pipelines.resolver)&&void 0!==t?t:m.a,a=this._pipelines.loader;return Object(nt.a)(i,{url:r}).pipe(Object(tt.a)((function(e){throw at(e)})),Object(te.a)((function(e){return ft(Object(nt.a)(a,e),n._backoffOptions).pipe(Object(tt.a)((function(e){throw at(e)})),Object(g.a)((function(e){return"retry"===e.type?{type:"warning",value:at(e.value)}:{type:"response",parse:function(t){return n._parseLoadedManifest(e.value.value,t)}}})))})))},t.parse=function(e,t){return this._parseLoadedManifest({responseData:e,size:void 0,duration:void 0},t)},t._parseLoadedManifest=function(e,t){var n,r,i=e.sendingTime,a=e.receivedTime,o=performance.now(),u=new s.a,c=(n=this._backoffOptions,r=u,function(e){return ft(Object(nt.a)(e,void 0),n).pipe(Object(ge.a)((function(e){return"retry"===e.type?(r.next(at(e.value)),null):e.value}),null),Object(tt.a)((function(e){throw at(e)})))});return Object(f.a)(u.pipe(Object(g.a)((function(e){return{type:"warning",value:e}}))),this._pipelines.parser({response:e,url:this._manifestUrl,externalClockOffset:t.externalClockOffset,previousManifest:t.previousManifest,scheduleRequest:c,unsafeMode:t.unsafeMode}).pipe(Object(tt.a)((function(e){throw V(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"})})),Object(g.a)((function(e){if("warning"===e.type)return{type:"warning",value:V(e.value,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"})};var t=performance.now()-o;return{type:"parsed",manifest:e.value.manifest,sendingTime:i,receivedTime:a,parsingTime:t}})),de((function(){u.complete()}))))},e}(),gt=L.a.DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR,yt=L.a.DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE,_t=L.a.INITIAL_BACKOFF_DELAY_BASE,Ot=L.a.MAX_BACKOFF_DELAY_BASE;var Tt=function(){function e(e){var t=e.prioritySteps;if(this._minPendingPriority=null,this._waitingQueue=[],this._pendingTasks=[],this._prioritySteps=t,this._prioritySteps.high>=this._prioritySteps.low)throw new Error("FP Error: the max high level priority should be given a lowerpriority number than the min low priority.")}var t=e.prototype;return t.create=function(e,t){var n=this,r=Object(ke.a)((function(){var i=new s.a,a={observable:r,priority:t,trigger:i},o=function(t){return t?(n._onTaskBegin(a),Object(v.a)(e.pipe(Object(g.a)((function(e){return{type:"data",value:e}}))),Object(m.a)({type:"ended"})).pipe(de((function(){n._onTaskEnd(a)})))):Object(m.a)({type:"interrupted"})};if(!n._canBeStartedNow(a))return n._waitingQueue.push(a),i.pipe(Object(he.a)(o));var u=i.pipe(Object(S.a)(!0),Object(he.a)(o));return n._isHighPriority(a)?Object(f.a)(u,Object(ke.a)((function(){return n._interruptCancellableTasks(),p.a}))):u}));return r},t.updatePriority=function(e,t){var n=Object(Ne.a)(this._waitingQueue,(function(t){return t.observable===e}));if(n>=0){var r=this._waitingQueue[n];if(r.priority===t)return;if(r.priority=t,!this._canBeStartedNow(r))return;return this._startTask(n),void(this._isHighPriority(r)&&this._interruptCancellableTasks())}var i=Object(Ne.a)(this._pendingTasks,(function(t){return t.observable===e}));if(i<0)P.a.warn("FP: request to update the priority of a non-existent task");else{var a=this._pendingTasks[i];if(a.priority!==t){var o=a.priority;a.priority=t,t<o?this._isHighPriority(a)&&this._interruptCancellableTasks():null!==this._minPendingPriority&&this._minPendingPriority<=this._prioritySteps.high&&this._interruptPendingTask(a)}}},t._interruptCancellableTasks=function(){for(var e=0;e<this._pendingTasks.length;e++){var t=this._pendingTasks[e];if(t.priority>=this._prioritySteps.low)return this._interruptPendingTask(t),this._interruptCancellableTasks()}},t._startTask=function(e){this._waitingQueue.splice(e,1)[0].trigger.next(!0)},t._interruptPendingTask=function(e){var t=Object(Ne.a)(this._pendingTasks,(function(t){return t.observable===e.observable}));t<0?P.a.warn("FP: Interrupting a non-existent pending task. Aborting..."):(this._pendingTasks.splice(t,1),this._waitingQueue.push(e),0===this._pendingTasks.length?this._minPendingPriority=null:this._minPendingPriority===e.priority&&(this._minPendingPriority=Math.min.apply(Math,this._pendingTasks.map((function(e){return e.priority})))),e.trigger.next(!1))},t._onTaskBegin=function(e){this._minPendingPriority=null===this._minPendingPriority?e.priority:Math.min(this._minPendingPriority,e.priority),this._pendingTasks.push(e)},t._onTaskEnd=function(e){var t=Object(Ne.a)(this._pendingTasks,(function(t){return t.observable===e.observable}));if(!(t<0||(e.trigger.complete(),this._pendingTasks.splice(t,1),this._pendingTasks.length>0||(this._minPendingPriority=null,0===this._waitingQueue.length)))){this._minPendingPriority=this._waitingQueue.reduce((function(e,t){return null===e||e>t.priority?t.priority:e}),null);for(var n=0;n<this._waitingQueue.length;n++){this._waitingQueue[n].priority===this._minPendingPriority&&(this._startTask(n),n--)}}},t._canBeStartedNow=function(e){return null===this._minPendingPriority||e.priority<=this._minPendingPriority},t._isHighPriority=function(e){return e.priority<=this._prioritySteps.high},e}(),Et=n(10),wt=n(54),St=n(85),jt=function(){function e(){this._cache=new WeakMap}var t=e.prototype;return t.add=function(e,t){var n=e.representation;e.segment.isInit&&this._cache.set(n,t)},t.get=function(e){var t=e.representation;if(e.segment.isInit){var n=this._cache.get(t);if(void 0!==n)return n}return null},e}(),kt=n(27);function At(e,t,n){return function(r){return function(r){function i(){var i;return dt(null!==(i=r.segment.mediaURLs)&&void 0!==i?i:[null],(function(t){var n=Object(Y.a)({url:t},r);return Object(v.a)(Object(m.a)({type:"request",value:n}),Object(nt.a)(e,n))}),n).pipe(Object(tt.a)((function(e){throw at(e)})),Object(g.a)((function(e){if("retry"===e.type)return{type:"warning",value:at(e.value)};if("request"===e.value.type)return e.value;var n=e.value;return"data-loaded"===n.type&&null!=t&&t.add(r,n.value),e.value})))}var a=null!=t?t.get(r):null;return null!=a?Object(kt.a)(a).pipe(Object(g.a)((function(e){return{type:"cache",value:e}})),Object(tt.a)(i)):i()}(r).pipe(Object(te.a)((function(e){var t;switch(t="data-chunk-complete"!==e.type&&"data-loaded"!==e.type||void 0===e.value.size||void 0===e.value.duration?p.a:Object(m.a)({type:"metrics",value:{size:e.value.size,duration:e.value.duration,content:r}}),e.type){case"warning":case"request":case"progress":return Object(m.a)(e);case"cache":case"data-created":case"data-loaded":return Object(v.a)(Object(m.a)({type:"data",value:e.value}),t);case"data-chunk":return Object(m.a)({type:"chunk",value:e.value});case"data-chunk-complete":return Object(v.a)(Object(m.a)({type:"chunk-complete",value:null}),t);default:Object(wt.a)(e)}})))}}var xt=Object(St.a)();var It=L.a.MIN_CANCELABLE_PRIORITY,Mt=L.a.MAX_HIGH_PRIORITY_LEVEL,Rt=function(){function e(e,t){this._transport=e,this._prioritizer=new Tt({prioritySteps:{high:Mt,low:It}}),this._backoffOptions=t}return e.prototype.createSegmentFetcher=function(e,t){var n,r,i,a=function(e,t){var n=t.maxRetryRegular,r=t.maxRetryOffline,i=t.lowLatencyMode;return{maxRetryRegular:"image"===e?0:null!=n?n:gt,maxRetryOffline:null!=r?r:yt,baseDelay:i?_t.LOW_LATENCY:_t.REGULAR,maxDelay:i?Ot.LOW_LATENCY:Ot.REGULAR}}(e,this._backoffOptions),o=function(e,t,n,r){var i=Object(Et.a)(["audio","video"],e)?new jt:void 0,a=At(t[e].loader,i,r),o=t[e].parser;return function(e){var t=xt(),r=!1;return a(e).pipe(Object(ue.a)((function(e){switch(e.type){case"metrics":n.next(e);break;case"request":var i=e.value.segment;if(void 0===i)return;r=!0,n.next({type:"requestBegin",value:{duration:i.duration,time:i.time,requestTimestamp:performance.now(),id:t}});break;case"progress":var a=e.value;null!=a.totalSize&&a.size<a.totalSize&&n.next({type:"progress",value:{duration:a.duration,size:a.size,totalSize:a.totalSize,timestamp:performance.now(),id:t}})}})),de((function(){r&&n.next({type:"requestEnd",value:{id:t}})})),Object(E.a)((function(e){switch(e.type){case"warning":case"chunk":case"chunk-complete":case"data":return!0;case"progress":case"metrics":case"request":return!1;default:Object(wt.a)(e)}})),Object(te.a)((function(t){if("warning"===t.type)return Object(m.a)(t);if("chunk-complete"===t.type)return Object(m.a)({type:"chunk-complete"});var n="chunk"===t.type,r={type:"chunk",parse:function(r){var i={data:t.value.responseData,isChunked:n};return o({response:i,initTimescale:r,content:e}).pipe(Object(tt.a)((function(e){throw V(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown parsing error"})})))}};return n?Object(m.a)(r):Object(v.a)(Object(m.a)(r),Object(m.a)({type:"chunk-complete"}))})),Object(w.a)())}}(e,this._transport,t,a);return n=this._prioritizer,r=o,i=new WeakMap,{createRequest:function(e,t){void 0===t&&(t=0);var a=n.create(r(e),t),o=a.pipe(Object(g.a)((function(e){return"data"===e.type?e.value:e})));return i.set(o,a),o},updatePriority:function(e,t){var r=i.get(e);void 0!==r?n.updatePriority(r,t):P.a.warn("Fetchers: Cannot update the priority of a request: task not found.")}}},e}(),Ct=n(131),Nt=n(96),Pt=n(34),Dt=n(2),Lt=R.a.onSourceOpen$;function Bt(e,t,n){if(null!==t&&"closed"!==t.readyState){for(var r=t.readyState,i=t.sourceBuffers,a=i.length-1;a>=0;a--){var o=i[a];try{"open"===r&&(P.a.info("Init: Removing SourceBuffer from mediaSource",o),o.abort()),t.removeSourceBuffer(o)}catch(e){P.a.warn("Init: Error while disposing SourceBuffer",e)}}i.length>0&&P.a.warn("Init: Not all SourceBuffers could have been removed.")}if(Object(Nt.a)(e),null!==n)try{P.a.debug("Init: Revoking previous URL"),URL.revokeObjectURL(n)}catch(e){P.a.warn("Init: Error while revoking the media source URL",e)}}function Ut(e){return function(e){return new ye.a((function(t){if(null==Pt.c)throw new B.a("MEDIA_SOURCE_NOT_SUPPORTED","No MediaSource Object was found in the current browser.");var n=Object(Dt.a)(e.src)?e.src:null;Bt(e,null,n),P.a.info("Init: Creating MediaSource");var r=new Pt.c,i=URL.createObjectURL(r);return P.a.info("Init: Attaching MediaSource URL to the media element",i),e.src=i,t.next(r),function(){Bt(e,r,i)}}))}(e).pipe(Object(te.a)((function(e){return Lt(e).pipe(Object(_.a)(1),Object(j.a)(e))})))}var Ft=n(38),Vt=L.a.DEFAULT_LIVE_GAP;var zt=n(97),Kt=n(228),$t=n(227),Ht=n(174),Wt=n(1),Gt=n(48),Yt=n(32),qt=L.a.SOURCE_BUFFER_FLUSHING_INTERVAL,Xt=function(e){function t(t,n,r){var i;i=e.call(this)||this;var a=r.addSourceBuffer(n);return i._destroy$=new s.a,i.bufferType=t,i._mediaSource=r,i._sourceBuffer=a,i._queue=[],i._pendingTask=null,i._lastInitSegment=null,i.codec=n,Object(Kt.a)(qt).pipe(Object(ue.a)((function(){return i._flush()})),Object(b.a)(i._destroy$)).subscribe(),Object($t.a)(i._sourceBuffer,"error").pipe(Object(ue.a)((function(e){return i._onPendingTaskError(e)})),Object(b.a)(i._destroy$)).subscribe(),Object($t.a)(i._sourceBuffer,"updateend").pipe(Object(ue.a)((function(){return i._flush()})),Object(b.a)(i._destroy$)).subscribe(),i}o()(t,e);var n=t.prototype;return n.pushChunk=function(e){return P.a.debug("AVSB: receiving order to push data to the SourceBuffer",this.bufferType,e),this._addToQueue({type:Yt.b.Push,value:e})},n.removeBuffer=function(e,t){return P.a.debug("AVSB: receiving order to remove data from the SourceBuffer",this.bufferType,e,t),this._addToQueue({type:Yt.b.Remove,value:{start:e,end:t}})},n.endOfSegment=function(e){return P.a.debug("AVSB: receiving order for validating end of segment",this.bufferType,e.segment),this._addToQueue({type:Yt.b.EndOfSegment,value:e})},n.getBufferedRanges=function(){return this._sourceBuffer.buffered},n.getPendingOperations=function(){var e=function(e){switch(e.type){case Yt.b.Push:case Yt.b.Remove:case Yt.b.EndOfSegment:return{type:e.type,value:e.value}}},t=this._queue.map(e);return null===this._pendingTask?t:[e(this._pendingTask)].concat(t)},n.dispose=function(){for(this._destroy$.next(),this._destroy$.complete(),null!==this._pendingTask&&(this._pendingTask.subject.complete(),this._pendingTask=null);this._queue.length>0;){var e=this._queue.shift();void 0!==e&&e.subject.complete()}if("open"===this._mediaSource.readyState)try{this._sourceBuffer.abort()}catch(e){P.a.warn("AVSB: Failed to abort a "+this.bufferType+" SourceBuffer:",e)}},n._onPendingTaskError=function(e){if(this._lastInitSegment=null,null!==this._pendingTask){var t=e instanceof Error?e:new Error("An unknown error occured when doing operations on the SourceBuffer");this._pendingTask.subject.error(t)}},n._addToQueue=function(e){var t=this;return new ye.a((function(n){var r=0===t._queue.length&&null===t._pendingTask,i=new s.a,a=Object(Y.a)({subject:i},e);t._queue.push(a);var o=i.subscribe(n);return r&&t._flush(),function(){o.unsubscribe();var e=t._queue.indexOf(a);e>=0&&t._queue.splice(e,1)}}))},n._flush=function(){if(!this._sourceBuffer.updating){if(null!==this._pendingTask){var e=this._pendingTask;if(e.type!==Yt.b.Push||0===e.data.length){switch(e.type){case Yt.b.Push:null!==e.inventoryData&&this._segmentInventory.insertChunk(e.inventoryData);break;case Yt.b.EndOfSegment:this._segmentInventory.completeSegment(e.value);break;case Yt.b.Remove:this.synchronizeInventory();break;default:Object(wt.a)(e)}var t=e.subject;return this._pendingTask=null,t.next(),t.complete(),void this._flush()}}else{var n=this._queue.shift();if(void 0===n)return;if(n.type!==Yt.b.Push)this._pendingTask=n;else{var r,i=n.value;try{r=this._preparePushOperation(i.data)}catch(e){this._pendingTask=Object(Y.a)({data:[],inventoryData:i.inventoryInfos},n);var a=e instanceof Error?e:new Error("An unknown error occured when preparing a push operation");return this._lastInitSegment=null,void n.subject.error(a)}this._pendingTask=Object(Y.a)({data:r,inventoryData:i.inventoryInfos},n)}}try{switch(this._pendingTask.type){case Yt.b.EndOfSegment:return P.a.debug("AVSB: Acknowledging complete segment",this._pendingTask.value),void this._flush();case Yt.b.Push:var o=this._pendingTask.data.shift();if(void 0===o)return void this._flush();this._sourceBuffer.appendBuffer(o);break;case Yt.b.Remove:var s=this._pendingTask.value,u=s.start,c=s.end;P.a.debug("AVSB: removing data from SourceBuffer",this.bufferType,u,c),this._sourceBuffer.remove(u,c);break;default:Object(wt.a)(this._pendingTask)}}catch(e){this._onPendingTaskError(e)}}},n._preparePushOperation=function(e){var t=[],n=e.codec,r=e.timestampOffset,i=e.appendWindow,a=!1;if(n!==this.codec&&(P.a.debug("AVSB: updating codec",n),(a=Object(Ht.a)(this._sourceBuffer,n))?this.codec=n:P.a.debug("AVSB: could not update codec",n,this.codec)),this._sourceBuffer.timestampOffset!==r){var o=r;P.a.debug("AVSB: updating timestampOffset",this.bufferType,this._sourceBuffer.timestampOffset,o),this._sourceBuffer.timestampOffset=o}if(void 0===i[0]?this._sourceBuffer.appendWindowStart>0&&(this._sourceBuffer.appendWindowStart=0):i[0]!==this._sourceBuffer.appendWindowStart&&(i[0]>=this._sourceBuffer.appendWindowEnd&&(this._sourceBuffer.appendWindowEnd=i[0]+1),this._sourceBuffer.appendWindowStart=i[0]),void 0===i[1]?this._sourceBuffer.appendWindowEnd!==1/0&&(this._sourceBuffer.appendWindowEnd=1/0):i[1]!==this._sourceBuffer.appendWindowEnd&&(this._sourceBuffer.appendWindowEnd=i[1]),null!==e.initSegment&&(a||!this._isLastInitSegment(e.initSegment))){var s=e.initSegment;t.push(s);var u=Object(Wt.m)(s);this._lastInitSegment={data:u,hash:Object(Gt.a)(u)}}return null!==e.chunk&&t.push(e.chunk),t},n._isLastInitSegment=function(e){if(null===this._lastInitSegment)return!1;if(this._lastInitSegment.data===e)return!0;var t=this._lastInitSegment.data;if(t.byteLength===e.byteLength){var n=Object(Wt.m)(e);if(Object(Gt.a)(n)===this._lastInitSegment.hash&&Object($.a)(t,n))return!0}return!1},t}(Yt.a),Qt=["audio","video","text","image"];function Zt(e){return"audio"===e||"video"===e}var Jt=function(){function e(e,t){this._mediaElement=e,this._mediaSource=t,this._initializedSegmentBuffers={},this._onNativeBufferAddedOrDisabled=[]}e.isNative=function(e){return Zt(e)};var t=e.prototype;return t.getBufferTypes=function(){var e=this.getNativeBufferTypes();return null==K.a.nativeTextTracksBuffer&&null==K.a.htmlTextTracksBuffer||e.push("text"),null!=K.a.imageBuffer&&e.push("image"),e},t.getNativeBufferTypes=function(){return"AUDIO"===this._mediaElement.nodeName?["audio"]:["video","audio"]},t.getStatus=function(e){var t=this._initializedSegmentBuffers[e];return void 0===t?{type:"uninitialized"}:null===t?{type:"disabled"}:{type:"initialized",value:t}},t.waitForUsableBuffers=function(){var e=this;return this._areNativeBuffersUsable()?Object(m.a)(void 0):new ye.a((function(t){e._onNativeBufferAddedOrDisabled.push((function(){e._areNativeBuffersUsable()&&(t.next(void 0),t.complete())}))}))},t.disableSegmentBuffer=function(t){var n=this._initializedSegmentBuffers[t];if(null!==n){if(void 0!==n)throw new Error("Cannot disable an active SegmentBuffer.");this._initializedSegmentBuffers[t]=null,e.isNative(t)&&this._onNativeBufferAddedOrDisabled.forEach((function(e){return e()}))}else P.a.warn("SBS: The "+t+" SegmentBuffer was already disabled.")},t.createSegmentBuffer=function(e,t,n){void 0===n&&(n={});var r,i=this._initializedSegmentBuffers[e];if(Zt(e)){if(null!=i)return i instanceof Xt&&i.codec!==t?P.a.warn("SB: Reusing native SegmentBuffer with codec",i.codec,"for codec",t):P.a.info("SB: Reusing native SegmentBuffer with codec",t),i;P.a.info("SB: Adding native SegmentBuffer with codec",t);var a=new Xt(e,t,this._mediaSource);return this._initializedSegmentBuffers[e]=a,this._onNativeBufferAddedOrDisabled.forEach((function(e){return e()})),a}if(null!=i)return P.a.info("SB: Reusing a previous custom SegmentBuffer for the type",e),i;if("text"===e){if(P.a.info("SB: Creating a new text SegmentBuffer"),"html"===n.textTrackMode){if(null==K.a.htmlTextTracksBuffer)throw new Error("HTML Text track feature not activated");r=new K.a.htmlTextTracksBuffer(this._mediaElement,n.textTrackElement)}else{if(null==K.a.nativeTextTracksBuffer)throw new Error("Native Text track feature not activated");r=new K.a.nativeTextTracksBuffer(this._mediaElement,!0===n.hideNativeSubtitle)}return this._initializedSegmentBuffers.text=r,r}if("image"===e){if(null==K.a.imageBuffer)throw new Error("Image buffer feature not activated");return P.a.info("SB: Creating a new image SegmentBuffer"),r=new K.a.imageBuffer,this._initializedSegmentBuffers.image=r,r}throw P.a.error("SB: Unknown buffer type:",e),new B.a("BUFFER_TYPE_UNKNOWN","The player wants to create a SegmentBuffer of an unknown type.")},t.disposeSegmentBuffer=function(e){var t=this._initializedSegmentBuffers[e];null!=t?(P.a.info("SB: Aborting SegmentBuffer",e),t.dispose(),delete this._initializedSegmentBuffers[e]):P.a.warn("SB: Trying to dispose a SegmentBuffer that does not exist")},t.disposeAll=function(){var e=this;Qt.forEach((function(t){"initialized"===e.getStatus(t).type&&e.disposeSegmentBuffer(t)}))},t._areNativeBuffersUsable=function(){var e=this,t=this.getNativeBufferTypes();return!t.some((function(t){return void 0===e._initializedSegmentBuffers[t]}))&&!t.every((function(t){return null===e._initializedSegmentBuffers[t]}))},e}(),en=function(){function e(e){this._array=[],this._sortingFn=e}var t=e.prototype;return t.add=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.sort(this._sortingFn);for(var r=0,i=0;i<t.length;i++){for(var a=t[i],o=!1;!o&&r<this._array.length;)this._sortingFn(a,this._array[r])<0?(this._array.splice(r,0,a),o=!0):r++;o||this._array.push(a)}},t.length=function(){return this._array.length},t.get=function(e){if(e<0||e>=this._array.length)throw new Error("Invalid index.");return this._array[e]},t.findFirst=function(e){return Object(Be.a)(this._array,e)},t.has=function(e){return Object(Et.a)(this._array,e)},t.removeElement=function(e){var t=this._array.indexOf(e);if(t>=0)return this._array.splice(t,1),t},t.head=function(){return this._array[0]},t.last=function(){return this._array[this._array.length-1]},t.shift=function(){return this._array.shift()},t.pop=function(){return this._array.pop()},e}(),tn=function(){function e(e){this._weakMap=new WeakMap,this._fn=e}var t=e.prototype;return t.get=function(e){var t=this._weakMap.get(e);if(void 0===t){var n=this._fn(e);return this._weakMap.set(e,n),n}return t},t.destroy=function(e){this._weakMap.delete(e)},e}(),nn=n(177);function rn(e){var t=e.segmentBuffer,n=e.clock$,r=e.maxBufferBehind$,i=e.maxBufferAhead$;return Object(h.a)([n,r,i]).pipe(Object(te.a)((function(e){var n=e[0],r=e[1],i=e[2];return function(e,t,n,r){if(!isFinite(n)&&!isFinite(r))return p.a;var i=[],a=Object(X.c)(e.getBufferedRanges(),t),o=a.innerRange,s=a.outerRanges,u=function(){if(isFinite(r)){for(var e=0;e<s.length;e++){var n=s[e];t+r<=n.start?i.push(n):t<=n.start&&t+r<n.end&&t+r>n.start&&i.push({start:t+r,end:n.end})}null!=o&&t+r<o.end&&i.push({start:t+r,end:o.end})}};return function(){if(isFinite(n)){for(var e=0;e<s.length;e++){var r=s[e];t-n>=r.end?i.push(r):t>=r.end&&t-n>r.start&&t-n<r.end&&i.push({start:r.start,end:t-n})}null!=o&&t-n>o.start&&i.push({start:o.start,end:t-n})}}(),u(),Object(re.a)(i.map((function(t){return P.a.debug("GC: cleaning range from SegmentBuffer",t),e.removeBuffer(t.start,t.end)}))).pipe(Object(nn.a)(),Object(ce.a)())}(t,n,r,i)})))}var an={activePeriodChanged:function(e){return{type:"activePeriodChanged",value:{period:e}}},adaptationChange:function(e,t,n){return{type:"adaptationChange",value:{type:e,adaptation:t,period:n}}},addedSegment:function(e,t,n,r){return{type:"added-segment",value:{content:e,segment:t,segmentData:r,buffered:n}}},bitrateEstimationChange:function(e,t){return{type:"bitrateEstimationChange",value:{type:e,bitrate:t}}},streamComplete:function(e){return{type:"complete-stream",value:{type:e}}},endOfStream:function(){return{type:"end-of-stream",value:void 0}},needsManifestRefresh:function(){return{type:"needs-manifest-refresh",value:void 0}},manifestMightBeOufOfSync:function(){return{type:"manifest-might-be-out-of-sync",value:void 0}},needsMediaSourceReload:function(e,t,n){return{type:"needs-media-source-reload",value:{position:t,autoPlay:n,period:e}}},needsDecipherabilityFlush:function(e,t,n){return{type:"needs-decipherability-flush",value:{position:e,autoPlay:t,duration:n}}},periodStreamReady:function(e,t,n){return{type:"periodStreamReady",value:{type:e,period:t,adaptation$:n}}},periodStreamCleared:function(e,t){return{type:"periodStreamCleared",value:{type:e,period:t}}},protectedSegment:function(e){return{type:"protected-segment",value:e}},representationChange:function(e,t,n){return{type:"representationChange",value:{type:e,period:t,representation:n}}},streamTerminating:function(){return{type:"stream-terminating",value:void 0}},resumeStream:function(){return{type:"resume-stream",value:void 0}},warning:function(e){return{type:"warning",value:e}}},on=n(108),sn=n.n(on);var un=function(){function e(e,t){this.predicate=e,this.inclusive=t}return e.prototype.call=function(e,t){return t.subscribe(new cn(e,this.predicate,this.inclusive))},e}(),cn=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.predicate=n,i.inclusive=r,i.index=0,i}return c.a(t,e),t.prototype._next=function(e){var t,n=this.destination;try{t=this.predicate(e,this.index++)}catch(e){return void n.error(e)}this.nextOrComplete(e,t)},t.prototype.nextOrComplete=function(e,t){var n=this.destination;Boolean(t)?n.next(e):(this.inclusive&&n.next(e),n.complete())},t}(k.a);var ln=N.e,dn=n(166),fn=L.a.CONTENT_REPLACEMENT_PADDING,pn=L.a.BITRATE_REBUFFERING_RATIO,hn=L.a.MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT,vn=L.a.MINIMUM_SEGMENT_SIZE,mn=Math.min(1/60,vn);function bn(e){var t=e.content,n=e.currentPlaybackTime,r=e.fastSwitchThreshold,i=e.neededRange,a=e.segmentsBeingPushed,o=e.bufferedSegments,s=t.representation.index.getSegments(i.start,i.end-i.start),u=o.filter((function(e){return!yn(e.infos,t,n,r)})).filter((function(e,t,n){var r=0===t?null:n[t-1],a=t>=n.length-1?null:n[t+1];return!function(e,t,n){if(void 0===e.bufferedStart)return P.a.warn("Stream: Start of a segment unknown. Assuming it is garbage collected by default.",e),!0;if(null!==t&&void 0!==t.bufferedEnd&&e.bufferedStart-t.bufferedEnd<.1)return!1;if(n<e.bufferedStart&&e.bufferedStart-e.start>hn)return P.a.info("Stream: The start of the wanted segment has been garbage collected",e),!0;return!1}(e,r,i.start)&&!function(e,t,n){if(void 0===e.bufferedEnd)return P.a.warn("Stream: End of a segment unknown. Assuming it is garbage collected by default.",e),!0;if(null!==t&&void 0!==t.bufferedStart&&t.bufferedStart-e.bufferedEnd<.1)return!1;if(n>e.bufferedEnd&&e.end-e.bufferedEnd>hn)return P.a.info("Stream: The end of the wanted segment has been garbage collected",e),!0;return!1}(e,a,i.end)}));return s.filter((function(e){var i=Object(Y.a)({segment:e},t);if(a.length>0&&a.some((function(e){return Object(dn.a)(i,e)})))return!1;var o=e.duration,s=e.time,c=e.end;if(e.isInit)return!0;if(o<vn)return!1;if(a.length>0&&a.some((function(e){if(e.period.id!==t.period.id||e.adaptation.id!==t.adaptation.id)return!1;var a=e.segment;return!(a.time-mn>s)&&(!(a.end+mn<c)&&!yn(e,i,n,r))})))return!1;for(var l=0;l<u.length;l++){var d=u[l];if(d.infos.period.id===t.period.id){var f=d.infos.segment;if(s-f.time>-mn&&f.end-c>-mn)return!1}}for(var p=0;p<u.length;p++){var h=u[p];if(h.end>s)return h.start>s+mn||gn(u,p).end<c-mn}return!0}))}function gn(e,t){for(var n=t+1;n<e.length-1&&e[n-1].end+mn>e[n].start;)n++;return e[--n]}function yn(e,t,n,r){if(e.period.id!==t.period.id)return!1;var i=e.segment;return!(ln&&i.time<n+fn)&&(e.adaptation.id!==t.adaptation.id||function(e,t,n){var r=e.bitrate;if(void 0===n){var i=r*pn;return t.bitrate>i}return r<n&&t.bitrate>r}(e.representation,t.representation,r))}var _n=L.a.SEGMENT_PRIORITIES_STEPS;function On(e,t){for(var n=e-(t.position+t.wantedTimeOffset),r=0;r<_n.length;r++)if(n<_n[r])return r;return _n.length}var Tn=L.a.MINIMUM_SEGMENT_SIZE;function En(e,t,n,r,i){var a,o=e.period,s=e.representation;i.synchronizeInventory();var u,c,l=t.position+t.wantedTimeOffset,d=l+r,f={start:Math.max(l,o.start),end:Math.min(d,null!==(a=o.end)&&void 0!==a?a:1/0)},p=s.index.shouldRefresh(l,d),h=i.getPendingOperations().filter((function(e){return e.type===Yt.b.EndOfSegment})).map((function(e){return e.value})),v=function(e,t){for(var n=Math.max(1/60,Tn),r=e.start+n,i=e.end-n,a=[],o=t.length-1;o>=0;o--){var s=t[o],u=s.infos.representation;if(!s.partiallyPushed&&!1!==u.decipherable&&u.isSupported){var c=s.infos.segment,l=c.time/c.timescale;((null==c.duration?s.end:l+c.duration/c.timescale)>r&&l<i||s.end>r&&s.start<i)&&a.unshift(s)}}return a}({start:Math.max(f.start-.5,0),end:f.end+.5},i.getInventory()),m=bn({content:e,currentPlaybackTime:t.getCurrentTime(),fastSwitchThreshold:n,neededRange:f,bufferedSegments:v,segmentsBeingPushed:h}).map((function(e){return{priority:On(e.time,t),segment:e}})),b=s.index.getLastPosition();if(!s.index.isInitialized()||void 0===o.end||m.length>0)u=!1;else if(void 0===b)u=f.end>=o.end&&s.index.isFinished();else if(null===b)u=s.index.isFinished();else{var g=void 0!==o.end?Math.min(o.end,b):b;u=f.end>=g&&s.index.isFinished()}if(s.index.isInitialized()&&(s.index.areSegmentsChronologicallyGenerated()||u)){var y=null;h.length>0&&(y=Math.min.apply(Math,h.map((function(e){return e.segment.time})))),m.length>0&&(y=null!==y?Math.min(y,m[0].segment.time):m[0].segment.time),c=function(e,t,n,r,i){for(var a,o=e.period,s=e.adaptation,u=e.representation,c=0;c<i.length;c++){var l=i[c];if(void 0===l.bufferedEnd)break;if(l.bufferedEnd>t.start){a=c;break}}if(void 0===a){var d=u.index.checkDiscontinuity(t.start);if(null!==d)return{start:void 0,end:d}}else{var f=i[a];if(void 0!==f.bufferedStart&&f.bufferedStart>t.start&&(null===n||f.infos.segment.end<=n))return P.a.error("RS: current discontinuity encountered",s.type,f.bufferedStart),{start:void 0,end:f.bufferedStart};for(var p,h=a+1;h<i.length;h++){var v=i[h],m=i[h-1];if(void 0===v.bufferedStart||void 0===m.bufferedEnd||v.bufferedStart>=t.end)break;v.bufferedStart-m.bufferedEnd>0&&(p=h)}if(void 0!==p&&(null===n||i[p].infos.segment.end<=n)){var b=i[p-1].bufferedEnd,g=i[p].bufferedStart;return P.a.error("RS: future discontinuity encountered",s.type,b,g),{start:b,end:g}}if(null===n){if(r&&void 0!==o.end){if(t.end<o.end)return null;for(var y,_=i.length-1;_>=0;_--){var O=i[_];if(void 0===O.bufferedStart)break;if(O.bufferedStart<o.end){y=_;break}}if(void 0!==y){var T=i[y];if(void 0!==T.bufferedEnd&&T.bufferedEnd<o.end)return P.a.error("RS: discontinuity encountered at the end of the current period",s.type,T.bufferedEnd,o.end),{start:T.bufferedEnd,end:null}}}for(var E,w=i.length-1;w>=0;w--){var S=i[w];if(void 0===S.bufferedStart)break;if(S.bufferedStart<t.end){E=w;break}}if(void 0!==E){var j=i[E];if(void 0!==j.bufferedEnd&&j.bufferedEnd<t.end){var k=u.index.checkDiscontinuity(t.end);if(null!==k)return{start:j.bufferedEnd,end:k}}}}}return null}(e,f,y,u,v)}else c=null;return{imminentDiscontinuity:c,hasFinishedLoading:u,neededSegments:m,shouldRefreshManifest:p}}var wn=L.a.BUFFER_GC_GAPS.CALM,Sn=L.a.BUFFER_GC_GAPS.BEEFY;function jn(e,t,n){for(var r=Object(X.c)(t,e),i=r.innerRange,a=r.outerRanges,o=[],s=0;s<a.length;s++){var u=a[s];(e-n<u.end||e+n>u.start)&&o.push(u)}return null!=i&&(P.a.debug("Stream: GC removing part of inner range",o),e-n>i.start&&o.push({start:i.start,end:e-n}),e+n<i.end&&o.push({start:e+n,end:i.end})),o}function kn(e,t,n){var r=t.pushChunk(n);return r.pipe(Object(tt.a)((function(n){if(!(n instanceof Error)||"QuotaExceededError"!==n.name){var i=n instanceof Error?n.toString():"An unknown error happened when pushing content";throw new B.a("BUFFER_APPEND_ERROR",i)}return Object(v.a)((a=e,o=t,a.pipe(Object(_.a)(1),Object(te.a)((function(e){P.a.warn("Stream: Running garbage collector");var t=o.getBufferedRanges(),n=jn(e.position,t,wn);return 0===n.length&&(n=jn(e.position,t,Sn)),P.a.debug("Stream: GC cleaning",n),Object(re.a)(n.map((function(e){var t=e.start,n=e.end;return o.removeBuffer(t,n)}))).pipe(Object(nn.a)())})))).pipe(Object(ce.a)()),r).pipe(Object(tt.a)((function(e){var t=e instanceof Error?e.toString():"Could not clean the buffer";throw new B.a("BUFFER_FULL_ERROR",t)})));var a,o})))}var An=L.a.APPEND_WINDOW_SECURITIES;var xn=function(e){var t,n,r=e.bufferGoal$,i=e.clock$,a=e.content,o=e.fastSwitchThreshold$,c=e.segmentBuffer,l=e.segmentFetcher,d=e.terminate$,b=a.manifest,y=a.period,O=a.adaptation,T=a.representation,E=O.type,j=T.index.getInitSegment(),k=null===j?{initializationData:null,segmentProtections:[],initTimescale:void 0}:null,A=[],x=new u.a(1),I=new s.a,M=null,R=Object(h.a)([i,r,d.pipe(Object(_.a)(1),Object(S.a)(null)),I.pipe(Object(S.a)(void 0))]).pipe(Ie(o),Object(te.a)((function(e){var t=e[0],n=t[0],r=t[1],i=t[2],o=e[1],s=En(a,n,o,r,c),u=s.neededSegments;if(T.index.isInitialized()){if(u.length>0&&null!==j&&null===k){var d=u[0].priority;u.unshift({segment:j,priority:d})}}else null===j?P.a.warn("Stream: Uninitialized index without an initialization segment"):null!==k?P.a.warn("Stream: Uninitialized index with an already loaded initialization segment"):u.unshift({segment:j,priority:On(y.start,n)});var f=u[0];if(null!==i){if(A=[],i.urgent)return P.a.debug("Stream: urgent termination request, terminate.",E),x.complete(),Object(m.a)(an.streamTerminating());if(null===M)return P.a.debug("Stream: no request, terminate.",E),x.complete(),Object(m.a)(an.streamTerminating());if(void 0===f||M.segment.id!==f.segment.id)return P.a.debug("Stream: cancel request and terminate.",E),x.next(),x.complete(),Object(m.a)(an.streamTerminating());if(M.priority!==f.priority){var p=M.request$;M.priority=f.priority,l.updatePriority(p,f.priority)}P.a.debug("Stream: terminate after request.",E)}else if(void 0===f)null!==M&&P.a.debug("Stream: interrupt segment request.",E),A=[],x.next();else if(null===M)P.a.debug("Stream: start downloading queue.",E),A=u,x.next();else if(M.segment.id!==f.segment.id)P.a.debug("Stream: restart download queue.",E),A=u,x.next();else if(M.priority!==f.priority){P.a.debug("Stream: update request priority.",E);var h=M.request$;M.priority=f.priority,l.updatePriority(h,f.priority)}else P.a.debug("Stream: update downloading queue",E),A=u.slice().splice(1,u.length);var b=Object(m.a)({type:"stream-status",value:{period:y,position:n.position,bufferType:E,imminentDiscontinuity:s.imminentDiscontinuity,hasFinishedLoading:s.hasFinishedLoading,neededSegments:s.neededSegments}});return s.shouldRefreshManifest?Object(v.a)(Object(m.a)(an.needsManifestRefresh()),b):b})),(t=function(e){return"stream-terminating"!==e.type},void 0===(n=!0)&&(n=!1),function(e){return e.lift(new un(t,n))})),C=x.pipe(Object(he.a)((function(){return A.length>0?(e=Object(ke.a)((function(){var t=A.shift();if(void 0===t)return sn()((function(){I.next()})),p.a;var n=t.segment,r=t.priority,i={manifest:b,period:y,adaptation:O,representation:T,segment:n},a=l.createRequest(i,r);return M={segment:n,priority:r,request$:a},a.pipe(Object(te.a)((function(t){switch(t.type){case"warning":return Object(m.a)({type:"retry",value:{segment:n,error:t.value}});case"chunk-complete":return M=null,Object(m.a)({type:"end-of-segment",value:{segment:n}});case"interrupted":return P.a.info("Stream: segment request interrupted temporarly.",n),p.a;case"chunk":var r=null==k?void 0:k.initTimescale;return t.parse(r).pipe(Object(g.a)((function(e){return Object(Y.a)({segment:n},e)})));case"ended":return e;default:Object(wt.a)(t)}})))}))).pipe(de((function(){M=null}))):p.a;var e})),Object(te.a)((function(e){var t;switch(e.type){case"retry":return Object(v.a)(Object(m.a)({type:"warning",value:e.value.error}),Object(ke.a)((function(){var t=e.value.segment,n=T.index;if(!1===n.isSegmentStillAvailable(t))I.next();else if(n.canBeOutOfSyncError(e.value.error,t))return Object(m.a)(an.manifestMightBeOufOfSync());return p.a})));case"parsed-init-segment":k=e.value;var n=m.a.apply(void 0,e.value.segmentProtections.map((function(e){return an.protectedSegment(e)}))),r=function(e){var t=e.clock$,n=e.content,r=e.segment,i=e.segmentData,a=e.segmentBuffer;return Object(ke.a)((function(){if(null===i)return p.a;var e=n.representation.getMimeTypeString();return kn(t,a,{data:{initSegment:i,chunk:null,timestampOffset:0,appendWindow:[void 0,void 0],codec:e},inventoryInfos:null}).pipe(Object(g.a)((function(){var e=a.getBufferedRanges();return an.addedSegment(n,r,e,i)})))}))}({clock$:i,content:a,segment:e.segment,segmentData:e.value.initializationData,segmentBuffer:c});return Object(f.a)(n,r);case"parsed-segment":var o=null!==(t=null==k?void 0:k.initializationData)&&void 0!==t?t:null;return function(e){var t=e.clock$,n=e.content,r=e.initSegmentData,i=e.parsedSegment,a=e.segment,o=e.segmentBuffer;return Object(ke.a)((function(){var e,s;if(null===i.chunkData)return p.a;var u=i.chunkData,c=i.chunkInfos,l=i.chunkOffset,d=i.appendWindow,f=n.representation.getMimeTypeString(),h=[void 0!==d[0]?Math.max(0,d[0]-An.START):void 0,void 0!==d[1]?d[1]+An.END:void 0],v={initSegment:r,chunk:u,timestampOffset:l,appendWindow:h,codec:f},m=null!==(e=null==c?void 0:c.time)&&void 0!==e?e:a.time,b=m+(null!==(s=null==c?void 0:c.duration)&&void 0!==s?s:a.duration);void 0!==h[0]&&(m=Math.max(m,h[0])),void 0!==h[1]&&(b=Math.min(b,h[1]));var y=Object(Y.a)({segment:a,start:m,end:b},n);return kn(t,o,{data:v,inventoryInfos:y}).pipe(Object(g.a)((function(){var e=o.getBufferedRanges();return an.addedSegment(n,a,e,u)})))}))}({clock$:i,content:a,initSegmentData:o,parsedSegment:e.value,segment:e.segment,segmentBuffer:c});case"end-of-segment":var s=e.value.segment;return c.endOfSegment(Object(Y.a)({segment:s},a)).pipe(Object(ce.a)());default:Object(wt.a)(e)}})));return Object(f.a)(R,C).pipe(Object(w.a)())};function In(e,t,n){return t.pipe(Object(_.a)(1),Object(te.a)((function(r){var i;if(e.start<=r.position&&(void 0===e.end||e.end>r.position)){var a=r.getCurrentTime()+n,o=Math.min(Math.max(e.start,a),null!==(i=e.end)&&void 0!==i?i:1/0);return Object(m.a)(an.needsMediaSourceReload(e,o,!r.isPaused))}return t.pipe(Object(g.a)((function(t){return an.needsMediaSourceReload(e,t.getCurrentTime(),!t.isPaused)})))})))}var Mn=L.a.DELTA_POSITION_AFTER_RELOAD;var Rn=function(e){var t=e.abrManager,n=e.clock$,r=e.content,i=e.options,a=e.segmentBuffer,o=e.segmentFetcherCreator,u=e.wantedBufferAhead$,c="direct"===i.manualBitrateSwitchingMode,l=r.manifest,h=r.period,b=r.adaptation,O={},T=function(e,t,n){var r=new s.a,i=new s.a,a=Object(f.a)(r,i),o=e.getPlayableRepresentations();if(o.length<=0)throw new B.a("NO_PLAYABLE_REPRESENTATION","No Representation in the chosen Adaptation can be played");return{estimator$:t.get$(e.type,o,n,a),streamFeedback$:r,requestFeedback$:i}}(b,t,n),S=T.estimator$,j=T.requestFeedback$,k=T.streamFeedback$,A=o.createSegmentFetcher(b.type,j),x=new d(null),I=S.pipe(Object(ue.a)((function(e){x.next(e)})),Object(be.a)(),Object(w.a)()),M=I.pipe(Object(E.a)((function(e){return null!=e.bitrate})),Object(y.a)((function(e,t){return e.bitrate===t.bitrate})),Object(g.a)((function(e){var t=e.bitrate;return P.a.debug("Stream: new "+b.type+" bitrate estimate",t),an.bitrateEstimationChange(b.type,t)}))),R=I.pipe(ae((function(e,t){return C(e,0===t)})));return Object(f.a)(R,M);function C(e,t){var r=e.representation;if(c&&e.manual&&!t)return In(h,n,Mn.bitrateSwitch);var a=x.pipe(Object(E.a)((function(t){return null===t||t.representation.id!==r.id||t.manual&&!e.manual})),Object(_.a)(1),Object(g.a)((function(e){return null===e?(P.a.info("Stream: urgent Representation termination",b.type),{urgent:!0}):e.urgent?(P.a.info("Stream: urgent Representation switch",b.type),{urgent:!0}):(P.a.info("Stream: slow Representation switch",b.type),{urgent:!1})}))),o=i.enableFastSwitching?x.pipe(Object(g.a)((function(e){return null===e?void 0:e.knownStableBitrate})),Object(y.a)()):Object(m.a)(0),s=Object(m.a)(an.representationChange(b.type,h,r));return Object(v.a)(s,N(r,a,o)).pipe(Object(ue.a)((function(e){if("representationChange"===e.type||"added-segment"===e.type)return k.next(e)})),Object(te.a)((function(e){if("stream-terminating"===e.type){var t=x.getValue();return null===t?p.a:C(t,!1)}return Object(m.a)(e)})))}function N(e,t,r){return Object(ke.a)((function(){var i=O[e.id],o=null!=i?i:1;O[e.id]=o;var s=u.pipe(Object(g.a)((function(e){return e*o})));return P.a.info("Stream: changing representation",b.type,e),xn({clock$:n,content:{representation:e,adaptation:b,period:h,manifest:l},segmentBuffer:a,segmentFetcher:A,terminate$:t,bufferGoal$:s,fastSwitchThreshold$:r}).pipe(Object(tt.a)((function(n){var i=V(n,{defaultCode:"NONE",defaultReason:"Unknown `RepresentationStream` error"});if("BUFFER_FULL_ERROR"===i.code){var a=u.getValue(),s=o;if(s<=.25||a*s<=2)throw i;return O[e.id]=s-.25,N(e,t,r)}throw i})))}))}};function Cn(e,t,n,r){var i=r.period,a=!1;return Object(h.a)([e,t]).pipe(Object(te.a)((function(e){var t=e[0],r=e[1],o=t.position;return void 0!==i.end&&o+r>=i.end&&(P.a.debug('Stream: full "empty" AdaptationStream',n),a=!0),Object(m.a)({type:"stream-status",value:{period:i,bufferType:n,position:t.position,imminentDiscontinuity:null,hasFinishedLoading:a,neededSegments:[],shouldRefreshManifest:!1}})})))}var Nn=n(101);var Pn=function(e,t){var n=e.split(";"),r=n[0],i=n.slice(1),a=t.split(";"),o=a[0],s=a.slice(1);if(r!==o)return!1;var u=Object(Be.a)(i,(function(e){return Object(Nn.a)(e,"codecs=")})),c=Object(Be.a)(s,(function(e){return Object(Nn.a)(e,"codecs=")}));if(void 0===u||void 0===c)return!1;var l=u.substring(7),d=c.substring(7);return l.split(".")[0]===d.split(".")[0]},Dn=L.a.ADAPTATION_SWITCH_BUFFER_PADDINGS;function Ln(e,t,n,r,i){if(void 0!==e.codec&&"reload"===i.onCodecSwitch&&!Bn(n,e.codec))return{type:"needs-reload",value:void 0};var a=e.getBufferedRanges();if(0===a.length)return{type:"continue",value:void 0};var o=Object(X.a)(a),s=t.start,u=null==t.end?1/0:t.end,c=Object(X.l)(o,[{start:s,end:u}]);if(0===c.length)return{type:"continue",value:void 0};e.synchronizeInventory();var l=e.getInventory();if(!l.some((function(e){return e.infos.period.id===t.id&&e.infos.adaptation.id!==n.id})))return{type:"continue",value:void 0};var d=function(e,t,n){return e.reduce((function(e,r){if(r.infos.period.id!==t.id||r.infos.adaptation.id!==n.id)return e;var i=r.bufferedStart,a=r.bufferedEnd;return void 0===i||void 0===a||e.push({start:i,end:a}),e}),[])}(l,t,n),f=Object(X.b)(c,d);if(0===f.length)return{type:"continue",value:void 0};var p=r.currentTime;if("video"===n.type&&Object(X.j)({start:s,end:u},p)&&(r.readyState>1||!n.getPlayableRepresentations().some((function(t){var n;return Pn(t.getMimeTypeString(),null!==(n=e.codec)&&void 0!==n?n:"")})))&&!Object(X.k)(d,p))return{type:"needs-reload",value:void 0};if("audio"===n.type&&void 0!==e.codec&&"direct"===i.audioTrackSwitchingMode&&Object(X.j)({start:s,end:u},p)&&(r.readyState>1||!Bn(n,e.codec))&&!Object(X.k)(d,p))return{type:"needs-reload",value:void 0};var h=[],v=function(e,t){for(var n=0;n<e.length;n++)if(e[n].infos.period.start>=t.start)return n>0?e[n-1]:null;return e.length>0?e[e.length-1]:null}(l,t);null!==v&&(void 0===v.bufferedEnd||t.start-v.bufferedEnd<1)&&h.push({start:0,end:t.start+1});var m=n.type,b=Dn[m].before;null==b&&(b=0);var g=Dn[m].after;if(null==g&&(g=0),h.push({start:p-b,end:p+g}),void 0!==t.end){var y=function(e,t){for(var n=0;n<e.length;n++)if(e[n].infos.period.start>t.start)return e[n];return null}(l,t);null!==y&&(void 0===y.bufferedStart||y.bufferedStart-t.end<1)&&h.push({start:t.end-1,end:Number.MAX_VALUE})}var _=Object(X.b)(f,h);return _.length>0?{type:"clean-buffer",value:_}:{type:"continue",value:void 0}}function Bn(e,t){return e.getPlayableRepresentations().some((function(e){return Pn(e.getMimeTypeString(),t)}))}var Un=L.a.DELTA_POSITION_AFTER_RELOAD;var Fn=function(e){var t=e.abrManager,n=e.bufferType,r=e.clock$,i=e.content,a=e.garbageCollectors,o=e.segmentFetcherCreator,s=e.segmentBuffersStore,c=e.options,l=e.wantedBufferAhead$,d=i.period,h=new u.a(1);return h.pipe(Object(he.a)((function(e,u){var h=0===u?0:"audio"===n?Un.trackSwitch.audio:"video"===n?Un.trackSwitch.video:Un.trackSwitch.other;if(null===e){P.a.info("Stream: Set no "+n+" Adaptation",d);var b,y=s.getStatus(n);if("initialized"===y.type){if(P.a.info("Stream: Clearing previous "+n+" SegmentBuffer"),Jt.isNative(n))return In(d,r,h);b=y.value.removeBuffer(d.start,null==d.end?1/0:d.end)}else"uninitialized"===y.type&&s.disableSegmentBuffer(n),b=Object(m.a)(null);return Object(v.a)(b.pipe(Object(j.a)(an.adaptationChange(n,null,d))),Cn(r,l,n,{period:d}))}if(Jt.isNative(n)&&"disabled"===s.getStatus(n).type)return In(d,r,h);P.a.info("Stream: Updating "+n+" adaptation",e,d);var O=r.pipe(Object(_.a)(1),Object(te.a)((function(u){var b=function(e,t,n,r){var i=e.getStatus(t);if("initialized"===i.type)return P.a.info("Stream: Reusing a previous SegmentBuffer for the type",t),i.value;var a=function(e){var t=e.representations;if(null==t[0])return"";return t[0].getMimeTypeString()}(n),o="text"===t?r.textTrackOptions:void 0;return e.createSegmentBuffer(t,a,o)}(s,n,e,c),y={currentTime:u.getCurrentTime(),readyState:u.readyState},_=Ln(b,d,e,y,c);if("needs-reload"===_.type)return In(d,r,h);var O="clean-buffer"===_.type?v.a.apply(void 0,_.value.map((function(e){var t=e.start,n=e.end;return b.removeBuffer(t,n)}))).pipe(Object(ce.a)()):p.a,T=a.get(b),E=function(e,a){var u=i.manifest,f=r.pipe(Object(g.a)((function(e){var t=a.getBufferedRanges();return Object(Y.a)({},e,{bufferGap:Object(X.d)(t,e.position)})})));return Rn({abrManager:t,clock$:f,content:{manifest:u,period:d,adaptation:e},options:c,segmentBuffer:a,segmentFetcherCreator:o,wantedBufferAhead$:l}).pipe(Object(tt.a)((function(e){if(!Jt.isNative(n)){P.a.error("Stream: "+n+" Stream crashed. Aborting it.",e),s.disposeSegmentBuffer(n);var t=V(e,{defaultCode:"NONE",defaultReason:"Unknown `AdaptationStream` error"});return Object(v.a)(Object(m.a)(an.warning(t)),Cn(r,l,n,{period:d}))}throw P.a.error("Stream: "+n+" Stream crashed. Stopping playback.",e),e})))}(e,b);return s.waitForUsableBuffers().pipe(Object(te.a)((function(){return Object(v.a)(O,Object(f.a)(E,T))})))})));return Object(v.a)(Object(m.a)(an.adaptationChange(n,e,d)),O)})),Object(S.a)(an.periodStreamReady(n,d,h)))},Vn=n(241);function zn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return e.pipe(Object(E.a)((function(e){return"complete-stream"===e.type||"stream-status"===e.type&&!e.value.hasFinishedLoading})),Object(g.a)((function(e){return"complete-stream"===e.type})),Object(S.a)(!1),Object(y.a)())}));return Object(h.a)(r).pipe(Object(g.a)((function(e){return e.every((function(e){return e}))})),Object(y.a)())}var Kn=L.a.MAXIMUM_MAX_BUFFER_AHEAD,$n=L.a.MAXIMUM_MAX_BUFFER_BEHIND;var Hn=function(e,t,n,r,i,a){var o,u,c=e.manifest,l=e.initialPeriod,d=a.maxBufferAhead$,h=a.maxBufferBehind$,O=a.wantedBufferAhead$,T=new tn((function(e){var n=e.bufferType,r=null!=$n[n]?$n[n]:1/0,i=null!=Kn[n]?Kn[n]:1/0;return rn({segmentBuffer:e,clock$:t.pipe(Object(g.a)((function(e){return e.position}))),maxBufferBehind$:h.pipe(Object(g.a)((function(e){return Math.min(e,r)}))),maxBufferAhead$:d.pipe(Object(g.a)((function(e){return Math.min(e,i)})))})})),S=t.pipe(Object(ge.a)((function(e){var t=e.position,n=e.wantedTimeOffset+t;if(n<c.getMinimumPosition()){var r=new B.a("MEDIA_TIME_BEFORE_MANIFEST","The current position is behind the earliest time announced in the Manifest.");return an.warning(r)}if(n>c.getMaximumPosition()){var i=new B.a("MEDIA_TIME_AFTER_MANIFEST","The current position is after the latest time announced in the Manifest.");return an.warning(i)}return null}),null)),j=r.getBufferTypes().map((function(e){return function(e,n){var i=new en((function(e,t){return e.start-t.start})),a=new s.a,o=!1;function u(t){return x(e,t,a).pipe(Object(ge.a)((function(e){switch(e.type){case"needs-media-source-reload":var t=i.head();if(void 0===t||t.id!==e.value.period.id)return null;break;case"periodStreamReady":o=!0,i.add(e.value.period);break;case"periodStreamCleared":i.removeElement(e.value.period)}return e}),null),Object(w.a)())}function l(e){var t=i.head(),n=i.last();return null==t||null==n||(t.start>e||(null==n.end?1/0:n.end)<e)}var d=t.pipe(Object(ge.a)((function(t){var n,r=t.position,i=t.wantedTimeOffset,s=i+r;if(!o||!l(s))return null;var u=null!==(n=c.getPeriodForTime(s))&&void 0!==n?n:c.getNextPeriod(s);return void 0===u?null:(P.a.info("SO: Current position out of the bounds of the active periods,re-creating Streams.",e,r+i),o=!1,a.next(),u)}),null),Object(te.a)((function(e){if(null==e)throw new B.a("MEDIA_TIME_NOT_FOUND","The wanted position is not found in the Manifest.");return u(e)}))),h=Object(H.b)(c,"decipherabilityUpdate").pipe(Object(te.a)((function(n){var i=r.getStatus(e);if(!n.some((function(t){return t.adaptation.type===e}))||"initialized"!==i.type)return p.a;var s=i.value,l=function(e,t){e.synchronizeInventory();for(var n=[],r=e.getInventory(),i=function(i){var a=r[i];if(t.some((function(e){return a.infos.period.id===e.period.id&&a.infos.adaptation.id===e.adaptation.id&&a.infos.representation.id===e.representation.id}))){var o=a.bufferedStart,s=a.bufferedEnd;if(void 0===o||void 0===s){P.a.warn("SO: No buffered start or end found from a segment.");var u=e.getBufferedRanges(),c=u.length;return 0===c?{v:[]}:{v:[{start:u.start(0),end:u.end(c-1)}]}}var l=n[n.length-1];void 0!==l&&l.end===o?l.end=s:n.push({start:o,end:s})}},a=0;a<r.length;a++){var o=i(a);if("object"==typeof o)return o.v}return n}(s,n);return o=!1,a.next(),v.a.apply(void 0,l.map((function(e){var t=e.start,n=e.end;return s.removeBuffer(t,n).pipe(Object(ce.a)())})).concat([t.pipe(Object(_.a)(1),Object(te.a)((function(e){return Object(v.a)(Object(m.a)(an.needsDecipherabilityFlush(e.position,!e.isPaused,e.duration)),Object(ke.a)((function(){var t=e.position+e.wantedTimeOffset,n=c.getPeriodForTime(t);if(null==n)throw new B.a("MEDIA_TIME_NOT_FOUND","The wanted position is not found in the Manifest.");return u(n)})))})))]))})));return Object(f.a)(d,h,u(n))}(e,l).pipe(Object(be.a)(),Object(w.a)())})),k=(o=j,u=o.length,f.a.apply(void 0,o).pipe(Object(E.a)((function(e){var t=e.type;return"periodStreamCleared"===t||"adaptationChange"===t||"representationChange"===t})),Object(Vn.a)((function(e,t){switch(t.type){case"periodStreamCleared":var n=t.value,r=n.period,i=n.type,a=e[r.id];void 0!==a&&a.buffers.has(i)&&(a.buffers.delete(i),0===a.buffers.size&&delete e[r.id]);break;case"adaptationChange":if(null!==t.value.adaptation)return e;case"representationChange":var o=t.value,s=o.period,u=o.type,c=e[s.id];if(void 0===c||c.buffers.has(u)){var l=new Set;l.add(u),e[s.id]={period:s,buffers:l}}else c.buffers.add(u)}return e}),{}),Object(g.a)((function(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;r++){var i=e[t[r]];void 0!==i&&i.buffers.size===u&&n.push(i.period)}return n.reduce((function(e,t){return null===e||t.start<e.start?t:e}),null)})),Object(y.a)((function(e,t){return null===e&&null===t||null!==e&&null!==t&&e.id===t.id})))).pipe(Object(E.a)((function(e){return null!==e})),Object(g.a)((function(e){return P.a.info("Stream: New active period",e),an.activePeriodChanged(e)}))),A=zn.apply(void 0,j).pipe(Object(g.a)((function(e){return e?an.endOfStream():an.resumeStream()})));return f.a.apply(void 0,j.concat([k,A,S]));function x(e,o,u){P.a.info("SO: Creating new Stream for",e,o);var l=new s.a,d=new s.a,p=t.pipe(Object(E.a)((function(e){var t=e.position,n=e.wantedTimeOffset;return null!=o.end&&t+n>=o.end}))),h=l.pipe(ae((function(t){return x(e,t,d)}))),g=u.pipe(Object(_.a)(1),Object(ue.a)((function(){l.complete(),d.next(),d.complete()})),Object(w.a)()),y=Object(f.a)(p,g),S=Fn({abrManager:n,bufferType:e,clock$:t,content:{manifest:c,period:o},garbageCollectors:T,segmentFetcherCreator:i,segmentBuffersStore:r,options:a,wantedBufferAhead$:O}).pipe(Object(te.a)((function(t){if("stream-status"===t.type)if(t.value.hasFinishedLoading){var n=c.getPeriodAfter(o);if(null===n)return Object(v.a)(Object(m.a)(t),Object(m.a)(an.streamComplete(e)));l.next(n)}else d.next();return Object(m.a)(t)})),Object(w.a)()),j=Object(v.a)(S.pipe(Object(b.a)(y)),Object(m.a)(an.periodStreamCleared(e,o)).pipe(Object(ue.a)((function(){P.a.info("SO: Destroying Stream for",e,o)}))));return Object(f.a)(j,h,g.pipe(Object(ce.a)()))}};var Wn=n(189),Gn=n(118);var Yn=function(){function e(e){if(this.total=e,this.total<0)throw new Gn.a}return e.prototype.call=function(e,t){return t.subscribe(new qn(e,this.total))},e}(),qn=function(e){function t(t,n){var r=e.call(this,t)||this;return r.total=n,r.ring=new Array,r.count=0,r}return c.a(t,e),t.prototype._next=function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e},t.prototype._complete=function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,i=0;i<n;i++){var a=t++%n;e.next(r[a])}e.complete()},t}(k.a),Xn=R.a.onRemoveSourceBuffers$,Qn=R.a.onSourceOpen$,Zn=R.a.onUpdate$;function Jn(e){return Object(ke.a)((function(){if(P.a.debug("Init: Trying to call endOfStream"),"open"!==e.readyState)return P.a.debug("Init: MediaSource not open, cancel endOfStream"),Object(m.a)(null);var t=e.sourceBuffers,n=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.updating&&t.push(r)}return t}(t);if(0===n.length)return P.a.info("Init: Triggering end of stream"),e.endOfStream(),Object(m.a)(null);P.a.debug("Init: Waiting SourceBuffers to be updated before calling endOfStream.");var r,i=n.map((function(e){return Zn(e).pipe(Object(_.a)(1))}));return Object(Wn.a)(f.a.apply(void 0,i).pipe((r=1,function(e){return 0===r?Object(p.b)():e.lift(new Yn(r))})),Xn(t).pipe(Object(_.a)(1))).pipe(Object(te.a)((function(){return Jn(e)})))}))}var er=n(129),tr=n(175),nr=L.a.BUFFER_DISCONTINUITY_THRESHOLD,rr=1/60;function ir(e,t,n,r){var i=r.pipe(Ie(e),Object(Vn.a)((function(e,t){return function(e,t,n){for(;e.length>0&&void 0!==e[0].period.end&&e[0].period.end+10<n.position;)e.shift();var r=t.period,i=t.bufferType;if("audio"!==i&&"video"!==i)return e;for(var a=0;a<e.length;a++)if(e[a].period.id===r.id){if(e[a].bufferType===i)return ar(t)?e[a]=t:e.splice(a,1),e}else if(e[a].period.start>r.start)return ar(t)&&e.splice(a,0,t),e;ar(t)&&e.push(t);return e}(e,t[0],t[1])}),[]));return e.pipe(Ie(i),Object(g.a)((function(e){var r=e[0],i=e[1],a=r.buffered,o=r.currentRange,s=r.position,u=r.state,c=r.stalled;if(null===c)return{type:"unstalled",value:null};var l=c.position;if(null!==l){var d=function(e,t,n){if(0===e.length)return null;for(var r=null,i=0;i<e.length;i++){var a=e[i].period;if(a.start>n)return r;var o=void 0;if(void 0===a.end||a.end>n){var s=e[i],u=s.discontinuity,c=s.position,l=u.start,d=u.end;if(n>=(null!=l?l:c)-rr)if(null===d){var f=t.getPeriodAfter(a);null!==f?o=f.start+rr:P.a.warn("Init: discontinuity at Period's end but no next Period")}else n<d+rr&&(o=d+rr);void 0!==o&&(P.a.info("Init: discontinuity found",n,o),r=null!==r&&r>o?r:o)}}return r}(i,n,l);if(null!==d){var f=d+.001;if(!(f<=t.currentTime))return P.a.warn("SA: skippable discontinuity found in the stream",s,f),t.currentTime=f,an.warning(or(l,f));P.a.info("Init: position to seek already reached, no seeking",t.currentTime,f)}}if(Object(tr.a)(s,o,u,null!==c))return P.a.warn("Init: After freeze seek",s,o),t.currentTime=s,an.warning(or(s,s));var p=null!=l?l:s,h=Object(X.e)(a,p);if(h<nr){var v=p+h+rr;if(t.currentTime<v)return P.a.warn("Init: discontinuity encountered inferior to the threshold",p,v,nr),t.currentTime=v,an.warning(or(p,v))}for(var m=n.periods.length-2;m>=0;m--){var b=n.periods[m];if(void 0!==b.end&&b.end<=p){if(n.periods[m+1].start>p&&n.periods[m+1].start>t.currentTime){var g=n.periods[m+1];return t.currentTime=g.start,an.warning(or(p,g.start))}break}}return{type:"stalled",value:c}})))}function ar(e){return null!==e.discontinuity}function or(e,t){return new B.a("DISCONTINUITY_ENCOUNTERED","A discontinuity has been encountered at position "+String(e)+", seeked at position "+String(t))}var sr=function(){function e(){}return e.prototype.call=function(e,t){return t.subscribe(new ur(e))},e}(),ur=function(e){function t(t){var n=e.call(this,t)||this;return n.hasPrev=!1,n}return c.a(t,e),t.prototype._next=function(e){var t;this.hasPrev?t=[this.prev,e]:this.hasPrev=!0,this.prev=e,t&&this.destination.next(t)},t}(k.a);var cr=function(e,t){return e.id===t.id&&e.start===t.start&&e.end===t.end};var lr=function(e,t){for(var n=[],r=t.periods,i=0;i<r.length;i++){r[i].streamEvents.forEach((function(t){for(var r=t.start,i=t.end,a=t.id,o=t.data,s=0;s<e.length;s++){var u=e[s];if(cr(u,{id:a,start:r,end:i}))return void n.push(u)}if(void 0===i){var c={start:r,id:a,data:o,publicEvent:{start:r,data:o}};n.push(c)}else{var l={start:r,end:i,id:a,data:o,publicEvent:{start:r,end:i,data:o}};n.push(l)}}))}return n},dr=L.a.STREAM_EVENT_EMITTER_POLL_INTERVAL;function fr(e){return void 0!==e.end}var pr=function(e,t,n){var r=new WeakMap,i=[];return Object(H.b)(e,"manifestUpdate").pipe(Object(S.a)(null),Object(Vn.a)((function(t){return lr(t,e)}),[])).pipe(Object(ue.a)((function(e){return i=e})),Object(g.a)((function(e){return e.length>0})),Object(y.a)(),Object(he.a)((function(e){return e?Object(h.a)([Object(Kt.a)(dr).pipe(Object(S.a)(null)),n]).pipe(Object(g.a)((function(e){e[0];return{isSeeking:e[1].seeking,currentTime:t.currentTime}})),(function(e){return e.lift(new sr)}),Object(te.a)((function(e){var t=e[0],n=e[1];return function(e,t,n){for(var i=t.currentTime,a=n.isSeeking,o=n.currentTime,s=[],u=[],c=0;c<e.length;c++){var l=e[c],d=l.start,f=fr(l)?l.end:void 0;r.has(l)?(d>o||void 0!==f&&o>=f)&&(fr(l)&&u.push(l.publicEvent),r.delete(l)):d<=o&&void 0!==f&&o<f?(s.push({type:"stream-event",value:l.publicEvent}),r.set(l,!0)):i<d&&o>=(null!=f?f:d)&&(a?s.push({type:"stream-event-skip",value:l.publicEvent}):(s.push({type:"stream-event",value:l.publicEvent}),fr(l)&&u.push(l.publicEvent)))}return Object(v.a)(s.length>0?m.a.apply(void 0,s):p.a,u.length>0?m.a.apply(void 0,u).pipe(Object(ue.a)((function(e){"function"==typeof e.onExit&&e.onExit()})),Object(ce.a)()):p.a)}(i,t,n)}))):p.a})))},hr=n(134);function vr(e){var t=e.mediaElement,n=e.manifest,r=e.clock$,i=e.speed$,a=e.bufferOptions,o=e.abrManager,u=e.segmentFetcherCreator;return function(e,c,l){var d,v=n.isLive?1/0:n.getMaximumPosition();!function(e,t){var n=t===1/0?Number.MAX_VALUE:t;e.duration!==n&&(P.a.info("Init: Setting duration",n),e.duration=n)}(e,v);var y=null!==(d=n.getPeriodForTime(c))&&void 0!==d?d:n.getNextPeriod(c);if(void 0===y){var _=new B.a("MEDIA_STARTING_TIME_NOT_FOUND","Wanted starting time not found in the Manifest.");return Object(zt.a)(_)}var O=new Jt(t,e),T=Object(er.a)({clock$:r,mediaElement:t,startTime:c,mustAutoPlay:l,isDirectfile:!1}),w=T.seek$,j=T.load$,k=j.pipe(Object(E.a)((function(e){return"not-loaded-metadata"!==e}))),A=k.pipe(Object(te.a)((function(){return pr(n,t,r)}))),x=function(e,t){var n=t.autoPlay,r=t.initialPlay$,i=t.initialSeek$,a=t.manifest,o=t.speed$,s=t.startTime,u=!1,c=!1,l=r.pipe(Object(ue.a)((function(){u=!0})),Object(ce.a)()),d=i.pipe(Object(ue.a)((function(){c=!0})),Object(ce.a)()),p=Object(h.a)([e,o]).pipe(Object(g.a)((function(e){var t=e[0],r=e[1],i=a.isLive;return{position:t.position,getCurrentTime:t.getCurrentTime,duration:t.duration,isPaused:u?t.paused:!n,liveGap:i?a.getMaximumPosition()-t.position:1/0,readyState:t.readyState,speed:r,stalled:t.stalled,wantedTimeOffset:c?0:s-t.position}})));return Object(f.a)(l,d,p)}(r,{autoPlay:l,initialPlay$:k,initialSeek$:w,manifest:n,speed$:i,startTime:c}),I=new s.a,M=new s.a,R=Hn({manifest:n,initialPeriod:y},x,o,O,u,a).pipe(Object(te.a)((function(t){switch(t.type){case"end-of-stream":return P.a.debug("Init: end-of-stream order received."),function(e){return Qn(e).pipe(Object(S.a)(null),Object(he.a)((function(){return Jn(e)})))}(e).pipe(Object(ce.a)(),Object(b.a)(I));case"resume-stream":return P.a.debug("Init: resume-stream order received."),I.next(null),p.a;case"stream-status":var n=t.value,r=n.period,i=n.bufferType,a=n.imminentDiscontinuity,o=n.position;return M.next({period:r,bufferType:i,discontinuity:a,position:o}),p.a;default:return Object(m.a)(t)}}))),C=Object(hr.a)(t,i,r,{pauseWhenStalled:!0}).pipe(Object(ce.a)()),N=ir(r,t,n,M),D=j.pipe(Object(te.a)((function(e){if("autoplay-blocked"===e){var t=new B.a("MEDIA_ERR_BLOCKED_AUTOPLAY","Cannot trigger auto-play automatically: your browser does not allow it.");return Object(m.a)(Ft.a.warning(t),Ft.a.loaded(O))}if("not-loaded-metadata"===e){var n=new B.a("MEDIA_ERR_NOT_LOADED_METADATA","Cannot load automatically: your browser falsely announced having loaded the content.");return Object(m.a)(Ft.a.warning(n))}return P.a.debug("Init: The current content is loaded."),Object(m.a)(Ft.a.loaded(O))})));return Object(f.a)(D,C,N,R,A).pipe(de((function(){O.disposeAll()})))}}var mr=L.a.FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY,br=L.a.MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE,gr=L.a.MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE;function yr(e){var t=e.fetchManifest,n=e.initialManifest,r=e.manifestUpdateUrl,i=e.minimumManifestUpdateInterval,a=e.scheduleRefresh$,o=n.manifest,s=0;function u(e){var t,n=e.sendingTime,r=e.parsingTime,l=e.updatingTime,d=void 0!==r?r+(null!=l?l:0):void 0,h=s>0?s<br:void 0!==d&&d>=gr,v=a.pipe(Object(te.a)((function(e){var t=e.completeRefresh,r=e.delay,a=e.canUseUnsafeMode&&h;return _r(null!=r?r:0,i,n).pipe(Object(j.a)({completeRefresh:t,unsafeMode:a}))}))),b=void 0===n?0:performance.now()-n,g=Math.max(i-b,0);if(void 0===o.lifetime||o.lifetime<0)t=p.a;else{var y=1e3*o.lifetime-b;if(void 0!==d)if(o.lifetime<3&&d>=100){var O=1e3*(3-o.lifetime)+y,T=Math.max(O,Math.max(y,0)+d);P.a.info("MUS: Manifest update rythm is too frequent. Postponing next request.",y,T),y=T}else if(d>=1e3*o.lifetime/10){var E=Math.max(y,0)+d;P.a.info("MUS: Manifest took too long to parse. Postponing next request",y,E),y=E}t=Object(st.a)(Math.max(y,g)).pipe(Object(j.a)({completeRefresh:!1,unsafeMode:h}))}var w=null===o.expired?p.a:Object(st.a)(g).pipe(Object(M.a)(Object(re.a)(o.expired)),Object(j.a)({completeRefresh:!0,unsafeMode:h}));return Object(f.a)(t,v,w).pipe(Object(_.a)(1),Object(te.a)((function(e){return c({completeRefresh:e.completeRefresh,unsafeMode:e.unsafeMode})})),Object(te.a)((function(e){return"warning"===e.type?Object(m.a)(e):u(e)})))}return Object(ke.a)((function(){return u(n)}));function c(e){var n=e.completeRefresh,a=e.unsafeMode,u=n||void 0===r,l=u?o.getUrl():r,d=o.clockOffset;return a?(s+=1,P.a.info('Init: Refreshing the Manifest in "unsafeMode" for the '+String(s)+" consecutive time.")):s>0&&(P.a.info('Init: Not parsing the Manifest in "unsafeMode" anymore after '+String(s)+" consecutive times."),s=0),t(l,{externalClockOffset:d,previousManifest:o,unsafeMode:a}).pipe(Object(te.a)((function(e){if("warning"===e.type)return Object(m.a)(e);var t=e.manifest,n=e.sendingTime,r=e.receivedTime,a=e.parsingTime,s=performance.now();if(u)o.replace(t);else try{o.update(t)}catch(e){var l=e instanceof Error?e.message:"unknown error";return P.a.warn("MUS: Attempt to update Manifest failed: "+l,"Re-downloading the Manifest fully"),_r(mr,i,n).pipe(Object(te.a)((function(){return c({completeRefresh:!0,unsafeMode:!1})})))}return Object(m.a)({type:"parsed",manifest:o,sendingTime:n,receivedTime:r,parsingTime:a,updatingTime:performance.now()-s})})))}}function _r(e,t,n){return Object(ke.a)((function(){var r=void 0===n?0:performance.now()-n,i=Math.max(t-r,0);return Object(st.a)(Math.max(e-r,i))}))}var Or=n(133),Tr=L.a.OUT_OF_SYNC_MANIFEST_REFRESH_DELAY;var Er=function(e){var t,n,r,i=e.adaptiveOptions,a=e.autoPlay,o=e.bufferOptions,u=e.clock$,c=e.content,l=e.keySystems,d=e.lowLatencyMode,v=e.mediaElement,y=e.minimumManifestUpdateInterval,O=e.networkConfig,T=e.speed$,E=e.startAt,k=e.textTrackOptions,A=e.transportPipelines,x=c.url,I=c.initialManifest,M=c.manifestUpdateUrl,R=O.offlineRetry,C=O.segmentRetry,N=O.manifestRetry,D=new bt(x,A,{lowLatencyMode:d,maxRetryRegular:N,maxRetryOffline:R}),L=(t=function(e,t){return D.fetch(e).pipe(Object(te.a)((function(e){return"warning"===e.type?Object(m.a)(e):e.parse(t)})),Object(w.a)())},n=!1,function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];return new ye.a((function(e){if(!n){n=!0;var i=t.apply(void 0,r).subscribe((function(t){e.next(t)}),(function(t){n=!1,e.error(t)}),(function(){n=!1,e.complete()}));return function(){i.unsubscribe(),n=!1}}e.complete()}))}),B=new Rt(A,{lowLatencyMode:d,maxRetryOffline:R,maxRetryRegular:C}),U=new et(i),F=Ut(v).pipe(Object(ne.a)({refCount:!0})),V=new s.a,z=Object(Ct.a)(v,l,V).pipe(Object(be.a)(),Object(w.a)()),K=Object(Or.a)(v);r=I instanceof me.a?Object(m.a)({type:"parsed",manifest:I}):void 0!==I?D.parse(I,{previousManifest:null,unsafeMode:!1}):L(x,{previousManifest:null,unsafeMode:!1});var $=z.pipe(Object(te.a)((function(e){switch(e.type){case"eme-disabled":case"attached-media-keys":return Object(m.a)(void 0);case"created-media-keys":return F.pipe(Object(te.a)((function(){return e.value.attachMediaKeys$.next(),!0===e.value.options.disableMediaKeysAttachmentLock?Object(m.a)(void 0):p.a})));default:return p.a}})),Object(_.a)(1),ae((function(){return F}))),W=Object(h.a)([r,$]).pipe(Object(te.a)((function(e){var t=e[0],n=e[1];if("warning"===t.type)return Object(m.a)(t);var r=t.manifest;P.a.debug("Init: Calculating initial time");var i=function(e,t,n){if(P.a.debug("Init: calculating initial time"),null!=n){var r=e.getMinimumPosition(),i=e.getMaximumPosition();if(null!=n.position)return P.a.debug("Init: using startAt.minimumPosition"),Math.max(Math.min(n.position,i),r);if(null!=n.wallClockTime){P.a.debug("Init: using startAt.wallClockTime");var a=null==e.availabilityStartTime?0:e.availabilityStartTime,o=n.wallClockTime-a;return Math.max(Math.min(o,i),r)}if(null!=n.fromFirstPosition){P.a.debug("Init: using startAt.fromFirstPosition");var s=n.fromFirstPosition;return s<=0?r:Math.min(i,r+s)}if(null!=n.fromLastPosition){P.a.debug("Init: using startAt.fromLastPosition");var u=n.fromLastPosition;return u>=0?i:Math.max(r,i+u)}if(null!=n.percentage){P.a.debug("Init: using startAt.percentage");var c=n.percentage;return c>100?i:c<0?r:r+ +c/100*(i-r)}}var l=e.getMinimumPosition();if(e.isLive){var d,f=e.suggestedPresentationDelay,p=e.clockOffset,h=e.getMaximumPosition();if(null==p)P.a.info("Init: no clock offset found for a live content, starting close to maximum available position"),d=h;else{P.a.info("Init: clock offset found for a live content, checking if we can start close to it");var v=null==e.availabilityStartTime?0:e.availabilityStartTime,m=(performance.now()+p)/1e3-v;d=Math.min(h,m)}var b=void 0!==f?f:t?Vt.LOW_LATENCY:Vt.DEFAULT;return P.a.debug("Init: "+d+" defined as the live time, applying a live gap of "+b),Math.max(d-b,l)}return P.a.info("Init: starting at the minimum available position:",l),l}(r,d,E);P.a.debug("Init: Initial time calculated:",i);var c=vr({abrManager:U,bufferOptions:Object(Y.a)({textTrackOptions:k},o),clock$:u,manifest:r,mediaElement:v,segmentFetcherCreator:B,speed$:T}),l=function e(t,n,r){var i=new s.a,a=c(t,n,r).pipe(Object(ge.a)((function(e){switch(e.type){case"needs-manifest-refresh":return p.next({completeRefresh:!1,canUseUnsafeMode:!0}),null;case"manifest-might-be-out-of-sync":return p.next({completeRefresh:!0,canUseUnsafeMode:!1,delay:Tr}),null;case"needs-media-source-reload":return i.next(e.value),null;case"needs-decipherability-flush":var t=Object(J.a)(v);if(Object(ve.a)(t))return i.next(e.value),null;var n=e.value.position;return n+.001<e.value.duration?v.currentTime+=.001:v.currentTime=n,null;case"protected-segment":return V.next(e.value),null}return e}),null)).pipe(Object(b.a)(i)),o=i.pipe(Object(he.a)((function(t){return Ut(v).pipe(Object(te.a)((function(n){return e(n,t.position,t.autoPlay)})),Object(S.a)(Ft.a.reloadingMediaSource()))})));return Object(f.a)(o,a)}(n,i,a),p=new s.a,h=yr({fetchManifest:L,initialManifest:t,manifestUpdateUrl:M,minimumManifestUpdateInterval:y,scheduleRefresh$:p}),_=Object(f.a)(Object(H.b)(r,"manifestUpdate").pipe(Object(j.a)(Ft.a.manifestUpdate())),Object(H.b)(r,"decipherabilityUpdate").pipe(Object(g.a)(Ft.a.decipherabilityUpdate))),O=z.pipe(Object(ue.a)((function(e){"blacklist-keys"===e.type?(P.a.info("Init: blacklisting Representations based on keyIDs"),r.addUndecipherableKIDs(e.value)):"blacklist-protection-data"===e.type&&(P.a.info("Init: blacklisting Representations based on protection data."),void 0!==e.value.type&&r.addUndecipherableProtectionData(e.value.type,e.value.data))})),Object(ce.a)());return Object(f.a)(_,h,O,l).pipe(Object(S.a)(Ft.a.manifestReady(r)),de((function(){p.complete()})))})));return Object(f.a)(W,K,z)},wr=n(132),Sr=L.a.SAMPLING_INTERVAL_MEDIASOURCE,jr=L.a.SAMPLING_INTERVAL_LOW_LATENCY,kr=L.a.SAMPLING_INTERVAL_NO_MEDIASOURCE,Ar=L.a.RESUME_GAP_AFTER_SEEKING,xr=L.a.RESUME_GAP_AFTER_NOT_ENOUGH_DATA,Ir=L.a.RESUME_GAP_AFTER_BUFFERING,Mr=L.a.STALL_GAP,Rr=["canplay","play","progress","seeking","seeked","loadedmetadata","ratechange"];function Cr(e,t){if(null===e)return 0;var n=t?"LOW_LATENCY":"DEFAULT";switch(e.reason){case"seeking":return Ar[n];case"not-ready":return xr[n];case"buffering":return Ir[n]}}function Nr(e,t){var n=e.buffered,r=e.currentTime,i=e.duration,a=e.ended,o=e.paused,s=e.playbackRate,u=e.readyState,c=e.seeking,l=Object(X.g)(n,r);return{bufferGap:null!==l?l.end-r:1/0,buffered:n,currentRange:l,position:r,duration:i,ended:a,paused:o,playbackRate:s,readyState:u,seeking:c,state:t}}function Pr(e,t,n){var r,i,a,o=n.withMediaSource,s=n.lowLatencyMode,u=t.state,c=t.position,l=t.bufferGap,d=t.currentRange,f=t.duration,p=t.paused,h=t.readyState,v=t.ended,m=e.stalled,b=e.state,g=e.position,y=function(e,t,n){var r=n?"LOW_LATENCY":"DEFAULT";return null!==e&&t-e.end<=Mr[r]}(d,f,s),_=h>=1&&"loadedmetadata"!==u&&null===m&&!(y||v),O=null,T=s?Mr.LOW_LATENCY:Mr.DEFAULT;if(o){if(_)l<=T?(r=!0,O=c+l):l===1/0?(r=!0,O=c):1===h&&(r=!0);else if(null!==m){var E=Cr(m,s);!0!==r&&null!==m&&h>1&&(y||v||l<1/0&&l>E)?i=!0:(l===1/0||l<=E)&&(O=l===1/0?c:c+l)}}else _&&(!p&&"timeupdate"===u&&"timeupdate"===b&&c===g||"seeking"===u&&l===1/0)?r=!0:null!==m&&("seeking"!==u&&c!==g||"canplay"===u||l<1/0&&(l>Cr(m,s)||y||v))&&(i=!0);return!0===i?null:!0===r||null!==m?(a="seeking"===u||t.seeking||null!==m&&"seeking"===m.reason?"seeking":1===h?"not-ready":"buffering",null!==m&&m.reason===a?{reason:m.reason,timestamp:m.timestamp,position:O}:{reason:a,timestamp:performance.now(),position:O}):null}var Dr=function(e,t){return Object(ke.a)((function(){var n=Object(Y.a)(Nr(e,"init"),{stalled:null,getCurrentTime:function(){return e.currentTime}});var r=Rr.map((function(t){return Object($t.a)(e,t).pipe(Object(j.a)(t))})),i=t.lowLatencyMode?jr:t.withMediaSource?Sr:kr,a=Object(Kt.a)(i).pipe(Object(j.a)("timeupdate"));return f.a.apply(void 0,[a].concat(r)).pipe(Object(g.a)((function(r){return n=function(r){var i=Nr(e,r),a=Pr(n,i,t),o=Object(Y.a)({},{stalled:a,getCurrentTime:function(){return e.currentTime}},i);return P.a.debug("API: current media element state",o),o}(r),"DEBUG"===P.a.getLevel()&&P.a.debug("API: current playback timeline:\n"+function(e,t){for(var n="",r="",i=0;i<e.length;i++){var a=e.start(i),o=e.end(i),s=a.toFixed(2),u=o.toFixed(2),c=s+"|=="+(o-a).toFixed(2)+"==|"+u;if(n+=c,0===r.length&&o>t){var l=n.length-Math.floor(c.length/2);r=" ".repeat(l)+"^"+t}if(i<e.length-1){var d=e.start(i+1),f=" ~"+(d-o).toFixed(2)+"~ ";if(n+=f,0===r.length&&t<d){var p=n.length-Math.floor(f.length/2);r=" ".repeat(p)+"^"+t}}}0===r.length&&(r=" ".repeat(n.length)+"^"+t);return n+"\n"+r}(n.buffered,n.position),"\n"+r),n})),Object(S.a)(n))})).pipe(Object(O.a)((function(){return new u.a(1)})),Object(wr.a)())};var Lr=L.a.FORCED_ENDED_THRESHOLD,Br="STOPPED",Ur="LOADED",Fr="LOADING",Vr="PLAYING",zr="PAUSED",Kr="ENDED",$r="BUFFERING",Hr="SEEKING",Wr="RELOADING";var Gr=n(107);function Yr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function qr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xr=L.a.DEFAULT_AUDIO_TRACK_SWITCHING_MODE,Qr=L.a.DEFAULT_AUTO_PLAY,Zr=L.a.DEFAULT_CODEC_SWITCHING_BEHAVIOR,Jr=L.a.DEFAULT_ENABLE_FAST_SWITCHING,ei=L.a.DEFAULT_INITIAL_BITRATES,ti=L.a.DEFAULT_LIMIT_VIDEO_WIDTH,ni=L.a.DEFAULT_MANUAL_BITRATE_SWITCHING_MODE,ri=L.a.DEFAULT_MIN_BITRATES,ii=L.a.DEFAULT_MAX_BITRATES,ai=L.a.DEFAULT_MAX_BUFFER_AHEAD,oi=L.a.DEFAULT_MAX_BUFFER_BEHIND,si=L.a.DEFAULT_SHOW_NATIVE_SUBTITLE,ui=L.a.DEFAULT_STOP_AT_END,ci=L.a.DEFAULT_TEXT_TRACK_MODE,li=L.a.DEFAULT_THROTTLE_WHEN_HIDDEN,di=L.a.DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN,fi=L.a.DEFAULT_WANTED_BUFFER_AHEAD;var pi=n(58);function hi(e){return e.map((function(e){return null==e?e:{normalized:void 0===e.language?void 0:Object(pi.a)(e.language),audioDescription:e.audioDescription,codec:e.codec}}))}function vi(e){return e.map((function(e){return null==e?e:{normalized:Object(pi.a)(e.language),closedCaption:e.closedCaption}}))}var mi=function(){function e(){this._periods=new en((function(e,t){return e.period.start-t.period.start})),this._audioChoiceMemory=new WeakMap,this._textChoiceMemory=new WeakMap,this._videoChoiceMemory=new WeakMap,this._preferredAudioTracks=[],this._preferredTextTracks=[],this._preferredVideoTracks=[]}var t=e.prototype;return t.setPreferredAudioTracks=function(e,t){this._preferredAudioTracks=e,t&&this._applyAudioPreferences()},t.setPreferredTextTracks=function(e,t){this._preferredTextTracks=e,t&&this._applyTextPreferences()},t.setPreferredVideoTracks=function(e,t){this._preferredVideoTracks=e,t&&this._applyVideoPreferences()},t.addPeriod=function(e,t,n){var r=Ei(this._periods,t),i=t.getPlayableAdaptations(e);if(null!=r){if(null!=r[e])return void P.a.warn("TrackChoiceManager: "+e+" already added for period",t);r[e]={adaptations:i,adaptation$:n}}else{var a;this._periods.add(((a={period:t})[e]={adaptations:i,adaptation$:n},a))}},t.removePeriod=function(e,t){var n=function(e,t){for(var n=0;n<e.length();n++){if(e.get(n).period.id===t.id)return n}}(this._periods,t);if(null!=n){var r=this._periods.get(n);null!=r[e]?(delete r[e],null==r.audio&&null==r.text&&null==r.video&&this._periods.removeElement(r)):P.a.warn("TrackChoiceManager: "+e+" already removed for period",t)}else P.a.warn("TrackChoiceManager: "+e+" not found for period",t)},t.resetPeriods=function(){for(;this._periods.length()>0;)this._periods.pop()},t.update=function(){this._resetChosenAudioTracks(),this._resetChosenTextTracks(),this._resetChosenVideoTracks()},t.setInitialAudioTrack=function(e){var t=Ei(this._periods,e),n=null!=t?t.audio:null;if(null==n||null==t)throw new Error("TrackChoiceManager: Given Period not found.");var r=e.getPlayableAdaptations("audio"),i=this._audioChoiceMemory.get(e);if(null===i)n.adaptation$.next(null);else if(void 0!==i&&Object(Et.a)(r,i))n.adaptation$.next(i);else{var a=gi(r,hi(this._preferredAudioTracks));this._audioChoiceMemory.set(e,a),n.adaptation$.next(a)}},t.setInitialTextTrack=function(e){var t=Ei(this._periods,e),n=null!=t?t.text:null;if(null==n||null==t)throw new Error("TrackChoiceManager: Given Period not found.");var r=e.getPlayableAdaptations("text"),i=this._textChoiceMemory.get(e);if(null===i)n.adaptation$.next(null);else if(void 0!==i&&Object(Et.a)(r,i))n.adaptation$.next(i);else{var a=_i(r,vi(this._preferredTextTracks));this._textChoiceMemory.set(e,a),n.adaptation$.next(a)}},t.setInitialVideoTrack=function(e){var t=Ei(this._periods,e),n=null!=t?t.video:null;if(null==n||null==t)throw new Error("TrackChoiceManager: Given Period not found.");var r=e.getPlayableAdaptations("video"),i=this._videoChoiceMemory.get(e);if(null===i)n.adaptation$.next(null);else if(void 0!==i&&Object(Et.a)(r,i))n.adaptation$.next(i);else{var a=Ti(r,this._preferredVideoTracks);this._videoChoiceMemory.set(e,a),n.adaptation$.next(a)}},t.setAudioTrackByID=function(e,t){var n=Ei(this._periods,e),r=null!=n?n.audio:null;if(null==r)throw new Error("TrackChoiceManager: Given Period not found.");var i=Object(Be.a)(r.adaptations,(function(e){return e.id===t}));if(void 0===i)throw new Error("Audio Track not found.");this._audioChoiceMemory.get(e)!==i&&(this._audioChoiceMemory.set(e,i),r.adaptation$.next(i))},t.setTextTrackByID=function(e,t){var n=Ei(this._periods,e),r=null!=n?n.text:null;if(null==r)throw new Error("TrackChoiceManager: Given Period not found.");var i=Object(Be.a)(r.adaptations,(function(e){return e.id===t}));if(void 0===i)throw new Error("Text Track not found.");this._textChoiceMemory.get(e)!==i&&(this._textChoiceMemory.set(e,i),r.adaptation$.next(i))},t.setVideoTrackByID=function(e,t){var n=Ei(this._periods,e),r=null!=n?n.video:null;if(null==r)throw new Error("LanguageManager: Given Period not found.");var i=Object(Be.a)(r.adaptations,(function(e){return e.id===t}));if(void 0===i)throw new Error("Video Track not found.");this._videoChoiceMemory.get(e)!==i&&(this._videoChoiceMemory.set(e,i),r.adaptation$.next(i))},t.disableTextTrack=function(e){var t=Ei(this._periods,e),n=null!=t?t.text:null;if(null==n)throw new Error("TrackChoiceManager: Given Period not found.");null!==this._textChoiceMemory.get(e)&&(this._textChoiceMemory.set(e,null),n.adaptation$.next(null))},t.disableVideoTrack=function(e){var t=Ei(this._periods,e),n=null==t?void 0:t.video;if(void 0===n)throw new Error("TrackManager: Given Period not found.");null!==this._videoChoiceMemory.get(e)&&(this._videoChoiceMemory.set(e,null),n.adaptation$.next(null))},t.getChosenAudioTrack=function(e){var t=Ei(this._periods,e);if(null==(null!=t?t.audio:null))return null;var n=this._audioChoiceMemory.get(e);if(null==n)return null;var r={language:Object(_e.a)(n.language,""),normalized:Object(_e.a)(n.normalizedLanguage,""),audioDescription:!0===n.isAudioDescription,id:n.id,representations:n.representations.map(Si)};return!0===n.isDub&&(r.dub=!0),r},t.getChosenTextTrack=function(e){var t=Ei(this._periods,e);if(null==(null!=t?t.text:null))return null;var n=this._textChoiceMemory.get(e);return null==n?null:{language:Object(_e.a)(n.language,""),normalized:Object(_e.a)(n.normalizedLanguage,""),closedCaption:!0===n.isClosedCaption,id:n.id}},t.getChosenVideoTrack=function(e){var t=Ei(this._periods,e);if(null==(null!=t?t.video:null))return null;var n=this._videoChoiceMemory.get(e);if(null==n)return null;var r={id:n.id,representations:n.representations.map(wi)};return!0===n.isSignInterpreted&&(r.signInterpreted=!0),r},t.getAvailableAudioTracks=function(e){var t=Ei(this._periods,e),n=null!=t?t.audio:null;if(null==n)return[];var r=this._audioChoiceMemory.get(e),i=null!=r?r.id:null;return n.adaptations.map((function(e){var t={language:Object(_e.a)(e.language,""),normalized:Object(_e.a)(e.normalizedLanguage,""),audioDescription:!0===e.isAudioDescription,id:e.id,active:null!=i&&i===e.id,representations:e.representations.map(Si)};return!0===e.isDub&&(t.dub=!0),t}))},t.getAvailableTextTracks=function(e){var t=Ei(this._periods,e),n=null!=t?t.text:null;if(null==n)return[];var r=this._textChoiceMemory.get(e),i=null!=r?r.id:null;return n.adaptations.map((function(e){return{language:Object(_e.a)(e.language,""),normalized:Object(_e.a)(e.normalizedLanguage,""),closedCaption:!0===e.isClosedCaption,id:e.id,active:null!=i&&i===e.id}}))},t.getAvailableVideoTracks=function(e){var t=Ei(this._periods,e),n=null!=t?t.video:null;if(null==n)return[];var r=this._videoChoiceMemory.get(e),i=null!=r?r.id:null;return n.adaptations.map((function(e){var t={id:e.id,active:null!==i&&i===e.id,representations:e.representations.map(wi)};return!0===e.isSignInterpreted&&(t.signInterpreted=!0),t}))},t._applyAudioPreferences=function(){this._audioChoiceMemory=new WeakMap,this._resetChosenAudioTracks()},t._applyTextPreferences=function(){this._textChoiceMemory=new WeakMap,this._resetChosenTextTracks()},t._applyVideoPreferences=function(){this._videoChoiceMemory=new WeakMap,this._resetChosenVideoTracks()},t._resetChosenAudioTracks=function(){var e=this,t=hi(this._preferredAudioTracks);!function n(r){if(!(r>=e._periods.length())){var i=e._periods.get(r);if(null!=i.audio){var a=i.period,o=i.audio,s=a.getPlayableAdaptations("audio"),u=e._audioChoiceMemory.get(a);if(null===u||void 0!==u&&Object(Et.a)(s,u))n(r+1);else{var c=gi(s,t);e._audioChoiceMemory.set(a,c),o.adaptation$.next(c),n(0)}}else n(r+1)}}(0)},t._resetChosenTextTracks=function(){var e=this,t=vi(this._preferredTextTracks);!function n(r){if(!(r>=e._periods.length())){var i=e._periods.get(r);if(null!=i.text){var a=i.period,o=i.text,s=a.getPlayableAdaptations("text"),u=e._textChoiceMemory.get(a);if(null===u||void 0!==u&&Object(Et.a)(s,u))n(r+1);else{var c=_i(s,t);e._textChoiceMemory.set(a,c),o.adaptation$.next(c),n(0)}}else n(r+1)}}(0)},t._resetChosenVideoTracks=function(){var e=this,t=this._preferredVideoTracks;!function n(r){if(!(r>=e._periods.length())){var i=e._periods.get(r);if(null!=i.video){var a=i.period,o=i.video,s=a.getPlayableAdaptations("video"),u=e._videoChoiceMemory.get(a);if(null===u||void 0!==u&&Object(Et.a)(s,u))n(r+1);else{var c=Ti(s,t);e._videoChoiceMemory.set(a,c),o.adaptation$.next(c),n(0)}}else n(r+1)}}(0)},e}();function bi(e){return function(t){var n;if(void 0!==e.normalized&&(null!==(n=t.normalizedLanguage)&&void 0!==n?n:"")!==e.normalized)return!1;if(void 0!==e.audioDescription)if(e.audioDescription){if(!0!==t.isAudioDescription)return!1}else if(!0===t.isAudioDescription)return!1;if(void 0===e.codec)return!0;var r=e.codec.test,i=function(e){return void 0!==e.codec&&r.test(e.codec)};return e.codec.all?t.representations.every(i):t.representations.some(i)}}function gi(e,t){if(0===e.length)return null;for(var n=0;n<t.length;n++){var r=t[n];if(null===r)return null;var i=bi(r),a=Object(Be.a)(e,i);if(void 0!==a)return a}return e[0]}function yi(e){return function(t){return Object(_e.a)(t.normalizedLanguage,"")===e.normalized&&(e.closedCaption?!0===t.isClosedCaption:!0!==t.isClosedCaption)}}function _i(e,t){if(0===e.length)return null;for(var n=0;n<t.length;n++){var r=t[n];if(null===r)return null;var i=yi(r),a=Object(Be.a)(e,i);if(void 0!==a)return a}return null}function Oi(e){return function(t){if(void 0!==e.signInterpreted&&e.signInterpreted!==t.isSignInterpreted)return!1;if(void 0===e.codec)return!0;var n=e.codec.test,r=function(e){return void 0!==e.codec&&n.test(e.codec)};return e.codec.all?t.representations.every(r):t.representations.some(r)}}function Ti(e,t){if(0===e.length)return null;for(var n=0;n<t.length;n++){var r=t[n];if(null===r)return null;var i=Oi(r),a=Object(Be.a)(e,i);if(void 0!==a)return a}return e[0]}function Ei(e,t){for(var n=0;n<e.length();n++){var r=e.get(n);if(r.period.id===t.id)return r}}function wi(e){return{id:e.id,bitrate:e.bitrate,frameRate:e.frameRate,width:e.width,height:e.height,codec:e.codec}}function Si(e){return{id:e.id,bitrate:e.bitrate,codec:e.codec}}var ji=L.a.DEFAULT_UNMUTED_VOLUME,ki=R.a.isActive,Ai=R.a.isVideoVisible,xi=R.a.onEnded$,Ii=R.a.onFullscreenChange$,Mi=R.a.onPlayPause$,Ri=R.a.onPictureInPictureEvent$,Ci=R.a.onSeeking$,Ni=R.a.onTextTrackChanges$,Pi=R.a.videoWidth$,Di=function(e){function t(t){var n;void 0===t&&(t={}),n=e.call(this)||this;var r=function(e){var t,n,r,i,a,o,s,u,c,l,d,f,p,h,v;if(Object(W.a)(e.maxBufferAhead))t=ai;else if(t=Number(e.maxBufferAhead),isNaN(t))throw new Error("Invalid maxBufferAhead parameter. Should be a number.");if(Object(W.a)(e.maxBufferBehind))n=oi;else if(n=Number(e.maxBufferBehind),isNaN(n))throw new Error("Invalid maxBufferBehind parameter. Should be a number.");if(Object(W.a)(e.wantedBufferAhead))r=fi;else if(r=Number(e.wantedBufferAhead),isNaN(r))throw new Error("Invalid wantedBufferAhead parameter. Should be a number.");var m=Object(W.a)(e.limitVideoWidth)?ti:!!e.limitVideoWidth;if(Object(W.a)(e.throttleWhenHidden)?i=li:(Object(Q.a)("`throttleWhenHidden` API is deprecated. Consider using `throttleVideoBitrateWhenHidden` instead."),i=!!e.throttleWhenHidden),a=!i&&(Object(W.a)(e.throttleVideoBitrateWhenHidden)?di:!!e.throttleVideoBitrateWhenHidden),void 0!==e.preferredTextTracks?Array.isArray(e.preferredTextTracks)?s=e.preferredTextTracks:(Object(Q.a)("Invalid `preferredTextTracks` option, it should be an Array"),s=[]):s=[],void 0!==e.preferredAudioTracks?Array.isArray(e.preferredAudioTracks)?o=e.preferredAudioTracks:(Object(Q.a)("Invalid `preferredAudioTracks` option, it should be an Array"),o=[]):o=[],void 0!==e.preferredVideoTracks?Array.isArray(e.preferredVideoTracks)?u=e.preferredVideoTracks:(Object(Q.a)("Invalid `preferredVideoTracks` option, it should be an Array"),u=[]):u=[],Object(W.a)(e.videoElement))c=document.createElement("video");else{if(!(e.videoElement instanceof HTMLMediaElement))throw new Error("Invalid videoElement parameter. Should be a HTMLMediaElement.");c=e.videoElement}if(Object(W.a)(e.initialVideoBitrate))l=ei.video;else if(l=Number(e.initialVideoBitrate),isNaN(l))throw new Error("Invalid initialVideoBitrate parameter. Should be a number.");if(Object(W.a)(e.initialAudioBitrate))d=ei.audio;else if(d=Number(e.initialAudioBitrate),isNaN(d))throw new Error("Invalid initialAudioBitrate parameter. Should be a number.");if(Object(W.a)(e.minVideoBitrate))p=ri.video;else if(p=Number(e.minVideoBitrate),isNaN(p))throw new Error("Invalid maxVideoBitrate parameter. Should be a number.");if(Object(W.a)(e.minAudioBitrate))f=ri.audio;else if(f=Number(e.minAudioBitrate),isNaN(f))throw new Error("Invalid minAudioBitrate parameter. Should be a number.");if(Object(W.a)(e.maxVideoBitrate))v=ii.video;else{if(v=Number(e.maxVideoBitrate),isNaN(v))throw new Error("Invalid maxVideoBitrate parameter. Should be a number.");if(p>v)throw new Error('Invalid maxVideoBitrate parameter. Its value, "'+v+'", is inferior to the set minVideoBitrate, "'+p+'"')}if(Object(W.a)(e.maxAudioBitrate))h=ii.audio;else{if(h=Number(e.maxAudioBitrate),isNaN(h))throw new Error("Invalid maxAudioBitrate parameter. Should be a number.");if(f>h)throw new Error('Invalid maxAudioBitrate parameter. Its value, "'+h+'", is inferior to the set minAudioBitrate, "'+f+'"')}return{maxBufferAhead:t,maxBufferBehind:n,limitVideoWidth:m,videoElement:c,wantedBufferAhead:r,throttleWhenHidden:i,throttleVideoBitrateWhenHidden:a,preferredAudioTracks:o,preferredTextTracks:s,preferredVideoTracks:u,initialAudioBitrate:d,initialVideoBitrate:l,minAudioBitrate:f,minVideoBitrate:p,maxAudioBitrate:h,maxVideoBitrate:v,stopAtEnd:Object(W.a)(e.stopAtEnd)?ui:!!e.stopAtEnd}}(t),i=r.initialAudioBitrate,a=r.initialVideoBitrate,o=r.limitVideoWidth,c=r.minAudioBitrate,l=r.minVideoBitrate,f=r.maxAudioBitrate,p=r.maxBufferAhead,h=r.maxBufferBehind,v=r.maxVideoBitrate,m=r.preferredAudioTracks,_=r.preferredTextTracks,O=r.preferredVideoTracks,T=r.throttleWhenHidden,E=r.throttleVideoBitrateWhenHidden,w=r.videoElement,S=r.wantedBufferAhead,j=r.stopAtEnd;return w.preload="auto",n.version="3.23.0",n.log=P.a,n.state="STOPPED",n.videoElement=w,n._priv_destroy$=new s.a,n._priv_pictureInPictureEvent$=new u.a(1),Ri(w).pipe(Object(b.a)(n._priv_destroy$)).subscribe(n._priv_pictureInPictureEvent$),Ii(w).pipe(Object(b.a)(n._priv_destroy$)).subscribe((function(){return n.trigger("fullscreenChange",n.isFullscreen())})),Ni(w.textTracks).pipe(Object(b.a)(n._priv_destroy$),Object(g.a)((function(e){for(var t=e.target,n=[],r=0;r<t.length;r++){var i=t[r];n.push(i)}return n})),Object(y.a)((function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}))).subscribe((function(e){return n._priv_onNativeTextTracksNext(e)})),n._priv_playing$=new u.a(1),n._priv_speed$=new d(w.playbackRate),n._priv_stopCurrentContent$=new s.a,n._priv_contentLock$=new d(!1),n._priv_bufferOptions={wantedBufferAhead$:new d(S),maxBufferAhead$:new d(p),maxBufferBehind$:new d(h)},n._priv_bitrateInfos={lastBitrates:{audio:i,video:a},minAutoBitrates:{audio:new d(c),video:new d(l)},maxAutoBitrates:{audio:new d(f),video:new d(v)},manualBitrates:{audio:new d(-1),video:new d(-1)}},n._priv_throttleWhenHidden=T,n._priv_throttleVideoBitrateWhenHidden=E,n._priv_limitVideoWidth=o,n._priv_mutedMemory=ji,n._priv_trackChoiceManager=null,n._priv_mediaElementTrackChoiceManager=null,n._priv_currentError=null,n._priv_contentInfos=null,n._priv_contentEventsMemory={},n._priv_stopAtEnd=j,n._priv_setPlayerState(Br),n._priv_preferredAudioTracks=m,n._priv_preferredTextTracks=_,n._priv_preferredVideoTracks=O,n._priv_lastContentPlaybackInfos={},n}o()(t,e);var n=t.prototype;return n.stop=function(){this.state!==Br&&(this._priv_stopCurrentContent$.next(),this._priv_cleanUpCurrentContentState(),this._priv_setPlayerState(Br))},n.dispose=function(){this.stop(),null!==this.videoElement&&Object(Z.a)(this.videoElement),this._priv_destroy$.next(),this._priv_destroy$.complete(),this._priv_stopCurrentContent$.complete(),this._priv_playing$.complete(),this._priv_speed$.complete(),this._priv_contentLock$.complete(),this._priv_bufferOptions.wantedBufferAhead$.complete(),this._priv_bufferOptions.maxBufferAhead$.complete(),this._priv_bufferOptions.maxBufferBehind$.complete(),this._priv_pictureInPictureEvent$.complete(),this._priv_bitrateInfos.manualBitrates.video.complete(),this._priv_bitrateInfos.manualBitrates.audio.complete(),this._priv_bitrateInfos.minAutoBitrates.video.complete(),this._priv_bitrateInfos.minAutoBitrates.audio.complete(),this._priv_bitrateInfos.maxAutoBitrates.video.complete(),this._priv_bitrateInfos.maxAutoBitrates.audio.complete(),this._priv_lastContentPlaybackInfos={},this.videoElement=null},n.loadVideo=function(e){var t=function(e){var t,n,r,i,a,o,s,u,c,l,d,f,p;if(Object(W.a)(e))throw new Error("No option set on loadVideo");if(Object(W.a)(e.url)){if(Object(W.a)(null===(t=e.transportOptions)||void 0===t?void 0:t.initialManifest)&&Object(W.a)(null===(n=e.transportOptions)||void 0===n?void 0:n.manifestLoader))throw new Error("Unable to load a content: no url set on loadVideo.\nPlease provide at least either an `url` argument, a `transportOptions.initialManifest` option or a `transportOptions.manifestLoader` option so the RxPlayer can load the content.")}else u=String(e.url);if(Object(W.a)(e.transport))throw new Error("No transport set on loadVideo");c=String(e.transport);var h=Object(W.a)(e.autoPlay)?Qr:!!e.autoPlay;if(Object(W.a)(e.keySystems))l=[];else for(var v,m=Yr(l=Array.isArray(e.keySystems)?e.keySystems:[e.keySystems]);!(v=m()).done;){var b=v.value;if("string"!=typeof b.type||"function"!=typeof b.getLicense)throw new Error("Invalid key system given: Missing type string or getLicense callback")}var g=void 0!==e.lowLatencyMode&&!!e.lowLatencyMode,y="object"==typeof e.transportOptions&&null!==e.transportOptions?e.transportOptions:{},_=null===(r=e.transportOptions)||void 0===r?void 0:r.initialManifest,O=null===(i=e.transportOptions)||void 0===i?void 0:i.manifestUpdateUrl,T=null!==(o=null===(a=e.transportOptions)||void 0===a?void 0:a.minimumManifestUpdateInterval)&&void 0!==o?o:0,E=Object(W.a)(e.audioTrackSwitchingMode)?Xr:e.audioTrackSwitchingMode;Object(Et.a)(["seamless","direct"],E)||(P.a.warn("The `audioTrackSwitchingMode` loadVideo option must match one of the following strategy name:\n- `seamless`\n- `direct`\nIf badly set, "+Xr+" strategy will be used as default"),E=Xr);var w=Object(W.a)(e.onCodecSwitch)?Zr:e.onCodecSwitch;Object(Et.a)(["continue","reload"],w)||(P.a.warn("The `onCodecSwitch` loadVideo option must match one of the following string:\n- `continue`\n- `reload`\nIf badly set, "+Zr+" will be used as default"),w=Zr);var S=Object(Y.a)({},y,{supplementaryImageTracks:[],supplementaryTextTracks:[],lowLatencyMode:g});if(delete S.initialManifest,delete S.manifestUpdateUrl,delete S.minimumManifestUpdateInterval,void 0!==e.supplementaryTextTracks){Object(Q.a)("The `supplementaryTextTracks` loadVideo option is deprecated.\nPlease use the `TextTrackRenderer` tool instead.");for(var j,k=Array.isArray(e.supplementaryTextTracks)?e.supplementaryTextTracks:[e.supplementaryTextTracks],A=Yr(k);!(j=A()).done;){var x=j.value;if("string"!=typeof x.language||"string"!=typeof x.mimeType||"string"!=typeof x.url)throw new Error("Invalid supplementary text track given. Missing either language, mimetype or url")}S.supplementaryTextTracks=k}if(void 0!==e.supplementaryImageTracks){Object(Q.a)("The `supplementaryImageTracks` loadVideo option is deprecated.\nPlease use the `parseBifThumbnails` tool instead.");for(var I,M=Array.isArray(e.supplementaryImageTracks)?e.supplementaryImageTracks:[e.supplementaryImageTracks],R=Yr(M);!(I=R()).done;){var C=I.value;if("string"!=typeof C.mimeType||"string"!=typeof C.url)throw new Error("Invalid supplementary image track given. Missing either mimetype or url")}S.supplementaryImageTracks=M}if(Object(W.a)(e.textTrackMode))d=ci;else{if("native"!==e.textTrackMode&&"html"!==e.textTrackMode)throw new Error("Invalid textTrackMode.");d=e.textTrackMode}Object(W.a)(e.defaultAudioTrack)||Object(Q.a)("The `defaultAudioTrack` loadVideo option is deprecated.\nPlease use the `preferredAudioTracks` constructor option or the`setPreferredAudioTracks` method instead");var N=Object(Gr.b)(e.defaultAudioTrack);Object(W.a)(e.defaultTextTrack)||Object(Q.a)("The `defaultTextTrack` loadVideo option is deprecated.\nPlease use the `preferredTextTracks` constructor option or the`setPreferredTextTracks` method instead");var D=Object(Gr.c)(e.defaultTextTrack),L=!si;Object(W.a)(e.hideNativeSubtitle)||(Object(Q.a)("The `hideNativeSubtitle` loadVideo option is deprecated"),L=!!e.hideNativeSubtitle);var B=null!==(s=e.manualBitrateSwitchingMode)&&void 0!==s?s:ni,U=Object(W.a)(e.enableFastSwitching)?Jr:e.enableFastSwitching;if("html"===d){if(Object(W.a)(e.textTrackElement))throw new Error('You have to provide a textTrackElement in "html" textTrackMode.');if(!(e.textTrackElement instanceof HTMLElement))throw new Error("textTrackElement should be an HTMLElement.");f=e.textTrackElement}else Object(W.a)(e.textTrackElement)||P.a.warn('API: You have set a textTrackElement without being in an "html" textTrackMode. It will be ignored.');if(!Object(W.a)(e.startAt))if(e.startAt.wallClockTime instanceof Date){var F=e.startAt.wallClockTime.getTime()/1e3;p=Object(Y.a)({},e.startAt,{wallClockTime:F})}else p=e.startAt;return{autoPlay:h,defaultAudioTrack:N,defaultTextTrack:D,enableFastSwitching:U,hideNativeSubtitle:L,keySystems:l,initialManifest:_,lowLatencyMode:g,manualBitrateSwitchingMode:B,audioTrackSwitchingMode:E,manifestUpdateUrl:O,minimumManifestUpdateInterval:T,networkConfig:Object(W.a)(e.networkConfig)?{}:{manifestRetry:e.networkConfig.manifestRetry,offlineRetry:e.networkConfig.offlineRetry,segmentRetry:e.networkConfig.segmentRetry},onCodecSwitch:w,startAt:p,textTrackElement:f,textTrackMode:d,transport:c,transportOptions:S,url:u}}(e);P.a.info("API: Calling loadvideo",t),this._priv_lastContentPlaybackInfos={options:t},this._priv_initializeContentPlayback(t)},n.reload=function(e){var t,n=this._priv_lastContentPlaybackInfos,r=n.options,i=n.manifest,a=n.lastPlaybackPosition;if(void 0===r||void 0===i||void 0===a)throw new Error("API: Can't reload without having previously loaded a content.");if(function(e){var t,n,r,i;if(null===e||"object"!=typeof e&&void 0!==e)throw new Error("API: reload - Invalid options format.");if(null===(null==e?void 0:e.reloadAt)||"object"!=typeof(null==e?void 0:e.reloadAt)&&void 0!==(null==e?void 0:e.reloadAt))throw new Error("API: reload - Invalid 'reloadAt' option format.");if("number"!=typeof(null===(t=null==e?void 0:e.reloadAt)||void 0===t?void 0:t.position)&&void 0!==(null===(n=null==e?void 0:e.reloadAt)||void 0===n?void 0:n.position))throw new Error("API: reload - Invalid 'reloadAt.position' option format.");if("number"!=typeof(null===(r=null==e?void 0:e.reloadAt)||void 0===r?void 0:r.relative)&&void 0!==(null===(i=null==e?void 0:e.reloadAt)||void 0===i?void 0:i.relative))throw new Error("API: reload - Invalid 'reloadAt.relative' option format.")}(e),void 0!==e&&void 0!==e.reloadAt&&void 0!==e.reloadAt.position)t=e.reloadAt.position;else{var o;if("STOPPED"===this.state||"ENDED"===this.state)o=a;else{if(null===this.videoElement)throw new Error("API: reload - Can't reload when video element does not exist.");o=this.videoElement.currentTime}t=void 0!==e&&void 0!==e.reloadAt&&void 0!==e.reloadAt.relative?e.reloadAt.relative+o:o}var s=Object.assign(Object.assign({},r),{initialManifest:i});s.startAt={position:t},this._priv_initializeContentPlayback(s)},n._priv_initializeContentPlayback=function(e){var t,n,r,i=this,a=e.autoPlay,o=e.audioTrackSwitchingMode,s=e.defaultAudioTrack,u=e.defaultTextTrack,c=e.enableFastSwitching,l=e.initialManifest,d=e.keySystems,O=e.lowLatencyMode,k=e.manualBitrateSwitchingMode,x=e.manifestUpdateUrl,R=e.minimumManifestUpdateInterval,C=e.networkConfig,N=e.onCodecSwitch,L=e.startAt,B=e.transport,U=e.transportOptions,F=e.url;if(null===this.videoElement)throw new Error("the attached video element is disposed");this.stop();var V="directfile"===B;this._priv_currentError=null,this._priv_contentInfos={url:F,isDirectFile:V,segmentBuffersStore:null,thumbnails:null,manifest:null,currentPeriod:null,activeAdaptations:null,activeRepresentations:null,initialAudioTrack:s,initialTextTrack:u},this._priv_playing$.next(!1);var z,$=this.videoElement,H=Dr($,{withMediaSource:!V,lowLatencyMode:O}),W=Object(f.a)(this._priv_stopCurrentContent$,this._priv_stopAtEnd?xi($):p.a).pipe(Object(_.a)(1));if(V){if(null===K.a.directfile)throw new Error("DirectFile feature not activated in your build.");this._priv_mediaElementTrackChoiceManager=new K.a.directfile.mediaElementTrackChoiceManager(this.videoElement);var q=void 0===s?this._priv_preferredAudioTracks:[s];this._priv_mediaElementTrackChoiceManager.setPreferredAudioTracks(q,!0);var X=void 0===u?this._priv_preferredTextTracks:[u];this._priv_mediaElementTrackChoiceManager.setPreferredTextTracks(X,!0),this._priv_mediaElementTrackChoiceManager.setPreferredVideoTracks(this._priv_preferredVideoTracks,!0),this.trigger("availableAudioTracksChange",this._priv_mediaElementTrackChoiceManager.getAvailableAudioTracks()),this.trigger("availableVideoTracksChange",this._priv_mediaElementTrackChoiceManager.getAvailableVideoTracks()),this.trigger("availableTextTracksChange",this._priv_mediaElementTrackChoiceManager.getAvailableTextTracks()),this.trigger("audioTrackChange",null!==(t=this._priv_mediaElementTrackChoiceManager.getChosenAudioTrack())&&void 0!==t?t:null),this.trigger("textTrackChange",null!==(n=this._priv_mediaElementTrackChoiceManager.getChosenTextTrack())&&void 0!==n?n:null),this.trigger("videoTrackChange",null!==(r=this._priv_mediaElementTrackChoiceManager.getChosenVideoTrack())&&void 0!==r?r:null),this._priv_mediaElementTrackChoiceManager.addEventListener("availableVideoTracksChange",(function(e){return i.trigger("availableVideoTracksChange",e)})),this._priv_mediaElementTrackChoiceManager.addEventListener("availableAudioTracksChange",(function(e){return i.trigger("availableAudioTracksChange",e)})),this._priv_mediaElementTrackChoiceManager.addEventListener("availableTextTracksChange",(function(e){return i.trigger("availableTextTracksChange",e)})),this._priv_mediaElementTrackChoiceManager.addEventListener("audioTrackChange",(function(e){return i.trigger("audioTrackChange",e)})),this._priv_mediaElementTrackChoiceManager.addEventListener("videoTrackChange",(function(e){return i.trigger("videoTrackChange",e)})),this._priv_mediaElementTrackChoiceManager.addEventListener("textTrackChange",(function(e){return i.trigger("textTrackChange",e)}));var Q=K.a.directfile.initDirectFile({autoPlay:a,clock$:H,keySystems:d,mediaElement:$,speed$:this._priv_speed$,startAt:L,url:F}).pipe(Object(b.a)(W));z=T()(Q)}else{var Z=K.a.transports[B];if("function"!=typeof Z)throw new Error('transport "'+B+'" not supported');var J=Z(U),ee=D(),ne={throttle:{},throttleBitrate:{},limitWidth:{}};this._priv_throttleWhenHidden&&(ee?ne.throttle={video:ki().pipe(Object(g.a)((function(e){return e?1/0:0})),Object(b.a)(this._priv_stopCurrentContent$))}:P.a.warn("API: Can't apply throttleWhenHidden because browser can't be trusted for visibility.")),this._priv_throttleVideoBitrateWhenHidden&&(ee?ne.throttleBitrate={video:Ai(this._priv_pictureInPictureEvent$).pipe(Object(g.a)((function(e){return e?1/0:0})),Object(b.a)(this._priv_stopCurrentContent$))}:P.a.warn("API: Can't apply throttleVideoBitrateWhenHidden because browser can't be trusted for visibility.")),this._priv_limitVideoWidth&&(ee?ne.limitWidth={video:Pi($,this._priv_pictureInPictureEvent$).pipe(Object(b.a)(this._priv_stopCurrentContent$))}:P.a.warn("API: Can't apply limitVideoWidth because browser can't be trusted for video size."));var re={initialBitrates:this._priv_bitrateInfos.lastBitrates,lowLatencyMode:O,manualBitrates:this._priv_bitrateInfos.manualBitrates,minAutoBitrates:this._priv_bitrateInfos.minAutoBitrates,maxAutoBitrates:this._priv_bitrateInfos.maxAutoBitrates,throttlers:ne},ie="native"===e.textTrackMode?{textTrackMode:"native",hideNativeSubtitle:e.hideNativeSubtitle}:{textTrackMode:"html",textTrackElement:e.textTrackElement},ae=Object(Y.a)({audioTrackSwitchingMode:o,enableFastSwitching:c,manualBitrateSwitchingMode:k,onCodecSwitch:N},this._priv_bufferOptions),oe=Er({adaptiveOptions:re,autoPlay:a,bufferOptions:ae,clock$:H,content:{initialManifest:l,manifestUpdateUrl:x,url:F},keySystems:d,lowLatencyMode:O,mediaElement:$,minimumManifestUpdateInterval:R,networkConfig:C,transportPipelines:J,speed$:this._priv_speed$,startAt:L,textTrackOptions:ie}).pipe(Object(b.a)(W));z=T()(oe)}var se,ue,ce=z.pipe(Object(E.a)((function(e){return"stalled"===e.type||"unstalled"===e.type})),Object(g.a)((function(e){return e.value})),Object(y.a)((function(e,t){return null===e&&null===t||null!==e&&null!==t&&e.reason===t.reason}))),le=z.pipe(Object(E.a)((function(e){return"loaded"===e.type})),Object(w.a)()),de=z.pipe(Object(E.a)((function(e){return"reloading-media-source"===e.type})),Object(w.a)()),fe=xi($),pe=Ci($),he=Object(h.a)([this._priv_playing$,ce.pipe(Object(S.a)(null)),fe.pipe(Object(S.a)(null)),pe.pipe(Object(S.a)(null))]).pipe(Object(b.a)(this._priv_stopCurrentContent$),Object(g.a)((function(e){var t=e[0],n=e[1];return function(e,t,n){if(e.ended)return Kr;if(null!==n){var r=Math.abs(e.duration-e.currentTime);return null!=Lr&&r<Lr?Kr:"seeking"===n.reason?Hr:$r}return t?Vr:zr}($,t,n)}))),ve=Object(v.a)(Object(m.a)(Fr),le.pipe(Object(_.a)(1),Object(j.a)(Ur)),Object(f.a)(he.pipe(Object(b.a)(de),(se=function(e){return e===zr},function(e){return e.lift(new A(se))})),de.pipe(Object(I.a)(le.pipe(Object(_.a)(1),Object(M.a)(he),Object(S.a)(Wr)))))).pipe(Object(y.a)());this._priv_stopCurrentContent$.pipe(Object(_.a)(1)).subscribe((function(){void 0!==ue&&ue.unsubscribe()})),Mi($).pipe(Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(e){return i._priv_onPlayPauseNext("play"===e.type)}),G.a),H.pipe(Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(e){return i._priv_triggerPositionUpdate(e)}),G.a),le.pipe(Object(I.a)(function(e,t){return Object(ke.a)((function(){if(null===e)return p.a;var n=Object($t.a)(e,"seeking").pipe(Object(j.a)("seeking")),r=Object($t.a)(e,"seeked").pipe(Object(I.a)(t.pipe(Object(te.a)((function(e){return null===e.stalled||"seeking"!==e.stalled.reason?Object(m.a)("seeked"):p.a})),Object(_.a)(1)))),i=Object(f.a)(n,r);return e.seeking?i.pipe(Object(S.a)("seeking")):i}))}(this.videoElement,H)),Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(e){P.a.info('API: Triggering "'+e+'" event'),i.trigger(e,null)})),ve.pipe(Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(e){return i._priv_setPlayerState(e)}),G.a),z.subscribe((function(e){return i._priv_onPlaybackEvent(e)}),(function(e){return i._priv_onPlaybackError(e)}),(function(){return i._priv_onPlaybackFinished()})),this._priv_contentLock$.pipe(Object(E.a)((function(e){return!e})),Object(_.a)(1),Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(){ue=z.connect()}))},n.getError=function(){return this._priv_currentError},n.getManifest=function(){return Object(Q.a)("getManifest is deprecated. Please open an issue if you used this API."),null===this._priv_contentInfos?null:this._priv_contentInfos.manifest},n.getCurrentAdaptations=function(){if(Object(Q.a)("getCurrentAdaptations is deprecated. Please open an issue if you used this API."),null===this._priv_contentInfos)return null;var e=this._priv_contentInfos,t=e.currentPeriod,n=e.activeAdaptations;return null===t||null===n||Object(W.a)(n[t.id])?null:n[t.id]},n.getCurrentRepresentations=function(){return Object(Q.a)("getCurrentRepresentations is deprecated. Please open an issue if you used this API."),this._priv_getCurrentRepresentations()},n.getVideoElement=function(){return this.videoElement},n.getNativeTextTrack=function(){if(Object(Q.a)("getNativeTextTrack is deprecated. Please open an issue if you used this API."),null===this.videoElement)throw new Error("Disposed player");var e=this.videoElement;return e.textTracks.length>0?e.textTracks[0]:null},n.getPlayerState=function(){return this.state},n.isLive=function(){if(null===this._priv_contentInfos)return!1;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;return!t&&null!==n&&n.isLive},n.getUrl=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest,r=e.url;return t?r:null!==n?n.getUrl():void 0}},n.getVideoDuration=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration},n.getVideoBufferGap=function(){if(null===this.videoElement)throw new Error("Disposed player");var e=this.videoElement;return Object(X.d)(e.buffered,e.currentTime)},n.getVideoLoadedTime=function(){if(null===this.videoElement)throw new Error("Disposed player");var e=this.videoElement;return Object(X.h)(e.buffered,e.currentTime)},n.getVideoPlayedTime=function(){if(null===this.videoElement)throw new Error("Disposed player");var e=this.videoElement;return Object(X.f)(e.buffered,e.currentTime)},n.getWallClockTime=function(){if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)return this.videoElement.currentTime;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;return t?this.videoElement.currentTime:null!==n?this.videoElement.currentTime+(void 0!==n.availabilityStartTime?n.availabilityStartTime:0):0},n.getPosition=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.currentTime},n.getPlaybackRate=function(){return this._priv_speed$.getValue()},n.setPlaybackRate=function(e){this._priv_speed$.next(e)},n.getAvailableVideoBitrates=function(){if(null===this._priv_contentInfos)return[];var e=this._priv_contentInfos,t=e.currentPeriod,n=e.activeAdaptations;if(null===t||null===n)return[];var r=n[t.id];return void 0===r||Object(W.a)(r.video)?[]:r.video.getAvailableBitrates()},n.getAvailableAudioBitrates=function(){if(null===this._priv_contentInfos)return[];var e=this._priv_contentInfos,t=e.currentPeriod,n=e.activeAdaptations;if(null===t||null===n)return[];var r=n[t.id];return void 0===r||Object(W.a)(r.audio)?[]:r.audio.getAvailableBitrates()},n.getManualAudioBitrate=function(){return this._priv_bitrateInfos.manualBitrates.audio.getValue()},n.getManualVideoBitrate=function(){return this._priv_bitrateInfos.manualBitrates.video.getValue()},n.getVideoBitrate=function(){var e=this._priv_getCurrentRepresentations();if(null!==e&&!Object(W.a)(e.video))return e.video.bitrate},n.getAudioBitrate=function(){var e=this._priv_getCurrentRepresentations();if(null!==e&&!Object(W.a)(e.audio))return e.audio.bitrate},n.getMinVideoBitrate=function(){return this._priv_bitrateInfos.minAutoBitrates.video.getValue()},n.getMinAudioBitrate=function(){return this._priv_bitrateInfos.minAutoBitrates.audio.getValue()},n.getMaxVideoBitrate=function(){return this._priv_bitrateInfos.maxAutoBitrates.video.getValue()},n.getMaxAudioBitrate=function(){return this._priv_bitrateInfos.maxAutoBitrates.audio.getValue()},n.play=function(){var e=this;if(null===this.videoElement)throw new Error("Disposed player");var t=this.videoElement.play();return Object(W.a)(t)||"function"!=typeof t.catch?q.a.resolve():t.catch((function(t){if("NotAllowedError"===t.name){var n=new B.a("MEDIA_ERR_PLAY_NOT_ALLOWED",t.toString());e.trigger("warning",n)}throw t}))},n.pause=function(){if(null===this.videoElement)throw new Error("Disposed player");this.videoElement.pause()},n.seekTo=function(e){if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)throw new Error("player: no content loaded");var t,n=this._priv_contentInfos,r=n.isDirectFile,i=n.manifest;if(!r&&null===i)throw new Error("player: the content did not load yet");if("number"==typeof e)t=e;else if("object"==typeof e){var a=e,o=this.videoElement.currentTime;if(Object(W.a)(a.relative))if(Object(W.a)(a.position)){if(Object(W.a)(a.wallClockTime))throw new Error('invalid time object. You must set one of the following properties: "relative", "position" or "wallClockTime"');t=r||null===i?a.wallClockTime:a.wallClockTime-(void 0!==i.availabilityStartTime?i.availabilityStartTime:0)}else t=a.position;else t=o+a.relative}if(void 0===t)throw new Error("invalid time given");return this.videoElement.currentTime=t,t},n.isFullscreen=function(){return Object(Q.a)("isFullscreen is deprecated. Fullscreen management should now be managed by the application"),Object(C.b)()},n.setFullscreen=function(e){if(void 0===e&&(e=!0),Object(Q.a)("setFullscreen is deprecated. Fullscreen management should now be managed by the application"),null===this.videoElement)throw new Error("Disposed player");e?Object(C.c)(this.videoElement):Object(C.a)()},n.exitFullscreen=function(){Object(Q.a)("exitFullscreen is deprecated. Fullscreen management should now be managed by the application"),Object(C.a)()},n.getVolume=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.volume},n.setVolume=function(e){if(null===this.videoElement)throw new Error("Disposed player");var t=this.videoElement;e!==t.volume&&(t.volume=e,this.trigger("volumeChange",e))},n.isMute=function(){return 0===this.getVolume()},n.mute=function(){this._priv_mutedMemory=this.getVolume(),this.setVolume(0)},n.unMute=function(){0===this.getVolume()&&this.setVolume(0===this._priv_mutedMemory?ji:this._priv_mutedMemory)},n.setVideoBitrate=function(e){this._priv_bitrateInfos.manualBitrates.video.next(e)},n.setAudioBitrate=function(e){this._priv_bitrateInfos.manualBitrates.audio.next(e)},n.setMinVideoBitrate=function(e){var t=this._priv_bitrateInfos.maxAutoBitrates.video.getValue();if(e>t)throw new Error('Invalid minimum video bitrate given. Its value, "'+e+'" is superior the current maximum video birate, "'+t+'".');this._priv_bitrateInfos.minAutoBitrates.video.next(e)},n.setMinAudioBitrate=function(e){var t=this._priv_bitrateInfos.maxAutoBitrates.audio.getValue();if(e>t)throw new Error('Invalid minimum audio bitrate given. Its value, "'+e+'" is superior the current maximum audio birate, "'+t+'".');this._priv_bitrateInfos.minAutoBitrates.audio.next(e)},n.setMaxVideoBitrate=function(e){var t=this._priv_bitrateInfos.minAutoBitrates.video.getValue();if(e<t)throw new Error('Invalid maximum video bitrate given. Its value, "'+e+'" is inferior the current minimum video birate, "'+t+'".');this._priv_bitrateInfos.maxAutoBitrates.video.next(e)},n.setMaxAudioBitrate=function(e){var t=this._priv_bitrateInfos.minAutoBitrates.audio.getValue();if(e<t)throw new Error('Invalid maximum audio bitrate given. Its value, "'+e+'" is inferior the current minimum audio birate, "'+t+'".');this._priv_bitrateInfos.maxAutoBitrates.audio.next(e)},n.setMaxBufferBehind=function(e){this._priv_bufferOptions.maxBufferBehind$.next(e)},n.setMaxBufferAhead=function(e){this._priv_bufferOptions.maxBufferAhead$.next(e)},n.setWantedBufferAhead=function(e){this._priv_bufferOptions.wantedBufferAhead$.next(e)},n.getMaxBufferBehind=function(){return this._priv_bufferOptions.maxBufferBehind$.getValue()},n.getMaxBufferAhead=function(){return this._priv_bufferOptions.maxBufferAhead$.getValue()},n.getWantedBufferAhead=function(){return this._priv_bufferOptions.wantedBufferAhead$.getValue()},n.getCurrentKeySystem=function(){if(null===this.videoElement)throw new Error("Disposed player");return Object(J.a)(this.videoElement)},n.getAvailableAudioTracks=function(){var e,t;if(null===this._priv_contentInfos)return[];var n=this._priv_contentInfos,r=n.currentPeriod;return n.isDirectFile?null!==(t=null===(e=this._priv_mediaElementTrackChoiceManager)||void 0===e?void 0:e.getAvailableAudioTracks())&&void 0!==t?t:[]:null===this._priv_trackChoiceManager||null===r?[]:this._priv_trackChoiceManager.getAvailableAudioTracks(r)},n.getAvailableTextTracks=function(){var e,t;if(null===this._priv_contentInfos)return[];var n=this._priv_contentInfos,r=n.currentPeriod;return n.isDirectFile?null!==(t=null===(e=this._priv_mediaElementTrackChoiceManager)||void 0===e?void 0:e.getAvailableTextTracks())&&void 0!==t?t:[]:null===this._priv_trackChoiceManager||null===r?[]:this._priv_trackChoiceManager.getAvailableTextTracks(r)},n.getAvailableVideoTracks=function(){var e,t;if(null===this._priv_contentInfos)return[];var n=this._priv_contentInfos,r=n.currentPeriod;return n.isDirectFile?null!==(t=null===(e=this._priv_mediaElementTrackChoiceManager)||void 0===e?void 0:e.getAvailableVideoTracks())&&void 0!==t?t:[]:null===this._priv_trackChoiceManager||null===r?[]:this._priv_trackChoiceManager.getAvailableVideoTracks(r)},n.getAudioTrack=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.currentPeriod;if(e.isDirectFile){if(null===this._priv_mediaElementTrackChoiceManager)return;return this._priv_mediaElementTrackChoiceManager.getChosenAudioTrack()}if(null!==this._priv_trackChoiceManager&&null!==t)return this._priv_trackChoiceManager.getChosenAudioTrack(t)}},n.getTextTrack=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.currentPeriod;if(e.isDirectFile){if(null===this._priv_mediaElementTrackChoiceManager)return;return this._priv_mediaElementTrackChoiceManager.getChosenTextTrack()}if(null!==this._priv_trackChoiceManager&&null!==t)return this._priv_trackChoiceManager.getChosenTextTrack(t)}},n.getVideoTrack=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.currentPeriod;if(e.isDirectFile){if(null===this._priv_mediaElementTrackChoiceManager)return;return this._priv_mediaElementTrackChoiceManager.getChosenVideoTrack()}if(null!==this._priv_trackChoiceManager&&null!==t)return this._priv_trackChoiceManager.getChosenVideoTrack(t)}},n.setAudioTrack=function(e){var t;if(null===this._priv_contentInfos)throw new Error("No content loaded");var n=this._priv_contentInfos,r=n.currentPeriod;if(n.isDirectFile)try{return void(null===(t=this._priv_mediaElementTrackChoiceManager)||void 0===t||t.setAudioTrackById(e))}catch(e){throw new Error("player: unknown audio track")}if(null===this._priv_trackChoiceManager||null===r)throw new Error("No compatible content launched.");try{this._priv_trackChoiceManager.setAudioTrackByID(r,e)}catch(e){throw new Error("player: unknown audio track")}},n.setTextTrack=function(e){var t;if(null===this._priv_contentInfos)throw new Error("No content loaded");var n=this._priv_contentInfos,r=n.currentPeriod;if(n.isDirectFile)try{return void(null===(t=this._priv_mediaElementTrackChoiceManager)||void 0===t||t.setTextTrackById(e))}catch(e){throw new Error("player: unknown text track")}if(null===this._priv_trackChoiceManager||null===r)throw new Error("No compatible content launched.");try{this._priv_trackChoiceManager.setTextTrackByID(r,e)}catch(e){throw new Error("player: unknown text track")}},n.disableTextTrack=function(){var e;if(null!==this._priv_contentInfos){var t=this._priv_contentInfos,n=t.currentPeriod;if(t.isDirectFile)null===(e=this._priv_mediaElementTrackChoiceManager)||void 0===e||e.disableTextTrack();else if(null!==this._priv_trackChoiceManager&&null!==n)return this._priv_trackChoiceManager.disableTextTrack(n)}},n.setVideoTrack=function(e){var t;if(null===this._priv_contentInfos)throw new Error("No content loaded");var n=this._priv_contentInfos,r=n.currentPeriod;if(n.isDirectFile)try{return void(null===(t=this._priv_mediaElementTrackChoiceManager)||void 0===t||t.setVideoTrackById(e))}catch(e){throw new Error("player: unknown video track")}if(null===this._priv_trackChoiceManager||null===r)throw new Error("No compatible content launched.");try{this._priv_trackChoiceManager.setVideoTrackByID(r,e)}catch(e){throw new Error("player: unknown video track")}},n.disableVideoTrack=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.currentPeriod;if(e.isDirectFile&&null!==this._priv_mediaElementTrackChoiceManager)return this._priv_mediaElementTrackChoiceManager.disableVideoTrack();if(null!==this._priv_trackChoiceManager&&null!==t)return this._priv_trackChoiceManager.disableVideoTrack(t)}},n.getPreferredAudioTracks=function(){return this._priv_preferredAudioTracks},n.getPreferredTextTracks=function(){return this._priv_preferredTextTracks},n.getPreferredVideoTracks=function(){return this._priv_preferredVideoTracks},n.setPreferredAudioTracks=function(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))throw new Error("Invalid `setPreferredAudioTracks` argument. Should have been an Array.");this._priv_preferredAudioTracks=e,null!==this._priv_trackChoiceManager?this._priv_trackChoiceManager.setPreferredAudioTracks(e,t):null!==this._priv_mediaElementTrackChoiceManager&&this._priv_mediaElementTrackChoiceManager.setPreferredAudioTracks(e,t)},n.setPreferredTextTracks=function(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))throw new Error("Invalid `setPreferredTextTracks` argument. Should have been an Array.");this._priv_preferredTextTracks=e,null!==this._priv_trackChoiceManager?this._priv_trackChoiceManager.setPreferredTextTracks(e,t):null!==this._priv_mediaElementTrackChoiceManager&&this._priv_mediaElementTrackChoiceManager.setPreferredTextTracks(e,t)},n.setPreferredVideoTracks=function(e,t){if(void 0===t&&(t=!1),!Array.isArray(e))throw new Error("Invalid `setPreferredVideoTracks` argument. Should have been an Array.");this._priv_preferredVideoTracks=e,null!==this._priv_trackChoiceManager?this._priv_trackChoiceManager.setPreferredVideoTracks(e,t):null!==this._priv_mediaElementTrackChoiceManager&&this._priv_mediaElementTrackChoiceManager.setPreferredVideoTracks(e,t)},n.getImageTrackData=function(){return Object(Q.a)("`getImageTrackData` is deprecated.Please use the `parseBifThumbnails` tool instead."),null===this._priv_contentInfos?null:this._priv_contentInfos.thumbnails},n.getMinimumPosition=function(){if(null===this._priv_contentInfos)return null;if(this._priv_contentInfos.isDirectFile)return 0;var e=this._priv_contentInfos.manifest;return null!==e?e.getMinimumPosition():null},n.getMaximumPosition=function(){if(null===this._priv_contentInfos)return null;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;if(t){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration}return null!==n?n.getMaximumPosition():null},n.__priv_getSegmentBufferContent=function(e){if(null===this._priv_contentInfos||null===this._priv_contentInfos.segmentBuffersStore)return null;var t=this._priv_contentInfos.segmentBuffersStore.getStatus(e);return"initialized"===t.type?t.value.getInventory():null},n._priv_cleanUpCurrentContentState=function(){var e,t=this;P.a.debug("Locking `contentLock` to clean-up the current content."),this._priv_contentLock$.next(!0),this._priv_contentInfos=null,this._priv_trackChoiceManager=null,null===(e=this._priv_mediaElementTrackChoiceManager)||void 0===e||e.dispose(),this._priv_mediaElementTrackChoiceManager=null,this._priv_contentEventsMemory={};var n=function(){P.a.debug("Unlocking `contentLock`. Next content can begin."),t._priv_contentLock$.next(!1)};Object(W.a)(this.videoElement)?n():Object(ee.a)(this.videoElement).subscribe(G.a,(function(e){P.a.error("API: An error arised when trying to clean-up the EME session:"+(e instanceof Error?e.toString():"Unknown Error")),n()}),(function(){P.a.debug("API: EME session cleaned-up with success!"),n()}))},n._priv_onPlaybackEvent=function(e){switch(e.type){case"stream-event":this.trigger("streamEvent",e.value);break;case"stream-event-skip":this.trigger("streamEventSkip",e.value);break;case"activePeriodChanged":this._priv_onActivePeriodChanged(e.value);break;case"periodStreamReady":this._priv_onPeriodStreamReady(e.value);break;case"periodStreamCleared":this._priv_onPeriodStreamCleared(e.value);break;case"reloading-media-source":this._priv_onReloadingMediaSource();break;case"representationChange":this._priv_onRepresentationChange(e.value);break;case"adaptationChange":this._priv_onAdaptationChange(e.value);break;case"bitrateEstimationChange":this._priv_onBitrateEstimationChange(e.value);break;case"manifestReady":this._priv_onManifestReady(e.value);break;case"warning":this._priv_onPlaybackWarning(e.value);break;case"loaded":if(null===this._priv_contentInfos)return void P.a.error("API: Loaded event while no content is loaded");this._priv_contentInfos.segmentBuffersStore=e.value.segmentBuffersStore;break;case"decipherabilityUpdate":this.trigger("decipherabilityUpdate",e.value);break;case"added-segment":if(null===this._priv_contentInfos)return void P.a.error("API: Added segment while no content is loaded");var t=e.value,n=t.content,r=t.segmentData;if("image"===n.adaptation.type&&!Object(W.a)(r)&&"bif"===r.type){var i=r.data;this._priv_contentInfos.thumbnails=i,this.trigger("imageTrackUpdate",{data:this._priv_contentInfos.thumbnails})}}},n._priv_onPlaybackError=function(e){var t=V(e,{defaultCode:"NONE",defaultReason:"An unknown error stopped content playback."});t.fatal=!0,this._priv_stopCurrentContent$.next(),this._priv_cleanUpCurrentContentState(),this._priv_currentError=t,P.a.error("API: The player stopped because of an error:",e),this._priv_setPlayerState(Br),this._priv_currentError===t&&this.trigger("error",t)},n._priv_onPlaybackFinished=function(){P.a.info("API: Previous playback finished. Stopping and cleaning-up..."),this._priv_stopCurrentContent$.next(),this._priv_cleanUpCurrentContentState(),this._priv_setPlayerState(Kr)},n._priv_onPlaybackWarning=function(e){var t=V(e,{defaultCode:"NONE",defaultReason:"An unknown error happened."});P.a.warn("API: Sending warning:",t),this.trigger("warning",t)},n._priv_onManifestReady=function(e){var t=this,n=e.manifest;if(null!==this._priv_contentInfos){this._priv_contentInfos.manifest=n,this._priv_lastContentPlaybackInfos.manifest=n;var r=this._priv_contentInfos,i=r.initialAudioTrack,a=r.initialTextTrack;this._priv_trackChoiceManager=new mi;var o=void 0===i?this._priv_preferredAudioTracks:[i];this._priv_trackChoiceManager.setPreferredAudioTracks(o,!0);var s=void 0===a?this._priv_preferredTextTracks:[a];this._priv_trackChoiceManager.setPreferredTextTracks(s,!0),this._priv_trackChoiceManager.setPreferredVideoTracks(this._priv_preferredVideoTracks,!0),Object(H.b)(n,"manifestUpdate").pipe(Object(b.a)(this._priv_stopCurrentContent$)).subscribe((function(){null!==t._priv_trackChoiceManager&&t._priv_trackChoiceManager.update()}))}else P.a.error("API: The manifest is loaded but no content is.")},n._priv_onActivePeriodChanged=function(e){var t,n,r,i,a,o,s=e.period;if(null!==this._priv_contentInfos){if(this._priv_contentInfos.currentPeriod=s,this._priv_contentEventsMemory.periodChange!==s&&(this._priv_contentEventsMemory.periodChange=s,this.trigger("periodChange",s)),this.trigger("availableAudioTracksChange",this.getAvailableAudioTracks()),this.trigger("availableTextTracksChange",this.getAvailableTextTracks()),this.trigger("availableVideoTracksChange",this.getAvailableVideoTracks()),null!==this._priv_trackChoiceManager){var u=this._priv_trackChoiceManager.getChosenAudioTrack(s),c=this._priv_trackChoiceManager.getChosenTextTrack(s),l=this._priv_trackChoiceManager.getChosenVideoTrack(s);this.trigger("audioTrackChange",u),this.trigger("textTrackChange",c),this.trigger("videoTrackChange",l)}else this.trigger("audioTrackChange",null),this.trigger("textTrackChange",null),this.trigger("videoTrackChange",null);this._priv_triggerAvailableBitratesChangeEvent("availableAudioBitratesChange",this.getAvailableAudioBitrates()),this._priv_triggerAvailableBitratesChangeEvent("availableVideoBitratesChange",this.getAvailableVideoBitrates());var d=null!==(r=null===(n=null===(t=this._priv_getCurrentRepresentations())||void 0===t?void 0:t.audio)||void 0===n?void 0:n.bitrate)&&void 0!==r?r:-1;this._priv_triggerCurrentBitrateChangeEvent("audioBitrateChange",d);var f=null!==(o=null===(a=null===(i=this._priv_getCurrentRepresentations())||void 0===i?void 0:i.video)||void 0===a?void 0:a.bitrate)&&void 0!==o?o:-1;this._priv_triggerCurrentBitrateChangeEvent("videoBitrateChange",f)}else P.a.error("API: The active period changed but no content is loaded")},n._priv_onPeriodStreamReady=function(e){var t=e.type,n=e.period,r=e.adaptation$;switch(t){case"video":null===this._priv_trackChoiceManager?(P.a.error("API: TrackChoiceManager not instanciated for a new video period"),r.next(null)):(this._priv_trackChoiceManager.addPeriod(t,n,r),this._priv_trackChoiceManager.setInitialVideoTrack(n));break;case"audio":null===this._priv_trackChoiceManager?(P.a.error("API: TrackChoiceManager not instanciated for a new "+t+" period"),r.next(null)):(this._priv_trackChoiceManager.addPeriod(t,n,r),this._priv_trackChoiceManager.setInitialAudioTrack(n));break;case"text":null===this._priv_trackChoiceManager?(P.a.error("API: TrackChoiceManager not instanciated for a new "+t+" period"),r.next(null)):(this._priv_trackChoiceManager.addPeriod(t,n,r),this._priv_trackChoiceManager.setInitialTextTrack(n));break;default:var i=n.adaptations[t];!Object(W.a)(i)&&i.length>0?r.next(i[0]):r.next(null)}},n._priv_onPeriodStreamCleared=function(e){var t=e.type,n=e.period;switch(t){case"audio":case"text":case"video":null!==this._priv_trackChoiceManager&&this._priv_trackChoiceManager.removePeriod(t,n)}if(null!==this._priv_contentInfos){var r=this._priv_contentInfos,i=r.activeAdaptations,a=r.activeRepresentations;if(!Object(W.a)(i)&&!Object(W.a)(i[n.id])){var o=i[n.id];delete o[t],0===Object.keys(o).length&&delete i[n.id]}if(!Object(W.a)(a)&&!Object(W.a)(a[n.id])){var s=a[n.id];delete s[t],0===Object.keys(s).length&&delete a[n.id]}}},n._priv_onReloadingMediaSource=function(){null!==this._priv_contentInfos&&(this._priv_contentInfos.segmentBuffersStore=null),null!==this._priv_trackChoiceManager&&this._priv_trackChoiceManager.resetPeriods()},n._priv_onAdaptationChange=function(e){var t=e.type,n=e.adaptation,r=e.period;if(null!==this._priv_contentInfos){null===this._priv_contentInfos.activeAdaptations&&(this._priv_contentInfos.activeAdaptations={});var i,a=this._priv_contentInfos,o=a.activeAdaptations,s=a.currentPeriod,u=o[r.id];if(Object(W.a)(u))o[r.id]=((i={})[t]=n,i);else u[t]=n;if(null!==this._priv_trackChoiceManager&&null!==s&&!Object(W.a)(r)&&r.id===s.id)switch(t){case"audio":var c=this._priv_trackChoiceManager.getChosenAudioTrack(s);this.trigger("audioTrackChange",c);var l=this.getAvailableAudioBitrates();this._priv_triggerAvailableBitratesChangeEvent("availableAudioBitratesChange",l);break;case"text":var d=this._priv_trackChoiceManager.getChosenTextTrack(s);this.trigger("textTrackChange",d);break;case"video":var f=this._priv_trackChoiceManager.getChosenVideoTrack(s);this.trigger("videoTrackChange",f);var p=this.getAvailableVideoBitrates();this._priv_triggerAvailableBitratesChangeEvent("availableVideoBitratesChange",p)}}else P.a.error("API: The adaptations changed but no content is loaded")},n._priv_onRepresentationChange=function(e){var t,n=e.type,r=e.period,i=e.representation;if(null!==this._priv_contentInfos){null===this._priv_contentInfos.activeRepresentations&&(this._priv_contentInfos.activeRepresentations={});var a,o=this._priv_contentInfos,s=o.activeRepresentations,u=o.currentPeriod,c=s[r.id];if(Object(W.a)(c))s[r.id]=((a={})[n]=i,a);else c[n]=i;var l=null!==(t=null==i?void 0:i.bitrate)&&void 0!==t?t:-1;Object(W.a)(r)||null===u||u.id!==r.id||("video"===n?this._priv_triggerCurrentBitrateChangeEvent("videoBitrateChange",l):"audio"===n&&this._priv_triggerCurrentBitrateChangeEvent("audioBitrateChange",l))}else P.a.error("API: The representations changed but no content is loaded")},n._priv_onBitrateEstimationChange=function(e){var t=e.type,n=e.bitrate;void 0!==n&&(this._priv_bitrateInfos.lastBitrates[t]=n),this.trigger("bitrateEstimationChange",{type:t,bitrate:n})},n._priv_onPlayPauseNext=function(e){if(null===this.videoElement)throw new Error("Disposed player");this._priv_playing$.next(e)},n._priv_onNativeTextTracksNext=function(e){this.trigger("nativeTextTracksChange",e)},n._priv_setPlayerState=function(e){this.state!==e&&(this.state=e,P.a.info("API: playerStateChange event",e),this.trigger("playerStateChange",e))},n._priv_triggerPositionUpdate=function(e){var t;if(null!==this._priv_contentInfos){if(this.state!==Wr){var n=this._priv_contentInfos,r=n.isDirectFile,i=n.manifest;if((r||null!==i)&&!Object(W.a)(e)){this._priv_lastContentPlaybackInfos.lastPlaybackPosition=e.position;var a=null!==i?i.getMaximumPosition():void 0,o={position:e.position,duration:e.duration,playbackRate:e.playbackRate,maximumBufferTime:a,bufferGap:isFinite(e.bufferGap)?e.bufferGap:0};if(null!==i&&void 0!==a&&i.isLive&&e.position>0){var s=null!==(t=i.availabilityStartTime)&&void 0!==t?t:0;o.wallClockTime=e.position+s,o.liveGap=a-e.position}this.trigger("positionUpdate",o)}}}else P.a.warn("API: Cannot perform time update: no content loaded.")},n._priv_triggerAvailableBitratesChangeEvent=function(e,t){var n=this._priv_contentEventsMemory[e];(void 0===n||Object($.a)(t,n))&&(this._priv_contentEventsMemory[e]=t,this.trigger(e,t))},n._priv_triggerCurrentBitrateChangeEvent=function(e,t){t!==this._priv_contentEventsMemory[e]&&(this._priv_contentEventsMemory[e]=t,this.trigger(e,t))},n._priv_getCurrentRepresentations=function(){if(null===this._priv_contentInfos)return null;var e=this._priv_contentInfos,t=e.currentPeriod,n=e.activeRepresentations;return null===t||null===n||Object(W.a)(n[t.id])?null:n[t.id]},i()(t,null,[{key:"ErrorTypes",get:function(){return z.b}},{key:"ErrorCodes",get:function(){return z.a}},{key:"LogLevel",get:function(){return P.a.getLevel()},set:function(e){P.a.setLevel(e)}}]),t}(H.a);Di.version="3.23.0";var Li=Di,Bi=n(33);!function(){Bi.a.emeManager=n(147).default,Bi.a.imageBuffer=n(226).default,Bi.a.imageParser=n(208).default,Bi.a.transports.smooth=n(219).default,Bi.a.transports.dash=n(218).default,Bi.a.nativeTextTracksBuffer=n(223).default,Bi.a.nativeTextTracksParsers.vtt=n(224).default,Bi.a.nativeTextTracksParsers.ttml=n(225).default,Bi.a.nativeTextTracksParsers.sami=n(211).default,Bi.a.nativeTextTracksParsers.srt=n(212).default,Bi.a.htmlTextTracksBuffer=n(222).default,Bi.a.htmlTextTracksParsers.sami=n(213).default,Bi.a.htmlTextTracksParsers.ttml=n(220).default,Bi.a.htmlTextTracksParsers.srt=n(214).default,Bi.a.htmlTextTracksParsers.vtt=n(221).default;var e=n(215).default,t=n(216).default;Bi.a.directfile={initDirectFile:e,mediaElementTrackChoiceManager:t}}();t.default=Li},function(e,t,n){"use strict";n.r(t);var r=n(138),i=n(30),a=n(24),o=n(29),s=n(18);function u(e){var t=e.segment,n=e.url;return t.isInit||null===n?Object(i.a)({type:"data-created",value:{responseData:null}}):Object(o.a)({url:n,responseType:"arraybuffer",sendProgressEvents:!0})}function c(e){var t=e.response,n=e.content,r=n.segment,o=n.period,u=t.data,c=t.isChunked;if(n.segment.isInit)return Object(i.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:void 0}});if(c)throw new Error("Image data should not be downloaded in chunks");var l=Object(s.a)(r.timestampOffset,0);if(null===u||null===a.a.imageParser)return Object(i.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:{duration:r.duration,time:r.time},chunkOffset:l,appendWindow:[o.start,o.end]}});var d=a.a.imageParser(new Uint8Array(u)),f=d.thumbs;return Object(i.a)({type:"parsed-segment",value:{chunkData:{data:f,start:0,end:Number.MAX_VALUE,timescale:1,type:"bif"},chunkInfos:{time:0,duration:Number.MAX_VALUE,timescale:d.timescale},chunkOffset:l,appendWindow:[o.start,o.end]}})}var l=n(103),d=n(233),f=n(157),p=n(37),h=n(50),v=n(73),m=n(4),b=n(0),g=n(14),y=n(67);function _(e){return 0===e.length?0:e.reduce((function(e,t){var n;return Math.min(null!==(n=t.attributes.availabilityTimeOffset)&&void 0!==n?n:0,e)}),1/0)}function O(e){var t=Date.parse(e)-performance.now();if(!isNaN(t))return t;b.a.warn("DASH Parser: Invalid clock received: ",e)}function T(e){for(var t=e.representations,n=null,r=0;r<t.length;r++){var i=t[r].index.getLastPosition();if(void 0===i)return;null!==i&&(n=null==n?i:Math.min(n,i))}return null===n?null:n}function E(e){for(var t=e.length-1;t>=0;t--){var n=e[t].adaptations,r=void 0===n.audio?void 0:n.audio[0],i=void 0===n.video?void 0:n.video[0];if(void 0!==r||void 0!==i){var a=null,o=null;if(void 0!==r){var s=T(r);if(void 0===s)return;a=s}if(void 0!==i){var u=T(i);if(void 0===u)return;o=u}if(void 0!==r&&null===a||void 0!==i&&null===o)return void b.a.info("Parser utils: found Period with no segment. ","Going to previous one to calculate last position");if(null!==o)return null!==a?Math.min(a,o):o;if(null!==a)return a}}}function w(e){for(var t=e.representations,n=null,r=0;r<t.length;r++){var i=t[r].index.getFirstPosition();if(void 0===i)return;null!==i&&(n=null==n?i:Math.max(n,i))}return null===n?null:n}function S(e){for(var t=0;t<=e.length-1;t++){var n=e[t].adaptations,r=void 0===n.audio?void 0:n.audio[0],i=void 0===n.video?void 0:n.video[0];if(void 0!==r||void 0!==i){var a=null,o=null;if(void 0!==r){var s=w(r);if(void 0===s)return;a=s}if(void 0!==i){var u=w(i);if(void 0===u)return;o=u}if(void 0!==r&&null===a||void 0!==i&&null===o)return void b.a.info("Parser utils: found Period with no segment. ","Going to next one to calculate first position");if(null!==o)return null!==a?Math.max(a,o):o;if(null!==a)return a}}}var j=n(39),k=n.n(j),A=n(15),x=n.n(A),I=n(40),M=n.n(I),R=n(53),C=n(2),N=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,P=/([0-9]+)-([0-9]+)/;function D(e,t){return"true"===e?[!0,null]:"false"===e?[!1,null]:[!1,new W("`"+t+'` property is not a boolean value but "'+e+'"')]}function L(e,t){var n=parseInt(e,10);return isNaN(n)?[null,new W("`"+t+'` property is not an integer value but "'+e+'"')]:[n,null]}function B(e,t){var n=parseFloat(e);return isNaN(n)?[null,new W("`"+t+'` property is not an integer value but "'+e+'"')]:[n,null]}function U(e,t){if("true"===e)return[!0,null];if("false"===e)return[!1,null];var n=parseInt(e,10);return isNaN(n)?[null,new W("`"+t+'` property is not a boolean nor an integer but "'+e+'"')]:[n,null]}function F(e,t){var n=Date.parse(e);return isNaN(n)?[null,new W("`"+t+'` is in an invalid date format: "'+e+'"')]:[new Date(Date.parse(e)).getTime()/1e3,null]}function V(e,t){if(!Object(C.a)(e))return[0,new W("`"+t+"` property is empty")];var n=N.exec(e);return null===n?[null,new W("`"+t+'` property has an unrecognized format "'+e+'"')]:[365*parseFloat(Object(C.a)(n[2])?n[2]:"0")*24*60*60+30*parseFloat(Object(C.a)(n[4])?n[4]:"0")*24*60*60+24*parseFloat(Object(C.a)(n[6])?n[6]:"0")*60*60+60*parseFloat(Object(C.a)(n[8])?n[8]:"0")*60+60*parseFloat(Object(C.a)(n[10])?n[10]:"0")+parseFloat(Object(C.a)(n[12])?n[12]:"0"),null]}function z(e,t){var n=P.exec(e);return null===n?[null,new W("`"+t+'` property has an unrecognized format "'+e+'"')]:[[+n[1],+n[2]],null]}function K(e,t){try{return[Object(R.a)(e),null]}catch(n){return[null,new W("`"+t+'` is not a valid base64 string: "'+e+'"')]}}function $(e){for(var t,n,r=0;r<e.attributes.length;r++){var i=e.attributes[r];switch(i.name){case"schemeIdUri":t=i.value;break;case"value":n=i.value}}return{schemeIdUri:t,value:n}}function H(e,t){return function(n,r){var i=r.asKey,a=(0,r.parser)(n,r.dashName),o=a[0],s=a[1];null!==s&&(b.a.warn(s.message),t.push(s)),null!==o&&(e[i]=o)}}var W=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf(k()(r),t.prototype),r.name="MPDError",r.message=n,r}return x()(t,e),t}(M()(Error));function G(e){var t={},n=e.textContent,r=[],i=H(t,r);if(null===n||0===n.length)return[void 0,r];for(var a=0;a<e.attributes.length;a++){var o=e.attributes[a];switch(o.name){case"availabilityTimeOffset":"INF"===o.value?t.availabilityTimeOffset=1/0:i(o.value,{asKey:"availabilityTimeOffset",parser:L,dashName:"availabilityTimeOffset"})}}return[{value:n,attributes:t},r]}function Y(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"id":t.id=r.value;break;case"lang":t.language=r.value;break;case"contentType":t.contentType=r.value;break;case"par":t.par=r.value}}return t}var q=n(11);function X(e){var t=function(e){for(var t=[],n=[],r=0;r<e.length;r++)if(e[r].nodeType===Node.ELEMENT_NODE){var i=e[r];if("cenc:pssh"===i.nodeName){var a=i.textContent;if(null!==a&&a.length>0){var o=K(a,"cenc:pssh"),s=o[0],u=o[1];null!==u&&(b.a.warn(u.message),t.push(u)),null!==s&&n.push(s)}}}return[{cencPssh:n},t]}(e.childNodes),n=t[0],r=t[1];return[{children:n,attributes:function(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"schemeIdUri":t.schemeIdUri=r.value;break;case"value":t.value=r.value;break;case"cenc:default_KID":t.keyId=Object(q.c)(r.value.replace(/-/g,""))}}return t}(e)},r]}function Q(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"range":r(a.value,{asKey:"range",parser:z,dashName:"range"});break;case"sourceURL":t.media=a.value}}return[t,n]}function Z(e){for(var t={},n=[],r=H(t,n),i=e.childNodes,a=0;a<i.length;a++)if(i[a].nodeType===Node.ELEMENT_NODE){var o=i[a];if("Initialization"===o.nodeName){var s=Q(o),u=s[0],c=s[1];t.initialization=u,n=n.concat(c)}}for(var l=0;l<e.attributes.length;l++){var d=e.attributes[l];switch(d.name){case"timescale":r(d.value,{asKey:"timescale",parser:L,dashName:"timescale"});break;case"presentationTimeOffset":r(d.value,{asKey:"presentationTimeOffset",parser:B,dashName:"presentationTimeOffset"});break;case"indexRange":r(d.value,{asKey:"indexRange",parser:z,dashName:"indexRange"});break;case"indexRangeExact":r(d.value,{asKey:"indexRangeExact",parser:D,dashName:"indexRangeExact"});break;case"availabilityTimeOffset":r(d.value,{asKey:"availabilityTimeOffset",parser:B,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":r(d.value,{asKey:"availabilityTimeComplete",parser:D,dashName:"availabilityTimeComplete"});break;case"duration":r(d.value,{asKey:"duration",parser:L,dashName:"duration"});break;case"startNumber":r(d.value,{asKey:"startNumber",parser:L,dashName:"startNumber"})}}return[t,n]}var J=n(13);function ee(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"media":t.media=a.value;break;case"indexRange":r(a.value,{asKey:"indexRange",parser:z,dashName:"indexRange"});break;case"index":t.index=a.value;break;case"mediaRange":r(a.value,{asKey:"mediaRange",parser:z,dashName:"mediaRange"})}}return[t,n]}function te(e){for(var t=Z(e),n=t[0],r=t[1],i=[],a=e.childNodes,o=0;o<a.length;o++)if(a[o].nodeType===Node.ELEMENT_NODE){var s=a[o];if("SegmentURL"===s.nodeName){var u=ee(s),c=u[0],l=u[1];i.push(c),r=r.concat(l)}}var d=n.duration;if(null==d)throw new Error("Invalid SegmentList: no duration");return[Object(J.a)(n,{list:i,duration:d}),r]}function ne(e){var t=null;return function(){if(null===t){var n=e.getElementsByTagName("S");return t=n,n}return t}}function re(e){for(var t,n=Z(e),r=n[0],i=n[1],a=0;a<e.childNodes.length;a++)if(e.childNodes[a].nodeType===Node.ELEMENT_NODE){var o=e.childNodes[a];"SegmentTimeline"===o.nodeName&&(t=ne(o))}for(var s=Object(J.a)({},r,{duration:r.duration,timelineParser:t}),u=H(s,i),c=0;c<e.attributes.length;c++){var l=e.attributes[c];switch(l.nodeName){case"initialization":null==s.initialization&&(s.initialization={media:l.value});break;case"index":s.index=l.value;break;case"availabilityTimeOffset":"INF"===l.value&&(s.availabilityTimeOffset=1/0),u(l.value,{asKey:"availabilityTimeOffset",parser:L,dashName:"availabilityTimeOffset"});break;case"media":s.media=l.value;break;case"bitstreamSwitching":u(l.value,{asKey:"bitstreamSwitching",parser:D,dashName:"bitstreamSwitching"})}}return[s,i]}function ie(e){var t=function(e){for(var t={baseURLs:[]},n=[],r=0;r<e.length;r++)if(e[r].nodeType===Node.ELEMENT_NODE){var i=e[r];switch(i.nodeName){case"BaseURL":var a=G(i),o=a[0],s=a[1];void 0!==o&&t.baseURLs.push(o),n=n.concat(s);break;case"SegmentBase":var u=Z(i),c=u[0],l=u[1];t.segmentBase=c,l.length>0&&(n=n.concat(l));break;case"SegmentList":var d=te(i),f=d[0],p=d[1];n=n.concat(p),t.segmentList=f;break;case"SegmentTemplate":var h=re(i),v=h[0],m=h[1];n=n.concat(m),t.segmentTemplate=v}}return[t,n]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"audioSamplingRate":t.audioSamplingRate=a.value;break;case"bandwidth":r(a.value,{asKey:"bitrate",parser:L,dashName:"bandwidth"});break;case"codecs":t.codecs=a.value;break;case"codingDependency":r(a.value,{asKey:"codingDependency",parser:D,dashName:"codingDependency"});break;case"frameRate":t.frameRate=a.value;break;case"height":r(a.value,{asKey:"height",parser:L,dashName:"height"});break;case"id":t.id=a.value;break;case"maxPlayoutRate":r(a.value,{asKey:"maxPlayoutRate",parser:B,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":r(a.value,{asKey:"maximumSAPPeriod",parser:B,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=a.value;break;case"profiles":t.profiles=a.value;break;case"qualityRanking":r(a.value,{asKey:"qualityRanking",parser:L,dashName:"qualityRanking"});break;case"segmentProfiles":t.segmentProfiles=a.value;break;case"width":r(a.value,{asKey:"width",parser:L,dashName:"width"})}}return void 0===t.bitrate&&n.push(new W("No bitrate found on a Representation")),[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}function ae(e){var t=function(e){for(var t={baseURLs:[],representations:[]},n=[],r=[],i=0;i<e.length;i++)if(e[i].nodeType===Node.ELEMENT_NODE){var a=e[i];switch(a.nodeName){case"Accessibility":t.accessibility=$(a);break;case"BaseURL":var o=G(a),s=o[0],u=o[1];void 0!==s&&t.baseURLs.push(s),u.length>0&&(r=r.concat(u));break;case"ContentComponent":t.contentComponent=Y(a);break;case"EssentialProperty":null==t.essentialProperties?t.essentialProperties=[$(a)]:t.essentialProperties.push($(a));break;case"Representation":var c=ie(a),l=c[0],d=c[1];t.representations.push(l),d.length>0&&(r=r.concat(d));break;case"Role":null==t.roles?t.roles=[$(a)]:t.roles.push($(a));break;case"SupplementalProperty":null==t.supplementalProperties?t.supplementalProperties=[$(a)]:t.supplementalProperties.push($(a));break;case"SegmentBase":var f=Z(a),p=f[0],h=f[1];t.segmentBase=p,h.length>0&&(r=r.concat(h));break;case"SegmentList":var v=te(a),m=v[0],b=v[1];t.segmentList=m,b.length>0&&(r=r.concat(b));break;case"SegmentTemplate":var g=re(a),y=g[0],_=g[1];t.segmentTemplate=y,_.length>0&&(r=r.concat(_));break;case"ContentProtection":var O=X(a),T=O[0],E=O[1];E.length>0&&(r=r.concat(E)),void 0!==T&&n.push(T)}}return n.length>0&&(t.contentProtections=n),[t,r]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"group":r(a.value,{asKey:"group",parser:L,dashName:"group"});break;case"lang":t.language=a.value;break;case"contentType":t.contentType=a.value;break;case"par":t.par=a.value;break;case"minBandwidth":r(a.value,{asKey:"minBitrate",parser:L,dashName:"minBandwidth"});break;case"maxBandwidth":r(a.value,{asKey:"maxBitrate",parser:L,dashName:"maxBandwidth"});break;case"minWidth":r(a.value,{asKey:"minWidth",parser:L,dashName:"minWidth"});break;case"maxWidth":r(a.value,{asKey:"maxWidth",parser:L,dashName:"maxWidth"});break;case"minHeight":r(a.value,{asKey:"minHeight",parser:L,dashName:"minHeight"});break;case"maxHeight":r(a.value,{asKey:"maxHeight",parser:L,dashName:"maxHeight"});break;case"minFrameRate":t.minFrameRate=a.value;break;case"maxFrameRate":t.maxFrameRate=a.value;break;case"selectionPriority":r(a.value,{asKey:"selectionPriority",parser:L,dashName:"selectionPriority"});break;case"segmentAlignment":r(a.value,{asKey:"segmentAlignment",parser:U,dashName:"segmentAlignment"});break;case"subsegmentAlignment":r(a.value,{asKey:"subsegmentAlignment",parser:U,dashName:"subsegmentAlignment"});break;case"bitstreamSwitching":r(a.value,{asKey:"bitstreamSwitching",parser:D,dashName:"bitstreamSwitching"});break;case"audioSamplingRate":t.audioSamplingRate=a.value;break;case"codecs":t.codecs=a.value;break;case"codingDependency":r(a.value,{asKey:"codingDependency",parser:D,dashName:"codingDependency"});break;case"frameRate":t.frameRate=a.value;break;case"height":r(a.value,{asKey:"height",parser:L,dashName:"height"});break;case"maxPlayoutRate":r(a.value,{asKey:"maxPlayoutRate",parser:B,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":r(a.value,{asKey:"maximumSAPPeriod",parser:B,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=a.value;break;case"profiles":t.profiles=a.value;break;case"segmentProfiles":t.segmentProfiles=a.value;break;case"width":r(a.value,{asKey:"width",parser:L,dashName:"width"})}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}var oe=function(e){for(var t,n=[],r={timescale:1},i=[],a=H(r,i),o=0;o<e.attributes.length;o++){var s=e.attributes[o];switch(s.name){case"schemeIdUri":r.schemeId=s.value;break;case"timescale":a(s.value,{asKey:"timescale",parser:L,dashName:"timescale"});break;case"value":r.value=s.value}}for(var u=0;u<e.childNodes.length;u++){var c=e.childNodes[u],l={id:void 0,eventPresentationTime:0,duration:void 0,timescale:r.timescale,data:{type:"dash-event-stream",value:{schemeIdUri:null!==(t=r.schemeId)&&void 0!==t?t:"",timescale:r.timescale,element:c}}},d=H(l,i);if("Event"===c.nodeName&&c.nodeType===Node.ELEMENT_NODE){for(var f=c.attributes,p=0;p<f.length;p++){var h=f[p];switch(h.name){case"presentationTime":d(h.value,{asKey:"eventPresentationTime",parser:L,dashName:"presentationTime"});break;case"duration":d(h.value,{asKey:"duration",parser:L,dashName:"duration"});break;case"id":l.id=h.value}}n.push(l)}}return[n,i]};function se(e){var t=function(e){for(var t,n=[],r=[],i=[],a=[],o=0;o<e.length;o++)if(e[o].nodeType===Node.ELEMENT_NODE){var s=e[o];switch(s.nodeName){case"BaseURL":var u=G(s),c=u[0],l=u[1];void 0!==c&&n.push(c),i=i.concat(l);break;case"AdaptationSet":var d=ae(s),f=d[0],p=d[1];r.push(f),i=i.concat(p);break;case"EventStream":var h=oe(s),v=h[0],m=h[1];a.push.apply(a,v),i=i.concat(m);break;case"SegmentTemplate":var b=re(s),g=b[0],y=b[1];t=g,y.length>0&&(i=i.concat(y))}}return[{baseURLs:n,adaptations:r,streamEvents:a,segmentTemplate:t},i]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"start":r(a.value,{asKey:"start",parser:V,dashName:"start"});break;case"duration":r(a.value,{asKey:"duration",parser:V,dashName:"duration"});break;case"bitstreamSwitching":r(a.value,{asKey:"bitstreamSwitching",parser:D,dashName:"bitstreamSwitching"});break;case"xlink:href":t.xlinkHref=a.value;break;case"xlink:actuate":t.xlinkActuate=a.value}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}function ue(e){var t=function(e){for(var t=[],n=[],r=[],i=[],a=[],o=0;o<e.length;o++)if(e[o].nodeType===Node.ELEMENT_NODE){var s=e[o];switch(s.nodeName){case"BaseURL":var u=G(s),c=u[0],l=u[1];void 0!==c&&t.push(c),a=a.concat(l);break;case"Location":n.push(null===s.textContent?"":s.textContent);break;case"Period":var d=se(s),f=d[0],p=d[1];r.push(f),a=a.concat(p);break;case"UTCTiming":var h=$(s);i.push(h)}}return[{baseURLs:t,locations:n,periods:r,utcTimings:i},a]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=H(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"profiles":t.profiles=a.value;break;case"type":t.type=a.value;break;case"availabilityStartTime":r(a.value,{asKey:"availabilityStartTime",parser:F,dashName:"availabilityStartTime"});break;case"availabilityEndTime":r(a.value,{asKey:"availabilityEndTime",parser:F,dashName:"availabilityEndTime"});break;case"publishTime":r(a.value,{asKey:"publishTime",parser:F,dashName:"publishTime"});break;case"mediaPresentationDuration":r(a.value,{asKey:"duration",parser:V,dashName:"mediaPresentationDuration"});break;case"minimumUpdatePeriod":r(a.value,{asKey:"minimumUpdatePeriod",parser:V,dashName:"minimumUpdatePeriod"});break;case"minBufferTime":r(a.value,{asKey:"minBufferTime",parser:V,dashName:"minBufferTime"});break;case"timeShiftBufferDepth":r(a.value,{asKey:"timeShiftBufferDepth",parser:V,dashName:"timeShiftBufferDepth"});break;case"suggestedPresentationDelay":r(a.value,{asKey:"suggestedPresentationDelay",parser:V,dashName:"suggestedPresentationDelay"});break;case"maxSegmentDuration":r(a.value,{asKey:"maxSegmentDuration",parser:V,dashName:"maxSegmentDuration"});break;case"maxSubsegmentDuration":r(a.value,{asKey:"maxSubsegmentDuration",parser:V,dashName:"maxSubsegmentDuration"})}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}var ce=n(98),le=n(85),de=n(78);var fe=function(){function e(e){this._isDynamic=e.isDynamic,this._timeShiftBufferDepth=e.isDynamic&&void 0!==e.timeShiftBufferDepth?e.timeShiftBufferDepth:null}var t=e.prototype;return t.setLastPosition=function(e,t){this._lastPosition=e,this._positionTime=t},t.lastPositionIsKnown=function(){return this._isDynamic?null!=this._positionTime&&null!=this._lastPosition:null!=this._lastPosition},t.getMinimumBound=function(){if(!this._isDynamic||null===this._timeShiftBufferDepth)return 0;var e=this.getMaximumBound();return void 0!==e?e-this._timeShiftBufferDepth:void 0},t.getMaximumBound=function(){return this._isDynamic&&null!=this._positionTime&&null!=this._lastPosition?Math.max(this._lastPosition-this._positionTime+performance.now()/1e3,0):this._lastPosition},e}(),pe=n(10),he=["audio","video","text","image"],ve=["subtitle","caption"];function me(e,t,n,r){function i(e,t){var n=e.split("/")[0];return Object(pe.a)(he,n)?n:"application/bif"===e?"image":"application/ttml+xml"===e||"application/mp4"===e&&null!=t&&null!=Object(g.a)(t,(function(e){return"urn:mpeg:dash:role:2011"===e.schemeIdUri&&Object(pe.a)(ve,e.value)}))?"text":void 0}function a(e){switch(e.substring(0,3)){case"avc":case"hev":case"hvc":case"vp8":case"vp9":case"av1":return"video";case"vtt":return"text";case"bif":return"image"}switch(e.substring(0,4)){case"mp4a":return"audio";case"wvtt":case"stpp":return"text"}}if(null!==t){var o=i(t,r);if(void 0!==o)return o}if(null!==n){var s=a(n);if(void 0!==s)return s}for(var u=0;u<e.length;u++){var c=e[u].attributes,l=c.mimeType,d=c.codecs;if(void 0!==l){var f=i(l,r);if(void 0!==f)return f}if(void 0!==d){var p=a(d);if(void 0!==p)return p}}}var be=n(20);function ge(e){var t,n=e.initialization;return{id:"init",isInit:!0,time:0,end:0,duration:0,timescale:1,range:null!=n?n.range:void 0,indexRange:e.indexRange,mediaURLs:null!==(t=null==n?void 0:n.mediaURLs)&&void 0!==t?t:null,timestampOffset:-e.indexTimeOffset/e.timescale}}function ye(e){return function(t,n,r){var i,a,o,s=Object(C.a)(r)?parseInt(r,10):1;return i=String(e),a=s,(o=i.toString()).length>=a?o:(new Array(a+1).join("0")+o).slice(-a)}}function _e(e,t,n,r){return 0===e.length?void 0!==t?[Oe(t,n,r)]:null:e.map((function(e){return Oe(Object(y.a)(e,t),n,r)}))}function Oe(e,t,n){return-1===e.indexOf("$")?e:e.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,String(t)).replace(/\$Bandwidth(|\%0(\d+)d)\$/g,ye(void 0===n?0:n))}function Te(e,t){return function(n){return-1===n.indexOf("$")?n:n.replace(/\$\$/g,"$").replace(/\$Number(|\%0(\d+)d)\$/g,(function(e,n,r){if(void 0===t)throw new Error("Segment number not defined in a $Number$ scheme");return ye(t)(e,n,r)})).replace(/\$Time(|\%0(\d+)d)\$/g,(function(t,n,r){if(void 0===e)throw new Error("Segment time not defined in a $Time$ scheme");return ye(e)(t,n,r)}))}}function Ee(e,t,n,r){for(var i,a,o=Object(be.f)(t,e),s=Object(be.f)(t+n,e),u=e.timeline,c=e.timescale,l=e.mediaURLs,d=e.startNumber,f=null!=d?d:void 0,p=[],h=u.length,v=u.length>0&&null!=u[0].duration?u[0].duration:0,m=0;m<h;m++){var b=u[m],g=b.duration,y=b.start,_=b.range;v=Math.max(v,g);for(var O=Object(be.a)(b,u[m+1],r),T=(i=g,a=void 0,(a=o-y)>0?Math.floor(a/i):0),E=y+T*g;E<s&&T<=O;){var w=null!=f?f+T:void 0,S=null===l?null:l.map(Te(E,w)),j=E-e.indexTimeOffset,k={id:String(E),time:j/c,end:(j+g)/c,duration:g/c,isInit:!1,range:_,timescale:1,mediaURLs:S,number:w,timestampOffset:-e.indexTimeOffset/c};p.push(k),E=y+ ++T*g}if(E>=s)return p;null!=f&&(f+=O+1)}return p}function we(e,t){if(t.timescale!==e.timescale){var n=e.timescale;e.timeline.push({start:t.time/t.timescale*n,duration:t.duration/t.timescale*n,repeatCount:void 0===t.count?0:t.count,range:t.range})}else e.timeline.push({start:t.time,duration:t.duration,repeatCount:void 0===t.count?0:t.count,range:t.range});return!0}var Se=function(){function e(e,t){var n,r,i=t.periodStart,a=t.periodEnd,o=t.representationBaseURLs,s=t.representationId,u=t.representationBitrate,c=null!==(n=e.timescale)&&void 0!==n?n:1,l=(null!=e.presentationTimeOffset?e.presentationTimeOffset:0)-i*c,d=_e(o,void 0!==e.initialization?e.initialization.media:void 0,s,u),f=void 0!==e.initialization?e.initialization.range:void 0!==e.indexRange?[0,e.indexRange[0]-1]:void 0;this._index={indexRange:e.indexRange,indexTimeOffset:l,initialization:{mediaURLs:d,range:f},mediaURLs:_e(o,e.media,s,u),startNumber:e.startNumber,timeline:null!==(r=e.timeline)&&void 0!==r?r:[],timescale:c},this._scaledPeriodEnd=null==a?void 0:Object(be.f)(a,this._index),this._isInitialized=this._index.timeline.length>0}var t=e.prototype;return t.getInitSegment=function(){return ge(this._index)},t.getSegments=function(e,t){return Ee(this._index,e,t,this._scaledPeriodEnd)},t.shouldRefresh=function(){return!1},t.getFirstPosition=function(){var e=this._index;return 0===e.timeline.length?null:Object(be.c)(e.timeline[0].start,e)},t.getLastPosition=function(){var e=this._index.timeline;if(0===e.length)return null;var t=e[e.length-1],n=Object(be.d)(t,null,this._scaledPeriodEnd);return Object(be.c)(n,this._index)},t.isSegmentStillAvailable=function(){return!0},t.checkDiscontinuity=function(){return null},t.areSegmentsChronologicallyGenerated=function(){return!0},t._addSegments=function(e){for(var t=0;t<e.length;t++)we(this._index,e[t]);!this._isInitialized&&this._index.timeline.length>0&&(this._isInitialized=!0)},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){return!0},t.isInitialized=function(){return this._isInitialized},t._replace=function(e){this._index=e._index},t._update=function(){b.a.error("Base RepresentationIndex: Cannot update a SegmentList")},e}(),je=function(){function e(e,t){var n,r=t.periodStart,i=t.representationBaseURLs,a=t.representationId,o=t.representationBitrate;this._periodStart=r;var s=null!=e.presentationTimeOffset?e.presentationTimeOffset:0,u=null!==(n=e.timescale)&&void 0!==n?n:1,c=s-r*u,l=e.list.map((function(e){return{mediaURLs:_e(i,e.media,a,o),mediaRange:e.mediaRange}}));this._index={list:l,timescale:u,duration:e.duration,indexTimeOffset:c,indexRange:e.indexRange,initialization:null==e.initialization?void 0:{mediaURLs:_e(i,e.initialization.media,a,o),range:e.initialization.range}}}var t=e.prototype;return t.getInitSegment=function(){return ge(this._index)},t.getSegments=function(e,t){for(var n=this._index,r=n.duration,i=n.list,a=n.timescale,o=r/a,s=e-this._periodStart,u=Object(be.e)(s,t,a),c=u[0],l=u[1],d=Math.min(i.length-1,Math.floor(l/r)),f=[],p=Math.floor(c/r);p<=d;){var h=i[p].mediaRange,v=i[p].mediaURLs,m=p*o+this._periodStart,b={id:String(p),time:m,isInit:!1,range:h,duration:o,timescale:1,end:m+o,mediaURLs:v,timestampOffset:-n.indexTimeOffset/a};f.push(b),p++}return f},t.shouldRefresh=function(e,t){var n=this._index,r=n.timescale,i=n.duration,a=n.list,o=t*r,s=Math.floor(o/i);return s<0||s>=a.length},t.getFirstPosition=function(){return this._periodStart},t.getLastPosition=function(){var e=this._index,t=e.duration;return e.list.length*t/e.timescale+this._periodStart},t.isSegmentStillAvailable=function(){return!0},t.checkDiscontinuity=function(){return null},t.areSegmentsChronologicallyGenerated=function(){return!0},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){return!0},t.isInitialized=function(){return!0},t._replace=function(e){this._index=e._index},t._update=function(){b.a.error("List RepresentationIndex: Cannot update a SegmentList")},e}(),ke=n(180),Ae=n(124),xe=n(122),Ie=n(123);function Me(e,t,n,r){var i=e.start,a=e.duration,o=e.repeatCount;return null==i&&(null==t?i=r:null!=t.duration&&(i=t.start+t.duration*(t.repeatCount+1))),null!=a&&!isNaN(a)||null==n||null==n.start||isNaN(n.start)||null==i||isNaN(i)||(a=n.start-i),null==i||isNaN(i)||null==a||isNaN(a)||null!=o&&isNaN(o)?(b.a.warn('DASH: A "S" Element could not have been parsed.'),null):{start:i,duration:a,repeatCount:void 0===o?0:o}}function Re(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"t":var i=parseInt(r.value,10);isNaN(i)?b.a.warn('DASH: invalid t ("'+r.value+'")'):t.start=i;break;case"d":var a=parseInt(r.value,10);isNaN(a)?b.a.warn('DASH: invalid d ("'+r.value+'")'):t.duration=a;break;case"r":var o=parseInt(r.value,10);isNaN(o)?b.a.warn('DASH: invalid r ("'+r.value+'")'):t.repeatCount=o}}return t}function Ce(e,t){for(var n=[],r=0;r<e.length;r++)n.push(Re(e[r]));for(var i=[],a=0;a<n.length;a++){var o=Me(n[a],void 0===i[i.length-1]?null:i[i.length-1],void 0===n[a+1]?null:n[a+1],t);null!=o&&i.push(o)}return i}function Ne(e,t,n){var r,i=function(e,t){if(0===e.length||0===t.length)return null;var n=e[0].start,r=t[0].getAttribute("t"),i=null===r?null:parseInt(r,10);if(null===i||Number.isNaN(i))return null;if(n===i)return{prevSegmentsIdx:0,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(n<i)for(var a=e[0],o=0;;){if(a.repeatCount>0){var s=i-a.start;if(s%a.duration==0&&s/a.duration<=a.repeatCount)return{repeatNumberInPrevSegments:s/a.duration,prevSegmentsIdx:o,newElementsIdx:0,repeatNumberInNewElements:0}}if(++o>=e.length)return null;if((a=e[o]).start===i)return{prevSegmentsIdx:o,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(a.start>i)return null}else for(var u=0,c=t[0],l=i;;){var d=c.getAttribute("d"),f=null===d?null:parseInt(d,10);if(null===f||Number.isNaN(f))return null;var p=c.getAttribute("r"),h=null===p?null:parseInt(p,10);if(null!==h){if(Number.isNaN(h)||h<0)return null;if(h>0){var v=n-l;if(v%f==0&&v/f<=h)return{repeatNumberInPrevSegments:0,repeatNumberInNewElements:v/f,prevSegmentsIdx:0,newElementsIdx:u}}l+=f*(h+1)}else l+=f;if(++u>=t.length)return null;var m=(c=t[u]).getAttribute("t"),b=null===m?null:parseInt(m,10);if(null!==b){if(Number.isNaN(b))return null;l=b}if(l===n)return{newElementsIdx:u,prevSegmentsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(l>i)return null}}(t,e);if(null===i)return b.a.warn('DASH: Cannot perform "based" update. Common segment not found.'),Ce(e,n);var a=i.prevSegmentsIdx,o=i.newElementsIdx,s=i.repeatNumberInPrevSegments,u=i.repeatNumberInNewElements,c=t.length-a+o-1;if(c>=e.length)return b.a.info('DASH: Cannot perform "based" update. New timeline too short'),Ce(e,n);var l=t.slice(a);if(s>0){var d=l[0];d.start+=d.duration*s,l[0].repeatCount-=s}if(u>0&&0!==o)return b.a.info('DASH: Cannot perform "based" update. The new timeline has a different form.'),Ce(e,n);var f=l[l.length-1],p=Re(e[c]),h=(null!==(r=p.repeatCount)&&void 0!==r?r:0)-u;if(p.duration!==f.duration||f.repeatCount>h)return b.a.info('DASH: Cannot perform "based" update. The new timeline has a different form at the beginning.'),Ce(e,n);void 0!==p.repeatCount&&p.repeatCount>f.repeatCount&&(f.repeatCount=p.repeatCount);for(var v=[],m=[],g=c+1;g<e.length;g++)m.push(Re(e[g]));for(var y=0;y<m.length;y++){var _=Me(m[y],void 0===v[v.length-1]?f:v[v.length-1],void 0===m[y+1]?null:m[y+1],n);null!==_&&v.push(_)}return l.concat(v)}var Pe=m.a.MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY,De=function(){function e(t,n,r){var i,a=r.manifestBoundsCalculator,o=r.isDynamic,s=r.representationBaseURLs,u=r.representationId,c=r.representationBitrate,l=r.periodStart,d=r.periodEnd,f=null!==(i=t.timescale)&&void 0!==i?i:1,p=(null!=t.presentationTimeOffset?t.presentationTimeOffset:0)-l*f;this._manifestBoundsCalculator=a,this._lastUpdate=null==r.receivedTime?performance.now():r.receivedTime,this._unsafelyBaseOnPreviousIndex=null,null!==r.unsafelyBaseOnPreviousRepresentation&&r.unsafelyBaseOnPreviousRepresentation.index instanceof e&&(r.unsafelyBaseOnPreviousRepresentation.index._unsafelyBaseOnPreviousIndex=null,this._unsafelyBaseOnPreviousIndex=r.unsafelyBaseOnPreviousRepresentation.index),this._isDynamic=o,this._parseTimeline=n,this._index={indexRange:t.indexRange,indexTimeOffset:p,initialization:null==t.initialization?void 0:{mediaURLs:_e(s,t.initialization.media,u,c),range:t.initialization.range},mediaURLs:_e(s,t.media,u,c),startNumber:t.startNumber,timeline:null,timescale:f},this._scaledPeriodStart=Object(be.f)(l,this._index),this._scaledPeriodEnd=null==d?void 0:Object(be.f)(d,this._index)}var t=e.prototype;return t.getInitSegment=function(){return ge(this._index)},t.getSegments=function(e,t){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var n=this._index;return Ee({mediaURLs:n.mediaURLs,startNumber:n.startNumber,timeline:n.timeline,timescale:n.timescale,indexTimeOffset:n.indexTimeOffset},e,t,this._scaledPeriodEnd)},t.shouldRefresh=function(){return!1},t.getFirstPosition=function(){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var e=this._index.timeline;return 0===e.length?null:Object(be.c)(e[0].start,this._index)},t.getLastPosition=function(){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var t=e.getIndexEnd(this._index.timeline,this._scaledPeriodStart);return null===t?null:Object(be.c)(t,this._index)},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var t=this._index,n=t.timeline,r=t.timescale,i=t.indexTimeOffset;return Object(xe.a)(e,n,r,i)},t.checkDiscontinuity=function(e){this._refreshTimeline();var t=this._index.timeline;return null===t&&(t=this._getTimeline(),this._index.timeline=t),Object(be.b)({timeline:t,timescale:this._index.timescale,indexTimeOffset:this._index.indexTimeOffset},e,this._scaledPeriodEnd)},t.canBeOutOfSyncError=function(e){return!!this._isDynamic&&(e instanceof ke.a&&e.isHttpError(404))},t.areSegmentsChronologicallyGenerated=function(){return!0},t._replace=function(e){this._parseTimeline=e._parseTimeline,this._index=e._index,this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate,this._manifestBoundsCalculator=e._manifestBoundsCalculator},t._update=function(e){null===this._index.timeline&&(this._index.timeline=this._getTimeline()),null===e._index.timeline&&(e._index.timeline=e._getTimeline()),Object(Ie.a)(this._index.timeline,e._index.timeline),this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate},t.isFinished=function(){if(!this._isDynamic)return!0;null===this._index.timeline&&(this._index.timeline=this._getTimeline());var e=this._index.timeline;if(null==this._scaledPeriodEnd||0===e.length)return!1;var t=e[e.length-1];return Object(be.d)(t,null,this._scaledPeriodEnd)+1/60>=this._scaledPeriodEnd},t.isInitialized=function(){return!0},t._refreshTimeline=function(){null===this._index.timeline&&(this._index.timeline=this._getTimeline());var e=this._manifestBoundsCalculator.getMinimumBound();if(null!=e){var t=Object(be.f)(e,this._index);Object(Ae.a)(this._index.timeline,t)}},e.getIndexEnd=function(e,t){return e.length<=0?null:Object(be.d)(e[e.length-1],null,t)},t._getTimeline=function(){if(null===this._parseTimeline)return null!==this._index.timeline?this._index.timeline:(b.a.error("DASH: Timeline already lazily parsed."),[]);var e,t=this._parseTimeline();return this._parseTimeline=null,null===this._unsafelyBaseOnPreviousIndex||t.length<Pe?Ce(t,this._scaledPeriodStart):(null===this._unsafelyBaseOnPreviousIndex._index.timeline?(e=this._unsafelyBaseOnPreviousIndex._getTimeline(),this._unsafelyBaseOnPreviousIndex._index.timeline=e):e=this._unsafelyBaseOnPreviousIndex._index.timeline,this._unsafelyBaseOnPreviousIndex=null,Ne(t,e,this._scaledPeriodStart))},e}(),Le=m.a.MINIMUM_SEGMENT_SIZE,Be=function(){function e(e,t){var n,r=t.aggressiveMode,i=t.availabilityTimeOffset,a=t.manifestBoundsCalculator,o=t.isDynamic,s=t.periodEnd,u=t.periodStart,c=t.representationBaseURLs,l=t.representationId,d=t.representationBitrate,f=null!==(n=e.timescale)&&void 0!==n?n:1;this._availabilityTimeOffset=i,this._manifestBoundsCalculator=a,this._aggressiveMode=r;var p=null!=e.presentationTimeOffset?e.presentationTimeOffset:0,h=p-u*f;if(void 0===e.duration)throw new Error("Invalid SegmentTemplate: no duration");this._index={duration:e.duration,timescale:f,indexRange:e.indexRange,indexTimeOffset:h,initialization:null==e.initialization?void 0:{mediaURLs:_e(c,e.initialization.media,l,d),range:e.initialization.range},mediaURLs:_e(c,e.media,l,d),presentationTimeOffset:p,startNumber:e.startNumber},this._isDynamic=o,this._periodStart=u,this._relativePeriodEnd=null==s?void 0:s-u}var t=e.prototype;return t.getInitSegment=function(){return ge(this._index)},t.getSegments=function(e,t){var n=this._index,r=n.duration,i=n.startNumber,a=n.timescale,o=n.mediaURLs,s=this._periodStart*a,u=null==this._relativePeriodEnd?void 0:this._relativePeriodEnd*a,c=e*a-s,l=(e+t)*a-s,d=this._getFirstSegmentStart(),f=this._getLastSegmentStart();if(null==d||null==f)return[];var p=Math.max(d,c),h=Math.min(f,l);if(h+r<=p)return[];for(var v=[],m=null==i?1:i,b=Math.floor(p/r),g=b*r;g<=h;g+=r){var y=b+m,_=null!=u&&g+r>u?u-g:r,O=g+s,T=g+this._index.presentationTimeOffset,E=null===o?null:o.map(Te(T,y)),w={id:String(y),number:y,time:O/a,end:(O+_)/a,duration:_/a,timescale:1,isInit:!1,scaledDuration:_/a,mediaURLs:E,timestampOffset:-n.indexTimeOffset/a};v.push(w),b++}return v},t.getFirstPosition=function(){var e=this._getFirstSegmentStart();return null==e?e:e/this._index.timescale+this._periodStart},t.getLastPosition=function(){var e=this._getLastSegmentStart();return null==e?e:(e+this._index.duration)/this._index.timescale+this._periodStart},t.shouldRefresh=function(){return!1},t.checkDiscontinuity=function(){return null},t.areSegmentsChronologicallyGenerated=function(){return!0},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;var t=this.getSegments(e.time,.1);return 0!==t.length&&(t[0].time===e.time&&t[0].end===e.end&&t[0].number===e.number)},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){if(!this._isDynamic)return!0;if(null==this._relativePeriodEnd)return!1;var e=this._index.timescale,t=this._getLastSegmentStart();return null!=t&&t+this._index.duration+1/60*e>=this._relativePeriodEnd*e},t.isInitialized=function(){return!0},t._replace=function(e){this._index=e._index,this._aggressiveMode=e._aggressiveMode,this._isDynamic=e._isDynamic,this._periodStart=e._periodStart,this._relativePeriodEnd=e._relativePeriodEnd,this._manifestBoundsCalculator=e._manifestBoundsCalculator},t._update=function(e){this._replace(e)},t._getFirstSegmentStart=function(){if(!this._isDynamic)return 0;if(0===this._relativePeriodEnd||null==this._relativePeriodEnd){var e=this._manifestBoundsCalculator.getMaximumBound();if(void 0!==e&&e<this._periodStart)return null}var t=this._index,n=t.duration,r=t.timescale,i=this._manifestBoundsCalculator.getMinimumBound();if(void 0!==i){var a=i>this._periodStart?(i-this._periodStart)*r:0;return Math.floor(a/n)*n}},t._getLastSegmentStart=function(){var e=this._index,t=e.duration,n=e.timescale;if(this._isDynamic){var r=this._manifestBoundsCalculator.getMaximumBound();if(void 0===r)return;var i=this._aggressiveMode?t/n:0;if(null!=this._relativePeriodEnd&&this._relativePeriodEnd<r+i-this._periodStart){var a=this._relativePeriodEnd*n;return a<t?null:(Math.floor(a/t)-1)*t}var o=(r-this._periodStart)*n;if(o<0)return null;var s=((void 0!==this._availabilityTimeOffset?this._availabilityTimeOffset:0)+i)*n,u=Math.floor((o+s)/t);return u<=0?null:(u-1)*t}var c=(void 0===this._relativePeriodEnd?0:this._relativePeriodEnd)*n,l=Math.ceil(c/t)-1,d=l*t;return c-d>Le*n||0===l?d:(l-1)*t},e}();function Ue(e,t){var n=[];if(0===t.length)return e;if(0===e.length){for(var r=0;r<t.length;r++)Object(pe.a)(n,t[r].value)||n.push(t[r].value);return n}for(var i=0;i<e.length;i++)for(var a=e[i],o=0;o<t.length;o++){var s=Object(y.a)(a,t[o].value);Object(pe.a)(n,s)||n.push(s)}return n}function Fe(e,t,n){for(var r,i,a=[],o=function(o){for(var s=e[o],u=null!=s.attributes.id?s.attributes.id:String(s.attributes.bitrate)+(null!=s.attributes.height?"-"+s.attributes.height:"")+(null!=s.attributes.width?"-"+s.attributes.width:"")+(null!=s.attributes.mimeType?"-"+s.attributes.mimeType:"")+(null!=s.attributes.codecs?"-"+s.attributes.codecs:"");a.some((function(e){return e.id===u}));)u+="-dup";var c=null!==(i=null===(r=n.unsafelyBaseOnPreviousAdaptation)||void 0===r?void 0:r.getRepresentation(u))&&void 0!==i?i:null,l=function(e,t){var n,r,i,a=Ue(t.baseURLs,e.children.baseURLs),o=t.aggressiveMode,s=t.availabilityTimeOffset,u=t.manifestBoundsCalculator,c=t.isDynamic,l=t.end,d=t.start,f=t.receivedTime,p=t.timeShiftBufferDepth,h={aggressiveMode:o,availabilityTimeOffset:s,unsafelyBaseOnPreviousRepresentation:t.unsafelyBaseOnPreviousRepresentation,manifestBoundsCalculator:u,isDynamic:c,periodEnd:l,periodStart:d,receivedTime:f,representationBaseURLs:a,representationBitrate:e.attributes.bitrate,representationId:e.attributes.id,timeShiftBufferDepth:p};if(void 0!==e.children.segmentBase){var v=e.children.segmentBase;h.availabilityTimeOffset=t.availabilityTimeOffset+_(e.children.baseURLs)+(null!==(n=v.availabilityTimeOffset)&&void 0!==n?n:0),i=new Se(v,h)}else if(void 0!==e.children.segmentList){var m=e.children.segmentList;i=new je(m,h)}else if(void 0!==e.children.segmentTemplate||t.parentSegmentTemplates.length>0){var b=t.parentSegmentTemplates.slice(),g=e.children.segmentTemplate;void 0!==g&&b.push(g);var y=J.a.apply(void 0,[{}].concat(b));h.availabilityTimeOffset=t.availabilityTimeOffset+_(e.children.baseURLs)+(null!==(r=y.availabilityTimeOffset)&&void 0!==r?r:0);var O=y.timelineParser;i=void 0!==O?new De(y,O,h):new Be(y,h)}else{var T=t.adaptation.children;if(void 0!==T.segmentBase){var E=T.segmentBase;i=new Se(E,h)}else if(void 0!==T.segmentList){var w=T.segmentList;i=new je(w,h)}else i=new Be({duration:Number.MAX_VALUE,timescale:1,startNumber:0,initialization:{media:""},media:""},h)}return i}(s,Object(J.a)({},n,{unsafelyBaseOnPreviousRepresentation:c,adaptation:t})),d=void 0;null==s.attributes.bitrate?(b.a.warn("DASH: No usable bitrate found in the Representation."),d=0):d=s.attributes.bitrate;var f={bitrate:d,index:l,id:u},p=void 0;if(null!=s.attributes.codecs?p=s.attributes.codecs:null!=t.attributes.codecs&&(p=t.attributes.codecs),null!=p&&(p="mp4a.40.02"===p?"mp4a.40.2":p,f.codecs=p),null!=s.attributes.frameRate?f.frameRate=s.attributes.frameRate:null!=t.attributes.frameRate&&(f.frameRate=t.attributes.frameRate),null!=s.attributes.height?f.height=s.attributes.height:null!=t.attributes.height&&(f.height=t.attributes.height),null!=s.attributes.mimeType?f.mimeType=s.attributes.mimeType:null!=t.attributes.mimeType&&(f.mimeType=t.attributes.mimeType),null!=s.attributes.width?f.width=s.attributes.width:null!=t.attributes.width&&(f.width=t.attributes.width),null!=t.children.contentProtections){var h=t.children.contentProtections.reduce((function(e,t){var n;if(void 0!==t.attributes.schemeIdUri&&"urn:uuid:"===t.attributes.schemeIdUri.substring(0,9)&&(n=t.attributes.schemeIdUri.substring(9).replace(/-/g,"").toLowerCase()),void 0!==t.attributes.keyId&&t.attributes.keyId.length>0&&e.keyIds.push({keyId:t.attributes.keyId,systemId:n}),void 0!==n)for(var r=t.children.cencPssh,i=0;i<r.length;i++){var a=r[i];void 0===e.initData.cenc&&(e.initData.cenc=[]),e.initData.cenc.push({systemId:n,data:a})}return e}),{keyIds:[],initData:{}});(Object.keys(h.initData).length>0||h.keyIds.length>0)&&(f.contentProtections=h)}a.push(f)},s=0;s<e.length;s++)o(s);return a}function Ve(e){return null!=e&&("urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"1"===e.value)}function ze(e){return null!=e&&("urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"2"===e.value)}function Ke(e){return null!=e&&("urn:mpeg:dash:role:2011"===e.schemeIdUri&&"sign"===e.value)}function $e(e,t){if(Object(C.a)(e.attributes.id))return e.attributes.id;var n=t.type;return Object(C.a)(e.attributes.language)&&(n+="-"+e.attributes.language),!0===t.isClosedCaption&&(n+="-cc"),!0===t.isAudioDescription&&(n+="-ad"),!0===t.isSignInterpreted&&(n+="-si"),Object(C.a)(e.attributes.contentType)&&(n+="-"+e.attributes.contentType),Object(C.a)(e.attributes.codecs)&&(n+="-"+e.attributes.codecs),Object(C.a)(e.attributes.mimeType)&&(n+="-"+e.attributes.mimeType),Object(C.a)(e.attributes.frameRate)&&(n+="-"+e.attributes.frameRate),n}function He(e){if(null!=e.children.supplementalProperties)for(var t=e.children.supplementalProperties,n=0;n<t.length;n++){var r=t[n];if("urn:mpeg:dash:adaptation-set-switching:2016"===r.schemeIdUri&&null!=r.value)return r.value.split(",").map((function(e){return e.trim()})).filter((function(e){return e}))}return[]}var We=Object(le.a)();function Ge(e,t){var n,r,i,a=[],o=function(e,t){var n=[];return e.forEach((function(r,i){var a,o;if(null!=r.attributes.start)a=r.attributes.start;else if(0===i)a=t.isDynamic&&null!=t.availabilityStartTime?t.availabilityStartTime:0;else{var s=n[n.length-1];if(null==s||null==s.periodEnd)throw new Error("Missing start time when parsing periods.");a=s.periodEnd}var u=e[i+1];null!=r.attributes.duration?o=r.attributes.duration:i===e.length-1?o=t.duration:null!=u.attributes.start&&(o=u.attributes.start-a);var c=null!=o?a+o:void 0;n.push({periodStart:a,periodDuration:o,periodEnd:c})})),n}(e,t);if(o.length!==e.length)throw new Error("MPD parsing error: the time information are incoherent.");var s=t.isDynamic,u=t.timeShiftBufferDepth,c=new fe({isDynamic:s,timeShiftBufferDepth:u});s||null==t.duration||c.setLastPosition(t.duration);for(var l=function(l){var d=e[l],f=t.xlinkInfos.get(d),p=Ue(t.baseURLs,d.children.baseURLs),h=o[l],v=h.periodStart,m=h.periodDuration,y=h.periodEnd,O=void 0;for(null==d.attributes.id?(b.a.warn("DASH: No usable id found in the Period. Generating one."),O="gen-dash-period-"+We()):O=d.attributes.id;a.some((function(e){return e.id===O}));)O+="-dup";var T=void 0!==f?f.receivedTime:t.receivedTime,E=_(d.children.baseURLs)+t.availabilityTimeOffset,w=null!==(r=null===(n=t.unsafelyBaseOnPreviousManifest)||void 0===n?void 0:n.getPeriod(O))&&void 0!==r?r:null,S={aggressiveMode:t.aggressiveMode,availabilityTimeOffset:E,baseURLs:p,manifestBoundsCalculator:c,end:y,isDynamic:s,receivedTime:T,segmentTemplate:d.children.segmentTemplate,start:v,timeShiftBufferDepth:u,unsafelyBaseOnPreviousPeriod:w},j=function(e,t){var n,r,i,a,o={},s={},u=[],c={};e.sort((function(e,t){var n,r,i=null!==(n=e.attributes.selectionPriority)&&void 0!==n?n:1;return(null!==(r=t.attributes.selectionPriority)&&void 0!==r?r:1)-i}));for(var l=0;l<e.length;l++){var d=e[l],f=d.children,p=f.essentialProperties,h=f.roles;if(!Array.isArray(p)||!p.some((function(e){return"http://dashif.org/guidelines/trickmode"===e.schemeIdUri}))){var v=Array.isArray(h)&&h.some((function(e){return"main"===e.value}))&&h.some((function(e){return"urn:mpeg:dash:role:2011"===e.schemeIdUri})),m=d.children.representations,y=_(d.children.baseURLs)+t.availabilityTimeOffset,O=d.attributes.mimeType,T=d.attributes.codecs,E=me(m,Object(C.a)(O)?O:null,Object(C.a)(T)?T:null,null!=f.roles?f.roles:null);if(void 0!==E){var w=d.attributes.id,S=void 0,j=He(d),k=[];void 0!==t.segmentTemplate&&k.push(t.segmentTemplate),void 0!==d.children.segmentTemplate&&k.push(d.children.segmentTemplate);var A={aggressiveMode:t.aggressiveMode,availabilityTimeOffset:y,baseURLs:Ue(t.baseURLs,f.baseURLs),manifestBoundsCalculator:t.manifestBoundsCalculator,end:t.end,isDynamic:t.isDynamic,parentSegmentTemplates:k,receivedTime:t.receivedTime,start:t.start,timeShiftBufferDepth:t.timeShiftBufferDepth,unsafelyBaseOnPreviousAdaptation:null};if("video"===E&&v&&void 0!==o.video&&o.video.length>0&&void 0!==c.video){var x,I=o.video[c.video];A.unsafelyBaseOnPreviousAdaptation=null!==(r=null===(n=t.unsafelyBaseOnPreviousPeriod)||void 0===n?void 0:n.getAdaptation(I.id))&&void 0!==r?r:null;var M=Fe(m,d,A);(x=I.representations).push.apply(x,M),S=I.id}else{var R=f.accessibility,N=void 0;void 0!==h&&h.some((function(e){return"dub"===e.value}))&&(N=!0);for(var P=!("text"!==E||null==R||!ze(R))||void 0,D=!("audio"!==E||null==R||!Ve(R))||void 0,L=!("video"!==E||null==R||!Ke(R))||void 0,B=$e(d,{isAudioDescription:D,isClosedCaption:P,isSignInterpreted:L,type:E});Object(pe.a)(u,B);)B+="-dup";S=B,u.push(B),A.unsafelyBaseOnPreviousAdaptation=null!==(a=null===(i=t.unsafelyBaseOnPreviousPeriod)||void 0===i?void 0:i.getAdaptation(B))&&void 0!==a?a:null;var U={id:B,representations:Fe(m,d,A),type:E};null!=d.attributes.language&&(U.language=d.attributes.language),null!=P&&(U.closedCaption=P),null!=D&&(U.audioDescription=D),!0===N&&(U.isDub=!0),!0===L&&(U.isSignInterpreted=!0);var F=o[E];if(void 0===F)o[E]=[U],v&&(c[E]=0);else{for(var V=null,z=function(e){var t=j[e],n=s[t];if(null!=n&&n.newID!==S&&Object(pe.a)(n.adaptationSetSwitchingIDs,w)){var r,i=Object(g.a)(F,(function(e){return e.id===t}));null!=i&&i.audioDescription===U.audioDescription&&i.closedCaption===U.closedCaption&&i.language===U.language&&(b.a.info('DASH Parser: merging "switchable" AdaptationSets',w,t),(r=i.representations).push.apply(r,U.representations),V=i)}},K=0;K<j.length;K++)z(K);if(v){var $=c[E],H=void 0===$?0:$+1;if(null===V)F.splice(H,0,U),c[E]=H;else{var W=F.indexOf(V);W<0?(F.splice(H,0,U),c[E]=H):(void 0===$||W>$)&&(F.splice(W,1),F.splice(H,0,V),c[E]=H)}}else null===V&&F.push(U)}}null!=w&&null==s[w]&&(s[w]={newID:S,adaptationSetSwitchingIDs:j})}}}return o}(d.children.adaptations,S),k=null===(i=d.children.streamEvents)||void 0===i?void 0:i.map((function(e){var t,n=(null!==(t=e.eventPresentationTime)&&void 0!==t?t:0)/e.timescale+v;return{start:n,end:void 0!==e.duration?n+e.duration/e.timescale:void 0,data:e.data,id:e.id}})),A={id:O,start:v,end:y,duration:m,adaptations:j,streamEvents:k};if(a.unshift(A),!c.lastPositionIsKnown()){var x=function(e){for(var t=null,n=!0,r=Object(de.a)(e).filter((function(e){return null!=e})),i=Object(ce.a)(r,(function(e){return e})),a=0;a<i.length;a++)for(var o=i[a].representations,s=0;s<o.length;s++){var u=o[s].index.getLastPosition();null!==u&&(n=!1,"number"==typeof u&&(t=null==t?u:Math.max(t,u)))}if(null!=t)return t;if(n)return null;return}(j);if(s)if("number"==typeof x){var I=performance.now()/1e3;c.setLastPosition(x,I)}else{var M=Ye(t,v);if(void 0!==M){var R=M[0],N=M[1];c.setLastPosition(R,N)}}else"number"==typeof x&&c.setLastPosition(x)}},d=e.length-1;d>=0;d--)l(d);if(t.isDynamic&&!c.lastPositionIsKnown()){var f=Ye(t,0);if(void 0!==f){var p=f[0],h=f[1];c.setLastPosition(p,h)}}return function(e){if(0===e.length)return[];for(var t=[e[0]],n=1;n<e.length;n++){for(var r=e[n],i=t[t.length-1];null==i.duration||i.start+i.duration>r.start;)b.a.warn("DASH: Updating overlapping Periods.",i,r),i.duration=r.start-i.start,i.end=r.start,i.duration<=0&&(t.pop(),i=t[t.length-1]);t.push(r)}return t}(a)}function Ye(e,t){if(null!=e.clockOffset){var n=e.clockOffset/1e3-e.availabilityStartTime,r=performance.now()/1e3,i=r+n;if(i>=t)return[i,r]}else{var a=Date.now()/1e3;if(a>=t)return b.a.warn("DASH Parser: no clock synchronization mechanism found. Using the system clock instead."),[a-e.availabilityStartTime,performance.now()/1e3]}}var qe=m.a.DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0;function Xe(e,t){var n=ue(e);return Qe(n[0],t,n[1])}function Qe(e,t,n,r){var i=e.children,a=e.attributes,o=new WeakMap;if(null==t.externalClockOffset){var s="dynamic"===a.type,u=Object(g.a)(i.utcTimings,(function(e){return"urn:mpeg:dash:utc:direct:2014"===e.schemeIdUri&&null!=e.value})),c=null!=u&&null!=u.value?O(u.value):void 0,l=null==c||isNaN(c)?void 0:c;if(null!=l)t.externalClockOffset=l;else if(s&&!0!==r){var d=function(e){var t=e.children.utcTimings.filter((function(e){return"urn:mpeg:dash:utc:http-iso:2014"===e.schemeIdUri&&void 0!==e.value}));return t.length>0?t[0].value:void 0}(e);if(null!=d&&d.length>0)return{type:"needs-ressources",value:{ressources:[d],continue:function(r){if(1!==r.length)throw new Error("DASH parser: wrong number of loaded ressources.");return l=O(r[0].responseData),t.externalClockOffset=l,Qe(e,t,n,!0)}}}}}for(var f=[],p=0;p<i.periods.length;p++){var h=i.periods[p].attributes,v=h.xlinkHref,m=h.xlinkActuate;null!=v&&"onLoad"===m&&f.push({index:p,ressource:v})}return 0===f.length?function(e,t,n,r){var i,a,o,s,u,c=e.children,l=e.attributes,d="dynamic"===l.type,f=Ue(void 0===t.url?[]:[Object(y.b)(t.url)],c.baseURLs),p=function(e,t){return"dynamic"!==e.type?0:null==e.availabilityStartTime?null==t?0:t:e.availabilityStartTime}(l,t.referenceDateTime),h=l.timeShiftBufferDepth,v=t.externalClockOffset,m=t.unsafelyBaseOnPreviousManifest,g=_(c.baseURLs),O={aggressiveMode:t.aggressiveMode,availabilityStartTime:p,availabilityTimeOffset:g,baseURLs:f,clockOffset:v,duration:l.duration,isDynamic:d,receivedTime:t.manifestReceivedTime,timeShiftBufferDepth:h,unsafelyBaseOnPreviousManifest:m,xlinkInfos:r},T=Ge(c.periods,O),w=l.duration,j=null;void 0!==l.minimumUpdatePeriod&&l.minimumUpdatePeriod>=0&&(o=0===l.minimumUpdatePeriod?qe:l.minimumUpdatePeriod);var k=function(e){if(0===e.length)throw new Error("DASH Parser: no period available for a dynamic content");return[S(e),E(e)]}(T),A=k[0],x=k[1],I=performance.now();if(d){var M;if(s=A,j=null!=h?h:null,void 0!==x)M=x;else{var R=null!=p?p:0,C=t.externalClockOffset;if(void 0===C)b.a.warn("DASH Parser: use system clock to define maximum position"),M=Date.now()/1e3-R;else M=(performance.now()+C)/1e3-R}u={isLinear:!0,value:M,time:I},null!==j&&void 0!==s&&M-s>j&&(j=M-s)}else{var N;if(s=void 0!==A?A:void 0!==(null===(i=T[0])||void 0===i?void 0:i.start)?T[0].start:0,void 0!==x)N=x;else if(void 0!==w)N=w;else if(void 0!==T[T.length-1]){var P=T[T.length-1];N=null!==(a=P.end)&&void 0!==a?a:void 0!==P.duration?P.start+P.duration:void 0}u={isLinear:!1,value:null!=N?N:1/0,time:I}}return{type:"done",value:{parsed:{availabilityStartTime:p,clockOffset:t.externalClockOffset,isDynamic:d,isLive:d,periods:T,suggestedPresentationDelay:l.suggestedPresentationDelay,transportType:"dash",timeBounds:{absoluteMinimumTime:s,timeshiftDepth:j,maximumTimeData:u},lifetime:o,uris:null==t.url?c.locations:[t.url].concat(c.locations)},warnings:n}}}(e,t,n,o):{type:"needs-ressources",value:{ressources:f.map((function(e){return e.ressource})),continue:function(r){if(r.length!==f.length)throw new Error("DASH parser: wrong number of loaded ressources.");for(var a=r.length-1;a>=0;a--){var s,u=f[a].index,c=r[a],l=c.responseData,d=c.receivedTime,p=c.sendingTime,h=c.url,v="<root>"+l+"</root>",m=(new DOMParser).parseFromString(v,"text/xml");if(null==m||0===m.children.length)throw new Error("DASH parser: Invalid external ressources");for(var b=m.children[0].children,g=[],y=0;y<b.length;y++)if(b[y].nodeType===Node.ELEMENT_NODE){var _=se(b[y]),O=_[0],T=_[1];o.set(O,{receivedTime:d,sendingTime:p,url:h}),g.push(O),T.length>0&&n.push.apply(n,T)}(s=i.periods).splice.apply(s,[u,1].concat(g))}return Qe(e,t,n)}}}}var Ze=function(e,t){var n=e.documentElement;if(null==n||"MPD"!==n.nodeName)throw new Error("DASH Parser: document root should be MPD");return Xe(n,t)},Je=n(125);function et(e){var t=e.aggressiveMode,n=e.referenceDateTime,r=void 0!==e.serverSyncInfos?e.serverSyncInfos.serverTimestamp-e.serverSyncInfos.clientTime:void 0;return function(a){var s,u=a.response,c=a.scheduleRequest,m=a.externalClockOffset,b=a.url,g=null!==(s=u.url)&&void 0!==s?s:b,y="string"==typeof u.responseData?(new DOMParser).parseFromString(u.responseData,"text/xml"):u.responseData,_=null!=r?r:m,O=a.unsafeMode?a.previousManifest:null;return function t(n){if("done"===n.type){var r=n.value,a=r.warnings,s=r.parsed,u=a.map((function(e){return{type:"warning",value:e}})),m=new v.a(s,e);return Object(l.a)(i.a.apply(void 0,u),Object(Je.a)(m,g))}var b=n.value,y=b.ressources,_=b.continue,O=y.map((function(e){return c((function(){return function(e){return Object(o.a)({url:e,responseType:"text"}).pipe(Object(f.a)((function(e){return"data-loaded"===e.type})),Object(p.a)((function(e){return e.value})))}(e)}))}));return Object(d.a)(O).pipe(Object(h.a)((function(e){for(var n=[],r=0;r<e.length;r++){var i=e[r];if("string"!=typeof i.responseData)throw new Error("External DASH resources should only be strings");n.push(Object(J.a)(i,{responseData:i.responseData}))}return t(_(n))})))}(Ze(y,{aggressiveMode:!0===t,unsafelyBaseOnPreviousManifest:O,url:g,referenceDateTime:n,externalClockOffset:_}))}}var tt=n(12),nt=n(95),rt=n(21),it=n(52);function at(e){return"video/webm"===e.mimeType||"audio/webm"===e.mimeType}var ot=n(156),st=n(100);function ut(e){return function(t){return e(t).pipe(Object(ot.a)((function(e){"data-loaded"!==e.type&&"data-chunk"!==e.type||null===e.value.responseData||"string"==typeof e.value.responseData||at(t.representation)||Object(st.a)(new Uint8Array(e.value.responseData),t.segment.isInit)})))}}var ct=n(1);function lt(e,t){var n=t.segment;if(void 0===n.range)return Object(o.a)({url:e,responseType:"arraybuffer",sendProgressEvents:!0});if(void 0===n.indexRange)return Object(o.a)({url:e,headers:{Range:Object(it.a)(n.range)},responseType:"arraybuffer",sendProgressEvents:!0});if(n.range[1]+1===n.indexRange[0])return Object(o.a)({url:e,headers:{Range:Object(it.a)([n.range[0],n.indexRange[1]])},responseType:"arraybuffer",sendProgressEvents:!0});var r=Object(o.a)({url:e,headers:{Range:Object(it.a)(n.range)},responseType:"arraybuffer",sendProgressEvents:!1}),i=Object(o.a)({url:e,headers:{Range:Object(it.a)(n.indexRange)},responseType:"arraybuffer",sendProgressEvents:!1});return Object(d.a)([r,i]).pipe(Object(p.a)((function(t){var n=t[0],r=t[1],i=Object(ct.e)(new Uint8Array(n.value.responseData),new Uint8Array(r.value.responseData)),a=Math.min(n.value.sendingTime,r.value.sendingTime),o=Math.max(n.value.receivedTime,r.value.receivedTime);return{type:"data-loaded",value:{url:e,responseData:i,size:n.value.size+r.value.size,duration:o-a,sendingTime:a,receivedTime:o}}})))}var dt=n(241),ft=n(81);function pt(e,t){var n=t.segment,r=void 0!==n.range?{Range:Object(it.a)(n.range)}:void 0;return Object(nt.a)({url:e,headers:r}).pipe(Object(dt.a)((function(e,t){if("data-complete"===t.type)return null!==e.partialChunk&&b.a.warn("DASH Pipelines: remaining chunk does not belong to any segment"),{event:t,completeChunks:[],partialChunk:null};var n=new Uint8Array(t.value.chunk),r=function(e){for(var t=0,n=[];t<e.length;){var r=e.subarray(t,1/0),i=Object(ft.a)(r,1836019558);if(i<0)return[n,r];var a=t+i+Object(ct.c)(e,i+t);if(a>e.length)return[n,r];var o=Object(ft.a)(r,1835295092);if(o<0)return[n,r];var s=t+o+Object(ct.c)(e,o+t);if(s>e.length)return[n,r];var u=Math.max(a,s),c=e.subarray(t,u);n.push(c),t=u}return[n,null]}(null!==e.partialChunk?Object(ct.e)(e.partialChunk,n):n);return{event:t,completeChunks:r[0],partialChunk:r[1]}}),{event:null,completeChunks:[],partialChunk:null}),Object(h.a)((function(e){for(var t=[],n=0;n<e.completeChunks.length;n++)t.push({type:"data-chunk",value:{responseData:e.completeChunks[n]}});var r=e.event;if(null!==r&&"data-chunk"===r.type){var a=r.value;t.push({type:"progress",value:{duration:a.duration,size:a.size,totalSize:a.totalSize}})}else if(null!==r&&"data-complete"===r.type){var o=r.value;t.push({type:"data-chunk-complete",value:{duration:o.duration,receivedTime:o.receivedTime,sendingTime:o.sendingTime,size:o.size,url:o.url}})}return i.a.apply(void 0,t)})))}function ht(e,t,n){if(t.segment.isInit)return lt(e,t);var r=at(t.representation);if(n&&!r){if(Object(nt.b)())return pt(e,t);Object(rt.a)("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}var i=t.segment;return Object(o.a)({url:e,responseType:"arraybuffer",sendProgressEvents:!0,headers:void 0!==i.range?{Range:Object(it.a)(i.range)}:void 0})}var vt=n(240),mt=n(239),bt=408125543,gt=357149030;function yt(e,t,n,r){for(var i=r[0],a=r[1],o=i;o<a;){var s=Et(n,o);if(null==s)return null;var u=s.value,c=o+s.length,l=wt(n,c);if(null==l)return null;var d=c+l.length,f=d+l.value;if(u===e)return[d,f];if(t.length>0)for(var p=0;p<t.length;p++){if(u===t[p])return yt(e,t.slice(p+1,t.length),n,[d,f])}o=f}return null}function _t(e,t){var n=yt(2807729,[bt,gt],e,[t,e.length]);if(null==n)return null;var r=n[1]-n[0];return 1e9/St(e,n[0],r)}function Ot(e,t){var n=yt(17545,[bt,gt],e,[t,e.length]);if(null==n)return null;var r=n[1]-n[0];return 4===r?function(e,t){return new DataView(e.buffer).getFloat32(t)}(e,n[0]):8===r?function(e,t){return new DataView(e.buffer).getFloat64(t)}(e,n[0]):null}function Tt(e,t){for(var n=1;n<=8;n++)if(e[t]>=Math.pow(2,8-n))return n}function Et(e,t){var n=Tt(e,t);if(null==n)return b.a.warn("webm: unrepresentable length"),null;if(t+n>e.length)return b.a.warn("webm: impossible length"),null;for(var r=0,i=0;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return{length:n,value:r}}function wt(e,t){var n=Tt(e,t);if(null==n)return b.a.warn("webm: unrepresentable length"),null;if(t+n>e.length)return b.a.warn("webm: impossible length"),null;for(var r=(e[t]&(1<<8-n)-1)*Math.pow(2,8*(n-1)),i=1;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return{length:n,value:r}}function St(e,t,n){for(var r=0,i=0;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return r}var jt=n(3);function kt(e,t,n,r){var i=Object(vt.d)(e);if(void 0===i||void 0===r)return null;var a,o=void 0!==n.timestampOffset?i+n.timestampOffset*r:i,s=Object(vt.a)(e);if(t)return{time:o/r,duration:void 0!==s?s/r:void 0};var u=n.duration*r,c=Math.min(.9*r,u/4);return void 0!==s&&Math.abs(s-u)<=c&&(a=s),{time:o/r,duration:void 0!==a?a/r:a}}function At(e){var t=e.__priv_patchLastSegmentInSidx;return function(e){var n=e.content,r=e.response,a=e.initTimescale,o=n.period,u=n.representation,c=n.segment,l=r.data,d=r.isChunked,f=[o.start,o.end];if(null===l){if(c.isInit){var p=u.getProtectionsInitializationData();return Object(i.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:p,initTimescale:void 0}})}return Object(i.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:null,chunkOffset:0,appendWindow:f}})}var h=l instanceof Uint8Array?l:new Uint8Array(l),v=at(u);if(!c.isInit){var m=v?null:kt(h,d,c,a),b=Object(s.a)(c.timestampOffset,0);return Object(i.a)({type:"parsed-segment",value:{chunkData:h,chunkInfos:m,chunkOffset:b,appendWindow:f}})}var g,y=c.indexRange;if(v)g=function(e,t){var n=yt(bt,[],e,[t,e.length]);if(null==n)return null;var r=n[0],i=n[1],a=_t(e,r);if(null==a)return null;var o=Ot(e,r);if(null==o)return null;var s=yt(475249515,[],e,[r,i]);if(null==s)return null;for(var u=[],c=s[0];c<s[1];){var l=yt(187,[],e,[c,s[1]]);if(null==l)break;var d=yt(179,[],e,[l[0],l[1]]);if(null==d)return null;var f=St(e,d[0],d[1]-d[0]),p=yt(241,[183],e,[l[0],l[1]]);if(null==p)return null;var h=St(e,p[0],p[1]-p[0])+r;u.push({time:f,rangeStart:h}),c=l[1]}for(var v=[],m=0;m<u.length;m++){var b=u[m];m===u.length-1?v.push({time:b.time,count:0,timescale:a,duration:0===m?o:o-b.time,range:[b.rangeStart,1/0]}):v.push({time:b.time,count:0,timescale:a,duration:u[m+1].time-b.time,range:[b.rangeStart,u[m+1].rangeStart-1]})}return v}(h,0);else if(g=Object(vt.c)(h,Array.isArray(y)?y[0]:0),!0===t&&null!==g&&g.length>0){var _=g[g.length-1];Array.isArray(_.range)&&(_.range[1]=1/0)}u.index instanceof Se&&null!==g&&g.length>0&&u.index._addSegments(g);var O=v?_t(h,0):Object(vt.b)(h),T=Object(jt.a)(O)?void 0:O;if(!v)for(var E=Object(mt.a)(h),w=0;w<E.length;w++){var S=E[w],j=S.systemID,k=S.data;u._addProtectionData("cenc",j,k)}var A=u.getProtectionsInitializationData();return Object(i.a)({type:"parsed-init-segment",value:{initializationData:h,segmentProtections:A,initTimescale:T}})}}function xt(e){return"application/mp4"===e.mimeType}var It=n(142);function Mt(e,t,n,r){var i,a,o=e.segment,s=e.adaptation,u=e.representation;if(o.isInit)return null;null===n?r?(i=o.time,a=o.end):b.a.warn("Transport: Unavailable time data for current text track."):(i=n.time,void 0!==n.duration?a=i+n.duration:r||(a=i+o.duration));var c=function(e){var t=e.codec;if(void 0===t)throw new Error("Cannot parse subtitles: unknown format");switch(t.toLowerCase()){case"stpp":case"stpp.ttml.im1t":return"ttml";case"wvtt":return"vtt"}throw new Error('The codec used for the subtitles "'+t+'" is not managed yet.')}(u);return{data:function(e){var t=Object(It.a)(e);return null===t?"":Object(q.g)(t)}(t),type:c,language:s.language,start:i,end:a}}function Rt(e,t,n){var r=e.segment,i=e.adaptation,a=e.representation;return r.isInit?null:(n&&b.a.warn("Transport: Unavailable time data for current text track."),{data:t,type:function(e){var t=e.mimeType,n=void 0===t?"":t;switch(e.mimeType){case"application/ttml+xml":return"ttml";case"application/x-sami":case"application/smil":return"sami";case"text/vtt":return"vtt"}var r=e.codec;if("srt"===(void 0===r?"":r).toLowerCase())return"srt";throw new Error("could not find a text-track parser for the type "+n)}(a),language:i.language})}function Ct(e){var t=e.__priv_patchLastSegmentInSidx;return function(e){var n=e.response,r=e.content,a=e.initTimescale,o=r.period,u=r.representation,c=r.segment,l=c.timestampOffset,d=void 0===l?0:l,f=n.data,p=n.isChunked;return null===f?c.isInit?Object(i.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:void 0}}):Object(i.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:null,chunkOffset:d,appendWindow:[o.start,o.end]}}):xt(u)?function(e,t){var n=e.response,r=e.content,a=e.initTimescale,o=r.period,u=r.representation,c=r.segment,l=c.isInit,d=c.indexRange,f=n.data,p=n.isChunked,h="string"==typeof f?Object(q.e)(f):f instanceof Uint8Array?f:new Uint8Array(f);if(l){var v=Object(vt.c)(h,Array.isArray(d)?d[0]:0);if(!0===t&&null!==v&&v.length>0){var m=v[v.length-1];Array.isArray(m.range)&&(m.range[1]=1/0)}var b=Object(vt.b)(h);return u.index instanceof Se&&null!==v&&v.length>0&&u.index._addSegments(v),Object(i.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:b}})}var g=kt(h,p,c,a),y=Mt(r,h,g,p),_=Object(s.a)(c.timestampOffset,0);return Object(i.a)({type:"parsed-segment",value:{chunkData:y,chunkInfos:g,chunkOffset:_,appendWindow:[o.start,o.end]}})}({response:{data:f,isChunked:p},content:r,initTimescale:a},t):function(e){var t=e.response,n=e.content,r=n.period,a=n.segment,o=a.timestampOffset,s=void 0===o?0:o;if(a.isInit)return Object(i.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:void 0}});var u,c=t.data,l=t.isChunked;if("string"!=typeof c){var d=c instanceof Uint8Array?c:new Uint8Array(c);u=Object(q.g)(d)}else u=c;var f=Rt(n,u,l);return Object(i.a)({type:"parsed-segment",value:{chunkData:f,chunkInfos:null,chunkOffset:s,appendWindow:[r.start,r.end]}})}({response:{data:f,isChunked:p},content:r})}}t.default=function(e){var t=Object(r.a)({customManifestLoader:e.manifestLoader}),n=et(e),a=function(e){var t=e.lowLatencyMode,n=e.segmentLoader;return!0!==e.checkMediaSegmentIntegrity?r:ut(r);function r(e){var r=e.url;if(null==r)return Object(i.a)({type:"data-created",value:{responseData:null}});if(t||void 0===n)return ht(r,e,t);var a={adaptation:e.adaptation,manifest:e.manifest,period:e.period,representation:e.representation,segment:e.segment,transport:"dash",url:r};return new tt.a((function(i){var o=!1,s=!1,u=n(a,{reject:function(e){void 0===e&&(e={}),s||(o=!0,i.error(e))},resolve:function(e){s||(o=!0,i.next({type:"data-loaded",value:{responseData:e.data,size:e.size,duration:e.duration}}),i.complete())},progress:function(e){s||i.next({type:"progress",value:{duration:e.duration,size:e.size,totalSize:e.totalSize}})},fallback:function(){s=!0,ht(r,e,t).subscribe(i)}});return function(){o||s||"function"!=typeof u||u()}}))}}(e),s=At(e);return{manifest:{loader:t,parser:n},audio:{loader:a,parser:s},video:{loader:a,parser:s},text:{loader:function(e){var t=e.lowLatencyMode;return!0!==e.checkMediaSegmentIntegrity?n:ut(n);function n(e){var n=e.segment.range,r=e.url;if(null===r)return Object(i.a)({type:"data-created",value:{responseData:null}});if(e.segment.isInit)return lt(r,e);var a=xt(e.representation);if(t&&a){if(Object(nt.b)())return pt(r,e);Object(rt.a)("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}var s=a?"arraybuffer":"text";return Object(o.a)({url:r,responseType:s,headers:Array.isArray(n)?{Range:Object(it.a)(n)}:null,sendProgressEvents:!0})}}(e),parser:Ct(e)},image:{loader:u,parser:c}}}},function(e,t,n){"use strict";n.r(t);var r=n(30),i=n(37),a=n(156),o=n(24),s=n(0),u=n(73),c=n(239),l=n(142),d=n(180),f=n(124),p=n(20),h=n(122),v=n(123);function m(e,t,n){var r=e.timeline,i=e.timescale,a=r[r.length-1],o=t.timescale===i?{time:t.time,duration:t.duration}:{time:t.time/t.timescale*i,duration:t.duration/t.timescale*i};return!(n.time===o.time)&&(o.time>=Object(p.d)(a,null)&&(a.duration===o.duration?a.repeatCount++:e.timeline.push({duration:o.duration,start:o.time,repeatCount:0}),!0))}function b(e,t){return e.replace(/\{start time\}/g,String(t))}function g(e,t,n){var r=t-e;return r>0?Math.floor(r/n):0}function y(e,t){var n=e.repeatCount;if(null!=e.duration&&n<0){var r=void 0!==t?t.start:1/0;n=Math.ceil((r-e.start)/e.duration)-1}return n}var _=function(){function e(e,t){var n=t.aggressiveMode,r=t.isLive,i=t.segmentPrivateInfos,a=null==e.manifestReceivedTime?performance.now():e.manifestReceivedTime;if(this._index=e,this._indexValidityTime=a,this._initSegmentInfos={bitsPerSample:i.bitsPerSample,channels:i.channels,codecPrivateData:i.codecPrivateData,packetSize:i.packetSize,samplingRate:i.samplingRate,timescale:e.timescale,protection:i.protection},this._isAggressiveMode=n,this._isLive=r,0!==e.timeline.length){var o=e.timeline[e.timeline.length-1],s=Object(p.d)(o,null);if(this._initialScaledLastPosition=s,e.isLive){var u=a/1e3*e.timescale;this._scaledLiveGap=u-s}}}var t=e.prototype;return t.getInitSegment=function(){return{id:"init",isInit:!0,privateInfos:{smoothInitSegment:this._initSegmentInfos},mediaURLs:null,time:0,end:0,duration:0,timescale:1}},t.getSegments=function(e,t){this._refreshTimeline();for(var n,r=function(e,t,n){var r=void 0===e.timescale||0===e.timescale?1:e.timescale;return{up:t*r,to:(t+n)*r}}(this._index,e,t),i=r.up,a=r.to,o=this._index,s=o.timeline,u=o.timescale,c=o.media,l=this._isAggressiveMode,d=[],f=s.length,p=null==this._scaledLiveGap?void 0:performance.now()/1e3*u-this._scaledLiveGap,h=0;h<f;h++){for(var v=s[h],m=v.duration,_=v.start,O=y(v,s[h+1]),T=g(_,i,m),E=_+T*m,w=l?0:m;E<a&&T<=O&&(null==p||E+w<=p);){var S=E,j=null!=n?n+T:void 0,k={id:String(E),isInit:!1,time:S/u,end:(S+m)/u,duration:m/u,timescale:1,number:j,mediaURLs:[b(c,S)],privateInfos:{smoothMediaSegment:{time:S,duration:m}}};d.push(k),E=_+ ++T*m}if(E>=a)return d;null!=n&&(n+=O+1)}return d},t.shouldRefresh=function(e,t){if(this._refreshTimeline(),!this._index.isLive)return!1;var n=this._index,r=n.timeline,i=n.timescale,a=r[r.length-1];if(void 0===a)return!1;var o=a.repeatCount,s=a.start+(o+1)*a.duration;return!(t*i<s)&&(e*i>=s||e*i>a.start+o*a.duration)},t.getFirstPosition=function(){this._refreshTimeline();var e=this._index;return 0===e.timeline.length?null:e.timeline[0].start/e.timescale},t.getLastPosition=function(){this._refreshTimeline();var e=this._index;if(null==this._scaledLiveGap){var t=e.timeline[e.timeline.length-1];return Object(p.d)(t,null)/e.timescale}for(var n=e.timeline.length-1;n>=0;n--)for(var r=e.timeline[n],i=performance.now()/1e3*e.timescale,a=r.start,o=r.duration,s=r.repeatCount;s>=0;s--){var u=a+o*(s+1);if((this._isAggressiveMode?u-o:u)<=i-this._scaledLiveGap)return u/e.timescale}},t.checkDiscontinuity=function(e){return this._refreshTimeline(),Object(p.b)(this._index,e,void 0)},t.areSegmentsChronologicallyGenerated=function(){return!0},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;this._refreshTimeline();var t=this._index,n=t.timeline,r=t.timescale;return Object(h.a)(e,n,r,0)},t.canBeOutOfSyncError=function(e){return!!this._isLive&&(e instanceof d.a&&(e.isHttpError(404)||e.isHttpError(412)))},t._replace=function(e){var t=this._index.timeline,n=e._index.timeline,r=this._index.timescale,i=e._index.timescale;if(this._index=e._index,this._initialScaledLastPosition=e._initialScaledLastPosition,this._indexValidityTime=e._indexValidityTime,this._scaledLiveGap=e._scaledLiveGap,0!==t.length&&0!==n.length&&r===i){var a=t[t.length-1],o=n[n.length-1],u=Object(p.d)(o,null);if(!(Object(p.d)(a,null)<=u))for(var c=0;c<t.length;c++){var l=t[c],d=Object(p.d)(l,null);if(d===u)return void(this._index.timeline=this._index.timeline.concat(t.slice(c+1)));if(d>u){if(l.duration!==o.duration)return;var f=u-l.start;if(0===f)return s.a.warn("Smooth Parser: a discontinuity detected in the previous manifest has been resolved."),void(this._index.timeline=this._index.timeline.concat(t.slice(c)));if(f<0||f%l.duration!=0)return;var h=f/l.duration-1,v=l.repeatCount-h;if(v<0)return;o.repeatCount+=v;var m=t.slice(c+1);return void(this._index.timeline=this._index.timeline.concat(m))}}}},t._update=function(e){Object(v.a)(this._index.timeline,e._index.timeline),this._initialScaledLastPosition=e._initialScaledLastPosition,this._indexValidityTime=e._indexValidityTime,this._scaledLiveGap=e._scaledLiveGap},t.isFinished=function(){return!this._isLive},t.isInitialized=function(){return!0},t._addSegments=function(e,t){this._refreshTimeline();for(var n=0;n<e.length;n++)m(this._index,e[n],t)},t._refreshTimeline=function(){if(null!=this._initialScaledLastPosition){var e=this._index,t=e.timeShiftBufferDepth,n=(performance.now()-this._indexValidityTime)/1e3+this._initialScaledLastPosition/e.timescale;if(null!=t){var r=(n-t)*e.timescale;Object(f.a)(e.timeline,r)}}},e}(),O=n(10),T=n(55),E=n(2),w=n(13),S=n(67),j=n(18);function k(e){var t=[];e.periods.forEach((function(n){var r=n.id;if(Object(O.a)(t,r)){s.a.warn("Two periods with the same ID found. Updating.");var i=r+"-dup";n.id=i,k(e),t.push(i)}else t.push(r);var a=n.adaptations,o=[];Object.keys(a).forEach((function(t){var n=a[t];void 0!==n&&n.forEach((function(t){var n=t.id;if(Object(O.a)(o,n)){s.a.warn("Two adaptations with the same ID found. Updating.",n);var r=n+"-dup";t.id=r,k(e),o.push(r)}else o.push(n);var i=[];t.representations.forEach((function(t){var n=t.id;if(Object(O.a)(i,n)){s.a.warn("Two representations with the same ID found. Updating.",n);var r=n+"-dup";t.id=r,k(e),i.push(r)}else i.push(n)}))}))}))}))}var A=n(53),x=n(1),I=n(11),M=n(209);function R(e){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:Object(x.e)([8,1,18,16],e)}]}function C(e,t,n){for(var r=e.firstElementChild,i=n;null!==r;)i=t(i,r.nodeName,r),r=r.nextElementSibling;return i}var N=["audio","video","text","image"],P={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},D={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4"};var L=function(e){void 0===e&&(e={});var t=void 0===e.referenceDateTime?Date.UTC(1970,0,1,0,0,0,0)/1e3:e.referenceDateTime,n=void 0===e.minRepresentationBitrate?0:e.minRepresentationBitrate,r=e.serverSyncInfos,i=void 0!==r?r.serverTimestamp-r.clientTime:void 0;function a(e,t){var n=C(e,(function(e,t,n){return"CustomAttributes"===t&&e.push.apply(e,C(n,(function(e,t,n){if("Attribute"===t){var r=n.getAttribute("Name"),i=n.getAttribute("Value");null!==r&&null!==i&&e.push(r+"="+i)}return e}),[])),e}),[]);function r(t){var n=e.getAttribute(t);return null==n?void 0:n}switch(t){case"audio":var i=r("AudioTag"),a=r("BitsPerSample"),o=r("Channels"),u=r("CodecPrivateData"),c=r("FourCC"),l=r("PacketSize"),d=r("SamplingRate"),f=r("Bitrate"),p=void 0===f||isNaN(parseInt(f,10))?0:parseInt(f,10);if(void 0!==c&&void 0===D[c]||void 0===u)return s.a.warn("Smooth parser: Unsupported audio codec. Ignoring quality level."),null;var h=function(e,t){var n;return 0==(n="AACH"===t?5:Object(E.a)(e)?(248&parseInt(e.substring(0,2),16))>>3:2)?"mp4a.40.2":"mp4a.40."+n}(u,c);return{audiotag:void 0!==i?parseInt(i,10):i,bitrate:p,bitsPerSample:void 0!==a?parseInt(a,10):a,channels:void 0!==o?parseInt(o,10):o,codecPrivateData:u,codecs:h,customAttributes:n,mimeType:void 0!==c?D[c]:c,packetSize:void 0!==l?parseInt(l,10):l,samplingRate:void 0!==d?parseInt(d,10):d};case"video":var v=r("CodecPrivateData"),m=r("FourCC"),b=r("MaxWidth"),g=r("MaxHeight"),y=r("Bitrate"),_=void 0===y||isNaN(parseInt(y,10))?0:parseInt(y,10);if(void 0!==m&&void 0===D[m]||void 0===v)return s.a.warn("Smooth parser: Unsupported video codec. Ignoring quality level."),null;var O=function(e){var t=/00000001\d7([0-9a-fA-F]{6})/.exec(e);return null!==t&&Object(E.a)(t[1])?"avc1."+t[1]:"avc1.4D401E"}(v);return{bitrate:_,customAttributes:n,mimeType:void 0!==m?D[m]:m,codecPrivateData:v,codecs:O,width:void 0!==b?parseInt(b,10):void 0,height:void 0!==g?parseInt(g,10):void 0};case"text":var T=r("CodecPrivateData"),w=r("FourCC"),S=r("Bitrate");return{bitrate:void 0===S||isNaN(parseInt(S,10))?0:parseInt(S,10),customAttributes:n,mimeType:void 0!==w?D[w]:w,codecPrivateData:Object(j.a)(T,"")};default:return s.a.error("Smooth Parser: Unrecognized StreamIndex type: "+t),null}}return function(r,o,u){var c=Object(S.b)(null==o?"":o),l=r.documentElement;if(null==l||"SmoothStreamingMedia"!==l.nodeName)throw new Error("document root should be SmoothStreamingMedia");var d=l.getAttribute("MajorVersion"),f=l.getAttribute("MinorVersion");if(null===d||null===f||!/^[2]-[0-2]$/.test(d+"-"+f))throw new Error("Version should be 2.0, 2.1 or 2.2");var p,h,v=l.getAttribute("Timescale"),m=Object(E.a)(v)?isNaN(+v)?1e7:+v:1e7,b=C(l,(function(t,n,r){switch(n){case"Protection":t.protections.push(function(e,t){if(void 0===t&&(t=R),null===e.firstElementChild||"ProtectionHeader"!==e.firstElementChild.nodeName)throw new Error("Protection should have ProtectionHeader child");var n=e.firstElementChild,r=Object(A.a)(null===n.textContent?"":n.textContent),i=Object(M.a)(r),a=Object(I.c)(i),o=n.getAttribute("SystemID");return{keyId:a,keySystems:[{systemId:(null!==o?o:"").toLowerCase().replace(/\{|\}/g,""),privateData:r}].concat(t(a))}}(r,e.keySystems));break;case"StreamIndex":t.adaptationNodes.push(r)}return t}),{adaptationNodes:[],protections:[]}),g=b.protections,y=b.adaptationNodes,j="boolean"==typeof(p=l.getAttribute("IsLive"))?p:"string"==typeof p&&"TRUE"===p.toUpperCase();if(j){var x=l.getAttribute("DVRWindowLength");null==x||isNaN(+x)||0==+x||(h=+x/m)}var D,L,B,U,F,V,z=y.reduce((function(t,r){var i=function(t){var r=t.root,i=t.timescale,o=t.rootURL,u=t.protections,c=t.timeShiftBufferDepth,l=t.manifestReceivedTime,d=t.isLive,f=r.getAttribute("Timescale"),p=null===f||isNaN(+f)?i:+f,h=r.getAttribute("Type");if(null===h)throw new Error("StreamIndex without type.");Object(O.a)(N,h)||s.a.warn("Smooth Parser: Unrecognized adaptation type:",h);var v,m=h,b=r.getAttribute("Subtype"),g=r.getAttribute("Language"),y=r.getAttribute("Url"),j=null===y?"":y,k=C(r,(function(e,t,r){switch(t){case"QualityLevel":var i=a(r,m);if(null===i)return e;("video"!==m||i.bitrate>n)&&e.qualityLevels.push(i);break;case"c":e.cNodes.push(r)}return e}),{qualityLevels:[],cNodes:[]}),A=k.qualityLevels,x=k.cNodes,I={timeline:(v=x,v.reduce((function(e,t,n){var r=t.getAttribute("d"),i=t.getAttribute("t"),a=t.getAttribute("r"),o=null!==a?+a-1:0,s=null!==i?+i:void 0,u=null!==r?+r:void 0;if(0===n)s=void 0===s||isNaN(s)?0:s;else{var c=e[n-1];if(null==s||isNaN(s)){if(null==c.duration||isNaN(c.duration))throw new Error("Smooth: Invalid CNodes. Missing timestamp.");s=c.start+c.duration*(c.repeatCount+1)}}if(null==u||isNaN(u)){var l=v[n+1];if(void 0===l)return e;var d=l.getAttribute("t"),f=Object(E.a)(d)?+d:null;if(null===f)throw new Error("Can't build index timeline from Smooth Manifest.");u=f-s}return e.push({duration:u,start:s,repeatCount:o}),e}),[])),timescale:p};Object(T.b)(0!==A.length,"Adaptation should have at least one playable representation.");var M=m+(Object(E.a)(g)?"_"+g:""),R=A.map((function(t){var n,r,i,a,s=Object(S.a)(o,j),f={timeline:I.timeline,timescale:I.timescale,media:(n=s,r=t.bitrate,i=t.customAttributes,n.replace(/\{bitrate\}/g,String(r)).replace(/{CustomAttributes}/g,i.length>0?i[0]:"")),isLive:d,timeShiftBufferDepth:c,manifestReceivedTime:l},p=Object(E.a)(t.mimeType)?t.mimeType:P[m],h=t.codecs,v=M+"_"+(null!=m?m+"-":"")+(null!=p?p+"-":"")+(null!=h?h+"-":"")+String(t.bitrate),b=[];u.length>0&&(a=u[0],u.forEach((function(e){var t=e.keyId;e.keySystems.forEach((function(e){b.push({keyId:t,systemId:e.systemId})}))})));var g={bitsPerSample:t.bitsPerSample,channels:t.channels,codecPrivateData:t.codecPrivateData,packetSize:t.packetSize,samplingRate:t.samplingRate,protection:null!=a?{keyId:a.keyId,keySystems:a.keySystems}:void 0},y=null!=e.aggressiveMode&&e.aggressiveMode,O=new _(f,{aggressiveMode:y,isLive:d,segmentPrivateInfos:g}),T=Object(w.a)({},t,{index:O,mimeType:p,codecs:h,id:v});return b.length>0&&(T.contentProtections={keyIds:b,initData:{}}),T}));if("ADVT"===b)return null;var D={id:M,type:m,representations:R,language:null==g?void 0:g};return"text"===m&&"DESC"===b&&(D.closedCaption=!0),D}({root:r,rootURL:c,timescale:m,protections:g,isLive:j,timeShiftBufferDepth:h,manifestReceivedTime:u});if(null===i)return t;var o=i.type,l=t[o];return void 0===l?t[o]=[i]:l.push(i),t}),{}),K=null,$=void 0!==z.video?z.video[0]:void 0,H=void 0!==z.audio?z.audio[0]:void 0;if(void 0!==$||void 0!==H){var W=[],G=[];if(void 0!==$){var Y=$.representations[0];if(void 0!==Y){var q=Y.index.getFirstPosition(),X=Y.index.getLastPosition();null!=q&&W.push(q),null!=X&&G.push(X)}}if(void 0!==H){var Q=H.representations[0];if(void 0!==Q){var Z=Q.index.getFirstPosition(),J=Q.index.getLastPosition();null!=Z&&W.push(Z),null!=J&&G.push(J)}}W.length>0&&(F=Math.max.apply(Math,W)),G.length>0&&(V=Math.min.apply(Math,G))}var ee=l.getAttribute("Duration"),te=null!=ee&&0!=+ee?+ee/m:void 0;j?(D=e.suggestedPresentationDelay,L=t,B=null!=F?F:L,U={isLinear:!0,value:null!=V?V:Date.now()/1e3-L,time:performance.now()},K=null!=h?h:null):(B=null!=F?F:0,U={isLinear:!1,value:void 0!==V?V:void 0!==te?B+te:1/0,time:performance.now()});var ne=j?0:B,re=j?void 0:U.value,ie={availabilityStartTime:void 0===L?0:L,clockOffset:i,isLive:j,isDynamic:j,timeBounds:{absoluteMinimumTime:B,timeshiftDepth:K,maximumTimeData:U},periods:[{adaptations:z,duration:void 0!==re?re-ne:te,end:re,id:"gen-smooth-period-0",start:ne}],suggestedPresentationDelay:D,transportType:"smooth",uris:null==o?[]:[o]};return k(ie),ie}},B=n(29),U=n(21),F=n(100),V=n(125),z=n(138),K=n(240),$=n(35);function H(e,t,n,r,i){var a,o,u,c=[];if(i){var d=Object(l.c)(e);null!==d?(u=function(e){var t=Object($.e)(e,3565190898,3392751253,2387879627,2655430559);if(void 0===t)return[];for(var n=[],r=t[0],i=t[4],a=0;a<i;a++){var o=void 0,s=void 0;1===r?(s=Object(x.d)(t,16*a+5),o=Object(x.d)(t,16*a+5+8)):(s=Object(x.c)(t,8*a+5),o=Object(x.c)(t,8*a+5+4)),n.push({time:s,duration:o})}return n}(d),o=function(e){var t=Object($.e)(e,1830656773,1121273062,2162299933,2952222642);if(void 0!==t)return{duration:Object(x.d)(t,12),time:Object(x.d)(t,4)}}(d)):s.a.warn("smooth: could not find traf atom")}if(void 0!==u)for(var f=0;f<u.length;f++)c.push({time:u[f].time,duration:u[f].duration,timescale:n});if(void 0!==o)return{nextSegments:c,chunkInfos:{time:o.time/n,duration:o.duration/n},scaledSegmentTime:o.time};if(t)return{nextSegments:c,chunkInfos:null,scaledSegmentTime:void 0};var p=r.duration*n,h=Math.min(.9*n,p/4),v=Object(K.a)(e),m=void 0!==(null===(a=r.privateInfos)||void 0===a?void 0:a.smoothMediaSegment)?r.privateInfos.smoothMediaSegment.time:Math.round(r.time*n);return{nextSegments:c,chunkInfos:void 0!==v&&Math.abs(v-p)<=h?{time:r.time,duration:v/n}:{time:r.time,duration:r.duration},scaledSegmentTime:m}}var W=n(168),G=n(181);function Y(e,t){return Object(G.a)("schm",Object(x.e)(4,Object(I.e)(e),Object(x.h)(t)))}function q(e){return Object(G.a)("frma",Object(I.e)(e))}function X(e){var t=[7,[e.length]];return Object(G.a)("stsd",x.e.apply(void 0,t.concat(e)))}function Q(e,t,n){return Object(G.a)("tenc",Object(x.e)(6,[e,t],n))}function Z(e,t,n,r,i){var a=[e,t,n];return void 0!==i&&a.push(Object(G.a)("senc",i),function(e){if(0===e.length)return Object(G.a)("saiz",new Uint8Array(0));var t=Object(x.c)(e,0),n=Object(x.c)(e,4),r=new Uint8Array(n+9);r.set(Object(x.h)(n),5);for(var i,a,o=9,s=8;s<e.length;)s+=8,2==(2&t)?(a=2,s+=6*(i=Object(x.a)(e,s))+2):(i=0,a=0),r[o]=6*i+8+a,o++;return Object(G.a)("saiz",r)}(i),function(e,t,n,r){return Object(G.a)("saio",Object(x.e)(4,[0,0,0,1],Object(x.h)(e.length+t.length+n.length+r.length+8+8+8+8)))}(r,e,t,n)),Object(G.b)("traf",a)}function J(e,t){var n=Object($.c)(e,1836019558);if(null===n)throw new Error("Smooth: Invalid ISOBMFF given");var r=e.subarray(n[1],n[2]),i=Object($.a)(r,1835427940),a=Object($.b)(r,1953653094);if(null===a||null===i)throw new Error("Smooth: Invalid ISOBMFF given");var o=Object($.c)(a,1952868452),s=Object($.c)(a,1953658222);if(null===o||null===s)throw new Error("Smooth: Invalid ISOBMFF given");var u=a.subarray(o[0],o[2]),c=a.subarray(s[0],s[2]);u.set([0,0,0,1],o[1]-o[0]+4);var l=function(e){return Object(G.a)("tfdt",Object(x.e)([1,0,0,0],Object(x.i)(e)))}(t),d=function(e,t){if((1&e[t+3])>0)return e;var n=new Uint8Array(e.length+4);return n.set(e.subarray(0,t+8),0),n[t+3]=1|n[t+3],n.set([0,0,0,0],t+8),n.set(e.subarray(t+8,e.length),t+12),Object(K.e)(n)}(c,s[1]-s[0]),f=Z(u,l,d,i,Object($.e)(a,2721664850,1520127764,2722393154,2086964724)),p=Object(G.b)("moof",[i,f]),h=Object($.c)(p,1836019558),v=Object($.c)(f,1953653094),m=Object($.c)(d,1953658222);if(null===h||null===v||null===m)throw new Error("Smooth: Invalid moof, trun or traf generation");var b=h[1]-h[0]+i.length+(v[1]-v[0])+u.length+l.length+(m[1]-m[0])+8,g=n[2]-n[0],y=p.length-g,_=Object($.c)(e,1835295092);if(null===_)throw new Error("Smooth: Invalid ISOBMFF given");if(Object(W.a)()&&(0===y||y<=-8)){var O=_[1];return p.set(Object(x.h)(O),b),e.set(p,n[0]),y<=-8&&e.set((E=-y,Object(G.a)("free",new Uint8Array(E-8))),p.length),e}var T=_[1]+y;p.set(Object(x.h)(T),b);var E,w=new Uint8Array(e.length+y),S=e.subarray(0,n[0]),j=e.subarray(n[2],e.length);return w.set(S,0),w.set(p,S.length),w.set(j,S.length+p.length),w}var ee=n(12),te=n(52);function ne(e,t,n,r){var i=[e,t,n];return r.forEach((function(e){var t=function(e,t,n){void 0===t&&(t=new Uint8Array(0)),void 0===n&&(n=new Uint8Array(0));var r,i,a=e.replace(/-/g,"");if(32!==a.length)throw new Error("HSS: wrong system id length");var o=n.length;return o>0?(r=1,i=x.e.apply(void 0,[Object(x.h)(o)].concat(n))):(r=0,i=[]),Object(G.a)("pssh",Object(x.e)([r,0,0,0],Object(I.c)(a),i,Object(x.h)(t.length),t))}(e.systemId,e.privateData,e.keyIds);i.push(t)})),Object(G.b)("moov",i)}function re(e,t,n,r,i,a,o){var s,u,c,l,d=Object(G.b)("stbl",[n,Object(G.a)("stts",new Uint8Array(8)),Object(G.a)("stsc",new Uint8Array(8)),Object(G.a)("stsz",new Uint8Array(12)),Object(G.a)("stco",new Uint8Array(8))]),f=function(e){return Object(G.a)("dref",Object(x.e)(7,[1],e))}(Object(G.a)("url ",new Uint8Array([0,0,0,1]))),p=Object(G.b)("dinf",[f]),h=Object(G.b)("minf",[r,p,d]),v=function(e){var t,n;switch(e){case"video":t="vide",n="VideoHandler";break;case"audio":t="soun",n="SoundHandler";break;default:t="hint",n=""}return Object(G.a)("hdlr",Object(x.e)(8,Object(I.e)(t),12,Object(I.e)(n),1))}(t),m=function(e){return Object(G.a)("mdhd",Object(x.e)(12,Object(x.h)(e),8))}(e),b=Object(G.b)("mdia",[m,v,h]),g=function(e,t,n){return Object(G.a)("tkhd",Object(x.e)(Object(x.h)(7),8,Object(x.h)(n),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],Object(x.g)(e),2,Object(x.g)(t),2))}(i,a,1),y=Object(G.b)("trak",[g,b]),_=(s=1,Object(G.a)("trex",Object(x.e)(4,Object(x.h)(s),[0,0,0,1],12))),O=Object(G.b)("mvex",[_]),T=ne(function(e,t){return Object(G.a)("mvhd",Object(x.e)(12,Object(x.h)(e),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,Object(x.g)(t+1)))}(e,1),O,y,o),E=(u="isom",c=["isom","iso2","iso6","avc1","dash"],l=x.e.apply(void 0,[Object(I.e)(u),[0,0,0,1]].concat(c.map(I.e))),Object(G.a)("ftyp",l));return Object(x.e)(E,T)}function ie(e,t,n,r,i,a,o,s,u){var c=void 0===u?[]:u,l=o.split("00000001"),d=l[1],f=l[2];if(void 0===d||void 0===f)throw new Error("Smooth: unsupported codec private data.");var p,h,v=function(e,t,n){var r=2===n?1:4===n?3:0,i=e[1],a=e[2],o=e[3];return Object(G.a)("avcC",Object(x.e)([1,i,a,o,252|r,225],Object(x.g)(e.length),e,[1],Object(x.g)(t.length),t))}(Object(I.c)(d),Object(I.c)(f),a);if(0===c.length||void 0===s){p=X([function(e,t,n,r,i,a,o){return Object(G.a)("avc1",Object(x.e)(6,Object(x.g)(1),16,Object(x.g)(e),Object(x.g)(t),Object(x.g)(n),2,Object(x.g)(r),6,[0,1,i.length],Object(I.e)(i),31-i.length,Object(x.g)(a),[255,255],o))}(t,n,r,i,"AVC Coding",24,v)])}else{var m=Q(1,8,s),b=Object(G.b)("schi",[m]),g=Y("cenc",65536),y=q("avc1");p=X([function(e,t,n,r,i,a,o,s){return Object(G.a)("encv",Object(x.e)(6,Object(x.g)(1),16,Object(x.g)(e),Object(x.g)(t),Object(x.g)(n),2,Object(x.g)(r),6,[0,1,i.length],Object(I.e)(i),31-i.length,Object(x.g)(a),[255,255],o,s))}(t,n,r,i,"AVC Coding",24,v,Object(G.b)("sinf",[y,g,b]))])}return re(e,"video",p,((h=new Uint8Array(12))[3]=1,Object(G.a)("vmhd",h)),t,n,c)}var ae=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];function oe(e,t,n,r,i,a,o,s){void 0===s&&(s=[]);var u,c,l,d=function(e,t){return Object(G.a)("esds",Object(x.e)(4,[3,25],Object(x.g)(e),[0,4,17,64,21],11,[5,2],Object(I.c)(t),[6,1,2]))}(1,0===a.length?(u=i,c=t,l=((l=((l=(63&2)<<4)|31&ae.indexOf(u))<<4)|31&c)<<3,Object(I.a)(Object(x.g)(l))):a);return re(e,"audio",function(){if(0===s.length||void 0===o)return X([function(e,t,n,r,i,a){return Object(G.a)("mp4a",Object(x.e)(6,Object(x.g)(e),8,Object(x.g)(t),Object(x.g)(n),2,Object(x.g)(r),Object(x.g)(i),2,a))}(1,t,n,r,i,d)]);var e=Q(1,8,o),a=Object(G.b)("schi",[e]),u=Y("cenc",65536),c=q("mp4a"),l=Object(G.b)("sinf",[c,u,a]);return X([function(e,t,n,r,i,a,o){return Object(G.a)("enca",Object(x.e)(6,Object(x.g)(e),8,Object(x.g)(t),Object(x.g)(n),2,Object(x.g)(r),Object(x.g)(i),2,a,o))}(1,t,n,r,i,d,l)])}(),Object(G.a)("smhd",new Uint8Array(8)),0,0,s)}function se(e){var t,n=e.url,r=e.segment.range;return Array.isArray(r)&&(t={Range:Object(te.a)(r)}),Object(B.a)({url:n,responseType:"arraybuffer",headers:t,sendProgressEvents:!0})}var ue=function(e){return function(t){var n=t.segment,i=t.representation,a=t.adaptation,o=t.period,s=t.manifest,u=t.url;if(n.isInit){if(void 0===n.privateInfos||void 0===n.privateInfos.smoothInitSegment)throw new Error("Smooth: Invalid segment format");var c,l=n.privateInfos.smoothInitSegment,d=l.codecPrivateData,f=l.timescale,p=l.protection,h=void 0===p?{keyId:void 0,keySystems:void 0}:p;if(void 0===d)throw new Error("Smooth: no codec private data.");switch(a.type){case"video":var v=i.width,m=void 0===v?0:v,b=i.height;c=ie(f,m,void 0===b?0:b,72,72,4,d,h.keyId,h.keySystems);break;case"audio":var g=l.channels,y=void 0===g?0:g,_=l.bitsPerSample,O=void 0===_?0:_,T=l.packetSize,E=void 0===T?0:T,w=l.samplingRate;c=oe(f,y,O,E,void 0===w?0:w,d,h.keyId,h.keySystems);break;default:0,c=new Uint8Array(0)}return Object(r.a)({type:"data-created",value:{responseData:c}})}if(null===u)return Object(r.a)({type:"data-created",value:{responseData:null}});var S={adaptation:a,manifest:s,period:o,representation:i,segment:n,transport:"smooth",url:u};return"function"!=typeof e?se(S):new ee.a((function(t){var n=!1,r=!1,i=e(S,{reject:function(e){void 0===e&&(e={}),r||(n=!0,t.error(e))},resolve:function(e){r||(n=!0,t.next({type:"data-loaded",value:{responseData:e.data,size:e.size,duration:e.duration}}),t.complete())},fallback:function(){r=!0,se(S).subscribe(t)},progress:function(e){r||t.next({type:"progress",value:{duration:e.duration,size:e.size,totalSize:e.totalSize}})}});return function(){n||r||"function"!=typeof i||i()}}))}},ce=/(\.isml?)(\?token=\S+)?$/,le=/\?token=(\S+)/;function de(e,t){return Object(E.a)(t)?e.replace(le,"?token="+t):e.replace(le,"")}function fe(e){return ce.test(e)?(Object(U.a)("Giving a isml URL to loadVideo is deprecated. Please give the Manifest URL directly"),e.replace(ce,"$1/manifest$2")):e}var pe=/\.wsx?(\?token=\S+)?/;function he(e,t,n){var r;s.a.debug("Smooth Parser: update segments information.");for(var i=e.representations,a=0;a<i.length;a++){var o=i[a];o.index instanceof _&&void 0!==(null===(r=null==n?void 0:n.privateInfos)||void 0===r?void 0:r.smoothMediaSegment)?o.index._addSegments(t,n.privateInfos.smoothMediaSegment):s.a.warn("Smooth Parser: should only encounter SmoothRepresentationIndex")}}function ve(e){return"string"==typeof e.mimeType&&e.mimeType.indexOf("mp4")>=0}t.default=function(e){var t=L(e),n=ue(e.segmentLoader),d={customManifestLoader:e.manifestLoader},f={loader:function(t){return t.segment.isInit||!0!==e.checkMediaSegmentIntegrity?n(t):n(t).pipe(Object(a.a)((function(e){"data-loaded"!==e.type&&"data-chunk"!==e.type||null===e.value.responseData||Object(F.a)(new Uint8Array(e.value.responseData),t.segment.isInit)})))},parser:function(e){var t,n,i=e.content,a=e.response,o=e.initTimescale,s=i.segment,u=i.representation,l=i.adaptation,d=i.manifest,f=a.data,p=a.isChunked;if(null===f){if(s.isInit){var h=u.getProtectionsInitializationData();return Object(r.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:h,initTimescale:void 0}})}return Object(r.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:null,chunkOffset:0,appendWindow:[void 0,void 0]}})}var v=f instanceof Uint8Array?f:new Uint8Array(f);if(s.isInit){var m=Object(c.a)(v);if(m.length>0)for(var b=0;b<m.length;b++){var g=m[b],y=g.systemID,_=g.data;u._addProtectionData("cenc",y,_)}var O=u.getProtectionsInitializationData(),T=null===(n=null===(t=s.privateInfos)||void 0===t?void 0:t.smoothInitSegment)||void 0===n?void 0:n.timescale;return Object(r.a)({type:"parsed-init-segment",value:{initializationData:f,initTimescale:T,segmentProtections:O}})}var E=void 0!==o?H(v,p,o,s,d.isLive):null;if(null===E||null===E.chunkInfos||void 0===E.scaledSegmentTime)throw new Error("Smooth Segment without time information");var w=E.nextSegments,S=E.chunkInfos,j=J(v,E.scaledSegmentTime);return w.length>0&&he(l,w,s),Object(r.a)({type:"parsed-segment",value:{chunkData:j,chunkInfos:S,chunkOffset:0,appendWindow:[void 0,void 0]}})}};return{manifest:{resolver:function(e){var t,n=e.url;if(void 0===n)return Object(r.a)({url:void 0});pe.test(n)?(Object(U.a)("Giving WSX URL to loadVideo is deprecated. You should only give Manifest URLs."),t=Object(B.a)({url:de(n,""),responseType:"document"}).pipe(Object(i.a)((function(e){var t=e.value,n=t.responseData.getElementsByTagName("media")[0].getAttribute("src");if(null===n||0===n.length)throw new Error("Invalid ISML");return n})))):t=Object(r.a)(n);var a=function(e){var t=le.exec(e);if(null!==t){var n=t[1];if(void 0!==n)return n}return""}(n);return t.pipe(Object(i.a)((function(e){return{url:de(fe(e),a)}})))},loader:Object(z.a)(d),parser:function(n){var r=n.response,i=n.url,a=void 0===r.url?i:r.url,o="string"==typeof r.responseData?(new DOMParser).parseFromString(r.responseData,"text/xml"):r.responseData,s=r.receivedTime,c=t(o,a,s),l=new u.a(c,{representationFilter:e.representationFilter,supplementaryImageTracks:e.supplementaryImageTracks,supplementaryTextTracks:e.supplementaryTextTracks});return Object(V.a)(l,a)}},audio:f,video:f,text:{loader:function(t){var n=t.segment,i=t.representation,o=t.url;if(n.isInit||null===o)return Object(r.a)({type:"data-created",value:{responseData:null}});var s=ve(i);return s&&!0===e.checkMediaSegmentIntegrity?Object(B.a)({url:o,responseType:"arraybuffer",sendProgressEvents:!0}).pipe(Object(a.a)((function(e){"data-loaded"===e.type&&Object(F.a)(new Uint8Array(e.value.responseData),n.isInit)}))):Object(B.a)({url:o,responseType:s?"arraybuffer":"text",sendProgressEvents:!0})},parser:function(e){var t,n,i=e.content,a=e.response,o=e.initTimescale,u=i.manifest,c=i.adaptation,d=i.representation,f=i.segment,p=c.language,h=ve(d),v=d.mimeType,m=void 0===v?"":v,b=d.codec,g=void 0===b?"":b,y=a.data,_=a.isChunked;if(f.isInit)return Object(r.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:void 0}});if(null===y)return Object(r.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:null,chunkOffset:0,appendWindow:[void 0,void 0]}});var O,T,E,w,S=null;if(h){var j;j="string"==typeof y?Object(I.e)(y):y instanceof Uint8Array?y:new Uint8Array(y);var k=void 0!==o?H(j,_,o,f,u.isLive):null;n=null==k?void 0:k.nextSegments,null===(S=null!==(t=null==k?void 0:k.chunkInfos)&&void 0!==t?t:null)?_?s.a.warn("Smooth: Unavailable time data for current text track."):(O=f.time,T=f.end):(O=S.time,T=void 0!==S.duration?S.time+S.duration:f.end);var A=g.toLowerCase();if("application/ttml+xml+mp4"===m||"stpp"===A||"stpp.ttml.im1t"===A)w="ttml";else{if("wvtt"!==A)throw new Error("could not find a text-track parser for the type "+m);w="vtt"}var x=Object(l.a)(j);E=null===x?"":Object(I.g)(x)}else{var M;if(O=f.time,T=f.end,"string"!=typeof y){var R=y instanceof Uint8Array?y:new Uint8Array(y);M=Object(I.g)(R)}else M=y;switch(m){case"application/x-sami":case"application/smil":w="sami";break;case"application/ttml+xml":w="ttml";break;case"text/vtt":w="vtt"}if(void 0===w){if("srt"!==g.toLowerCase())throw new Error("could not find a text-track parser for the type "+m);w="srt"}E=M}null!==S&&Array.isArray(n)&&n.length>0&&he(c,n,f);var C=null!=O?O:0;return Object(r.a)({type:"parsed-segment",value:{chunkData:{type:w,data:E,start:O,end:T,language:p},chunkInfos:S,chunkOffset:C,appendWindow:[void 0,void 0]}})}},image:{loader:function(e){var t=e.segment,n=e.url;return t.isInit||null===n?Object(r.a)({type:"data-created",value:{responseData:null}}):Object(B.a)({url:n,responseType:"arraybuffer",sendProgressEvents:!0})},parser:function(e){var t=e.response,n=e.content,i=t.data,a=t.isChunked;if(n.segment.isInit)return Object(r.a)({type:"parsed-init-segment",value:{initializationData:null,segmentProtections:[],initTimescale:void 0}});if(a)throw new Error("Image data should not be downloaded in chunks");if(null===i||null===o.a.imageParser)return Object(r.a)({type:"parsed-segment",value:{chunkData:null,chunkInfos:null,chunkOffset:0,appendWindow:[void 0,void 0]}});var s=o.a.imageParser(new Uint8Array(i)),u=s.thumbs;return Object(r.a)({type:"parsed-segment",value:{chunkData:{data:u,start:0,end:Number.MAX_VALUE,timescale:1,type:"bif"},chunkInfos:{time:0,duration:Number.MAX_VALUE,timescale:s.timescale},chunkOffset:0,segmentProtections:[],appendWindow:[void 0,void 0]}})}}}}},function(e,t,n){"use strict";n.r(t);var r=n(135);function i(e){return void 0===e.extent&&void 0===e.origin&&void 0===e.displayAlign&&void 0===e.display&&void 0===e.textAlign&&void 0===e.fontSize}function a(e){e.extent="70% 20%",e.fontSize="1c",e.origin="15% 80%",e.displayAlign="before",e.textAlign="center"}var o=n(140),s=n(172),u=n(2),c=n(13),l=n(128),d=n(72),f=n(0),p=n(16);function h(e,t){return"-1px -1px "+t+" "+e+",1px -1px "+t+" "+e+",-1px 1px "+t+" "+e+",1px 1px "+t+" "+e}function v(e){var t;return null!=(t=p.b.exec(e))?"rgba("+String(parseInt(t[1],16))+","+String(parseInt(t[2],16))+","+String(parseInt(t[3],16))+","+String(parseInt(t[4],16)/255)+")":null!=(t=p.a.exec(e))?"rgba("+String(parseInt(t[1]+t[1],16))+","+String(parseInt(t[2]+t[2],16))+","+String(parseInt(t[3]+t[3],16))+","+String(parseInt(t[4]+t[4],16)/255)+")":null!=(t=p.f.exec(e))?"rgb("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+")":null!=(t=p.e.exec(e))?"rgba("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+","+String(+t[4]/255)+")":e}var m=["color","direction","display","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","textOutline","unicodeBidi","visibility","wrapOption"];function b(e,t,n){var r=t.color;Object(u.a)(r)&&(e.style.color=v(r));var i=t.backgroundColor;Object(u.a)(i)&&(e.style.backgroundColor=v(i));var a=t.textOutline;if(Object(u.a)(a)){var o=a.trim().replace(/\s+/g," ").split(" "),c=o.length;if(3===c){var l=v(o[0]),d=o[1];e.style.textShadow=h(l,d)}else if(Object(u.a)(r)&&1===c){var m=o[0];e.style.textShadow=h(r,m)}else if(2===c){var b=/^[#A-Z]/i.test(o[0]);if(b!==/^[0-9]/.test(o[0]))if(b){var g=v(o[0]),y=o[1];e.style.textShadow=h(g,y)}else if(Object(u.a)(r)){var _=o[0];e.style.textShadow=h(r,_)}}}var O=t.textDecoration;if(Object(u.a)(O))switch(O){case"noUnderline":case"noLineThrough":case"noOverline":e.style.textDecoration="none";break;case"lineThrough":e.style.textDecoration="line-through";break;default:e.style.textDecoration=O}var T=t.fontFamily;if(Object(u.a)(T))switch(T){case"proportionalSansSerif":e.style.fontFamily="Arial, Helvetica, Liberation Sans, sans-serif";break;case"monospaceSansSerif":case"sansSerif":e.style.fontFamily="sans-serif";break;case"monospaceSerif":case"default":e.style.fontFamily="Courier New, Liberation Mono, monospace";break;case"proportionalSerif":e.style.fontFamily="serif";break;default:e.style.fontFamily=T}var E=t.fontStyle;Object(u.a)(E)&&(e.style.fontStyle=E);var w=t.fontWeight;Object(u.a)(w)&&(e.style.fontWeight=w);var S=t.fontSize;Object(u.a)(S)?function(e,t){var n=t.trim().split(" ");if(0!==n.length){var r=p.c.exec(n[0]);null!==r&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.fontSize=r[1]+r[2]:"c"===r[2]?(e.style.position="relative",Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-font-size",r[1])):f.a.warn("TTML Parser: unhandled fontSize unit:",r[2]))}}(e,S):(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-font-size","1"));var j=t.direction;Object(u.a)(j)&&(e.style.direction=j);var k=t.unicodeBidi;if(Object(u.a)(k))switch(k){case"bidiOverride":e.style.unicodeBidi="bidi-override";break;case"embed":e.style.unicodeBidi="embed";break;default:e.style.unicodeBidi="normal"}var A=t.visibility;Object(u.a)(A)&&(e.style.visibility=A),"none"===t.display&&(e.style.display="none");var x=t.wrapOption;e.style.whiteSpace="noWrap"===x?n?"nowrap":"pre":n?"normal":"pre-wrap"}function g(e,t){e.style.color="white",e.style.position="absolute";var n=t.extent;Object(u.a)(n)&&function(e,t){var n=t.trim();if("auto"!==n){var r=n.split(" ");if(2===r.length){var i=p.c.exec(r[0]),a=p.c.exec(r[1]);null!==i&&null!==a&&("px"===i[2]||"%"===i[2]||"em"===i[2]?e.style.width=i[1]+i[2]:"c"===i[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-width",i[1])):f.a.warn("TTML Parser: unhandled extent unit:",i[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.height=a[1]+a[2]:"c"===a[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-height",a[1])):f.a.warn("TTML Parser: unhandled extent unit:",a[2]))}}}(e,n);var r=t.writingMode;Object(u.a)(r);var i=t.overflow;e.style.overflow=Object(u.a)(i)?i:"hidden";var a=t.padding;Object(u.a)(a)&&function(e,t){var n=t.trim().split(" ");if(!(n.length<1)){var r=p.c.exec(n[0]);if(null!==r){if("px"===r[2]||"%"===r[2]||"em"===r[2]){var i=r[1]+r[2];1===n.length?e.style.padding=i:2===n.length?(e.style.paddingTop=i,e.style.paddingBottom=i):e.style.paddingTop=i}else"c"===r[2]?(Object(s.a)(e,"proportional-style"),1===n.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1]),e.setAttribute("data-proportional-padding-left",r[1]),e.setAttribute("data-proportional-padding-right",r[1])):2===n.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1])):e.setAttribute("data-proportional-padding-top",r[1])):f.a.warn("TTML Parser: unhandled padding unit:",r[2]);if(1!==n.length){var a=p.c.exec(n[1]);if(null!==a){if("px"===a[2]||"%"===a[2]||"em"===a[2]){var o=a[1]+a[2];n.length<4?(e.style.paddingLeft=o,e.style.paddingRight=o):e.style.paddingRight=o}else"c"===a[2]?(Object(s.a)(e,"proportional-style"),n.length<4?(e.setAttribute("data-proportional-padding-left",a[1]),e.setAttribute("data-proportional-padding-right",a[1])):e.setAttribute("data-proportional-padding-right",a[1])):f.a.warn("TTML Parser: unhandled padding unit:",a[2]);if(2!==n.length){var u=p.c.exec(n[2]);if(null!==u){if("px"===u[2]||"%"===u[2]||"em"===u[2]){var c=u[1]+u[2];e.style.paddingBottom=c}else"c"===u[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-padding-bottom",u[1])):f.a.warn("TTML Parser: unhandled padding unit:",u[2]);if(3!==n.length){var l=p.c.exec(n[3]);if(null!==l)if("px"===l[2]||"%"===l[2]||"em"===l[2]){var d=l[1]+l[2];e.style.paddingLeft=d}else"c"===l[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-padding-left",l[1])):f.a.warn("TTML Parser: unhandled padding unit:",l[2])}}}}}}}}(e,a);var o=t.origin;Object(u.a)(o)&&function(e,t){var n=t.trim();if("auto"!==n){var r=n.split(" ");if(2===r.length){var i=p.c.exec(r[0]),a=p.c.exec(r[1]);null!==i&&null!==a&&("px"===i[2]||"%"===i[2]||"em"===i[2]?e.style.left=i[1]+i[2]:"c"===i[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-left",i[1])):f.a.warn("TTML Parser: unhandled origin unit:",i[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.top=a[1]+a[2]:"c"===a[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-top",a[1])):f.a.warn("TTML Parser: unhandled origin unit:",a[2]))}}}(e,o);var c=t.displayAlign;if(Object(u.a)(c))switch(e.style.display="flex",e.style.flexDirection="column",c){case"before":e.style.justifyContent="flex-start";break;case"center":e.style.justifyContent="center";break;case"after":e.style.justifyContent="flex-end"}var l=t.opacity;Object(u.a)(l)&&(e.style.opacity=l);var d=t.visibility;Object(u.a)(d)&&(e.style.visibility=d),"none"===t.display&&(e.style.display="none")}function y(e,t){e.style.margin="0px";var n=t.backgroundColor;Object(u.a)(n)&&(e.style.backgroundColor=v(n));var r=t.lineHeight;Object(u.a)(r)&&function(e,t){var n=t.trim();if("auto"!==n){var r=p.c.exec(n[0]);null!==r&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.lineHeight=r[1]+r[2]:"c"===r[2]?(Object(s.a)(e,"proportional-style"),e.setAttribute("data-proportional-line-height",r[1])):f.a.warn("TTML Parser: unhandled lineHeight unit:",r[2]))}}(e,r);var i=t.textAlign;if(Object(u.a)(i))switch(i){case"center":e.style.textAlign="center";break;case"left":case"start":e.style.textAlign="left";break;case"right":case"end":e.style.textAlign="right"}}function _(e,t,n){var r=document.createElement("span"),i=null===e.textContent?"":e.textContent;if(n){var a=i.trim();i=a=a.replace(/\s+/g," ")}return r.innerHTML=i,r.className="rxp-texttrack-span",b(r,t,n),r}function O(e,t,n,r,i,a){var o=a.cellResolution,s=a.shouldTrimWhiteSpace,f=Object(l.a)(e,"div"),p=document.createElement("DIV");if(p.className="rxp-texttrack-region",p.setAttribute("data-resolution-columns",String(o.columns)),p.setAttribute("data-resolution-rows",String(o.rows)),g(p,i),null!==t){var h=Object(d.a)(["backgroundColor"],[].concat(f,[t]),r,n).bodyBackgroundColor;Object(u.a)(h)&&(p.style.backgroundColor=v(h))}var b=document.createElement("p");b.className="rxp-texttrack-p",y(b,i);for(var O=function(e,t,n,r,i){return function e(r,i,a,o){for(var s=r.childNodes,l=[],f=0;f<s.length;f++){var p=s[f];if("#text"===p.nodeName){var h=Object(d.a)(["backgroundColor"],a,n,t).backgroundColor;Object(u.a)(h)?i.backgroundColor=h:delete i.backgroundColor;var v=_(p,i,o);l.push(v)}else if("br"===p.nodeName){var b=document.createElement("BR");l.push(b)}else if("span"===p.nodeName&&p.nodeType===Node.ELEMENT_NODE&&p.childNodes.length>0){var g=p.getAttribute("xml:space"),y=Object(u.a)(g)?"default"===g:o,O=Object(c.a)({},i,Object(d.a)(m,[p],n,t));l.push.apply(l,e(p,O,[p].concat(a),y))}}return l}(e,Object(c.a)({},r),[],i)}(e,n,r,i,s),T=0;T<O.length;T++)b.appendChild(O[T]);return p.appendChild(b),p}function T(e){var t=e.paragraph,n=e.ttParams,r=e.body,i=e.regionStyles,a=e.idStyles,s=e.paragraphStyle,u=e.timeOffset,c=e.shouldTrimWhiteSpace;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;var l=n.cellResolution,d=Object(o.a)(t,n);return{start:d.start+u,end:d.end+u,element:O(t,r,i,a,s,{cellResolution:l,shouldTrimWhiteSpace:c})}}t.default=function(e,t){for(var n=Object(r.a)(e,t),o=[],s=0;s<n.length;s++){var u=n[s].paragraphStyle;i(u)&&a(u);var c=T(n[s]);null!==c&&o.push(c)}return o}},function(e,t,n){"use strict";n.r(t);var r=n(126),i=n(2),a=n(68);var o=n(139),s={white:"#ffffff",lime:"#00ff00",cyan:"#00ffff",red:"#ff0000",yellow:"#ffff00",magenta:"#ff00ff",blue:"#0000ff",black:"#000000"};function u(e){var t=Object.keys(s).reduce((function(e,t){return e[t]="color: "+s[t]+";",e["bg_"+t]="background-color: "+s[t]+";",e}),{}),n="";return e.forEach((function(e){if(e.length>=2)for(var r=1;r<e.length;r++){var a=e[r];if(Array.isArray(/::cue {/.exec(a)))for(a=e[++r];Object(i.a)(a)&&!Array.isArray(/}/.exec(a))&&0!==a.length;)n+=a,a=e[++r];else!function(){for(var n=[],o=/::cue\(\.?(.*?)\)(?:,| {)/.exec(a);Object(i.a)(a)&&Array.isArray(o);)n.push(o[1]),a=e[++r],o=/::cue\(\.?(.*?)\)(?:,| {)/.exec(a);for(var s="";Object(i.a)(a)&&!Array.isArray(/}/.exec(a))&&0!==a.length;)s+=a,a=e[++r];n.forEach((function(e){void 0===t[e]?t[e]=s:t[e]+=s}))}()}})),{classes:t,global:n}}var c=n(10);function l(e,t){var n,r=["u","i","b"],a=e.nodeName.toLowerCase().split(".")[0];if(Object(c.a)(["u","i","b","c","#text"],a))if("#text"===a){var o=e.wholeText.split("\n");n=document.createElement("span");for(var s=0;s<o.length;s++)if(s>0&&n.appendChild(document.createElement("br")),o[s].length>0){var u=document.createTextNode(o[s]);n.appendChild(u)}}else{var d=e.nodeName.toLowerCase().split("."),f=[];if(d.forEach((function(e){Object(i.a)(t[e])&&f.push(t[e])})),0!==f.length){var p=document.createAttribute("style");f.forEach((function(e){p.value+=e}));var h=Object(c.a)(r,a)?a:"span";(n=document.createElement(h)).setAttributeNode(p)}else{var v=Object(c.a)(r,a)?a:"span";n=document.createElement(v)}for(var m=0;m<e.childNodes.length;m++){var b=l(e.childNodes[m],t);n.appendChild(b)}}else{n=document.createElement("span");for(var g=0;g<e.childNodes.length;g++){var y=l(e.childNodes[g],t);n.appendChild(y)}}return n}var d=n(78);var f,p,h,v=function(e){if(!(void 0!==e&&0!==Object(d.a)(e).length))return"text-align:center";var t=m(e),n=y(e);return"position: absolute;margin: 0;transform: translate("+t.offset+"%,"+n.offset+"%);width: "+E(e.size)+"%;left: "+t.position+"%;top: "+(null!==n.position?n.position+"%":"auto")+";text-align: "+T(e.align)+";"};!function(e){e.LINE_LEFT="line-left",e.CENTER="center",e.LINE_RIGHT="line-right"}(f||(f={})),function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(p||(p={})),function(e){e.START="start",e.CENTER="center",e.END="end"}(h||(h={}));var m=function(e){return{position:b(e),offset:g(e)}},b=function(e){var t,n=S(e.position);if(null!==n)return n;var r=T(e.align);return((t={})[p.LEFT]=0,t[p.CENTER]=50,t[p.RIGHT]=100,t)[r]},g=function(e){var t,n,r,i,a=((t={})[f.LINE_LEFT]=0,t[f.CENTER]=-50,t[f.LINE_RIGHT]=-100,t),o=void 0!==e.position?(r=e.position,i=/,(line-left|line-right|center)/.exec(r),!Array.isArray(i)||i.length<2?null:i[1]):null;return null!==o?a[o]:((n={})[p.LEFT]=0,n[p.CENTER]=-50,n[p.RIGHT]=-100,n)[void 0!==e.align?T(e.align):p.CENTER]},y=function(e){return{position:_(e.line),offset:O(e.line)}},_=function(e){return S(e)},O=function(e){var t,n=((t={})[h.START]=0,t[h.CENTER]=-50,t[h.END]=-100,t);if(void 0===e)return n[h.START];var r,i=(r=/,(start|center|end)/.exec(e),!Array.isArray(r)||r.length<2?null:r[1]);return null!==i?n[i]:n[h.START]},T=function(e){switch(e){case"left":case"start":return"left";case"right":case"end":return"right";default:return"center"}},E=function(e){return w(e,100)},w=function(e,t){var n=S(e);return null!==n?n:t},S=function(e){if(void 0===e)return null;var t=/^([\d.]+)%/.exec(e);return!Array.isArray(t)||t.length<2?null:parseInt(t[1],10)};function j(e,t){var n=e.start,r=e.end,a=e.settings,o=e.header,s=e.payload,u=document.createElement("div"),c=document.createAttribute("style");c.value="width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-end;align-items:center;",u.setAttributeNode(c);var d=document.createElement("p"),f=function(e){var t=document.createAttribute("style");return t.value=v(e),t}(a);d.setAttributeNode(f);var p=document.createElement("span"),h=document.createAttribute("style");h.value="background-color:rgba(0,0,0,0.8);color:white;",p.setAttributeNode(h);var m=t.global,b=t.classes,g=[m,Object(i.a)(o)?b[o]:void 0].filter((function(e){return void 0!==e})).join("");return h.value+=g,p.setAttributeNode(h),function(e,t){for(var n=e.replace(/<[0-9]{2}:[0-9]{2}.[0-9]{3}>/,"").replace(/<([u,i,b,c])(\..*?)?(?: .*?)?>(.*?)<\/\1>/g,"<$1$2>$3</$1$2>"),r=(new DOMParser).parseFromString(n,"text/html").body.childNodes,i=[],a=0;a<r.length;a++)i.push(l(r[a],t));return i}(s.join("\n"),b).forEach((function(e){p.appendChild(e)})),u.appendChild(d),d.appendChild(p),{start:n,end:r,element:u}}t.default=function(e,t){var n=e.split(/\r\n|\n|\r/g),s=[];if(null===/^WEBVTT( |\t|\n|\r|$)/.exec(n[0]))throw new Error("Can't parse WebVTT: Invalid File.");for(var c=Object(a.b)(n),l=function(e,t){for(var n=[],r=t;r<e.length;r++)if(Object(a.d)(e,r)){var o=r;for(r++;Object(i.a)(e[r]);)r++;var s=e.slice(o,r);n.push(s)}else if(Object(i.a)(e[r]))for(;Object(i.a)(e[r]);)r++;return n}(n,c),d=Object(r.a)(n,c),f=u(l),p=0;p<d.length;p++){var h=Object(o.a)(d[p],t);if(null!=h){var v=j(h,f);s.push(v)}}return s}},function(e,t,n){"use strict";n.r(t);var r=n(15),i=n.n(r),a=n(105),o=n(228),s=n(103),u=n(30),c=n(57),l=n(82),d=n(185),f=n(242),p=n(187),h=n(234),v=n(8),m=n(171),b=n(4),g=n(0),y=n(32),_=n(89),O=n(24);function T(e,t){return Math.abs(e-t)<=.2}function E(e,t){for(var n=e.length-1;n>=0;n--){if(e[n].start<t)return e.slice(0,n+1)}return[]}function w(e,t){for(var n=0;n<e.length;n++){if(e[n].end>t)return e.slice(n,e.length)}return[]}function S(e,t,n){var r=Math.max(e.start,t),i=E(e.cues,t),a={start:e.start,end:r,cues:i},o=Math.min(n,e.end),s=w(e.cues,n);return[a,{start:o,end:e.end,cues:s}]}var j=function(){function e(){this._cuesBuffer=[]}var t=e.prototype;return t.get=function(e){for(var t=this._cuesBuffer,n=[],r=t.length-1;r>=0;r--){var i=t[r];if(e<i.end&&e>=i.start){for(var a=i.cues,o=0;o<a.length;o++)e>=a[o].start&&e<a[o].end&&n.push(a[o].element);return n}}return[]},t.remove=function(e,t){for(var n=Math.max(e,t),r=this._cuesBuffer,i=0;i<r.length;i++)if(r[i].end>e){var a=r[i];if(a.start>=n)return;if(a.end>=n){if(e<=a.start)a.cues=w(a.cues,n),a.start=n;else{var o=S(a,e,n),s=o[0],u=o[1];this._cuesBuffer[i]=s,r.splice(i+1,0,u)}return}a.start>=e?(r.splice(i,1),i--):(a.cues=E(a.cues,e),a.end=Math.max(e,a.start))}},t.insert=function(e,t,n){var r=this._cuesBuffer,i={start:t,end:n,cues:e};function a(e){var t=r[e];void 0===t||T(i.end,t.end)?r[e]=i:(t.start>=i.end||(t.cues=w(t.cues,i.end),t.start=i.end),r.splice(e,0,i))}for(var o=0;o<r.length;o++){var s=r[o];if(t<s.end){if(T(t,s.start)){if(T(n,s.end))return void(r[o]=i);if(n<s.end)return s.cues=w(s.cues,n),s.start=n,void r.splice(o,0,i);do{r.splice(o,1),s=r[o]}while(void 0!==s&&n>s.end);return void a(o)}if(t<s.start){if(n<s.start)return void r.splice(o,0,i);if(T(n,s.start))return s.start=n,void r.splice(o,0,i);if(T(n,s.end))return void r.splice(o,1,i);if(n<s.end)return s.cues=w(s.cues,n),s.start=n,void r.splice(o,0,i);do{r.splice(o,1),s=r[o]}while(void 0!==s&&n>s.end);return void a(o)}if(T(s.end,n))return s.cues=E(s.cues,t),s.end=t,void r.splice(o+1,0,i);if(s.end>n){var u=S(s,t,n),c=u[0],l=u[1];return this._cuesBuffer[o]=c,r.splice(o+1,0,i),void r.splice(o+2,0,l)}for(s.cues=E(s.cues,t),s.end=t,s=r[o+1];void 0!==s&&n>s.end;)r.splice(o,1),s=r[o];return void a(o)}}r.push(i)},e}();function k(e,t,n,r){for(var i=[t/n.columns,e/n.rows],a=r.getElementsByClassName("proportional-style"),o=0;o<a.length;o++){var s=a[o];if(s instanceof HTMLElement){var u=s.getAttribute("data-proportional-font-size");null===u||isNaN(+u)||(s.style.fontSize=String(+u*i[1])+"px");var c=s.getAttribute("data-proportional-width");null===c||isNaN(+c)||(s.style.width=String(+c*i[0])+"px");var l=s.getAttribute("data-proportional-height");null===l||isNaN(+l)||(s.style.height=String(+l*i[1])+"px");var d=s.getAttribute("data-proportional-line-height");null===d||isNaN(+d)||(s.style.lineHeight=String(+d*i[1])+"px");var f=s.getAttribute("data-proportional-left");null===f||isNaN(+f)||(s.style.left=String(+f*i[0])+"px");var p=s.getAttribute("data-proportional-top");null===p||isNaN(+p)||(s.style.top=String(+p*i[1])+"px");var h=s.getAttribute("data-proportional-padding-top");null===h||isNaN(+h)||(s.style.paddingTop=String(+h*i[1])+"px");var v=s.getAttribute("data-proportional-padding-bottom");null===v||isNaN(+v)||(s.style.paddingBottom=String(+v*i[1])+"px");var m=s.getAttribute("data-proportional-padding-left");null===m||isNaN(+m)||(s.style.paddingLeft=String(+m*i[0])+"px");var b=s.getAttribute("data-proportional-padding-right");null===b||isNaN(+b)||(s.style.paddingRight=String(+b*i[0])+"px")}}return a.length>0}var A=v.a.onEnded$,x=v.a.onSeeked$,I=v.a.onSeeking$,M=b.a.MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL,R=b.a.TEXT_TRACK_SIZE_CHECKS_INTERVAL;function C(e,t){try{e.removeChild(t)}catch(e){g.a.warn("HTSB: Can't remove text track: not in the element.")}}function N(e){var t=e.getAttribute("data-resolution-rows"),n=e.getAttribute("data-resolution-columns");if(null===t||null===n)return null;var r=parseInt(t,10),i=parseInt(n,10);return null===r||null===i?null:{rows:r,columns:i}}var P=function(e){function t(t,n){var r;return g.a.debug("HTSB: Creating HTMLTextSegmentBuffer"),(r=e.call(this)||this).bufferType="text",r._buffered=new _.a,r._videoElement=t,r._textTrackElement=n,r._clearSizeUpdates$=new c.a,r._destroy$=new c.a,r._buffer=new j,r._currentCues=[],function(e){var t=I(e),n=x(e),r=A(e),i=Object(a.a)(n,r),c=Object(o.a)(M).pipe(Object(d.a)(null));return i.pipe(Object(d.a)(null),Object(f.a)(Object(s.a)(c.pipe(Object(p.a)(!0),Object(h.a)(t)),Object(u.a)(!1))))}(r._videoElement).pipe(Object(h.a)(r._destroy$)).subscribe((function(e){if(e){var t=Math.max(r._videoElement.currentTime+M/1e3/2,0),n=r._buffer.get(t);0===n.length?r._disableCurrentCues():r._displayCues(n)}else r._disableCurrentCues()})),r}i()(t,e);var n=t.prototype;return n.pushChunk=function(e){var t=this;return Object(l.a)((function(){return t.pushChunkSync(e),Object(u.a)(void 0)}))},n.removeBuffer=function(e,t){var n=this;return Object(l.a)((function(){return n.removeBufferSync(e,t),Object(u.a)(void 0)}))},n.endOfSegment=function(e){var t=this;return Object(l.a)((function(){return t._segmentInventory.completeSegment(e),Object(u.a)(void 0)}))},n.getBufferedRanges=function(){return this._buffered},n.dispose=function(){g.a.debug("HTSB: Disposing HTMLTextSegmentBuffer"),this._disableCurrentCues(),this._buffer.remove(0,1/0),this._buffered.remove(0,1/0),this._destroy$.next(),this._destroy$.complete()},n.pushChunkSync=function(e){var t,n;g.a.debug("HTSB: Appending new html text tracks");var r=e.data,i=r.timestampOffset,a=r.appendWindow,o=r.chunk;if(null!==o){var s,u,c=o.start,l=o.end,d=o.data,f=o.type,p=o.language,h=null!==(t=a[0])&&void 0!==t?t:0,v=null!==(n=a[1])&&void 0!==n?n:1/0,m=function(e,t,n,r){g.a.debug("HTSB: Finding parser for html text tracks:",e);var i=O.a.htmlTextTracksParsers[e];if("function"!=typeof i)throw new Error("no parser found for the given text track");g.a.debug("HTSB: Parser found, parsing...");var a=i(t,n,r);return g.a.debug("HTTB: Parsed successfully!",a),a}(f,d,i,p);if(0!==h&&v!==1/0){for(var b=0;b<m.length&&m[b].end<=h;)b++;for(m.splice(0,b),b=0;b<m.length&&m[b].start<h;)m[b].start=h,b++;for(b=m.length-1;b>=0&&m[b].start>=v;)b--;for(m.splice(b,m.length),b=m.length-1;b>=0&&m[b].end>v;)m[b].end=v,b--}if(void 0!==c)s=Math.max(h,c);else{if(m.length<=0)return void g.a.warn("HTSB: Current text tracks have no cues nor start time. Aborting");g.a.warn("HTSB: No start time given. Guessing from cues."),s=m[0].start}if(void 0!==l)u=Math.min(v,l);else{if(m.length<=0)return void g.a.warn("HTSB: Current text tracks have no cues nor end time. Aborting");g.a.warn("HTSB: No end time given. Guessing from cues."),u=m[m.length-1].end}u<=s?g.a.warn("HTSB: Invalid text track appended: ","the start time is inferior or equal to the end time."):(null!==e.inventoryInfos&&this._segmentInventory.insertChunk(e.inventoryInfos),this._buffer.insert(m,s,u),this._buffered.insert(s,u))}},n.removeBufferSync=function(e,t){g.a.debug("HTSB: Removing html text track data",e,t),this._buffer.remove(e,t),this._buffered.remove(e,t)},n._disableCurrentCues=function(){if(this._clearSizeUpdates$.next(),this._currentCues.length>0){for(var e=0;e<this._currentCues.length;e++)C(this._textTrackElement,this._currentCues[e].element);this._currentCues=[]}},n._displayCues=function(e){if(!(this._currentCues.length===e.length&&this._currentCues.every((function(t,n){return t.element===e[n]})))){this._clearSizeUpdates$.next();for(var t=0;t<this._currentCues.length;t++)C(this._textTrackElement,this._currentCues[t].element);this._currentCues=[];for(var n=0;n<e.length;n++){var r=e[n],i=N(r);this._currentCues.push({element:r,resolution:i}),this._textTrackElement.appendChild(r)}var a=this._currentCues.filter((function(e){return null!==e.resolution}));a.length>0&&Object(m.a)(this._textTrackElement,R).pipe(Object(h.a)(this._clearSizeUpdates$),Object(h.a)(this._destroy$)).subscribe((function(e){for(var t=e.height,n=e.width,r=0;r<a.length;r++){var i=a[r];k(t,n,i.resolution,i.element)}}))}},t}(y.a);t.default=P},function(e,t,n){"use strict";n.r(t);var r=n(15),i=n.n(r),a=n(82),o=n(30),s=n(169),u=n(0),c=n(19);function l(e,t){if(c.b&&function(e,t){var n=e.activeCues;if(null===n)return!1;for(var r=0;r<n.length;r++)if(n[r]===t)return!0;return!1}(e,t)){var n=e.mode;e.mode="hidden";try{e.removeCue(t)}catch(e){u.a.warn("Compat: Could not remove cue from text track.")}e.mode=n}else try{e.removeCue(t)}catch(e){u.a.warn("Compat: Could not remove cue from text track.")}}var d=n(32),f=n(89),p=n(24);var h=function(e){function t(t,n){var r;u.a.debug("NTSB: Creating NativeTextSegmentBuffer"),r=e.call(this)||this;var i=Object(s.a)(t,n),a=i.track,o=i.trackElement;return r.bufferType="text",r._buffered=new f.a,r._videoElement=t,r._track=a,r._trackElement=o,r}i()(t,e);var n=t.prototype;return n.pushChunk=function(e){var t=this;return Object(a.a)((function(){var n,r;if(u.a.debug("NTSB: Appending new native text tracks"),null===e.data.chunk)return Object(o.a)(void 0);var i,a,s=e.data,c=s.timestampOffset,l=s.appendWindow,d=s.chunk,f=d.start,h=d.end,v=d.data,m=d.type,b=d.language,g=null!==(n=l[0])&&void 0!==n?n:0,y=null!==(r=l[1])&&void 0!==r?r:1/0,_=function(e,t,n,r){u.a.debug("NTSB: Finding parser for native text tracks:",e);var i=p.a.nativeTextTracksParsers[e];if("function"!=typeof i)throw new Error("no parser found for the given text track");u.a.debug("NTSB: Parser found, parsing...");var a=i(t,n,r);return u.a.debug("NTSB: Parsed successfully!",a),a}(m,v,c,b);if(0!==g&&y!==1/0){for(var O=0;O<_.length&&_[O].endTime<=g;)O++;for(_.splice(0,O),O=0;O<_.length&&_[O].startTime<g;)_[O].startTime=g,O++;for(O=_.length-1;O>=0&&_[O].startTime>=y;)O--;for(_.splice(O,_.length),O=_.length-1;O>=0&&_[O].endTime>y;)_[O].endTime=y,O--}if(void 0!==f)i=Math.max(g,f);else{if(_.length<=0)return u.a.warn("NTSB: Current text tracks have no cues nor start time. Aborting"),Object(o.a)(void 0);u.a.warn("NTSB: No start time given. Guessing from cues."),i=_[0].startTime}if(void 0!==h)a=Math.min(y,h);else{if(_.length<=0)return u.a.warn("NTSB: Current text tracks have no cues nor end time. Aborting"),Object(o.a)(void 0);u.a.warn("NTSB: No end time given. Guessing from cues."),a=_[_.length-1].endTime}if(a<=i)return u.a.warn("NTSB: Invalid text track appended: ","the start time is inferior or equal to the end time."),Object(o.a)(void 0);if(_.length>0){var T=_[0],E=t._track.cues;null!==E&&E.length>0&&T.startTime<E[E.length-1].startTime&&t._removeData(T.startTime,1/0);for(var w=0;w<_.length;w++)t._track.addCue(_[w])}return t._buffered.insert(i,a),null!==e.inventoryInfos&&t._segmentInventory.insertChunk(e.inventoryInfos),Object(o.a)(void 0)}))},n.removeBuffer=function(e,t){var n=this;return Object(a.a)((function(){return n._removeData(e,t),Object(o.a)(void 0)}))},n.endOfSegment=function(e){var t=this;return Object(a.a)((function(){return t._segmentInventory.completeSegment(e),Object(o.a)(void 0)}))},n.getBufferedRanges=function(){return this._buffered},n.dispose=function(){u.a.debug("NTSB: Aborting NativeTextSegmentBuffer"),this._removeData(0,1/0);var e=this._trackElement,t=this._videoElement;if(void 0!==e&&t.hasChildNodes())try{t.removeChild(e)}catch(e){u.a.warn("NTSB: Can't remove track element from the video")}this._track.mode="disabled",void 0!==this._trackElement&&(this._trackElement.innerHTML="")},n._removeData=function(e,t){u.a.debug("NTSB: Removing native text track data",e,t);var n=this._track,r=n.cues;if(null!==r)for(var i=r.length-1;i>=0;i--){var a=r[i],o=a.startTime,s=a.endTime;o>=e&&o<=t&&s<=t&&l(n,a)}this._buffered.remove(e,t)},t}(d.a);t.default=h},function(e,t,n){"use strict";n.r(t);var r=n(170),i=n(126),a=n(139),o=n(68),s=n(10),u=n(2);function c(e,t){if(!Object(u.a)(e.vertical)||"rl"!==e.vertical&&"lr"!==e.vertical||(t.vertical=e.vertical),Object(u.a)(e.line)){var n=/^(\d+(\.\d+)?)%(,([a-z]+))?/.exec(e.line);if(Array.isArray(n))t.line=Number(n[1]),t.snapToLines=!1,Object(s.a)(["start","center","end"],n[4])&&(t.lineAlign=n[4]);else{var r=/^(-?\d+)(,([a-z]+))?/.exec(e.line);Array.isArray(r)&&(t.line=Number(r[1]),t.snapToLines=!0,Object(s.a)(["start","center","end"],r[3])&&(t.lineAlign=r[3]))}}if(Object(u.a)(e.position)){var i=/^([\d\.]+)%(?:,(line-left|line-right|center))?$/.exec(e.position);if(Array.isArray(i)&&i.length>=2){var a=parseInt(i[1],10);isNaN(a)||(t.position=a,void 0!==i[2]&&(t.positionAlign=i[2]))}}Object(u.a)(e.size)&&(t.size=e.size),"string"==typeof e.align&&Object(s.a)(["start","center","end","left"],e.align)&&(t.align=e.align)}var l=n(127);t.default=function(e,t){var n=e.split(/\r\n|\n|\r/);if(!/^WEBVTT($| |\t)/.test(n[0]))throw new Error("Can't parse WebVTT: Invalid file.");for(var s,u,d,f,p=Object(o.b)(n),h=Object(i.a)(n,p),v=[],m=0;m<h.length;m++){var b=Object(a.a)(h[m],t);if(null!=b){var g=(u=void 0,d=void 0,f=void 0,u=(s=b).start,d=s.end,f=s.payload.join("\n"),Object(l.a)(u,d,f));null!=g&&(Object(r.a)(g)&&c(b.settings,g),v.push(g))}}return v}},function(e,t,n){"use strict";n.r(t);var r=n(135),i=n(127),a=n(170),o=n(2),s=n(140),u=n(16),c={left:"start",center:"center",right:"end",start:"start",end:"end"},l={left:"line-left",center:"center",right:"line-right"};function d(e){var t=e.paragraph,n=e.timeOffset,r=e.paragraphStyle,d=e.ttParams,f=e.shouldTrimWhiteSpace;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;var p=Object(s.a)(t,d),h=p.start,v=p.end,m=function(e,t){function n(e,t){for(var r=e.childNodes,i="",a=0;a<r.length;a++){var s=r[a];if("#text"===s.nodeName){var u=s.textContent;if(null===u&&(u=""),t){var c=u.trim();u=c=c.replace(/\s+/g," ")}i+=u.replace(/&|\u0026/g,"&amp;").replace(/<|\u003C/g,"&lt;").replace(/>|\u2265/g,"&gt;").replace(/\u200E/g,"&lrm;").replace(/\u200F/g,"&rlm;").replace(/\u00A0/g,"&nbsp;")}else if("br"===s.nodeName)i+="\n";else if("span"===s.nodeName&&s.nodeType===Node.ELEMENT_NODE&&s.childNodes.length>0){var l=s.getAttribute("xml:space");i+=n(s,Object(o.a)(l)?"default"===l:t)}}return i}return n(e,t)}(t,f),b=Object(i.a)(h+n,v+n,m);return null===b?null:(Object(a.a)(b)&&function(e,t){var n=t.extent;if(Object(o.a)(n)){var r=u.d.exec(n);null!=r&&(e.size=Number(r[1]))}switch(t.writingMode){case"tb":case"tblr":e.vertical="lr";break;case"tbrl":e.vertical="rl"}var i=t.origin;if(Object(o.a)(i))u.d.exec(i);var a=t.align;if(Object(o.a)(a)){e.align=a,"center"===a&&("center"!==e.align&&(e.align="middle"),e.position="auto");var s=l[a];e.positionAlign=void 0===s?"":s;var d=c[a];e.lineAlign=void 0===d?"":d}}(b,r),b)}t.default=function(e,t){for(var n=Object(r.a)(e,t),i=[],a=0;a<n.length;a++){var o=d(n[a]);null!==o&&i.push(o)}return i}},function(e,t,n){"use strict";n.r(t);var r=n(15),i=n.n(r),a=n(82),o=n(30),s=n(0),u=n(32),c=n(89),l=function(e){function t(){var t;return s.a.debug("ISB: Creating ImageSegmentBuffer"),(t=e.call(this)||this).bufferType="image",t._buffered=new c.a,t}i()(t,e);var n=t.prototype;return n.pushChunk=function(e){var t=this;return Object(a.a)((function(){var n,r;if(s.a.debug("ISB: appending new data."),null===e.data.chunk)return Object(o.a)(void 0);var i=e.data,a=i.appendWindow,u=i.chunk,c=u.start,l=u.end,d=u.timescale,f=null!==(n=a[0])&&void 0!==n?n:0,p=null!==(r=a[1])&&void 0!==r?r:1/0,h=c/d,v=l/d,m=Math.max(f,h),b=Math.min(p,v);return t._buffered.insert(m,b),null!==e.inventoryInfos&&t._segmentInventory.insertChunk(e.inventoryInfos),Object(o.a)(void 0)}))},n.removeBuffer=function(e,t){return Object(a.a)((function(){return s.a.info("ISB: ignored image data remove order",e,t),Object(o.a)(void 0)}))},n.endOfSegment=function(e){var t=this;return Object(a.a)((function(){return t._segmentInventory.completeSegment(e),Object(o.a)(void 0)}))},n.getBufferedRanges=function(){return this._buffered},n.dispose=function(){s.a.debug("ISB: disposing image SegmentBuffer"),this._buffered.remove(0,1/0)},t}(u.a);t.default=l},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(12),i=n(61),a=n(66),o=n(37);function s(e,t,n,c){return Object(a.a)(n)&&(c=n,n=void 0),c?s(e,t,n).pipe(Object(o.a)((function(e){return Object(i.a)(e)?c.apply(void 0,e):c(e)}))):new r.a((function(r){u(e,t,(function(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e)}),r,n)}))}function u(e,t,n,r,i){var a;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var o=e;e.addEventListener(t,n,i),a=function(){return o.removeEventListener(t,n,i)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var s=e;e.on(t,n),a=function(){return s.off(t,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var c=e;e.addListener(t,n),a=function(){return c.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var l=0,d=e.length;l<d;l++)u(e[l],t,n,r,i)}r.add(a)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(12),i=n(51),a=n(84);function o(e,t){return void 0===e&&(e=0),void 0===t&&(t=i.a),(!Object(a.a)(e)||e<0)&&(e=0),t&&"function"==typeof t.schedule||(t=i.a),new r.a((function(n){return n.add(t.schedule(s,e,{subscriber:n,counter:0,period:e})),n}))}function s(e){var t=e.subscriber,n=e.counter,r=e.period;t.next(n),this.schedule({subscriber:t,counter:n+1,period:r},r)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(102),i=n(132),a=n(57);function o(){return new a.a}function s(){return function(e){return Object(i.a)()(Object(r.a)(o)(e))}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(5),i=n(56),a=n(61),o=n(88),s=n(93),u=n(76),c={};function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=void 0,r=void 0;return Object(i.a)(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&Object(a.a)(e[0])&&(e=e[0]),Object(u.a)(e,r).lift(new d(n))}var d=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new f(e,this.resultSelector))},e}(),f=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return r.a(t,e),t.prototype._next=function(e){this.values.push(c),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(Object(s.a)(this,r,void 0,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=this.values,i=r[n],a=this.toRespond?i===c?--this.toRespond:this.toRespond:0;r[n]=t,0===a&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(o.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(23);function a(e){return function(t){return t.lift(new o(e))}}var o=function(){function e(e){this.notifier=e}return e.prototype.call=function(e,t){var n=new s(e),r=Object(i.c)(this.notifier,new i.a(n));return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n},e}(),s=function(e){function t(t){var n=e.call(this,t)||this;return n.seenValue=!1,n}return r.a(t,e),t.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},t.prototype.notifyComplete=function(){},t}(i.b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(189),i=n(190),a=n(30),o=n(50),s=n(37),u=n(155),c=n(27);function l(e){return Object(r.a)(Object(c.a)(e.close()),Object(i.a)(1e3).pipe(Object(o.a)((function(){return Object(c.a)(e.update(new Uint8Array(1))).pipe(Object(s.a)((function(){throw new Error("Compat: Couldn't know if session is closed")})),Object(u.a)((function(t){if(t instanceof Error&&"The session is already closed."===t.message)return Object(a.a)(null);var n=Object(c.a)(e.closed);return Object(r.a)(n,Object(i.a)(1e3).pipe(Object(s.a)((function(){throw new Error("Compat: Couldn't know if session is closed")}))))})))}))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),i=n(44),a=n(1),o=n(119);function s(e){for(var t=new Uint8Array,n=[],i=0;i<e.length;){if(e.length<i+8||Object(a.c)(e,i+4)!==o.a)return r.a.warn("Compat: Unrecognized initialization data. Use as is."),e;var s=Object(a.c)(new Uint8Array(e),i);if(i+s>e.length)return r.a.warn("Compat: Unrecognized initialization data. Use as is."),e;var c=e.subarray(i,i+s);u(n,c)?r.a.warn("Compat: Duplicated PSSH found in initialization data, removing it."):(t=Object(a.e)(t,c),n.push(e)),i+=s}return i!==e.length?(r.a.warn("Compat: Unrecognized initialization data. Use as is."),e):t}function u(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(Object(i.a)(t,r))return!0}return!1}function c(e){var t=e.initData,n=e.initDataType;return null==t?(r.a.warn("Compat: No init data found on media encrypted event."),{initData:t,initDataType:n}):{initData:s(new Uint8Array(t)),initDataType:e.initDataType}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(82),i=n(30),a=n(12),o=n(50),s=n(0),u=n(27),c=n(45);function l(e,t){return Object(r.a)((function(){return s.a.info("Compat/EME: Load persisted session",t),Object(c.a)((function(){return Object(u.a)(e.load(t))}),void 0)})).pipe(Object(o.a)((function(t){return!t||e.keyStatuses.size>0?Object(i.a)(t):new a.a((function(e){var n=setTimeout((function(){e.next(t),e.complete()}),0);return function(){clearTimeout(n)}}))})))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(82),i=n(155),a=n(0),o=n(35),s=n(1),u=n(27),c=n(119);function l(e,t){return Object(r.a)((function(){var n,r;a.a.debug("Compat: Calling generateRequest on the MediaKeySession");try{r=function(e){a.a.info("Compat: Trying to move CENC PSSH from init data at the end of it.");for(var t=!1,n=new Uint8Array,r=new Uint8Array,i=0;i<e.length;){if(e.length<i+8||Object(s.c)(e,i+4)!==c.a)throw a.a.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");var u=Object(s.c)(new Uint8Array(e),i);if(i+u>e.length)throw a.a.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");var l=e.subarray(i,i+u);if(16===e[i+12]&&119===e[i+13]&&239===e[i+14]&&236===e[i+15]&&192===e[i+16]&&178===e[i+17]&&77===e[i+18]&&2===e[i+19]&&172===e[i+20]&&227===e[i+21]&&60===e[i+22]&&30===e[i+23]&&82===e[i+24]&&226===e[i+25]&&251===e[i+26]&&75===e[i+27]){var d=Object(o.d)(l),f=null===d?void 0:l[d[1]];a.a.info("Compat: CENC PSSH found with version",f),void 0===f?a.a.warn("Compat: could not read version of CENC PSSH"):t===(1===f)?n=Object(s.e)(n,l):1===f?(a.a.warn("Compat: cenc version 1 encountered, removing every other cenc pssh box."),n=l,t=!0):a.a.warn("Compat: filtering out cenc pssh box with wrong version",f)}else r=Object(s.e)(r,l);i+=u}if(i!==e.length)throw a.a.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");return Object(s.e)(r,n)}(t.data)}catch(e){r=t.data}var l=null!==(n=t.type)&&void 0!==n?n:"";return Object(u.a)(e.generateRequest(l,r)).pipe(Object(i.a)((function(t){if(""!==l||!(t instanceof TypeError))throw t;return a.a.warn('Compat: error while calling `generateRequest` with an empty initialization data type. Retrying with a default "cenc" value.',t),Object(u.a)(e.generateRequest("cenc",r))})))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),i=n(11),a=n(35);function o(e){var t=0,n=Object(a.b)(e,1836019574);if(null===n)return[];for(var i=[];t<n.length;){var o=void 0;try{o=Object(a.c)(n,1886614376)}catch(e){return r.a.warn("ISOBMFF:",e),i}if(null==o)return i;var u=n.slice(o[0],o[2]),c=s(u,o[1]-o[0]);null!==c&&i.push({systemID:c,data:u}),n[o[0]+4]=102,n[o[0]+5]=114,n[o[0]+6]=101,n[o[0]+7]=101,t=o[2]}return i}function s(e,t){if(e[t]>1)return r.a.warn("ISOBMFF: un-handled PSSH version"),null;var n=t+4;if(n+16>e.length)return null;var a=e.slice(n,n+16);return Object(i.a)(a)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return d}));n(55);var r=n(1),i=(n(11),n(99)),a=(n(181),n(35)),o=n(142);function s(e,t){var n=Object(a.c)(e,1936286840);if(null===n)return null;var i=t,o=n[2]-n[0],s=n[1],u=e[s];s+=8;var c,l=Object(r.c)(e,s);if(s+=4,0===u)c=Object(r.c)(e,s),s+=4,i+=Object(r.c)(e,s)+o,s+=4;else{if(1!==u)return null;c=Object(r.d)(e,s),s+=8,i+=Object(r.d)(e,s)+o,s+=8}var d=[];s+=2;var f=Object(r.a)(e,s);for(s+=2;--f>=0;){var p=Object(r.c)(e,s);s+=4;var h=2147483647&p;if(1===(2147483648&p)>>>31)throw new Error("sidx with reference_type `1` not yet implemented");var v=Object(r.c)(e,s);s+=4,s+=4,d.push({time:c,duration:v,count:0,timescale:l,range:[i,i+h-1]}),c+=v,i+=h}return d}function u(e){var t=Object(o.c)(e);if(null!==t){var n=Object(a.b)(t,1952867444);if(null!==n){var i=n[0];return 1===i?Object(r.d)(n,4):0===i?Object(r.c)(n,4):void 0}}}function c(e){var t=Object(o.c)(e);if(null!==t){var n=Object(a.b)(t,1953658222);if(null!==n){var i=0,s=n[i];if(i+=1,!(s>1)){var u=Object(r.b)(n,i);i+=3;var c=(256&u)>0,l=0;if(c||void 0!==(l=function(e){var t=Object(a.b)(e,1952868452);if(null!==t){var n=1,i=Object(r.b)(t,n);if(n+=3,(8&i)>0)return n+=4,(1&i)>0&&(n+=8),(2&i)>0&&(n+=4),Object(r.c)(t,n)}}(t))){var d=(1&u)>0,f=(4&u)>0,p=(512&u)>0,h=(1024&u)>0,v=(2048&u)>0,m=Object(r.c)(n,i);i+=4,d&&(i+=4),f&&(i+=4);for(var b=m,g=0;b-- >0;)c?(g+=Object(r.c)(n,i),i+=4):g+=l,p&&(i+=4),h&&(i+=4),v&&(i+=4);return g}}}}}function l(e){var t=Object(o.b)(e);if(null!==t){var n=Object(a.b)(t,1835296868);if(null!==n){var i=0,s=n[i];return i+=4,1===s?Object(r.c)(n,i+16):0===s?Object(r.c)(n,i+8):void 0}}}function d(e){var t=e.length;if(t<4)throw new Error("Cannot update box length: box too short");var n=Object(r.c)(e,0);if(0===n){if(t>i.a){var a=new Uint8Array(t+8);return a.set(Object(r.h)(1),0),a.set(e.subarray(4,8),4),a.set(Object(r.i)(t+8),8),a.set(e.subarray(8,t),16),a}return e.set(Object(r.h)(t),0),e}if(1===n){if(t<16)throw new Error("Cannot update box length: box too short");return e.set(Object(r.i)(t),8),e}if(t<=i.a)return e.set(Object(r.h)(t),0),e;var o=new Uint8Array(t+8);return o.set(Object(r.h)(1),0),o.set(e.subarray(4,8),4),o.set(Object(r.i)(t+8),8),o.set(e.subarray(8,t),16),o}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5),i=n(9);function a(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new o(e,t,n))}}var o=function(){function e(e,t,n){void 0===n&&(n=!1),this.accumulator=e,this.seed=t,this.hasSeed=n}return e.prototype.call=function(e,t){return t.subscribe(new s(e,this.accumulator,this.seed,this.hasSeed))},e}(),s=function(e){function t(t,n,r,i){var a=e.call(this,t)||this;return a.accumulator=n,a._seed=r,a.hasSeed=i,a.index=0,a}return r.a(t,e),Object.defineProperty(t.prototype,"seed",{get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e},enumerable:!0,configurable:!0}),t.prototype._next=function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)},t.prototype._tryNext=function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(e){this.destination.error(e)}this.seed=t,this.destination.next(t)},t}(i.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(141);function i(e,t){return t?Object(r.a)((function(){return e}),t):Object(r.a)((function(){return e}))}}]).default}));