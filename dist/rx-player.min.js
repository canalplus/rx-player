/*! For license information please see rx-player.min.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.RxPlayer=t():e.RxPlayer=t()}(self,(function(){return function(){var e={3774:function(e,t,n){"use strict";n.d(t,{J:function(){return a},c:function(){return o}});var r=n(1946),i=n(2203).Z?void 0:window,a=void 0===i?void 0:(0,r.Z)(i.MediaSource)?(0,r.Z)(i.MozMediaSource)?(0,r.Z)(i.WebKitMediaSource)?i.MSMediaSource:i.WebKitMediaSource:i.MozMediaSource:i.MediaSource,o={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4}},3666:function(e,t,n){"use strict";n.d(t,{SB:function(){return m},YM:function(){return s},fq:function(){return o},gM:function(){return v},kD:function(){return u},op:function(){return d},uz:function(){return p},vS:function(){return h},vU:function(){return l},yS:function(){return c}});var r,i,a=n(2203),o=!a.Z&&void 0!==window.MSInputMethodContext&&void 0!==document.documentMode,s=!a.Z&&("Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&/(Trident|Edge)\//.test(navigator.userAgent)),u=!a.Z&&-1!==navigator.userAgent.toLowerCase().indexOf("edg/"),l=!a.Z&&-1!==navigator.userAgent.toLowerCase().indexOf("firefox"),d=!a.Z&&/SamsungBrowser/.test(navigator.userAgent),c=!a.Z&&/Tizen/.test(navigator.userAgent),f=!a.Z&&navigator.userAgent.indexOf("Web0S")>=0,v=f&&(/[Ww]eb[O0]S.TV-2021/.test(navigator.userAgent)||/[Cc]hr[o0]me\/79/.test(navigator.userAgent)),p=f&&(/[Ww]eb[O0]S.TV-2022/.test(navigator.userAgent)||/[Cc]hr[o0]me\/87/.test(navigator.userAgent)),h=!a.Z&&(Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>=0||"[object SafariRemoteNotification]"===(null===(i=null===(r=window.safari)||void 0===r?void 0:r.pushNotification)||void 0===i?void 0:i.toString())),m=!a.Z&&"string"==typeof navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)},5767:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3887),i=n(1946);function a(e){var t=e.textTracks;if(!(0,i.Z)(t)){for(var n=0;n<t.length;n++)t[n].mode="disabled";if(e.hasChildNodes())for(var a=e.childNodes,o=a.length-1;o>=0;o--)if("track"===a[o].nodeName)try{e.removeChild(a[o])}catch(e){r.Z.warn("Compat: Could not remove text track child from element.")}}e.src="",e.removeAttribute("src")}},6139:function(e,t,n){"use strict";n.d(t,{N:function(){return C},Y:function(){return D}});var r,i=n(3714),a=n(811),o=n(3666),s=n(2203),u=n(5059),l=n(3144),d=function(){function e(e,t,n){this._keyType=e,this._mediaKeys=t,this._configuration=n}var t=e.prototype;return t.createMediaKeys=function(){var e=this;return new Promise((function(t){return t(e._mediaKeys)}))},t.getConfiguration=function(){return this._configuration},(0,l.Z)(e,[{key:"keySystem",get:function(){return this._keyType}}]),e}();if(!s.Z){var c=window.MSMediaKeys;void 0!==c&&void 0!==c.prototype&&"function"==typeof c.isTypeSupported&&"function"==typeof c.prototype.createSession&&(r=c)}var f,v=n(4578),p=n(6716),h=n(3071),m=n(3505),g=n(1959),y=n(2453),_=function(e){function t(t){var n;return(n=e.call(this)||this).expiration=NaN,n.keyStatuses=new Map,n._mk=t,n._closeSession$=new p.x,n.closed=new Promise((function(e){n._closeSession$.subscribe(e)})),n.update=function(e){return new Promise((function(t,r){if(void 0===n._ss)return r("MediaKeySession not set.");try{t(n._ss.update(e,""))}catch(e){r(e)}}))},n}(0,v.Z)(t,e);var n=t.prototype;return n.generateRequest=function(e,t){var n=this;return new Promise((function(e){var r=t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer);n._ss=n._mk.createSession("video/mp4",r),(0,h.T)(y.GJ(n._ss),y.GV(n._ss),y.Xe(n._ss)).pipe((0,m.R)(n._closeSession$)).subscribe((function(e){return n.trigger(e.type,e)})),e()}))},n.close=function(){var e=this;return new Promise((function(t){null!=e._ss&&(e._ss.close(),e._ss=void 0),e._closeSession$.next(),e._closeSession$.complete(),t()}))},n.load=function(){return Promise.resolve(!1)},n.remove=function(){return Promise.resolve()},(0,l.Z)(t,[{key:"sessionId",get:function(){var e,t;return null!==(t=null===(e=this._ss)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}}]),t}(g.Z),b=function(){function e(e){if(void 0===r)throw new Error("No MSMediaKeys API.");this._mediaKeys=new r(e)}var t=e.prototype;return t._setVideo=function(e){if(this._videoElement=e,void 0!==this._videoElement.msSetMediaKeys)return this._videoElement.msSetMediaKeys(this._mediaKeys)},t.createSession=function(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new _(this._mediaKeys)},t.setServerCertificate=function(){throw new Error("Server certificate is not implemented in your browser")},e}();if(!s.Z){var S=window.MozMediaKeys;void 0!==S&&void 0!==S.prototype&&"function"==typeof S.isTypeSupported&&"function"==typeof S.prototype.createSession&&(f=S)}var E=n(9689),T=n(8894),w=n(3635);function k(e){return"function"==typeof e.webkitGenerateKeyRequest}var A=function(e){function t(t,n){var r;(r=e.call(this)||this)._vid=t,r._key=n,r.sessionId="",r._closeSession=T.Z,r.keyStatuses=new Map,r.expiration=NaN;var i=function(e){r.trigger(e.type,e)};return r.closed=new Promise((function(e){r._closeSession=function(){["keymessage","message","keyadded","ready","keyerror","error"].forEach((function(e){t.removeEventListener(e,i),t.removeEventListener("webkit"+e,i)})),e()}})),["keymessage","message","keyadded","ready","keyerror","error"].forEach((function(e){t.addEventListener(e,i),t.addEventListener("webkit"+e,i)})),r}(0,v.Z)(t,e);var n=t.prototype;return n.update=function(e){var t=this;return new Promise((function(n,r){try{if(t._key.indexOf("clearkey")>=0){var i=e instanceof ArrayBuffer?new Uint8Array(e):e,a=JSON.parse((0,w.uR)(i)),o=(0,E.K)(a.keys[0].k),s=(0,E.K)(a.keys[0].kid);n(t._vid.webkitAddKey(t._key,o,s,""))}else n(t._vid.webkitAddKey(t._key,e,null,""))}catch(e){r(e)}}))},n.generateRequest=function(e,t){var n=this;return new Promise((function(e){n._vid.webkitGenerateKeyRequest(n._key,t),e()}))},n.close=function(){var e=this;return new Promise((function(t){e._closeSession(),t()}))},n.load=function(){return Promise.resolve(!1)},n.remove=function(){return Promise.resolve()},t}(g.Z),I=function(){function e(e){this._keySystem=e}var t=e.prototype;return t._setVideo=function(e){if(!k(e))throw new Error("Video not attached to the MediaKeys");this._videoElement=e},t.createSession=function(){if(null==this._videoElement)throw new Error("Video not attached to the MediaKeys");return new A(this._videoElement,this._keySystem)},t.setServerCertificate=function(){throw new Error("Server certificate is not implemented in your browser")},e}();var R=n(6968);var x=n(158);function Z(e,t){var n=e;if(void 0===n.webkitSetMediaKeys)throw new Error("No webKitMediaKeys API.");return n.webkitSetMediaKeys(t)}var P=function(e){function t(t,n,r){var i;return(i=e.call(this)||this)._serverCertificate=r,i._videoElement=t,i._keyType=n,i._unbindSession=T.Z,i._closeSession=T.Z,i.closed=new Promise((function(e){i._closeSession=e})),i.keyStatuses=new Map,i.expiration=NaN,i}(0,v.Z)(t,e);var n=t.prototype;return n.update=function(e){var t=this;return new Promise((function(n,r){if(void 0===t._nativeSession||void 0===t._nativeSession.update||"function"!=typeof t._nativeSession.update)return r("Unavailable WebKit key session.");try{var i;i=e instanceof ArrayBuffer?new Uint8Array(e):e instanceof Uint8Array?e:new Uint8Array(e.buffer),n(t._nativeSession.update(i))}catch(e){r(e)}}))},n.generateRequest=function(e,t){var n=this;return new Promise((function(e){var r,i,a,o=n._videoElement;if(void 0===(null===(r=o.webkitKeys)||void 0===r?void 0:r.createSession))throw new Error("No WebKitMediaKeys API.");if("com.apple.fps.1_0"===(a=n._keyType)||"com.apple.fps.2_0"===a){if(void 0===n._serverCertificate)throw new Error("A server certificate is needed for creating fairplay session.");i=function(e,t){var n=e instanceof Uint8Array?e:new Uint8Array(e),r=t instanceof Uint8Array?t:new Uint8Array(t);if((0,R.dN)(n,0)+4!==n.length)throw new Error("Unsupported WebKit initData.");var i=(0,w.wV)(n),a=i.indexOf("skd://"),o=a>-1?i.substring(a+6):i,s=(0,w.TZ)(o),u=0,l=new Uint8Array(n.byteLength+4+s.byteLength+4+r.byteLength);return l.set(n),u+=n.length,l.set((0,R.O_)(s.byteLength),u),u+=4,l.set(s,u),u+=s.byteLength,l.set((0,R.O_)(r.byteLength),u),u+=4,l.set(r,u),l}(t,n._serverCertificate)}else i=t;var s=o.webkitKeys.createSession("video/mp4",i);if(null==s)throw new Error("Impossible to get the key sessions");n._listenEvent(s),n._nativeSession=s,e()}))},n.close=function(){var e=this;return new Promise((function(t,n){e._unbindSession(),e._closeSession(),void 0!==e._nativeSession?(e._nativeSession.close(),t()):n("No session to close.")}))},n.load=function(){return Promise.resolve(!1)},n.remove=function(){return Promise.resolve()},n._listenEvent=function(e){var t=this;this._unbindSession();var n=function(e){t.trigger(e.type,e)};["keymessage","message","keyadded","ready","keyerror","error"].forEach((function(t){e.addEventListener(t,n),e.addEventListener("webkit"+t,n)})),this._unbindSession=function(){["keymessage","message","keyadded","ready","keyerror","error"].forEach((function(t){e.removeEventListener(t,n),e.removeEventListener("webkit"+t,n)}))}},(0,l.Z)(t,[{key:"sessionId",get:function(){var e,t;return null!==(t=null===(e=this._nativeSession)||void 0===e?void 0:e.sessionId)&&void 0!==t?t:""}}]),t}(g.Z),M=function(){function e(e){if(void 0===x.t)throw new Error("No WebKitMediaKeys API.");this._keyType=e,this._mediaKeys=new x.t(e)}var t=e.prototype;return t._setVideo=function(e){if(this._videoElement=e,void 0===this._videoElement)throw new Error("Video not attached to the MediaKeys");return Z(this._videoElement,this._mediaKeys)},t.createSession=function(){if(void 0===this._videoElement||void 0===this._mediaKeys)throw new Error("Video not attached to the MediaKeys");return new P(this._videoElement,this._keyType,this._serverCertificate)},t.setServerCertificate=function(e){return this._serverCertificate=e,Promise.resolve()},e}();var C=null,D=function(e,t){var n=e;return"function"==typeof n.setMediaKeys?n.setMediaKeys(t):"function"==typeof n.webkitSetMediaKeys?n.webkitSetMediaKeys(t):"function"==typeof n.mozSetMediaKeys?n.mozSetMediaKeys(t):"function"==typeof n.msSetMediaKeys&&null!==t?n.msSetMediaKeys(t):void 0};if(s.Z||null!=navigator.requestMediaKeySystemAccess&&!(0,u.Z)())C=function(){var e;return(e=navigator).requestMediaKeySystemAccess.apply(e,arguments)};else{var O,N;if(k(HTMLVideoElement.prototype)){var L={isTypeSupported:function(e){var t=document.querySelector("video");return null==t&&(t=document.createElement("video")),null!=t&&"function"==typeof t.canPlayType&&!!t.canPlayType("video/mp4",e)},createCustomMediaKeys:function(e){return new I(e)},setMediaKeys:function(e,t){if(null!==t){if(!(t instanceof I))throw new Error("Custom setMediaKeys is supposed to be called with old webkit custom MediaKeys.");return t._setVideo(e)}}};O=L.isTypeSupported,N=L.createCustomMediaKeys,D=L.setMediaKeys}else if(void 0!==x.t){var U=function(){if(void 0===x.t)throw new Error("No WebKitMediaKeys API.");return{isTypeSupported:x.t.isTypeSupported,createCustomMediaKeys:function(e){return new M(e)},setMediaKeys:function(e,t){if(null===t)return Z(e,t);if(!(t instanceof M))throw new Error("Custom setMediaKeys is supposed to be called with webkit custom MediaKeys.");return t._setVideo(e)}}}();O=U.isTypeSupported,N=U.createCustomMediaKeys,D=U.setMediaKeys}else if(o.fq&&void 0!==r){var B={isTypeSupported:function(e,t){if(void 0===r)throw new Error("No MSMediaKeys API.");return void 0!==t?r.isTypeSupported(e,t):r.isTypeSupported(e)},createCustomMediaKeys:function(e){return new b(e)},setMediaKeys:function(e,t){if(null!==t){if(!(t instanceof b))throw new Error("Custom setMediaKeys is supposed to be called with IE11 custom MediaKeys.");return t._setVideo(e)}}};O=B.isTypeSupported,N=B.createCustomMediaKeys,D=B.setMediaKeys}else if(void 0!==f){var F={isTypeSupported:function(e,t){if(void 0===f)throw new Error("No MozMediaKeys API.");return void 0!==t?f.isTypeSupported(e,t):f.isTypeSupported(e)},createCustomMediaKeys:function(e){if(void 0===f)throw new Error("No MozMediaKeys API.");return new f(e)},setMediaKeys:function(e,t){var n=e;if(void 0===n.mozSetMediaKeys||"function"!=typeof n.mozSetMediaKeys)throw new Error("Can't set video on MozMediaKeys.");return n.mozSetMediaKeys(t)}};O=F.isTypeSupported,N=F.createCustomMediaKeys,D=F.setMediaKeys}else{var z=window.MediaKeys,V=function(){if(void 0===z)throw new i.Z("MEDIA_KEYS_NOT_SUPPORTED","No `MediaKeys` implementation found in the current browser.");if(void 0===z.isTypeSupported){throw new Error("This browser seems to be unable to play encrypted contents currently. Note: Some browsers do not allow decryption in some situations, like when not using HTTPS.")}};O=function(e){return V(),(0,a.Z)("function"==typeof z.isTypeSupported),z.isTypeSupported(e)},N=function(e){return V(),new z(e)}}C=function(e,t){if(!O(e))return Promise.reject(new Error("Unsupported key type"));for(var n=0;n<t.length;n++){var r=t[n],i=r.videoCapabilities,a=r.audioCapabilities,o=r.initDataTypes,s=r.distinctiveIdentifier,u=!0;if(u=(u=u&&(null==o||o.some((function(e){return"cenc"===e}))))&&"required"!==s){var l={initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"required",sessionTypes:["temporary","persistent-license"]};void 0!==i&&(l.videoCapabilities=i),void 0!==a&&(l.audioCapabilities=a);var c=N(e);return Promise.resolve(new d(e,c,l))}}return Promise.reject(new Error("Unsupported configuration"))}}},158:function(e,t,n){"use strict";var r;if(n.d(t,{t:function(){return r}}),!n(2203).Z){var i=window.WebKitMediaKeys;void 0!==i&&"function"==typeof i.isTypeSupported&&"function"==typeof i.prototype.createSession&&"function"==typeof HTMLMediaElement.prototype.webkitSetMediaKeys&&(r=i)}},2453:function(e,t,n){"use strict";n.d(t,{w0:function(){return M},it:function(){return C},O0:function(){return D},Oh:function(){return F},M4:function(){return j},GV:function(){return V},Xe:function(){return K},GJ:function(){return z},eX:function(){return G},x6:function(){return B},bQ:function(){return H},Q$:function(){return W},y4:function(){return U},k6:function(){return N},N8:function(){return L},u_:function(){return O}});var r=n(5987),i=n(7878),a=n(1480),o=n(7877),s=n(5685),u=n(8474),l=n(3211),d=["addListener","removeListener"],c=["addEventListener","removeEventListener"],f=["on","off"];function v(e,t,n,h){if((0,u.m)(n)&&(h=n,n=void 0),h)return v(e,t,n).pipe((0,l.Z)(h));var m=(0,r.CR)(function(e){return(0,u.m)(e.addEventListener)&&(0,u.m)(e.removeEventListener)}(e)?c.map((function(r){return function(i){return e[r](t,i,n)}})):function(e){return(0,u.m)(e.addListener)&&(0,u.m)(e.removeListener)}(e)?d.map(p(e,t)):function(e){return(0,u.m)(e.on)&&(0,u.m)(e.off)}(e)?f.map(p(e,t)):[],2),g=m[0],y=m[1];if(!g&&(0,s.z)(e))return(0,o.z)((function(e){return v(e,t,n)}))((0,i.Xf)(e));if(!g)throw new TypeError("Invalid event target");return new a.y((function(e){var t=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.next(1<t.length?t:t[0])};return g(t),function(){return y(t)}}))}function p(e,t){return function(n){return function(r){return e[n](t,r)}}}var h=n(2967),m=new a.y(h.Z);var g=n(3071),y=n(6872),_=n(6923),b=n(1946),S=n(8894),E=n(5095),T=n(2203),w=n(5059),k=["","webkit","moz","ms"],A=T.Z||null==window.devicePixelRatio||0===window.devicePixelRatio?1:window.devicePixelRatio;function I(e,t){return t.filter((function(t){return function(e,t){var n=document.createElement(e.tagName),r="on"+t;return r in n||(n.setAttribute(r,"return;"),"function"==typeof n[r])}(e,t)}))[0]}function R(e,t){return e.reduce((function(e,n){return e.concat((void 0===t?k:t).map((function(e){return e+n})))}),[])}function x(e){var t,n=R(e);return function(e,r,i){if(!i.isCancelled){if(e instanceof HTMLElement){if(void 0===t&&(t=I(e,n)),!(0,_.Z)(t))return void 0;e.addEventListener(t,r),i.register((function(){void 0!==t&&e.removeEventListener(t,r)}))}n.forEach((function(t){e.addEventListener(t,r),i.register((function(){e.removeEventListener(t,r)}))}))}}}function Z(e,t){var n,r=R(e,t);return function(e){return e instanceof HTMLElement?(void 0===n&&(n=I(e,r)),(0,_.Z)(n)?v(e,n):m):g.T.apply(void 0,r.map((function(t){return v(e,t)})))}}function P(e,t){var n=t.width,r=t.height/(e.clientHeight/e.clientWidth);return Math.min(n,r)}function M(e,t){var n=e;if(!0===n.webkitSupportsPresentationMode&&"function"==typeof n.webkitSetPresentationMode){var r="picture-in-picture"===n.webkitPresentationMode,i=(0,E.ZP)({isEnabled:r,pipWindow:null});return q(n,"webkitpresentationmodechanged",(function(){var e="picture-in-picture"===n.webkitPresentationMode;i.setValue({isEnabled:e,pipWindow:null})}),t),t.register((function(){i.finish()})),i}var a=document.pictureInPictureElement===n,o=(0,E.ZP)({isEnabled:a,pipWindow:null});return q(n,"enterpictureinpicture",(function(e){var t;o.setValue({isEnabled:!0,pipWindow:null!==(t=e.pictureInPictureWindow)&&void 0!==t?t:null})}),t),q(n,"leavepictureinpicture",(function(){o.setValue({isEnabled:!1,pipWindow:null})}),t),t.register((function(){o.finish()})),o}function C(e,t){var n,r=function(e){var t,n=document;null!=n.hidden?t="":null!=n.mozHidden?t="moz":null!=n.msHidden?t="ms":null!=n.webkitHidden&&(t="webkit");var r=(0,_.Z)(t)?t+"Hidden":"hidden",i=(0,_.Z)(t)?t+"visibilitychange":"visibilitychange",a=document[r],o=(0,E.ZP)(!a);return q(document,i,(function(){var e=!document[r];o.setValueIfChanged(e)}),e),e.register((function(){o.finish()})),o}(t),i=(0,E.ZP)(!0);return t.register((function(){clearTimeout(n),n=void 0,i.finish()})),r.onUpdate(a,{clearSignal:t}),e.onUpdate(a,{clearSignal:t}),a(),i;function a(){if(clearTimeout(n),n=void 0,e.getValue().isEnabled||r.getValue())i.setValueIfChanged(!0);else{var t=y.Z.getCurrent().INACTIVITY_DELAY;n=window.setTimeout((function(){i.setValueIfChanged(!1)}),t)}}}function D(e,t,n){var r=(0,E.ZP)(e.clientWidth*A),i=S.Z;t.onUpdate(o,{clearSignal:n}),q(window,"resize",o,n);var a=window.setInterval(o,2e4);return o(),n.register((function(){i(),clearInterval(a),r.finish()})),r;function o(){i();var n=t.getValue();if(n.isEnabled)if((0,b.Z)(n.pipWindow))r.setValueIfChanged(1/0);else{var a=n.pipWindow,o=P(e,a),s=function(){r.setValueIfChanged(P(e,a)*A)};a.addEventListener("resize",s),i=function(){a.removeEventListener("resize",s),i=S.Z},r.setValueIfChanged(o*A)}else r.setValueIfChanged(e.clientWidth*A)}}Z(["loadedmetadata"]),Z(["seeking"]),Z(["seeked"]),Z(["ended"]),Z(["timeupdate"]);var O=x(["sourceopen","webkitsourceopen"]),N=x(["sourceclose","webkitsourceclose"]),L=x(["sourceended","webkitsourceended"]),U=x(["update"]),B=x(["removesourcebuffer"]),F=Z((0,w.Z)()?["needkey"]:["encrypted","needkey"]),z=Z(["keymessage","message"]),V=Z(["keyadded","ready"]),K=Z(["keyerror","error"]),G=Z(["keystatuseschange"]),W=x(["seeking"]),H=x(["seeked"]),j=x(["ended"]);function q(e,t,n,r){e.addEventListener(t,n),r.register((function(){e.removeEventListener(t,n)}))}},2203:function(e,t){"use strict";var n="undefined"==typeof window;t.Z=n},1988:function(e,t,n){"use strict";function r(e){return"function"==typeof window.VTTCue&&e instanceof window.VTTCue}n.d(t,{Z:function(){return r}})},7253:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3887),i=n(1946);function a(e,t,n){if(e>=t)return r.Z.warn("Compat: Invalid cue times: "+e+" - "+t),null;if((0,i.Z)(window.VTTCue)){if((0,i.Z)(window.TextTrackCue))throw new Error("VTT cues not supported in your target");return new TextTrackCue(e,t,n)}return new VTTCue(e,t,n)}},5059:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3666),i=n(158);function a(){return(r.vS||r.SB)&&void 0!==i.t}},1669:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(3666);function i(){return r.op}},6872:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r={DEFAULT_UNMUTED_VOLUME:.1,DEFAULT_REQUEST_TIMEOUT:3e4,DEFAULT_TEXT_TRACK_MODE:"native",DEFAULT_MANUAL_BITRATE_SWITCHING_MODE:"seamless",DEFAULT_ENABLE_FAST_SWITCHING:!0,DELTA_POSITION_AFTER_RELOAD:{bitrateSwitch:-.1,trackSwitch:{audio:-.7,video:-.1,other:0}},DEFAULT_CODEC_SWITCHING_BEHAVIOR:"continue",DEFAULT_AUTO_PLAY:!1,DEFAULT_WANTED_BUFFER_AHEAD:30,DEFAULT_MAX_BUFFER_AHEAD:1/0,DEFAULT_MAX_BUFFER_BEHIND:1/0,DEFAULT_MAX_VIDEO_BUFFER_SIZE:1/0,MAXIMUM_MAX_BUFFER_AHEAD:{text:18e3},MAXIMUM_MAX_BUFFER_BEHIND:{text:18e3},DEFAULT_INITIAL_BITRATES:{audio:0,video:0,other:0},DEFAULT_MIN_BITRATES:{audio:0,video:0,other:0},DEFAULT_MAX_BITRATES:{audio:1/0,video:1/0,other:1/0},INACTIVITY_DELAY:6e4,DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN:!1,DEFAULT_LIMIT_VIDEO_WIDTH:!1,DEFAULT_LIVE_GAP:{DEFAULT:10,LOW_LATENCY:3.5},BUFFER_DISCONTINUITY_THRESHOLD:.2,FORCE_DISCONTINUITY_SEEK_DELAY:5e3,BITRATE_REBUFFERING_RATIO:1.5,BUFFER_GC_GAPS:{CALM:240,BEEFY:30},DEFAULT_MAX_MANIFEST_REQUEST_RETRY:4,DEFAULT_CDN_DOWNGRADE_TIME:60,DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR:4,DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE:1/0,INITIAL_BACKOFF_DELAY_BASE:{REGULAR:200,LOW_LATENCY:50},MAX_BACKOFF_DELAY_BASE:{REGULAR:3e3,LOW_LATENCY:1e3},SAMPLING_INTERVAL_MEDIASOURCE:1e3,SAMPLING_INTERVAL_LOW_LATENCY:250,SAMPLING_INTERVAL_NO_MEDIASOURCE:500,ABR_MINIMUM_TOTAL_BYTES:15e4,ABR_MINIMUM_CHUNK_SIZE:16e3,ABR_STARVATION_FACTOR:{DEFAULT:.72,LOW_LATENCY:.72},ABR_REGULAR_FACTOR:{DEFAULT:.8,LOW_LATENCY:.8},ABR_STARVATION_GAP:{DEFAULT:5,LOW_LATENCY:5},OUT_OF_STARVATION_GAP:{DEFAULT:7,LOW_LATENCY:7},ABR_STARVATION_DURATION_DELTA:.1,ABR_FAST_EMA:2,ABR_SLOW_EMA:10,RESUME_GAP_AFTER_SEEKING:{DEFAULT:1.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_NOT_ENOUGH_DATA:{DEFAULT:.5,LOW_LATENCY:.5},RESUME_GAP_AFTER_BUFFERING:{DEFAULT:5,LOW_LATENCY:.5},REBUFFERING_GAP:{DEFAULT:.5,LOW_LATENCY:.2},MINIMUM_BUFFER_AMOUNT_BEFORE_FREEZING:2,UNFREEZING_SEEK_DELAY:6e3,FREEZING_STALLED_DELAY:600,UNFREEZING_DELTA_POSITION:.001,MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT:.15,MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE:.4,MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE:.3,MINIMUM_SEGMENT_SIZE:.005,APPEND_WINDOW_SECURITIES:{START:.2,END:.1},MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL:50,TEXT_TRACK_SIZE_CHECKS_INTERVAL:250,BUFFER_PADDING:{audio:1,video:3,other:1},SEGMENT_PRIORITIES_STEPS:[2,4,8,12,18,25],MAX_HIGH_PRIORITY_LEVEL:1,MIN_CANCELABLE_PRIORITY:3,EME_DEFAULT_WIDEVINE_ROBUSTNESSES:["HW_SECURE_ALL","HW_SECURE_DECODE","HW_SECURE_CRYPTO","SW_SECURE_DECODE","SW_SECURE_CRYPTO"],EME_KEY_SYSTEMS:{clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.microsoft.playready","com.chromecast.playready","com.youtube.playready"],fairplay:["com.apple.fps.1_0"]},MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE:10,MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE:200,MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY:300,OUT_OF_SYNC_MANIFEST_REFRESH_DELAY:3e3,FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY:3e3,DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0:3,EME_DEFAULT_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS:15,EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION:1e3,EME_WAITING_DELAY_LOADED_SESSION_EMPTY_KEYSTATUSES:100,FORCED_ENDED_THRESHOLD:8e-4,ADAP_REP_SWITCH_BUFFER_PADDINGS:{video:{before:5,after:5},audio:{before:2,after:2.5},text:{before:0,after:0}},SOURCE_BUFFER_FLUSHING_INTERVAL:500,CONTENT_REPLACEMENT_PADDING:1.2,CACHE_LOAD_DURATION_THRESHOLDS:{video:50,audio:10},STREAM_EVENT_EMITTER_POLL_INTERVAL:250,DEFAULT_MAXIMUM_TIME_ROUNDING_ERROR:.001,BUFFERED_HISTORY_RETENTION_TIME:6e4,BUFFERED_HISTORY_MAXIMUM_ENTRIES:200,MIN_BUFFER_AHEAD:5,UPTO_CURRENT_POSITION_CLEANUP:5,DEFAULT_VIDEO_REPRESENTATIONS_SWITCHING_MODE:"seamless",DEFAULT_AUDIO_REPRESENTATIONS_SWITCHING_MODE:"seamless",DEFAULT_VIDEO_TRACK_SWITCHING_MODE:"reload",DEFAULT_AUDIO_TRACK_SWITCHING_MODE:"seamless"},i=n(8026);function a(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}function o(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(0===n.length)return e;var s=n.shift();if(a(e)&&a(s))for(var u in s)if(a(s[u])){var l=e[u];void 0===l&&(l={},e[u]=l),o(l,s[u])}else{var d;(0,i.Z)(e,((d={})[u]=s[u],d))}return o.apply(void 0,[e].concat(n))}var s=function(){function e(){this._config=r}var t=e.prototype;return t.update=function(e){var t=o(this._config,e);this._config=t},t.getCurrent=function(){return this._config},e}(),u=new s},1932:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(4578),i=n(3666);var a=n(1959),o=n(1946),s=n(5288);function u(e,t){var n;if(t.length!==e.length)return!0;for(var r=0;r<t.length;r++)if(t[r].nativeTrack!==(null===(n=e[r])||void 0===n?void 0:n.nativeTrack))return!0;return!1}function l(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],o=""===a.language?"nolang":a.language,u=null!==(t=r[o])&&void 0!==t?t:1,l="gen_audio_"+o+"_"+u.toString();r[o]=u+1;var d={language:a.language,id:l,normalized:(0,s.ZP)(a.language),audioDescription:"descriptions"===a.kind||"description"===a.kind,representations:[]};n.push({track:d,nativeTrack:a})}return n}function d(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],o=""===a.language?"nolang":a.language,u=null!==(t=r[o])&&void 0!==t?t:1,l="gen_text_"+o+"_"+u.toString();r[o]=u+1;var d={language:a.language,id:l,normalized:(0,s.ZP)(a.language),closedCaption:"captions"===a.kind};n.push({track:d,nativeTrack:a})}return n}function c(e){for(var t,n=[],r={},i=0;i<e.length;i++){var a=e[i],o=""===a.language?"nolang":a.language,s=null!==(t=r[o])&&void 0!==t?t:1,u="gen_video_"+o+"_"+s.toString();r[o]=s+1,n.push({track:{id:u,representations:[]},nativeTrack:a})}return n}var f=function(e){function t(t){var n,r,i,a;return(n=e.call(this)||this)._nativeAudioTracks=t.audioTracks,n._nativeVideoTracks=t.videoTracks,n._nativeTextTracks=t.textTracks,n._audioTracks=void 0!==n._nativeAudioTracks?l(n._nativeAudioTracks):[],n._videoTracks=void 0!==n._nativeVideoTracks?c(n._nativeVideoTracks):[],n._textTracks=void 0!==n._nativeTextTracks?d(n._nativeTextTracks):[],n._lastEmittedNativeAudioTrack=null===(r=n._getCurrentAudioTrack())||void 0===r?void 0:r.nativeTrack,n._lastEmittedNativeVideoTrack=null===(i=n._getCurrentVideoTrack())||void 0===i?void 0:i.nativeTrack,n._lastEmittedNativeTextTrack=null===(a=n._getCurrentTextTrack())||void 0===a?void 0:a.nativeTrack,n._handleNativeTracksCallbacks(),n}(0,r.Z)(t,e);var n=t.prototype;return n.setAudioTrackById=function(e){for(var t=0;t<this._audioTracks.length;t++){var n=this._audioTracks[t],r=n.track,i=n.nativeTrack;if(r.id===e)return this._enableAudioTrackFromIndex(t),void(this._audioTrackLockedOn=i)}throw new Error("Audio track not found.")},n.disableTextTrack=function(){v(this._textTracks),this._textTrackLockedOn=null},n.setTextTrackById=function(e){for(var t=!1,n=0;n<this._textTracks.length;n++){var r=this._textTracks[n],i=r.track,a=r.nativeTrack;i.id===e?(a.mode="showing",t=!0,this._textTrackLockedOn=a):"showing"!==a.mode&&"hidden"!==a.mode||(a.mode="disabled")}if(!t)throw new Error("Text track not found.")},n.disableVideoTrack=function(){h(this._videoTracks),this._videoTrackLockedOn=null},n.setVideoTrackById=function(e){for(var t=0;t<this._videoTracks.length;t++){var n=this._videoTracks[t],r=n.track,i=n.nativeTrack;if(r.id===e)return i.selected=!0,void(this._videoTrackLockedOn=i)}throw new Error("Video track not found.")},n.getChosenAudioTrack=function(){var e=this._getCurrentAudioTrack();return(0,o.Z)(e)?e:e.track},n.getChosenTextTrack=function(){var e=this._getCurrentTextTrack();return(0,o.Z)(e)?e:e.track},n.getChosenVideoTrack=function(){var e=this._getCurrentVideoTrack();return(0,o.Z)(e)?e:e.track},n.getAvailableAudioTracks=function(){return this._audioTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,language:t.language,normalized:t.normalized,audioDescription:t.audioDescription,active:n.enabled,representations:t.representations}}))},n.getAvailableTextTracks=function(){return this._textTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,language:t.language,normalized:t.normalized,closedCaption:t.closedCaption,active:"showing"===n.mode}}))},n.getAvailableVideoTracks=function(){return this._videoTracks.map((function(e){var t=e.track,n=e.nativeTrack;return{id:t.id,representations:t.representations,active:n.selected}}))},n.dispose=function(){void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onchange=null,this._nativeVideoTracks.onaddtrack=null,this._nativeVideoTracks.onremovetrack=null),void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onchange=null,this._nativeAudioTracks.onaddtrack=null,this._nativeAudioTracks.onremovetrack=null),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onchange=null,this._nativeTextTracks.onaddtrack=null,this._nativeTextTracks.onremovetrack=null),this.removeEventListener()},n._getCurrentAudioTrack=function(){if(void 0!==this._nativeAudioTracks){for(var e=0;e<this._audioTracks.length;e++){var t=this._audioTracks[e];if(t.nativeTrack.enabled)return t}return null}},n._getCurrentVideoTrack=function(){if(void 0!==this._nativeVideoTracks){for(var e=0;e<this._videoTracks.length;e++){var t=this._videoTracks[e];if(t.nativeTrack.selected)return t}return null}},n._getCurrentTextTrack=function(){if(void 0!==this._nativeTextTracks){for(var e=0;e<this._textTracks.length;e++){var t=this._textTracks[e];if("showing"===t.nativeTrack.mode)return t}return null}},n._setPreviouslyLockedAudioTrack=function(){if(void 0!==this._audioTrackLockedOn)if(null===this._audioTrackLockedOn)for(var e=0;e<this._audioTracks.length;e++){this._audioTracks[e].nativeTrack.enabled=!1}else for(var t=0;t<this._audioTracks.length;t++){if(this._audioTracks[t].nativeTrack===this._audioTrackLockedOn)return void this._enableAudioTrackFromIndex(t)}},n._setPreviouslyLockedTextTrack=function(){if(void 0!==this._textTrackLockedOn)if(null!==this._textTrackLockedOn)for(var e=0;e<this._textTracks.length;e++){var t=this._textTracks[e].nativeTrack;if(t===this._textTrackLockedOn)return p(this._textTracks,t),void("showing"!==t.mode&&(t.mode="showing"))}else v(this._textTracks)},n._setPreviouslyLockedVideoTrack=function(){if(void 0!==this._videoTrackLockedOn)if(null!==this._videoTrackLockedOn)for(var e=0;e<this._videoTracks.length;e++){var t=this._videoTracks[e].nativeTrack;if(t===this._videoTrackLockedOn)return void(t.selected=!0)}else h(this._videoTracks)},n._handleNativeTracksCallbacks=function(){var e=this;void 0!==this._nativeAudioTracks&&(this._nativeAudioTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeAudioTracks){var r=l(e._nativeAudioTracks);if(u(e._audioTracks,r)){e._audioTracks=r,e._setPreviouslyLockedAudioTrack(),e.trigger("availableAudioTracksChange",e.getAvailableAudioTracks());var i=e._getCurrentAudioTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeAudioTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeAudioTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeAudioTracks){var r=l(e._nativeAudioTracks);if(u(e._audioTracks,r)){e._audioTracks=r,e.trigger("availableAudioTracksChange",e.getAvailableAudioTracks());var i=e._getCurrentAudioTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeAudioTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeAudioTracks.onchange=function(){if(void 0!==e._audioTracks)for(var t=0;t<e._audioTracks.length;t++){var n=e._audioTracks[t],r=n.track,i=n.nativeTrack;if(i.enabled)return void(i!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",r),e._lastEmittedNativeAudioTrack=i))}null!==e._lastEmittedNativeAudioTrack&&(e.trigger("audioTrackChange",null),e._lastEmittedNativeAudioTrack=null)}),void 0!==this._nativeTextTracks&&(this._nativeTextTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeTextTracks){var r=d(e._nativeTextTracks);if(u(e._textTracks,r)){e._textTracks=r,e._setPreviouslyLockedTextTrack(),e.trigger("availableTextTracksChange",e.getAvailableTextTracks());var i=e._getCurrentTextTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeTextTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeTextTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeTextTracks){var r=d(e._nativeTextTracks);if(u(e._textTracks,r)){e._textTracks=r,e._setPreviouslyLockedTextTrack(),e.trigger("availableTextTracksChange",e.getAvailableTextTracks());var i=e._getCurrentTextTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeTextTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeTextTracks.onchange=function(){if(void 0!==e._textTracks)for(var t=0;t<e._textTracks.length;t++){var n=e._textTracks[t],r=n.track,i=n.nativeTrack;if("showing"===i.mode)return void(i!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",r),e._lastEmittedNativeTextTrack=i))}null!==e._lastEmittedNativeTextTrack&&(e.trigger("textTrackChange",null),e._lastEmittedNativeTextTrack=null)}),void 0!==this._nativeVideoTracks&&(this._nativeVideoTracks.onaddtrack=function(){var t,n;if(void 0!==e._nativeVideoTracks){var r=c(e._nativeVideoTracks);if(u(e._videoTracks,r)){e._videoTracks=r,e._setPreviouslyLockedVideoTrack(),e.trigger("availableVideoTracksChange",e.getAvailableVideoTracks());var i=e._getCurrentVideoTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeVideoTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeVideoTracks.onremovetrack=function(){var t,n;if(void 0!==e._nativeVideoTracks){var r=c(e._nativeVideoTracks);if(u(e._videoTracks,r)){e._videoTracks=r,e._setPreviouslyLockedVideoTrack(),e.trigger("availableVideoTracksChange",e.getAvailableVideoTracks());var i=e._getCurrentVideoTrack();(null==i?void 0:i.nativeTrack)!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null!==(t=null==i?void 0:i.track)&&void 0!==t?t:null),e._lastEmittedNativeVideoTrack=null!==(n=null==i?void 0:i.nativeTrack)&&void 0!==n?n:null)}}},this._nativeVideoTracks.onchange=function(){if(void 0!==e._videoTracks)for(var t=0;t<e._videoTracks.length;t++){var n=e._videoTracks[t],r=n.track,i=n.nativeTrack;if(i.selected)return void(i!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",r),e._lastEmittedNativeVideoTrack=i))}null!==e._lastEmittedNativeVideoTrack&&(e.trigger("videoTrackChange",null),e._lastEmittedNativeVideoTrack=null)})},n._enableAudioTrackFromIndex=function(e){!function(e,t){for(var n=0;n<e.length;n++)i.yS&&n===t||(e[n].enabled=!1);t<0||t>=e.length||(e[t].enabled=!0)}(this._audioTracks.map((function(e){return e.nativeTrack})),e)},t}(a.Z);function v(e){for(var t=0;t<e.length;t++){e[t].nativeTrack.mode="disabled"}}function p(e,t){for(var n=0;n<e.length;n++){var r=e[n].nativeTrack;r===t||"showing"!==r.mode&&"hidden"!==r.mode||(r.mode="disabled")}}function h(e){for(var t=0;t<e.length;t++){e[t].nativeTrack.selected=!1}}},1422:function(e,t,n){"use strict";n.d(t,{u:function(){return Pt},Z:function(){return Ct}});var r=n(5861),i=n(4578),a=n(4687),o=n.n(a),s=n(2453),u=n(3887),l=n(6490),d=n(4791),c=n(6968),f=n(3635),v=(0,c.pX)((0,f.tG)("pssh"),0);function p(e,t){for(var n=0;n<e.length;n++){var r=e[n];if((void 0===t.systemId||void 0===r.systemId||t.systemId===r.systemId)&&(0,d.Z)(t.data,r.data))return!0}return!1}function h(e){var t=e.initData,n=e.initDataType;if(null==t)return u.Z.warn("Compat: No init data found on media encrypted event."),null;var r=function(e){for(var t=[],n=0;n<e.length;){if(e.length<n+8||(0,c.pX)(e,n+4)!==v)return u.Z.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}];var r=(0,c.pX)(new Uint8Array(e),n);if(n+r>e.length)return u.Z.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}];var i=e.subarray(n,n+r),a={systemId:(0,l.Y)(i,8),data:i};p(t,a)?u.Z.warn("Compat: Duplicated PSSH found in initialization data, removing it."):t.push(a),n+=r}return n!==e.length?(u.Z.warn("Compat: Unrecognized initialization data. Use as is."),[{systemId:void 0,data:e}]):t}(new Uint8Array(t));return{type:n,values:r}}var m=n(6872),g=n(5157),y=n(5389),_=n(3274),b=n(7714),S=n(1959),E=n(1946),T=n(288),w=n(6139),k=n(770);function A(e){k.Z.setState(e,null),(0,w.Y)(e,null)}function I(){return(I=(0,r.Z)(o().mark((function e(t,n,r){var i,a,s,l,d,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.keySystemOptions,a=n.loadedSessionsStore,s=n.mediaKeySystemAccess,l=n.mediaKeys,d=k.Z.getState(t),c=null!==d&&d.loadedSessionsStore!==a?d.loadedSessionsStore.closeAllSessions():Promise.resolve(),e.next=5,c;case 5:if(!r.isCancelled){e.next=7;break}throw r.cancellationError;case 7:if(k.Z.setState(t,{keySystemOptions:i,mediaKeySystemAccess:s,mediaKeys:l,loadedSessionsStore:a}),t.mediaKeys!==l){e.next=10;break}return e.abrupt("return");case 10:u.Z.info("DRM: Attaching MediaKeys to the media element"),(0,w.Y)(t,l),u.Z.info("DRM: MediaKeys attached with success");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){if(""===e.sessionId)return!1;var t=e.keyStatuses,n=[];return t.forEach((function(e){n.push(e)})),n.length<=0?(u.Z.debug("DRM: isSessionUsable: MediaKeySession given has an empty keyStatuses",e.sessionId),!1):(0,b.Z)(n,"expired")?(u.Z.debug("DRM: isSessionUsable: MediaKeySession given has an expired key",e.sessionId),!1):(0,b.Z)(n,"internal-error")?(u.Z.debug("DRM: isSessionUsable: MediaKeySession given has a key with an internal-error",e.sessionId),!1):(u.Z.debug("DRM: isSessionUsable: MediaKeySession is usable",e.sessionId),!0)}function x(e,t,n,r){var i=e.loadedSessionsStore,a=e.persistentSessionsStore;return"temporary"===n?Z(i,t):null===a?(u.Z.warn("DRM: Cannot create persistent MediaKeySession, PersistentSessionsStore not created."),Z(i,t)):function(e,t,n,r){return P.apply(this,arguments)}(i,a,t,r)}function Z(e,t){u.Z.info("DRM: Creating a new temporary session");var n=e.createSession(t,"temporary");return Promise.resolve({type:"created-session",value:n})}function P(){return P=(0,r.Z)(o().mark((function e(t,n,i,a){var s,l,d,c,f,v;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v=function(){return v=(0,r.Z)(o().mark((function e(){var r,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===a.cancellationError){e.next=2;break}throw a.cancellationError;case 2:return u.Z.info("DRM: Removing previous persistent session."),null!==(r=n.get(i))&&n.delete(r.sessionId),e.prev=5,e.next=8,t.closeSession(s.mediaKeySession);case 8:e.next=15;break;case 10:if(e.prev=10,e.t0=e.catch(5),""===s.mediaKeySession.sessionId){e.next=14;break}throw e.t0;case 14:t.removeSessionWithoutClosingIt(s.mediaKeySession);case 15:if(null===a.cancellationError){e.next=17;break}throw a.cancellationError;case 17:return l=t.createSession(i,"persistent-license"),e.abrupt("return",{type:"created-session",value:l});case 19:case"end":return e.stop()}}),e,null,[[5,10]])}))),v.apply(this,arguments)},f=function(){return v.apply(this,arguments)},null===a.cancellationError){e.next=4;break}throw a.cancellationError;case 4:if(u.Z.info("DRM: Creating persistent MediaKeySession"),s=t.createSession(i,"persistent-license"),null!==(l=n.getAndReuse(i))){e.next=9;break}return e.abrupt("return",{type:"created-session",value:s});case 9:return e.prev=9,e.next=12,t.loadPersistentSession(s.mediaKeySession,l.sessionId);case 12:if(d=e.sent){e.next=19;break}return u.Z.warn("DRM: No data stored for the loaded session"),n.delete(l.sessionId),t.removeSessionWithoutClosingIt(s.mediaKeySession),c=t.createSession(i,"persistent-license"),e.abrupt("return",{type:"created-session",value:c});case 19:if(!d||!R(s.mediaKeySession)){e.next=23;break}return n.add(i,i.keyIds,s.mediaKeySession),u.Z.info("DRM: Succeeded to load persistent session."),e.abrupt("return",{type:"loaded-persistent-session",value:s});case 23:return u.Z.warn("DRM: Previous persistent session not usable anymore."),e.abrupt("return",f());case 27:return e.prev=27,e.t0=e.catch(9),u.Z.warn("DRM: Unable to load persistent session: "+(e.t0 instanceof Error?e.t0.toString():"Unknown Error")),e.abrupt("return",f());case 31:case"end":return e.stop()}}),e,null,[[9,27]])}))),P.apply(this,arguments)}function M(e,t){return C.apply(this,arguments)}function C(){return(C=(0,r.Z)(o().mark((function e(t,n){var r,i,a,s,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n<0||n>=t.getLength())){e.next=2;break}return e.abrupt("return");case 2:for(r=[],i=t.getAll().slice(),a=i.length-n,s=0;s<a;s++)u=i[s],r.push(t.closeSession(u.mediaKeySession));return e.next=8,Promise.all(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,n,r,i){return O.apply(this,arguments)}function O(){return(O=(0,r.Z)(o().mark((function e(t,n,r,i,a){var s,l,d,c,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=null,l=n.loadedSessionsStore,d=n.persistentSessionsStore,null===(c=l.reuse(t))){e.next=11;break}if(!R(s=c.mediaKeySession)){e.next=10;break}return u.Z.info("DRM: Reuse loaded session",s.sessionId),e.abrupt("return",{type:"loaded-open-session",value:{mediaKeySession:s,sessionType:c.sessionType,keySessionRecord:c.keySessionRecord}});case 10:null!==d&&""!==c.mediaKeySession.sessionId&&d.delete(c.mediaKeySession.sessionId);case 11:if(null===s){e.next=16;break}return e.next=14,l.closeSession(s);case 14:if(null===a.cancellationError){e.next=16;break}throw a.cancellationError;case 16:return e.next=18,M(l,i);case 18:if(null===a.cancellationError){e.next=20;break}throw a.cancellationError;case 20:return e.next=22,x(n,t,r,a);case 22:return f=e.sent,e.abrupt("return",{type:f.type,value:{mediaKeySession:f.value.mediaKeySession,sessionType:f.value.sessionType,keySessionRecord:f.value.keySessionRecord}});case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=n(3666);function L(){return!(N.gM||N.uz)}var U=n(9592);function B(e,t,n){var r=t.getConfiguration();if(N.fq||null==r)return null;var i=e.filter((function(e){return e.type===n.type&&((!0!==e.persistentLicense&&!0!==e.persistentStateRequired||"required"===r.persistentState)&&(!0!==e.distinctiveIdentifierRequired||"required"===r.distinctiveIdentifier))}))[0];return null!=i?{keySystemOptions:i,keySystemAccess:t}:null}function F(e,t){var n=["temporary"],r="optional",i="optional";!0===t.persistentLicense&&(r="required",n.push("persistent-license")),!0===t.persistentStateRequired&&(r="required"),!0===t.distinctiveIdentifierRequired&&(i="required");var a=m.Z.getCurrent().EME_DEFAULT_WIDEVINE_ROBUSTNESSES,o=null!=t.videoRobustnesses?t.videoRobustnesses:"widevine"===e?a:[],s=null!=t.audioRobustnesses?t.audioRobustnesses:"widevine"===e?a:[];return 0===o.length&&o.push(void 0),0===s.length&&s.push(void 0),[{initDataTypes:["cenc"],videoCapabilities:(0,U.Z)(o,(function(e){return['video/mp4;codecs="avc1.4d401e"','video/mp4;codecs="avc1.42e01e"','video/webm;codecs="vp8"'].map((function(t){return void 0!==e?{contentType:t,robustness:e}:{contentType:t}}))})),audioCapabilities:(0,U.Z)(s,(function(e){return['audio/mp4;codecs="mp4a.40.2"',"audio/webm;codecs=opus"].map((function(t){return void 0!==e?{contentType:t,robustness:e}:{contentType:t}}))})),distinctiveIdentifier:i,persistentState:r,sessionTypes:n}]}function z(e,t,n){u.Z.info("DRM: Searching for compatible MediaKeySystemAccess");var i=k.Z.getState(e);if(null!=i){var a=B(t,i.mediaKeySystemAccess,i.keySystemOptions);if(null!==a)return u.Z.info("DRM: Found cached compatible keySystem"),Promise.resolve({type:"reuse-media-key-system-access",value:{mediaKeySystemAccess:a.keySystemAccess,options:a.keySystemOptions}})}var s=t.reduce((function(e,t){var n,r=m.Z.getCurrent().EME_KEY_SYSTEMS[t.type];if(null!=r)n=r.map((function(e){return{keyName:t.type,keyType:e,keySystemOptions:t}}));else{var i=function(e){for(var t=m.Z.getCurrent().EME_KEY_SYSTEMS,n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if((0,b.Z)(t[i],e))return i}}(t.type);n=[{keyName:i,keyType:t.type,keySystemOptions:t}]}return e.concat(n)}),[]);return l(0);function l(e){return d.apply(this,arguments)}function d(){return(d=(0,r.Z)(o().mark((function e(t){var r,i,a,d,c,f;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=s.length)){e.next=2;break}throw new g.Z("INCOMPATIBLE_KEYSYSTEMS","No key system compatible with your wanted configuration has been found in the current browser.");case 2:if(null!=w.N){e.next=4;break}throw new Error("requestMediaKeySystemAccess is not implemented in your browser.");case 4:return r=s[t],i=r.keyName,a=r.keyType,d=r.keySystemOptions,c=F(i,d),u.Z.debug("DRM: Request keysystem access "+a+","+(t+1)+" of "+s.length),e.prev=7,e.next=10,(0,w.N)(a,c);case 10:return f=e.sent,u.Z.info("DRM: Found compatible keysystem",a,t+1),e.abrupt("return",{type:"create-media-key-system-access",value:{options:d,mediaKeySystemAccess:f}});case 15:if(e.prev=15,e.t0=e.catch(7),u.Z.debug("DRM: Rejected access to keysystem",a,t+1),null===n.cancellationError){e.next=20;break}throw n.cancellationError;case 20:return e.abrupt("return",l(t+1));case 21:case"end":return e.stop()}}),e,null,[[7,15]])})))).apply(this,arguments)}}var V=n(2297);function K(e,t,n){var r;u.Z.debug("Compat: Calling generateRequest on the MediaKeySession");try{r=function(e){u.Z.info("Compat: Trying to move CENC PSSH from init data at the end of it.");for(var t=!1,n=new Uint8Array,r=new Uint8Array,i=0;i<e.length;){if(e.length<i+8||(0,c.pX)(e,i+4)!==v)throw u.Z.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");var a=(0,c.pX)(new Uint8Array(e),i);if(i+a>e.length)throw u.Z.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");var o=e.subarray(i,i+a);if(16===e[i+12]&&119===e[i+13]&&239===e[i+14]&&236===e[i+15]&&192===e[i+16]&&178===e[i+17]&&77===e[i+18]&&2===e[i+19]&&172===e[i+20]&&227===e[i+21]&&60===e[i+22]&&30===e[i+23]&&82===e[i+24]&&226===e[i+25]&&251===e[i+26]&&75===e[i+27]){var s=(0,V.Xj)(o),l=null===s?void 0:o[s[1]];u.Z.info("Compat: CENC PSSH found with version",l),void 0===l?u.Z.warn("Compat: could not read version of CENC PSSH"):t===(1===l)?n=(0,c.zo)(n,o):1===l?(u.Z.warn("Compat: cenc version 1 encountered, removing every other cenc pssh box."),n=o,t=!0):u.Z.warn("Compat: filtering out cenc pssh box with wrong version",l)}else r=(0,c.zo)(r,o);i+=a}if(i!==e.length)throw u.Z.warn("Compat: unrecognized initialization data. Cannot patch it."),new Error("Compat: unrecognized initialization data. Cannot patch it.");return(0,c.zo)(r,n)}(n)}catch(e){r=n}var i=null!=t?t:"";return e.generateRequest(i,r).catch((function(t){if(""!==i||!(t instanceof TypeError))throw t;return u.Z.warn('Compat: error while calling `generateRequest` with an empty initialization data type. Retrying with a default "cenc" value.',t),e.generateRequest("cenc",r)}))}function G(e,t){return W.apply(this,arguments)}function W(){return W=(0,r.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.Z.info("Compat/DRM: Load persisted session",n),e.next=3,t.load(n);case 3:if((r=e.sent)&&!(t.keyStatuses.size>0)){e.next=6;break}return e.abrupt("return",r);case 6:return e.abrupt("return",new Promise((function(e){t.addEventListener("keystatuseschange",i);var n=setTimeout(i,100);function i(){clearTimeout(n),t.removeEventListener("keystatuseschange",i),e(r)}})));case 7:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}var H=n(7864);function j(e){var t=new T.ZP;return Promise.race([e.close().then((function(){t.cancel()})),e.closed.then((function(){t.cancel()})),function(){return n.apply(this,arguments)}()]);function n(){return(n=(0,r.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,H.Z)(1e3,t.signal);case 3:return e.next=5,i();case 5:e.next=13;break;case 7:if(e.prev=7,e.t0=e.catch(0),!(e.t0 instanceof T.FU)){e.next=11;break}return e.abrupt("return");case 11:n=e.t0 instanceof Error?e.t0.message:"Unknown error made it impossible to close the session",u.Z.error("DRM: "+n);case 13:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function i(){return a.apply(this,arguments)}function a(){return(a=(0,r.Z)(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.update(new Uint8Array(1));case 3:n.next=13;break;case 5:if(n.prev=5,n.t0=n.catch(0),!t.isUsed){n.next=9;break}return n.abrupt("return");case 9:if(!(n.t0 instanceof Error&&"The session is already closed."===n.t0.message)){n.next=11;break}return n.abrupt("return");case 11:return n.next=13,(0,H.Z)(1e3,t.signal);case 13:if(!t.isUsed){n.next=15;break}return n.abrupt("return");case 15:throw new Error("Compat: Couldn't know if session is closed");case 16:case"end":return n.stop()}}),n,null,[[0,5]])})))).apply(this,arguments)}}var q=n(811);function Y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return X(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return X(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(e,t){return e===t||(0,d.Z)(e,t)}function Q(e,t){return t.some((function(t){return $(t,e)}))}function J(e,t){for(var n,r=function(){var e=n.value;if(!t.some((function(t){return $(t,e)})))return{v:!1}},i=Y(e);!(n=i()).done;){var a=r();if("object"==typeof a)return a.v}return!0}function ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ne=function(){function e(e){this._initializationData=e,this._keyIds=null}var t=e.prototype;return t.associateKeyIds=function(e){null===this._keyIds&&(this._keyIds=[]);for(var t=0,n=Array.from(e);t<n.length;t++){var r=n[t];this.isAssociatedWithKeyId(r)||this._keyIds.push(r)}},t.isAssociatedWithKeyId=function(e){if(null===this._keyIds)return!1;for(var t,n=ee(this._keyIds);!(t=n()).done;){if($(t.value,e))return!0}return!1},t.getAssociatedKeyIds=function(){return null===this._keyIds?[]:this._keyIds},t.isCompatibleWith=function(e){var t=e.keyIds;if(void 0!==t&&t.length>0){if(null!==this._keyIds&&J(t,this._keyIds))return!0;if(void 0!==this._initializationData.keyIds)return J(t,this._initializationData.keyIds)}return this._checkInitializationDataCompatibility(e)},t._checkInitializationDataCompatibility=function(e){return void 0!==e.keyIds&&e.keyIds.length>0&&void 0!==this._initializationData.keyIds?J(e.keyIds,this._initializationData.keyIds):this._initializationData.type===e.type&&this._initializationData.values.isCompatibleWith(e.values)},e}();function re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ae=function(){function e(e){this._mediaKeys=e,this._storage=[]}var t=e.prototype;return t.createSession=function(e,t){var n=this,r=new ne(e),i=this._mediaKeys.createSession(t),a={mediaKeySession:i,sessionType:t,keySessionRecord:r,isGeneratingRequest:!1,isLoadingPersistentSession:!1,closingStatus:{type:"none"}};return(0,E.Z)(i.closed)||i.closed.then((function(){var e=n.getIndex(r);e>=0&&n._storage[e].mediaKeySession===i&&n._storage.splice(e,1)})).catch((function(e){u.Z.warn("DRM-LSS: MediaKeySession.closed rejected: "+e)})),u.Z.debug("DRM-LSS: Add MediaKeySession",a.sessionType),this._storage.push(Object.assign({},a)),a},t.reuse=function(e){for(var t=this._storage.length-1;t>=0;t--){var n=this._storage[t];if(n.keySessionRecord.isCompatibleWith(e))return this._storage.splice(t,1),this._storage.push(n),Object.assign({},n)}return null},t.getEntryForSession=function(e){for(var t=this._storage.length-1;t>=0;t--){var n=this._storage[t];if(n.mediaKeySession===e)return Object.assign({},n)}return null},t.generateLicenseRequest=function(){var e=(0,r.Z)(o().mark((function e(t,n,r){var i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=re(this._storage);case 1:if((s=a()).done){e.next=8;break}if((l=s.value).mediaKeySession!==t){e.next=6;break}return i=l,e.abrupt("break",8);case 6:e.next=1;break;case 8:if(void 0!==i){e.next=11;break}return u.Z.error("DRM-LSS: generateRequest error. No MediaKeySession found with the given initData and initDataType"),e.abrupt("return",K(t,n,r));case 11:if(i.isGeneratingRequest=!0,"none"===i.closingStatus.type){e.next=14;break}throw new Error("The `MediaKeySession` is being closed.");case 14:return e.prev=14,e.next=17,K(t,n,r);case 17:e.next=26;break;case 19:if(e.prev=19,e.t0=e.catch(14),void 0!==i){e.next=23;break}throw e.t0;case 23:throw i.isGeneratingRequest=!1,"awaiting"===i.closingStatus.type&&i.closingStatus.start(),e.t0;case 26:if(void 0!==i){e.next=28;break}return e.abrupt("return",void 0);case 28:i.isGeneratingRequest=!1,"awaiting"===i.closingStatus.type&&i.closingStatus.start();case 30:case"end":return e.stop()}}),e,this,[[14,19]])})));return function(t,n,r){return e.apply(this,arguments)}}(),t.loadPersistentSession=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,i,a,s,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=re(this._storage);case 1:if((a=i()).done){e.next=8;break}if((s=a.value).mediaKeySession!==t){e.next=6;break}return r=s,e.abrupt("break",8);case 6:e.next=1;break;case 8:if(void 0!==r){e.next=11;break}return u.Z.error("DRM-LSS: loadPersistentSession error. No MediaKeySession found with the given initData and initDataType"),e.abrupt("return",G(t,n));case 11:if(r.isLoadingPersistentSession=!0,"none"===r.closingStatus.type){e.next=14;break}throw new Error("The `MediaKeySession` is being closed.");case 14:return e.prev=14,e.next=17,G(t,n);case 17:l=e.sent,e.next=27;break;case 20:if(e.prev=20,e.t0=e.catch(14),void 0!==r){e.next=24;break}throw e.t0;case 24:throw r.isLoadingPersistentSession=!1,"awaiting"===r.closingStatus.type&&r.closingStatus.start(),e.t0;case 27:if(void 0!==r){e.next=29;break}return e.abrupt("return",l);case 29:return r.isLoadingPersistentSession=!1,"awaiting"===r.closingStatus.type&&r.closingStatus.start(),e.abrupt("return",l);case 32:case"end":return e.stop()}}),e,this,[[14,20]])})));return function(t,n){return e.apply(this,arguments)}}(),t.closeSession=function(){var e=(0,r.Z)(o().mark((function e(t){var n,r,i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=re(this._storage);case 1:if((i=r()).done){e.next=8;break}if((a=i.value).mediaKeySession!==t){e.next=6;break}return n=a,e.abrupt("break",8);case 6:e.next=1;break;case 8:if(void 0!==n){e.next=11;break}return u.Z.warn("DRM-LSS: No MediaKeySession found with the given initData and initDataType"),e.abrupt("return",Promise.resolve(!1));case 11:return e.abrupt("return",this._closeEntry(n));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getLength=function(){return this._storage.length},t.getAll=function(){return this._storage},t.closeAllSessions=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,r=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._storage,u.Z.debug("DRM-LSS: Closing all current MediaKeySessions",t.length),this._storage=[],n=t.map((function(e){return r._closeEntry(e)})),e.next=6,Promise.all(n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.removeSessionWithoutClosingIt=function(e){(0,q.Z)(""===e.sessionId,"Initialized `MediaKeySession`s should always be properly closed");for(var t=this._storage.length-1;t>=0;t--){if(this._storage[t].mediaKeySession===e)return this._storage.splice(t,1),!0}return!1},t.getIndex=function(e){for(var t=0;t<this._storage.length;t++){if(this._storage[t].keySessionRecord===e)return t}return-1},t._closeEntry=function(){var e=(0,r.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.mediaKeySession,e.abrupt("return",new Promise((function(e,r){function i(){void 0!==t&&(t.closingStatus={type:"pending"}),oe(n).then((function(){void 0!==t&&(t.closingStatus={type:"done"}),e(!0)})).catch((function(e){void 0!==t&&(t.closingStatus={type:"failed"}),r(e)}))}void 0!==t&&(t.isLoadingPersistentSession||t.isGeneratingRequest)?t.closingStatus={type:"awaiting",start:i}:i()})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}();function oe(e){return se.apply(this,arguments)}function se(){return(se=(0,r.Z)(o().mark((function e(t){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.Z.debug("DRM: Trying to close a MediaKeySession",t.sessionId),e.prev=1,e.next=4,j(t);case 4:return u.Z.debug("DRM: Succeeded to close MediaKeySession"),e.abrupt("return");case 8:return e.prev=8,e.t0=e.catch(1),u.Z.error("DRM: Could not close MediaKeySession: "+(e.t0 instanceof Error?e.t0.toString():"Unknown error")),e.abrupt("return");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}var ue=n(9689),le=n(2870),de=n(6923),ce=function(){function e(e){this.initData=e}return e.prototype.toJSON=function(){return(0,ue.J)(this.initData)},e.decode=function(e){return(0,ue.K)(e)},e}();function fe(e,t){var n,r;return null!==(r=null!==(n=ve(e,t))&&void 0!==n?n:ve(t,e))&&void 0!==r&&r}function ve(e,t){if(0===e.length)return!1;if(t.length<e.length)return null;for(var n=e[0],r=0,i=0;i<t.length;i++){var a=t[i];if(a.systemId===n.systemId){if(a.hash!==n.hash)return!1;var o=n.data instanceof Uint8Array?n.data:"string"==typeof n.data?ce.decode(n.data):n.data.initData,s=a.data instanceof Uint8Array?a.data:"string"==typeof a.data?ce.decode(a.data):a.data.initData;if(!(0,d.Z)(o,s))return!1;if(t.length-i<e.length)return null;for(r=1;r<e.length;r++){var u=e[r];for(i+=1;i<t.length;i++){var l=t[i];if(u.systemId===l.systemId){if(u.hash!==l.hash)return!1;var c=u.data instanceof Uint8Array?u.data:"string"==typeof u.data?ce.decode(u.data):u.data.initData,f=l.data instanceof Uint8Array?l.data:"string"==typeof l.data?ce.decode(l.data):l.data.initData;if(!(0,d.Z)(c,f))return!1;break}}if(r===t.length)return null}return!0}}return null}function pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function(){function e(e){!function(e){(0,q.u)(e,{save:"function",load:"function"},"licenseStorage")}(e),this._entries=[],this._storage=e;try{var t=this._storage.load();Array.isArray(t)||(t=[]),this._entries=t}catch(e){u.Z.warn("DRM-PSS: Could not get entries from license storage",e instanceof Error?e:""),this.dispose()}}var t=e.prototype;return t.getLength=function(){return this._entries.length},t.getAll=function(){return this._entries},t.get=function(e){var t=this._getIndex(e);return-1===t?null:this._entries[t]},t.getAndReuse=function(e){var t=this._getIndex(e);if(-1===t)return null;var n=this._entries.splice(t,1)[0];return this._entries.push(n),n},t.add=function(e,t,n){var r;if(!(0,E.Z)(n)&&(0,de.Z)(n.sessionId)){var i=n.sessionId,a=this._getIndex(e);if(a>=0){var o=void 0===t?3:4,s=this._entries[a];if((null!==(r=s.version)&&void 0!==r?r:-1)>=o&&i===s.sessionId)return;u.Z.info("DRM-PSS: Updating session info.",i),this._entries.splice(a,1)}else u.Z.info("DRM-PSS: Add new session",i);var l=e.values.getFormattedValues().map((function(e){var t=e.systemId,n=e.data;return{systemId:t,hash:e.hash,data:new ce(n)}}));void 0===t?this._entries.push({version:3,sessionId:i,values:l,initDataType:e.type}):this._entries.push({version:4,sessionId:i,keyIds:t.map((function(e){return new ce(e)})),values:l,initDataType:e.type}),this._save()}else u.Z.warn("DRM-PSS: Invalid Persisten Session given.")},t.delete=function(e){for(var t=-1,n=0;n<this._entries.length;n++){if(this._entries[n].sessionId===e){t=n;break}}if(-1!==t){var r=this._entries[t];u.Z.warn("DRM-PSS: Delete session from store",r.sessionId),this._entries.splice(t,1),this._save()}else u.Z.warn("DRM-PSS: initData to delete not found.")},t.deleteOldSessions=function(e){u.Z.info("DRM-PSS: Deleting last "+e+" sessions."),e<=0||(e<=this._entries.length?this._entries.splice(0,e):(u.Z.warn("DRM-PSS: Asked to remove more information that it contains",e,this._entries.length),this._entries=[]),this._save())},t.dispose=function(){this._entries=[],this._save()},t._getIndex=function(e){var t=this,n=null;function r(){if(null===n){var t=e.values.constructRequestData();n={initData:t,initDataHash:(0,le.Z)(t)}}return n}for(var i=function(n){var i=t._entries[n];if(i.initDataType===e.type)switch(i.version){case 4:if(void 0!==e.keyIds){if(e.keyIds.every((function(e){for(var t,n=(0,ue.J)(e),r=pe(i.keyIds);!(t=r()).done;){var a=t.value;if("string"==typeof a){if(n===a)return!0}else if($(a.initData,e))return!0}return!1})))return{v:n}}else if(fe(e.values.getFormattedValues(),i.values))return{v:n};break;case 3:if(fe(e.values.getFormattedValues(),i.values))return{v:n};break;case 2:var a=r(),o=a.initData,s=a.initDataHash;if(i.initDataHash===s)try{var l="string"==typeof i.initData?ce.decode(i.initData):i.initData.initData;if((0,d.Z)(l,o))return{v:n}}catch(e){u.Z.warn("DRM-PSS: Could not decode initialization data.",e instanceof Error?e:"")}break;case 1:var c=r(),f=c.initData,v=c.initDataHash;if(i.initDataHash===v){if(void 0===i.initData.length)return{v:n};if((0,d.Z)(i.initData,f))return{v:n}}break;default:var p=r().initDataHash;if(i.initData===p)return{v:n}}},a=0;a<this._entries.length;a++){var o=i(a);if("object"==typeof o)return o.v}return-1},t._save=function(){try{this._storage.save(this._entries)}catch(e){u.Z.warn("DRM-PSS: Could not save licenses in localStorage")}},e}();var ge=new WeakMap,ye=function(e){ge.set(e,null)},_e=function(e,t){var n=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer),r=(0,le.Z)(n);ge.set(e,{hash:r,serverCertificate:n})},be=function(e){var t=ge.get(e);return void 0!==t&&(null!==t||void 0)},Se=function(e,t){var n=ge.get(e);if(null==n)return!1;var r=n.hash,i=n.serverCertificate,a=t instanceof Uint8Array?t:new Uint8Array(t instanceof ArrayBuffer?t:t.buffer);if((0,le.Z)(a)!==r||i.length!==a.length)return!1;for(var o=0;o<i.length;o++)if(i[o]!==a[o])return!1;return!0};function Ee(e){if(!0!==e.persistentLicense)return null;var t=e.licenseStorage;if(null==t)throw new g.Z("INVALID_KEY_SYSTEM","No license storage found for persistent license.");return u.Z.debug("DRM: Set the given license storage"),new me(t)}function Te(e,t,n){return we.apply(this,arguments)}function we(){return(we=(0,r.Z)(o().mark((function e(t,n,r){var i,a,s,l,d,c,f,v,p,h;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t,n,r);case 2:if(i=e.sent,null===r.cancellationError){e.next=5;break}throw r.cancellationError;case 5:if(a=i.value,s=a.options,l=a.mediaKeySystemAccess,d=k.Z.getState(t),c=Ee(s),!L()||null===d||"reuse-media-key-system-access"!==i.type){e.next=12;break}if(f=d.mediaKeys,v=d.loadedSessionsStore,!1!==be(f)&&((0,E.Z)(s.serverCertificate)||!Se(f,s.serverCertificate))){e.next=12;break}return e.abrupt("return",{mediaKeys:f,mediaKeySystemAccess:l,stores:{loadedSessionsStore:v,persistentSessionsStore:c},options:s});case 12:return e.next=14,ke(l);case 14:return p=e.sent,u.Z.info("DRM: MediaKeys created with success"),h=new ae(p),e.abrupt("return",{mediaKeys:p,mediaKeySystemAccess:l,stores:{loadedSessionsStore:h,persistentSessionsStore:c},options:s});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e){return Ae.apply(this,arguments)}function Ae(){return(Ae=(0,r.Z)(o().mark((function e(t){var n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u.Z.info("DRM: Calling createMediaKeys on the MediaKeySystemAccess"),e.prev=1,e.next=4,t.createMediaKeys();case 4:return n=e.sent,e.abrupt("return",n);case 8:throw e.prev=8,e.t0=e.catch(1),r=e.t0 instanceof Error?e.t0.message:"Unknown error when creating MediaKeys.",new g.Z("CREATE_MEDIA_KEYS_ERROR",r);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function Ie(){return(Ie=(0,r.Z)(o().mark((function e(t,n,r){var i,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te(t,n,r);case 2:return i=e.sent,a=i.mediaKeys,null!==t.mediaKeys&&void 0!==t.mediaKeys&&a!==t.mediaKeys&&(u.Z.debug("DRM: Disabling old MediaKeys"),A(t)),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=n(7326),xe=n(2146),Ze=n(6716),Pe=n(9127),Me=n(7877),Ce=n(9917),De=n(8337),Oe=new(n(9682).v)(De.o),Ne=Oe;function Le(e){return e instanceof Date&&!isNaN(e)}var Ue=n(6798),Be=n(7878),Fe=n(1819),ze=n(2566),Ve=n(7845),Ke=(0,Fe.d)((function(e){return function(t){void 0===t&&(t=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}}));function Ge(e){throw new Ke(e)}var We=n(278),He=n(9878),je=n(3071),qe=n(8474);var Ye=n(1545),Xe=n(2817),$e=n(3505),Qe=n(2034),Je=n(2006),et=n(533),tt=n(1480),nt=n(3102);var rt=function(e){return e instanceof tt.y?e:e instanceof Promise||!(0,E.Z)(e)&&"function"==typeof e.then?(0,nt.D)(e):(0,Xe.of)(e)},it=n(4865);var at=n(2572);function ot(e,t){var n=t.baseDelay,r=t.maxDelay,i=t.totalRetry,a=t.shouldRetry,o=t.onRetry,s=0;return e.pipe((0,He.K)((function(e,t){if(!(0,E.Z)(a)&&!a(e)||s++>=i)throw e;"function"==typeof o&&o(e,s);var u=Math.min(n*Math.pow(2,s-1),r);return function(e,t,n){void 0===e&&(e=0),void 0===n&&(n=Ne);var r=-1;return null!=t&&((0,it.K)(t)?n=t:r=t),new tt.y((function(t){var i=Le(e)?+e-n.now():e;i<0&&(i=0);var a=0;return n.schedule((function(){t.closed||(t.next(a++),0<=r?this.schedule(void 0,r):t.complete())}),i)}))}((0,at.Z)(u)).pipe((0,Me.z)((function(){return t})))})))}function st(e,t){try{return e(t)}catch(e){return n=function(){return e},i=(0,qe.m)(n)?n:function(){return n},a=function(e){return e.error(i())},new tt.y(r?function(e){return r.schedule(a,0,e)}:a)}var n,r,i,a}var ut=n(7904),lt=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf((0,Re.Z)(r),t.prototype),r.reason=n,r}return(0,i.Z)(t,e),t}((0,xe.Z)(Error)),dt="expired",ct="internal-error",ft="output-restricted";function vt(e,t,n){var r,i=t.fallbackOn,a=void 0===i?{}:i,o=t.throwOnLicenseExpiration,s=t.onKeyExpiration,u=[],l=[],d=[];return e.keyStatuses.forEach((function(e,t){var r="string"==typeof e?[e,t]:[t,e],i=r[0],c=function(e,t){return-1!==e.indexOf("playready")&&(N.YM||N.kD)?(0,f.wO)(t):t}(n,new Uint8Array(r[1])),v={keyId:c.buffer,keyStatus:i};switch(i){case dt:var p=new g.Z("KEY_STATUS_CHANGE_ERROR","A decryption key expired ("+(0,f.ci)(c)+")",{keyStatuses:[v].concat(d)});if("error"===s||void 0===s&&!1===o)throw p;switch(s){case"close-session":throw new lt(p);case"fallback":u.push(c);break;default:"continue"===s||void 0===s?l.push(c):(0,ut.Z)(s)}d.push(v);break;case ct:if(!0!==a.keyInternalError)throw new g.Z("KEY_STATUS_CHANGE_ERROR",'A "'+i+'" status has been encountered ('+(0,f.ci)(c)+")",{keyStatuses:[v].concat(d)});d.push(v),u.push(c);break;case ft:if(!0!==a.keyOutputRestricted)throw new g.Z("KEY_STATUS_CHANGE_ERROR",'A "'+i+'" status has been encountered ('+(0,f.ci)(c)+")",{keyStatuses:[v].concat(d)});d.push(v),u.push(c);break;default:l.push(c)}})),d.length>0&&(r=new g.Z("KEY_STATUS_CHANGE_ERROR","One or several problematic key statuses have been encountered",{keyStatuses:d})),{warning:r,blacklistedKeyIds:u,whitelistedKeyIds:l}}var pt=s.Xe,ht=s.GJ,mt=s.eX,gt=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf((0,Re.Z)(r),t.prototype),r.sessionError=n,r}return(0,i.Z)(t,e),t}((0,xe.Z)(Error));function yt(e,t,n){u.Z.info("DRM: Binding session events",e.sessionId);var r,i,a=new Ze.x,o=t.getLicenseConfig,s=void 0===o?{}:o,l=pt(e).pipe((0,Pe.U)((function(e){throw new g.Z("KEY_ERROR",e.type)}))),d=mt(e).pipe((0,Me.z)((function(r){return function(e,t,n,r){u.Z.info("DRM: keystatuseschange event received",e.sessionId);var i=(0,Ce.P)((function(){return st((function(){return"function"!=typeof t.onKeyStatusesChange?Ye.E:rt(t.onKeyStatusesChange(r,e))}),void 0)})).pipe((0,Pe.U)((function(t){return{type:"key-status-change-handled",value:{session:e,license:t}}})),(0,He.K)((function(e){var t=new g.Z("KEY_STATUS_CHANGE_ERROR","Unknown `onKeyStatusesChange` error");throw!(0,E.Z)(e)&&(0,de.Z)(e.message)&&(t.message=e.message),t})));return(0,je.T)(_t(e,t,n),i)}(e,t,n,r)}))),c=ht(e).pipe((0,Me.z)((function(n){var r=new Uint8Array(n.message),i=(0,de.Z)(n.messageType)?n.messageType:"license-request";u.Z.info("DRM: Received message event, type "+i,e.sessionId);var o=(0,Ce.P)((function(){var e=t.getLicense(r,i),n=(0,E.Z)(s.timeout)?1e4:s.timeout;return rt(e).pipe(n>=0?function(e,t){var n=Le(e)?{first:e}:"number"==typeof e?{each:e}:e,r=n.first,i=n.each,a=n.with,o=void 0===a?Ge:a,s=n.scheduler,u=void 0===s?null!=t?t:Oe:s,l=n.meta,d=void 0===l?null:l;if(null==r&&null==i)throw new TypeError("No timeout provided.");return(0,Ue.e)((function(e,t){var n,a,s=null,l=0,c=function(e){a=(0,Ve.f)(t,u,(function(){try{n.unsubscribe(),(0,Be.Xf)(o({meta:d,lastValue:s,seen:l})).subscribe(t)}catch(e){t.error(e)}}),e)};n=e.subscribe((0,ze.x)(t,(function(e){null==a||a.unsubscribe(),l++,t.next(s=e),i>0&&c(i)}),void 0,void 0,(function(){(null==a?void 0:a.closed)||null==a||a.unsubscribe(),s=null}))),!l&&c(null!=r?"number"==typeof r?r:+r-u.now():i)}))}(n):We.y)})),l=function(e,t){return{totalRetry:null!=t?t:2,baseDelay:200,maxDelay:3e3,shouldRetry:function(e){return e instanceof Ke||(0,E.Z)(e)||!0!==e.noRetry},onRetry:function(t){return e.next({type:"warning",value:bt(t)})}}}(a,s.retry);return ot(o,l).pipe((0,Pe.U)((function(t){return{type:"key-message-handled",value:{session:e,license:t}}})),(0,He.K)((function(e){var t=bt(e);if(!(0,E.Z)(e)&&!0===e.fallbackOnLastTry)throw u.Z.warn("DRM: Last `getLicense` attempt failed. Blacklisting the current session."),new gt(t);throw t})))}))),f=(0,je.T)(c,d).pipe((r=function(t){switch(t.type){case"key-message-handled":case"key-status-change-handled":return(0,E.Z)(t.value.license)?(u.Z.info("DRM: No message given, skipping session.update"),Ye.E):function(e,t){return u.Z.info("DRM: Updating MediaKeySession with message"),rt(e.update(t)).pipe((0,He.K)((function(e){var t=e instanceof Error?e.toString():"`session.update` failed";throw new g.Z("KEY_UPDATE_ERROR",t)})),(0,Je.b)((function(){u.Z.info("DRM: MediaKeySession update succeeded.")})),(0,et.l)())}(e,t.value.license);default:return(0,Xe.of)(t)}},(0,qe.m)(i)?(0,Me.z)(r,i,1):(0,Me.z)(r,1))),v=(0,je.T)(_t(e,t,n),f,l,a);return(0,E.Z)(e.closed)?v:v.pipe((0,$e.R)(rt(e.closed)))}function _t(e,t,n){return(0,Ce.P)((function(){if(0===e.keyStatuses.size)return Ye.E;var r=vt(e,t,n),i=r.warning,a=r.blacklistedKeyIds,o=r.whitelistedKeyIds,s=(0,Xe.of)({type:"keys-update",value:{whitelistedKeyIds:o,blacklistedKeyIds:a}});return void 0!==i?(0,Qe.z)((0,Xe.of)({type:"warning",value:i}),s):s}))}function bt(e){if(e instanceof Ke)return new g.Z("KEY_LOAD_TIMEOUT","The license server took too much time to respond.");var t=new g.Z("KEY_LOAD_ERROR","An error occured when calling `getLicense`.");return!(0,E.Z)(e)&&(0,de.Z)(e.message)&&(t.message=e.message),t}var St=n(9822);function Et(e,t){return Tt.apply(this,arguments)}function Tt(){return(Tt=(0,r.Z)(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.setServerCertificate(n);case 3:return r=e.sent,e.abrupt("return",r);case 7:throw e.prev=7,e.t0=e.catch(0),u.Z.warn("DRM: mediaKeys.setServerCertificate returned an error",e.t0 instanceof Error?e.t0:""),i=e.t0 instanceof Error?e.t0.toString():"`setServerCertificate` error",new g.Z("LICENSE_SERVER_CERTIFICATE_ERROR",i);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function wt(e,t){return kt.apply(this,arguments)}function kt(){return(kt=(0,r.Z)(o().mark((function e(t,n){var r,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!0!==be(t)){e.next=3;break}return u.Z.info("DRM: The MediaKeys already has a server certificate, skipping..."),e.abrupt("return",{type:"already-has-one"});case 3:if("function"==typeof t.setServerCertificate){e.next=6;break}return u.Z.warn("DRM: Could not set the server certificate. mediaKeys.setServerCertificate is not a function"),e.abrupt("return",{type:"method-not-implemented"});case 6:return u.Z.info("DRM: Setting server certificate on the MediaKeys"),ye(t),e.prev=8,e.next=11,Et(t,n);case 11:return r=e.sent,_e(t,n),e.abrupt("return",{type:"success",value:r});case 16:return e.prev=16,e.t0=e.catch(8),i=(0,St.Z)(e.t0)?e.t0:new g.Z("LICENSE_SERVER_CERTIFICATE_ERROR","Unknown error when setting the server certificate."),e.abrupt("return",{type:"error",value:i});case 20:case"end":return e.stop()}}),e,null,[[8,16]])})))).apply(this,arguments)}function At(e,t){if(!(isNaN(t)||t<0||t>=e.getLength())){var n=e.getLength(),r=n-t;u.Z.info("DRM: Too many stored persistent sessions, removing some.",n,r),e.deleteOldSessions(r)}}var It=n(9252);var Rt=function(){function e(e){this._innerValues=e,this._lazyFormattedValues=null}var t=e.prototype;return t.constructRequestData=function(){return c.zo.apply(void 0,this._innerValues.map((function(e){return e.data})))},t.isCompatibleWith=function(t){var n=t instanceof e?t.getFormattedValues():t;return fe(this.getFormattedValues(),n)},t.getFormattedValues=function(){return null===this._lazyFormattedValues&&(this._lazyFormattedValues=this._innerValues.slice().sort((function(e,t){return e.systemId===t.systemId?0:void 0===e.systemId?1:void 0===t.systemId||e.systemId<t.systemId?-1:1})).map((function(e){var t=e.systemId,n=e.data;return{systemId:t,data:n,hash:(0,le.Z)(n)}}))),this._lazyFormattedValues},e}();function xt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Zt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Zt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pt,Mt=s.Oh,Ct=function(e){function t(t,n){var r;r=e.call(this)||this,u.Z.debug("DRM: Starting ContentDecryptor logic.");var i=new T.ZP;r._currentSessions=[],r._canceller=i,r._wasAttachCalled=!1,r._initDataQueue=[],r._stateData={state:Pt.Initializing,isMediaKeysAttached:!1,isInitDataQueueLocked:!0,data:null},r.error=null;var a=Mt(t).subscribe((function(e){u.Z.debug("DRM: Encrypted event received from media element.");var t=h(e);null!==t&&r.onInitializationData(t)}));return i.signal.register((function(){a.unsubscribe()})),function(e,t,n){return Ie.apply(this,arguments)}(t,n,i.signal).then((function(e){var n,i,a=e.options,o=e.mediaKeySystemAccess;((0,E.Z)(a.licenseStorage)||!0===a.licenseStorage.disableRetroCompatibility)&&(i=o.keySystem,n=(0,It.Z)(i,"com.microsoft.playready")||"com.chromecast.playready"===i||"com.youtube.playready"===i?"9a04f07998404286ab92e65be0885f95":"com.widevine.alpha"===i?"edef8ba979d64acea3c827dcd51d21ed":(0,It.Z)(i,"com.apple.fps")?"94ce86fb07ff4f43adb893d2fa968ca2":(0,It.Z)(i,"com.nagra.")?"adb41c242dbf4a6d958b4457c0d27b95":void 0),r.systemId=n,r._stateData.state===Pt.Initializing&&(r._stateData={state:Pt.WaitingForAttachment,isInitDataQueueLocked:!0,isMediaKeysAttached:!1,data:{mediaKeysInfo:e,mediaElement:t}},r.trigger("stateChange",r._stateData.state))})).catch((function(e){r._onFatalError(e)})),r}(0,i.Z)(t,e);var n=t.prototype;return n.getState=function(){return this._stateData.state},n.attach=function(){var e=this;if(this._stateData.state!==Pt.WaitingForAttachment)throw new Error("`attach` should only be called when in the WaitingForAttachment state");if(this._wasAttachCalled)u.Z.warn("DRM: ContentDecryptor's `attach` method called more than once.");else{this._wasAttachCalled=!0;var t=this._stateData.data,n=t.mediaElement,i=t.mediaKeysInfo,a=i.options,s=i.mediaKeys,l=i.mediaKeySystemAccess,d={loadedSessionsStore:i.stores.loadedSessionsStore,mediaKeySystemAccess:l,mediaKeys:s,keySystemOptions:a};!0===a.disableMediaKeysAttachmentLock&&(this._stateData={state:Pt.ReadyForContent,isInitDataQueueLocked:!0,isMediaKeysAttached:!1,data:null},this.trigger("stateChange",this._stateData.state),this._isStopped())||(u.Z.debug("DRM: Attaching current MediaKeys"),function(e,t,n){return I.apply(this,arguments)}(n,d,this._canceller.signal).then((0,r.Z)(o().mark((function t(){var n,r,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=a.serverCertificate,(0,E.Z)(n)){t.next=6;break}return t.next=4,wt(s,n);case 4:"error"===(r=t.sent).type&&e.trigger("warning",r.value);case 6:if(!e._isStopped()){t.next=8;break}return t.abrupt("return");case 8:u=e._stateData.state,e._stateData={state:Pt.ReadyForContent,isMediaKeysAttached:!0,isInitDataQueueLocked:!1,data:{mediaKeysData:i}},u!==Pt.ReadyForContent&&e.trigger("stateChange",Pt.ReadyForContent),e._isStopped()||e._processCurrentInitDataQueue();case 12:case"end":return t.stop()}}),t)})))).catch((function(t){e._onFatalError(t)})))}},n.dispose=function(){this.removeEventListener(),this._stateData={state:Pt.Disposed,isMediaKeysAttached:void 0,isInitDataQueueLocked:void 0,data:null},this._canceller.cancel(),this.trigger("stateChange",this._stateData.state)},n.onInitializationData=function(e){var t=this;if(!1===this._stateData.isInitDataQueueLocked){var n=this._stateData.data.mediaKeysData,r=Object.assign(Object.assign({},e),{values:new Rt(e.values)});this._processInitializationData(r,n).catch((function(e){t._onFatalError(e)}))}else{if(this._isStopped())throw new Error("ContentDecryptor either disposed or stopped.");this._initDataQueue.push(e)}},n._processInitializationData=function(){var e=(0,r.Z)(o().mark((function e(t,n){var r,i,a,s,l,d,c,v,p,h,y,b,S,E,T,w,k,A,I,R,x,Z,P,M,C,O,N,L,U,B,F,z,V,K,G=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.mediaKeySystemAccess,i=n.stores,a=n.options,!this._tryToUseAlreadyCreatedSession(t,n)&&!this._isStopped()){e.next=3;break}return e.abrupt("return");case 3:if("content"!==a.singleLicensePer){e.next=15;break}if(void 0===(s=(0,_.Z)(this._currentSessions,(function(e){return"created-session"===e.source})))){e.next=13;break}if(void 0!==(l=t.keyIds)){e.next=10;break}return void 0===t.content?u.Z.warn("DRM: Unable to fallback from a non-decipherable quality."):Nt(t.content.manifest,t),e.abrupt("return");case 10:return s.record.associateKeyIds(l),void 0!==t.content&&(u.Z.hasLevel("DEBUG")&&(d=l.reduce((function(e,t){return e+", "+(0,f.ci)(t)}),""),u.Z.debug("DRM: Blacklisting new key ids",d)),Ot(t.content.manifest,[],l,[])),e.abrupt("return");case 13:e.next=37;break;case 15:if("periods"!==a.singleLicensePer||void 0===t.content){e.next=37;break}c=t.content.period,v=this._currentSessions.filter((function(e){return"created-session"===e.source})),Bt(p=new Set,c),h=xt(v);case 21:if((y=h()).done){e.next=37;break}b=y.value,S=Array.from(p),E=0,T=S;case 25:if(!(E<T.length)){e.next=35;break}if(w=T[E],!b.record.isAssociatedWithKeyId(w)){e.next=32;break}for(b.record.associateKeyIds(p.values()),k=xt(S);!(A=k()).done;)Q(I=A.value,b.keyStatuses.whitelisted)||Q(I,b.keyStatuses.blacklisted)||b.keyStatuses.blacklisted.push(I);return Ot(t.content.manifest,b.keyStatuses.whitelisted,b.keyStatuses.blacklisted,[]),e.abrupt("return");case 32:E++,e.next=25;break;case 35:e.next=21;break;case 37:return this._lockInitDataQueue(),!0!==a.persistentLicense?R="temporary":Dt(r)?R="persistent-license":(u.Z.warn('DRM: Cannot create "persistent-license" session: not supported'),R="temporary"),x=m.Z.getCurrent(),Z=x.EME_DEFAULT_MAX_SIMULTANEOUS_MEDIA_KEY_SESSIONS,P=x.EME_MAX_STORED_PERSISTENT_SESSION_INFORMATION,M="number"==typeof a.maxSessionCacheSize?a.maxSessionCacheSize:Z,e.next=43,D(t,i,R,M,this._canceller.signal);case 43:if(C=e.sent,!this._isStopped()){e.next=46;break}return e.abrupt("return");case 46:if(O={record:C.value.keySessionRecord,source:C.type,keyStatuses:{whitelisted:[],blacklisted:[]},blacklistedSessionError:null},this._currentSessions.push(O),N=C.value,L=N.mediaKeySession,U=N.sessionType,B=!1,F=yt(L,a,r.keySystem).subscribe({next:function(e){if("warning"!==e.type){var n=Lt(t,O.record,a.singleLicensePer,"created-session"===O.source,e.value.whitelistedKeyIds,e.value.blacklistedKeyIds);if(O.record.associateKeyIds(n.whitelisted),O.record.associateKeyIds(n.blacklisted),O.keyStatuses={whitelisted:n.whitelisted,blacklisted:n.blacklisted},0!==O.record.getAssociatedKeyIds().length&&"persistent-license"===U&&null!==i.persistentSessionsStore&&!B){var r=i.persistentSessionsStore;At(r,P-1),r.add(t,O.record.getAssociatedKeyIds(),L),B=!0}void 0!==t.content&&Ot(t.content.manifest,n.whitelisted,n.blacklisted,[]),G._unlockInitDataQueue()}else G.trigger("warning",e.value)},error:function(e){var n;if(e instanceof lt){u.Z.warn("DRM: A session's closing condition has been triggered"),G._lockInitDataQueue();var r=G._currentSessions.indexOf(O);return r>=0&&G._currentSessions.splice(r),void 0!==t.content&&Ot(t.content.manifest,[],[],O.record.getAssociatedKeyIds()),null===(n=i.persistentSessionsStore)||void 0===n||n.delete(L.sessionId),i.loadedSessionsStore.closeSession(L).catch((function(e){var t=e instanceof Error?e:"unknown error";u.Z.warn("DRM: failed to close expired session",t)})).then((function(){return G._unlockInitDataQueue()})).catch((function(e){return G._onFatalError(e)})),void(G._isStopped()||G.trigger("warning",e.reason))}if(e instanceof gt){if(O.blacklistedSessionError=e,void 0!==t.content){var a=t.content.manifest;u.Z.info("DRM: blacklisting Representations based on protection data."),Nt(a,t)}G._unlockInitDataQueue()}else G._onFatalError(e)}}),this._canceller.signal.register((function(){F.unsubscribe()})),void 0!==a.singleLicensePer&&"init-data"!==a.singleLicensePer||this._unlockInitDataQueue(),"created-session"!==C.type){e.next=68;break}return z=t.values.constructRequestData(),e.prev=55,e.next=58,i.loadedSessionsStore.generateLicenseRequest(L,t.type,z);case 58:e.next=68;break;case 60:if(e.prev=60,e.t0=e.catch(55),null!==(V=i.loadedSessionsStore.getEntryForSession(L))&&"none"===V.closingStatus.type){e.next=67;break}return(K=this._currentSessions.indexOf(O))>=0&&this._currentSessions.splice(K,1),e.abrupt("return",Promise.resolve());case 67:throw new g.Z("KEY_GENERATE_REQUEST_ERROR",e.t0 instanceof Error?e.t0.toString():"Unknown error");case 68:return e.abrupt("return",Promise.resolve());case 69:case"end":return e.stop()}}),e,this,[[55,60]])})));return function(t,n){return e.apply(this,arguments)}}(),n._tryToUseAlreadyCreatedSession=function(e,t){var n=t.stores,r=t.options,i=(0,_.Z)(this._currentSessions,(function(t){return t.record.isCompatibleWith(e)}));if(void 0===i)return!1;var a=i.blacklistedSessionError;if(!(0,E.Z)(a))return void 0===e.type||void 0===e.content?(u.Z.error("DRM: This initialization data has already been blacklisted but the current content is not known."),!0):(u.Z.info("DRM: This initialization data has already been blacklisted. Blacklisting the related content."),Nt(e.content.manifest,e),!0);if(void 0!==e.keyIds){var o;if(void 0===r.singleLicensePer||"init-data"===r.singleLicensePer){var s=i.keyStatuses.blacklisted;o=function(e,t){for(var n,r=function(){var e=n.value;if(t.some((function(t){return $(t,e)})))return{v:!0}},i=Y(e);!(n=i()).done;){var a=r();if("object"==typeof a)return a.v}return!1}(e.keyIds,s)}else{var l=i.keyStatuses.whitelisted;o=!J(e.keyIds,l)}if(o)return void 0===e.content?(u.Z.error("DRM: Cannot forbid key id, the content is unknown."),!0):(u.Z.info("DRM: Current initialization data is linked to blacklisted keys. Marking Representations as not decipherable"),Ot(e.content.manifest,[],e.keyIds,[]),!0)}if(null!==n.loadedSessionsStore.reuse(e))return u.Z.debug("DRM: Init data already processed. Skipping it."),!0;var d=this._currentSessions.indexOf(i);return-1===d?u.Z.error("DRM: Unable to remove processed init data: not found."):(u.Z.debug("DRM: A session from a processed init data is not available anymore. Re-processing it."),this._currentSessions.splice(d,1)),!1},n._onFatalError=function(e){if(!this._canceller.isUsed){var t=e instanceof Error?e:new y.Z("NONE","Unknown decryption error");this.error=t,this._initDataQueue.length=0,this._stateData={state:Pt.Error,isMediaKeysAttached:void 0,isInitDataQueueLocked:void 0,data:null},this._canceller.cancel(),this.trigger("error",t),this._stateData.state===Pt.Error&&this.trigger("stateChange",this._stateData.state)}},n._isStopped=function(){return this._stateData.state===Pt.Disposed||this._stateData.state===Pt.Error},n._processCurrentInitDataQueue=function(){for(;!1===this._stateData.isInitDataQueueLocked;){var e=this._initDataQueue.shift();if(void 0===e)return;this.onInitializationData(e)}},n._lockInitDataQueue=function(){!1===this._stateData.isInitDataQueueLocked&&(this._stateData.isInitDataQueueLocked=!0)},n._unlockInitDataQueue=function(){!0===this._stateData.isMediaKeysAttached?(this._stateData.isInitDataQueueLocked=!1,this._processCurrentInitDataQueue()):u.Z.error("DRM: Trying to unlock in the wrong state")},t}(S.Z);function Dt(e){var t=e.getConfiguration().sessionTypes;return void 0!==t&&(0,b.Z)(t,"persistent-license")}function Ot(e,t,n,r){e.updateRepresentationsDeciperability((function(e){if(void 0===e.contentProtections)return e.decipherable;var i=e.contentProtections.keyIds;if(void 0!==i)for(var a,o=xt(i);!(a=o()).done;){for(var s,u=a.value,l=xt(n);!(s=l()).done;){if($(s.value,u.keyId))return!1}for(var d,c=xt(t);!(d=c()).done;){if($(d.value,u.keyId))return!0}for(var f,v=xt(r);!(f=v()).done;){if($(f.value,u.keyId))return}}return e.decipherable}))}function Nt(e,t){e.updateRepresentationsDeciperability((function(e){var n,r;if(!1===e.decipherable)return!1;for(var i,a=function(){var e=i.value;if((void 0===t.type||e.type===t.type)&&t.values.getFormattedValues().every((function(t){return e.values.some((function(e){return(void 0===t.systemId||e.systemId===t.systemId)&&(0,d.Z)(e.data,t.data)}))})))return{v:!1}},o=xt(null!==(r=null===(n=e.contentProtections)||void 0===n?void 0:n.initData)&&void 0!==r?r:[]);!(i=o()).done;){var s=a();if("object"==typeof s)return s.v}return e.decipherable}))}function Lt(e,t,n,r,i,a){for(var o,s,l=[].concat(i,a),d=function(){var e=s.value;l.some((function(t){return $(t,e)}))||(u.Z.hasLevel("DEBUG")&&u.Z.debug("DRM: KeySessionRecord's key missing in the license, blacklisting it",(0,f.ci)(e)),l.push(e))},c=xt(t.getAssociatedKeyIds());!(s=c()).done;)d();if(void 0!==n&&"init-data"!==n){var v=e.keyIds,p=e.content;if(void 0!==v){var h=v.filter((function(e){return!l.some((function(t){return $(t,e)}))}));h.length>0&&(u.Z.hasLevel("DEBUG")&&u.Z.debug("DRM: init data keys missing in the license, blacklisting them",h.map((function(e){return(0,f.ci)(e)})).join(", ")),l.push.apply(l,h))}if(r&&void 0!==p)if("content"===n){for(var m,g=new Set,y=xt(p.manifest.periods);!(m=y()).done;){Bt(g,m.value)}Ut(g,l)}else if("periods"===n)for(var _,b=xt(p.manifest.periods);!(_=b()).done;){var S=_.value,E=new Set;if(Bt(E,S),(null===(o=e.content)||void 0===o?void 0:o.period.id)===S.id)Ut(E,l);else for(var T=Array.from(E),w=function(){var e=A[k];if(l.some((function(t){return $(t,e)})))return Ut(E,l),"break"},k=0,A=T;k<A.length;k++){if("break"===w())break}}}return{whitelisted:i,blacklisted:l.slice(i.length)}}function Ut(e,t){for(var n=Array.from(e.values()),r=function(){var e=a[i];t.some((function(t){return $(t,e)}))||t.push(e)},i=0,a=n;i<a.length;i++)r()}function Bt(e,t){for(var n,r=xt(t.getAdaptations());!(n=r()).done;)for(var i,a=xt(n.value.representations);!(i=a()).done;){var o=i.value;if(void 0!==o.contentProtections&&void 0!==o.contentProtections.keyIds)for(var s,u=xt(o.contentProtections.keyIds);!(s=u()).done;){var l=s.value;e.add(l.keyId)}}}!function(e){e[e.Initializing=0]="Initializing",e[e.WaitingForAttachment=1]="WaitingForAttachment",e[e.ReadyForContent=2]="ReadyForContent",e[e.Error=3]="Error",e[e.Disposed=4]="Disposed"}(Pt||(Pt={}))},1266:function(e,t,n){"use strict";var r=n(1422);t.ZP=r.Z},770:function(e,t){"use strict";var n=new WeakMap;t.Z={setState:function(e,t){n.set(e,t)},getState:function(e){var t=n.get(e);return void 0===t?null:t},clearState:function(e){n.set(e,null)}}},9372:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(4578),i=n(5767),a=n(3887),o=n(5095),s=n(288),u=n(379),l=n(1757),d=n(8833),c=n(8799),f=n(6199),v=n(4576),p=function(e){function t(t){var n;return(n=e.call(this)||this)._settings=t,n._initCanceller=new s.ZP,n}(0,r.Z)(t,e);var n=t.prototype;return n.prepare=function(){},n.start=function(e,t){var n=this,r=this._initCanceller.signal,s=this._settings,u=s.keySystems,l=s.speed,d=s.url;if((0,i.Z)(e),null==d)throw new Error("No URL for a DirectFile content");var p=(0,c.Z)(e,u,(0,o.ZP)(null),{onError:function(e){return n._onFatalError(e)},onWarning:function(e){return n.trigger("warning",e)}},r);(0,v.Z)(e,(function(e){return n._onFatalError(e)}),r);var h=new f.Z(t,null,l);h.addEventListener("stalled",(function(e){return n.trigger("stalled",e)})),h.addEventListener("unstalled",(function(){return n.trigger("unstalled",null)})),h.addEventListener("warning",(function(e){return n.trigger("warning",e)})),r.register((function(){h.destroy()})),h.start(),p.onUpdate((function(o,s){"uninitialized"!==o.initializationState.type&&(s(),a.Z.info("Setting URL to HTMLMediaElement",d),e.src=d,r.register((function(){(0,i.Z)(e)})),"awaiting-media-link"===o.initializationState.type?(o.initializationState.value.isMediaLinked.setValue(!0),p.onUpdate((function(r,i){if("initialized"===r.initializationState.type)return i(),void n._seekAndPlay(e,t)}),{emitCurrentValue:!0,clearSignal:r})):n._seekAndPlay(e,t))}),{emitCurrentValue:!0,clearSignal:r})},n.dispose=function(){this._initCanceller.cancel()},n._onFatalError=function(e){this._initCanceller.cancel(),this.trigger("error",e)},n._seekAndPlay=function(e,t){var n=this,r=this._initCanceller.signal,i=this._settings,o=i.autoPlay,s=i.startAt;(0,d.Z)(e,t,(function(){a.Z.debug("Init: Calculating initial time");var t=function(e,t){if(null==t)return 0;if(null!=t.position)return t.position;if(null!=t.wallClockTime)return t.wallClockTime;if(null!=t.fromFirstPosition)return t.fromFirstPosition;var n=e.duration;if(null==n||!isFinite(n))return a.Z.warn("startAt.fromLastPosition set but no known duration, beginning at 0."),0;if("number"==typeof t.fromLastPosition)return Math.max(0,n+t.fromLastPosition);if(null!=t.percentage){var r=t.percentage;return r>=100?n:r<=0?0:n*(+r/100)}return 0}(e,s);return a.Z.debug("Init: Initial time calculated:",t),t}),o,(function(e){return n.trigger("warning",e)}),r).autoPlayResult.then((function(){return(0,l.Z)(t,e,!0,r).onUpdate((function(e,t){e&&(t(),n.trigger("loaded",{segmentBuffersStore:null}))}),{emitCurrentValue:!0,clearSignal:r})})).catch((function(e){r.isCancelled||n._onFatalError(e)}))},t}(u.K)},379:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n(4578),i=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t}(n(1959).Z)},1757:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(3666);var i=n(1669),a=n(5095),o=n(288);function s(e,t,n,s){var u=(0,a.ZP)(!1),l=new o.ZP({cancelOn:s});return l.signal.register((function(){return u.finish()})),e.listen((function(e){if(null===e.rebuffering&&null===e.freezing&&0!==e.readyState)return!function(e,t){return!e||!r.SB||t}(n,t.hasAttribute("playsinline"))&&t.duration>0||e.readyState>=3&&null!==e.currentRange&&(!(0,i.Z)()||t.duration>0)?(u.setValue(!0),void l.cancel()):void 0}),{includeLastObservation:!0,clearSignal:l.signal}),u}},8833:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(1669),i=n(3774),a=n(3714),o=n(3887),s=n(5095);function u(e,t,n,u,l,d){var c,f,v=new Promise((function(e,t){c=e,f=t})),p=(0,s.$l)(!1),h=(0,s.$l)(!1);return e.addEventListener("loadedmetadata",m),e.readyState>=i.c.HAVE_METADATA&&m(),d.register((function(t){e.removeEventListener("loadedmetadata",m),f(t)})),{autoPlayResult:v,initialPlayPerformed:h,initialSeekPerformed:p};function m(){e.removeEventListener("loadedmetadata",m);var i="function"==typeof n?n():n;if(o.Z.info("Init: Set initial time",i),t.setCurrentTime(i),p.setValue(!0),p.finish(),(0,r.Z)()&&0===e.duration){var s=new a.Z("MEDIA_ERR_NOT_LOADED_METADATA","Cannot load automatically: your browser falsely announced having loaded the content.");l(s)}d.isCancelled||t.listen((function(t,n){!t.seeking&&null===t.rebuffering&&t.readyState>=1&&(n(),function(){var t,n;if(o.Z.info("Init: Can begin to play content"),!u)return e.autoplay&&o.Z.warn("Init: autoplay is enabled on HTML media element. Media will play as soon as possible."),h.setValue(!0),h.finish(),c({type:"skipped"});try{n=null!==(t=e.play())&&void 0!==t?t:Promise.resolve()}catch(e){return f(e)}n.then((function(){if(!d.isCancelled)return h.setValue(!0),h.finish(),c({type:"autoplay"})})).catch((function(e){if(!d.isCancelled){if(e instanceof Error&&"NotAllowedError"===e.name){o.Z.warn("Init: Media element can't play. It may be due to browser auto-play policies.");var t=new a.Z("MEDIA_ERR_BLOCKED_AUTOPLAY","Cannot trigger auto-play automatically: your browser does not allow it.");if(l(t),d.isCancelled)return;return c({type:"autoplay-blocked"})}f(e)}}))}())}),{includeLastObservation:!0,clearSignal:d})}}},8799:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(6139);var i=n(5157),a=n(3887),o=n(5095),s=n(288),u=n(1266),l=n(1422);function d(e,t,n,d,c){if(0===t.length)return n.onUpdate((function(e,t){if(null!==e){t(),a.Z.error("Init: Encrypted event but EME feature not activated");var n=new i.Z("MEDIA_IS_ENCRYPTED_ERROR","EME feature not activated.");d.onError(n)}}),{clearSignal:c}),(0,o.ZP)({initializationState:{type:"initialized",value:null},drmSystemId:void 0});if("function"!=typeof r.N)return n.onUpdate((function(e,t){if(null!==e){t(),a.Z.error("Init: Encrypted event but no EME API available");var n=new i.Z("MEDIA_IS_ENCRYPTED_ERROR","Encryption APIs not found.");d.onError(n)}}),{clearSignal:c}),(0,o.ZP)({initializationState:{type:"initialized",value:null},drmSystemId:void 0});var f=new s.ZP({cancelOn:c}),v=(0,o.ZP)({initializationState:{type:"uninitialized",value:null},drmSystemId:void 0});a.Z.debug("Init: Creating ContentDecryptor");var p=new u.ZP(e,t);return p.addEventListener("stateChange",(function(e){if(e===l.u.WaitingForAttachment){var t=(0,o.ZP)(!1);t.onUpdate((function(t,n){t&&(n(),e===l.u.WaitingForAttachment&&p.attach())}),{clearSignal:f.signal}),v.setValue({initializationState:{type:"awaiting-media-link",value:{isMediaLinked:t}},drmSystemId:p.systemId})}else e===l.u.ReadyForContent&&(v.setValue({initializationState:{type:"initialized",value:null},drmSystemId:p.systemId}),p.removeEventListener("stateChange"))})),p.addEventListener("error",(function(e){f.cancel(),d.onError(e)})),p.addEventListener("warning",(function(e){d.onWarning(e)})),n.onUpdate((function(e){null!==e&&p.onInitializationData(e)}),{clearSignal:f.signal}),f.signal.register((function(){p.dispose()})),v}},6199:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(4578),i=n(3666).yS,a=n(6872),o=n(3714),s=n(3887),u=n(1959),l=n(2829),d=n(288),c=1/60,f=function(e){function t(t,n,r){var i;return(i=e.call(this)||this)._playbackObserver=t,i._manifest=n,i._speed=r,i._discontinuitiesStore=[],i._isStarted=!1,i._canceller=new d.ZP,i}(0,r.Z)(t,e);var n=t.prototype;return n.start=function(){var e=this;if(!this._isStarted){var t;this._isStarted=!0;var n,r=null,o=new h(this._playbackObserver,this._speed);this._canceller.signal.register((function(){o.dispose()})),this._playbackObserver.listen((function(u){var d,f,v=e._discontinuitiesStore,h=u.buffered,m=u.position,g=u.readyState,y=u.rebuffering,_=u.freezing,b=a.Z.getCurrent(),S=b.BUFFER_DISCONTINUITY_THRESHOLD,E=b.FORCE_DISCONTINUITY_SEEK_DELAY,T=b.FREEZING_STALLED_DELAY,w=b.UNFREEZING_SEEK_DELAY,k=b.UNFREEZING_DELTA_POSITION;if(!u.seeking&&i&&null===r&&null!==t&&u.position<t){s.Z.debug("Init: the device appeared to have seeked back by itself.");var A=performance.now();r=A}if(t=u.seeking?Math.max(null!==(d=u.pendingInternalSeek)&&void 0!==d?d:0,u.position):null,null!==_){var I=performance.now();if(I-(null===n?_.timestamp:n.attemptTimestamp)>w&&(s.Z.warn("Init: trying to seek to un-freeze player"),e._playbackObserver.setCurrentTime(e._playbackObserver.getCurrentTime()+k),n={attemptTimestamp:I}),I-_.timestamp>T)return null===y||null!==r?o.stopRebuffering():o.startRebuffering(),void e.trigger("stalled","freezing")}else n=null;if(null===y)return o.stopRebuffering(),1===g?(f=u.seeking?null!==u.pendingInternalSeek?"internal-seek":"seeking":"not-ready",void e.trigger("stalled",f)):void e.trigger("unstalled",null);var R="seeking"===y.reason&&null!==u.pendingInternalSeek?"internal-seek":y.reason;if(null!==r){var x=performance.now();if(x-r<E)return o.stopRebuffering(),s.Z.debug("Init: letting the device get out of a stall by itself"),void e.trigger("stalled",R);s.Z.warn("Init: ignored stall for too long, checking discontinuity",x-r)}if(r=null,o.startRebuffering(),null!==e._manifest){var Z=y.position;if(null!=Z&&e._speed.getValue()>0){var P=function(e,t,n){if(0===e.length)return null;for(var r=null,i=0;i<e.length;i++){var a=e[i].period;if(a.start>n)return r;var o=void 0;if(void 0===a.end||a.end>n){var u=e[i],l=u.discontinuity,d=u.position,f=l.start,v=l.end;if(n>=(null!=f?f:d)-c)if(null===v){var p=t.getPeriodAfter(a);null!==p?o=p.start+c:s.Z.warn("Init: discontinuity at Period's end but no next Period")}else n<v+c&&(o=v+c);void 0!==o&&(s.Z.info("Init: discontinuity found",n,o),r=null!==r&&r>o?r:o)}}return r}(v,e._manifest,Z);if(null!==P){var M=P+.001;if(!(M<=e._playbackObserver.getCurrentTime()))return s.Z.warn("SA: skippable discontinuity found in the stream",m,M),e._playbackObserver.setCurrentTime(M),void e.trigger("warning",p(Z,M));s.Z.info("Init: position to seek already reached, no seeking",e._playbackObserver.getCurrentTime(),M)}}var C=null!=Z?Z:m,D=(0,l.XS)(h,C);if(e._speed.getValue()>0&&D<S){var O=C+D+c;if(e._playbackObserver.getCurrentTime()<O)return s.Z.warn("Init: discontinuity encountered inferior to the threshold",C,O,S),e._playbackObserver.setCurrentTime(O),void e.trigger("warning",p(C,O))}for(var N=e._manifest.periods.length-2;N>=0;N--){var L=e._manifest.periods[N];if(void 0!==L.end&&L.end<=C){if(e._manifest.periods[N+1].start>C&&e._manifest.periods[N+1].start>e._playbackObserver.getCurrentTime()){var U=e._manifest.periods[N+1];return e._playbackObserver.setCurrentTime(U.start),void e.trigger("warning",p(C,U.start))}break}}e.trigger("stalled",R)}else e.trigger("stalled",R)}),{includeLastObservation:!0,clearSignal:this._canceller.signal})}},n.updateDiscontinuityInfo=function(e){this._isStarted||this.start();var t=this._playbackObserver.getReference().getValue();!function(e,t,n){for(;e.length>0&&void 0!==e[0].period.end&&e[0].period.end+10<n.position;)e.shift();var r=t.period,i=t.bufferType;if("audio"!==i&&"video"!==i)return;for(var a=0;a<e.length;a++)if(e[a].period.id===r.id){if(e[a].bufferType===i)return void(v(t)?e[a]=t:e.splice(a,1))}else if(e[a].period.start>r.start)return void(v(t)&&e.splice(a,0,t));v(t)&&e.push(t)}(this._discontinuitiesStore,e,t)},n.onLockedStream=function(e,t){var n;this._isStarted||this.start();var r=this._playbackObserver.getReference().getValue();if(!(!r.rebuffering||r.paused||this._speed.getValue()<=0||"audio"!==e&&"video"!==e)){var i=r.position,a=null!==(n=r.rebuffering.position)&&void 0!==n?n:i,o=t.start;i<o&&Math.abs(a-o)<1&&(s.Z.warn("Init: rebuffering because of a future locked stream.\nTrying to unlock by seeking to the next Period"),this._playbackObserver.setCurrentTime(o+.001))}},n.destroy=function(){this._canceller.cancel()},t}(u.Z);function v(e){return null!==e.discontinuity}function p(e,t){return new o.Z("DISCONTINUITY_ENCOUNTERED","A discontinuity has been encountered at position "+String(e)+", seeked at position "+String(t))}var h=function(){function e(e,t){this._speedUpdateCanceller=new d.ZP,this._isRebuffering=!1,this._playbackObserver=e,this._isDisposed=!1,this._speed=t,this._updateSpeed()}var t=e.prototype;return t.startRebuffering=function(){this._isRebuffering||this._isDisposed||(this._isRebuffering=!0,this._speedUpdateCanceller.cancel(),s.Z.info("Init: Pause playback to build buffer"),this._playbackObserver.setPlaybackRate(0))},t.stopRebuffering=function(){this._isRebuffering&&!this._isDisposed&&(this._isRebuffering=!1,this._speedUpdateCanceller=new d.ZP,this._updateSpeed())},t.dispose=function(){this._speedUpdateCanceller.cancel(),this._isDisposed=!0},t._updateSpeed=function(){var e=this;this._speed.onUpdate((function(t){s.Z.info("Init: Resume playback speed",t),e._playbackObserver.setPlaybackRate(t)}),{clearSignal:this._speedUpdateCanceller.signal,emitCurrentValue:!0})},e}()},4576:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3714),i=n(1946);function a(e,t,n){function a(){var n,a,o=e.error;switch((0,i.Z)(o)||(n=o.code,a=o.message),n){case 1:return a=null!=a?a:"The fetching of the associated resource was aborted by the user's request.",t(new r.Z("MEDIA_ERR_ABORTED",a));case 2:return a=null!=a?a:"A network error occurred which prevented the media from being successfully fetched",t(new r.Z("MEDIA_ERR_NETWORK",a));case 3:return a=null!=a?a:"An error occurred while trying to decode the media resource",t(new r.Z("MEDIA_ERR_DECODE",a));case 4:return a=null!=a?a:"The media resource has been found to be unsuitable.",t(new r.Z("MEDIA_ERR_SRC_NOT_SUPPORTED",a));default:return a=null!=a?a:"The HTMLMediaElement errored due to an unknown reason.",t(new r.Z("MEDIA_ERR_UNKNOWN",a))}}n.isCancelled||(e.addEventListener("error",a),n.register((function(){e.removeEventListener("error",a)})))}},5192:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(4578),i=n(2453),a=n(3887),o=n(5095),s=n(2203).Z?void 0:window.ResizeObserver;var u=n(6872),l=n(288),d=n(9612),c=n(4309),f=n(7874);function v(e,t){return Math.abs(e-t)<=.2}function p(e,t){for(var n=e.length-1;n>=0;n--){if(e[n].start<t)return e.slice(0,n+1)}return[]}function h(e,t){for(var n=0;n<e.length;n++){if(e[n].end>t)return e.slice(n,e.length)}return[]}function m(e,t,n){var r=Math.max(e.start,t),i=p(e.cues,t),a={start:e.start,end:r,cues:i},o=Math.min(n,e.end),s=h(e.cues,n);return[a,{start:o,end:e.end,cues:s}]}var g=function(){function e(){this._cuesBuffer=[]}var t=e.prototype;return t.get=function(e){for(var t=this._cuesBuffer,n=[],r=t.length-1;r>=0;r--){var i=t[r];if(e<i.end&&e>=i.start){for(var a=i.cues,o=0;o<a.length;o++)e>=a[o].start&&e<a[o].end&&n.push(a[o].element);return n}}return[]},t.remove=function(e,t){for(var n=Math.max(e,t),r=this._cuesBuffer,i=0;i<r.length;i++)if(r[i].end>e){var a=r[i];if(a.start>=n)return;if(a.end>=n){if(e<=a.start)a.cues=h(a.cues,n),a.start=n;else{var o=m(a,e,n),s=o[0],u=o[1];this._cuesBuffer[i]=s,r.splice(i+1,0,u)}return}a.start>=e?(r.splice(i,1),i--):(a.cues=p(a.cues,e),a.end=Math.max(e,a.start))}},t.insert=function(e,t,n){var r=this._cuesBuffer,i={start:t,end:n,cues:e};function a(e){var t=r[e];void 0===t||v(i.end,t.end)?r[e]=i:(t.start>=i.end||(t.cues=h(t.cues,i.end),t.start=i.end),r.splice(e,0,i))}for(var o=0;o<r.length;o++){var s=r[o];if(t<s.end){if(v(t,s.start)){if(v(n,s.end))return void(r[o]=i);if(n<s.end)return s.cues=h(s.cues,n),s.start=n,void r.splice(o,0,i);do{r.splice(o,1),s=r[o]}while(void 0!==s&&n>s.end);return void a(o)}if(t<s.start){if(n<s.start)return void r.splice(o,0,i);if(v(n,s.start))return s.start=n,void r.splice(o,0,i);if(v(n,s.end))return void r.splice(o,1,i);if(n<s.end)return s.cues=h(s.cues,n),s.start=n,void r.splice(o,0,i);do{r.splice(o,1),s=r[o]}while(void 0!==s&&n>s.end);return void a(o)}if(v(s.end,n))return s.cues=p(s.cues,t),s.end=t,void r.splice(o+1,0,i);if(s.end>n){var u=m(s,t,n),l=u[0],d=u[1];return this._cuesBuffer[o]=l,r.splice(o+1,0,i),void r.splice(o+2,0,d)}s.cues=p(s.cues,t),s.end=t;var c=o+1;for(s=r[c];void 0!==s&&n>s.end;)r.splice(c,1),s=r[c];return void a(c)}}r.push(i)},e}();function y(e,t,n,r){for(var i=[t/n.columns,e/n.rows],a=r.getElementsByClassName("proportional-style"),o=0;o<a.length;o++){var s=a[o];if(s instanceof HTMLElement){var u=s.getAttribute("data-proportional-font-size");null===u||isNaN(+u)||(s.style.fontSize=String(+u*i[1])+"px");var l=s.getAttribute("data-proportional-width");null===l||isNaN(+l)||(s.style.width=String(+l*i[0])+"px");var d=s.getAttribute("data-proportional-height");null===d||isNaN(+d)||(s.style.height=String(+d*i[1])+"px");var c=s.getAttribute("data-proportional-line-height");null===c||isNaN(+c)||(s.style.lineHeight=String(+c*i[1])+"px");var f=s.getAttribute("data-proportional-left");null===f||isNaN(+f)||(s.style.left=String(+f*i[0])+"px");var v=s.getAttribute("data-proportional-top");null===v||isNaN(+v)||(s.style.top=String(+v*i[1])+"px");var p=s.getAttribute("data-proportional-padding-top");null===p||isNaN(+p)||(s.style.paddingTop=String(+p*i[1])+"px");var h=s.getAttribute("data-proportional-padding-bottom");null===h||isNaN(+h)||(s.style.paddingBottom=String(+h*i[1])+"px");var m=s.getAttribute("data-proportional-padding-left");null===m||isNaN(+m)||(s.style.paddingLeft=String(+m*i[0])+"px");var g=s.getAttribute("data-proportional-padding-right");null===g||isNaN(+g)||(s.style.paddingRight=String(+g*i[0])+"px")}}return a.length>0}var _=i.M4,b=i.bQ,S=i.Q$;function E(e,t){try{e.removeChild(t)}catch(e){a.Z.warn("HTSB: Can't remove text track: not in the element.")}}function T(e){var t=e.getAttribute("data-resolution-rows"),n=e.getAttribute("data-resolution-columns");if(null===t||null===n)return null;var r=parseInt(t,10),i=parseInt(n,10);return null===r||null===i?null:{rows:r,columns:i}}var w=function(e){function t(t,n){var r;return a.Z.debug("HTSB: Creating HTMLTextSegmentBuffer"),(r=e.call(this)||this).bufferType="text",r._buffered=new c.Z,r._videoElement=t,r._textTrackElement=n,r._sizeUpdateCanceller=new l.ZP,r._canceller=new l.ZP,r._buffer=new g,r._currentCues=[],r.autoRefreshSubtitles(r._canceller.signal),r}(0,r.Z)(t,e);var n=t.prototype;return n.pushChunk=function(e){try{this.pushChunkSync(e)}catch(e){return Promise.reject(e)}return Promise.resolve()},n.removeBuffer=function(e,t){return this.removeBufferSync(e,t),Promise.resolve()},n.endOfSegment=function(e){return this._segmentInventory.completeSegment(e,this._buffered),Promise.resolve()},n.getBufferedRanges=function(){return this._buffered},n.dispose=function(){a.Z.debug("HTSB: Disposing HTMLTextSegmentBuffer"),this._disableCurrentCues(),this._buffer.remove(0,1/0),this._buffered.remove(0,1/0),this._canceller.cancel()},n.pushChunkSync=function(e){var t,n;a.Z.debug("HTSB: Appending new html text tracks");var r=e.data,i=r.timestampOffset,o=r.appendWindow,s=r.chunk;if(null!==s){var u,l,d=s.start,c=s.end,v=s.data,p=s.type,h=s.language,m=null!==(t=o[0])&&void 0!==t?t:0,g=null!==(n=o[1])&&void 0!==n?n:1/0,y=function(e,t,n,r){a.Z.debug("HTSB: Finding parser for html text tracks:",e);var i=f.Z.htmlTextTracksParsers[e];if("function"!=typeof i)throw new Error("no parser found for the given text track");a.Z.debug("HTSB: Parser found, parsing...");var o=i(t,n,r);return a.Z.debug("HTTB: Parsed successfully!",o.length),o}(p,v,i,h);if(0!==m&&g!==1/0){for(var _=0;_<y.length&&y[_].end<=m;)_++;for(y.splice(0,_),_=0;_<y.length&&y[_].start<m;)y[_].start=m,_++;for(_=y.length-1;_>=0&&y[_].start>=g;)_--;for(y.splice(_,y.length),_=y.length-1;_>=0&&y[_].end>g;)y[_].end=g,_--}if(void 0!==d)u=Math.max(m,d);else{if(y.length<=0)return void a.Z.warn("HTSB: Current text tracks have no cues nor start time. Aborting");a.Z.warn("HTSB: No start time given. Guessing from cues."),u=y[0].start}if(void 0!==c)l=Math.min(g,c);else{if(y.length<=0)return void a.Z.warn("HTSB: Current text tracks have no cues nor end time. Aborting");a.Z.warn("HTSB: No end time given. Guessing from cues."),l=y[y.length-1].end}l<=u?a.Z.warn("HTSB: Invalid text track appended: ","the start time is inferior or equal to the end time."):(null!==e.inventoryInfos&&this._segmentInventory.insertChunk(e.inventoryInfos),this._buffer.insert(y,u,l),this._buffered.insert(u,l))}},n.removeBufferSync=function(e,t){a.Z.debug("HTSB: Removing html text track data",e,t),this._buffer.remove(e,t),this._buffered.remove(e,t)},n._disableCurrentCues=function(){if(this._sizeUpdateCanceller.cancel(),this._currentCues.length>0){for(var e=0;e<this._currentCues.length;e++)E(this._textTrackElement,this._currentCues[e].element);this._currentCues=[]}},n._displayCues=function(e){if(!(this._currentCues.length===e.length&&this._currentCues.every((function(t,n){return t.element===e[n]})))){this._sizeUpdateCanceller.cancel();for(var t=0;t<this._currentCues.length;t++)E(this._textTrackElement,this._currentCues[t].element);this._currentCues=[];for(var n=0;n<e.length;n++){var r=e[n],i=T(r);this._currentCues.push({element:r,resolution:i}),this._textTrackElement.appendChild(r)}var d=this._currentCues.filter((function(e){return null!==e.resolution}));if(d.length>0){this._sizeUpdateCanceller=new l.ZP({cancelOn:this._canceller.signal});var c=u.Z.getCurrent().TEXT_TRACK_SIZE_CHECKS_INTERVAL,f=function(e,t,n){var r=e.getBoundingClientRect(),i=r.height,u=r.width,l=(0,o.ZP)({height:i,width:u}),d=i,c=u;if(void 0!==s){var f=new s((function(e){if(0!==e.length){var t=e[0].contentRect,n=t.height,r=t.width;n===d&&r===c||(d=n,c=r,l.setValue({height:n,width:r}))}else a.Z.error("Compat: Resized but no observed element.")}));f.observe(e),n.register((function(){f.disconnect()}))}else{var v=setInterval((function(){var t=e.getBoundingClientRect(),n=t.height,r=t.width;n===d&&r===c||(d=n,c=r,l.setValue({height:n,width:r}))}),t);n.register((function(){clearInterval(v)}))}return l}(this._textTrackElement,c,this._sizeUpdateCanceller.signal);f.onUpdate((function(e){for(var t=e.height,n=e.width,r=0;r<d.length;r++){var i=d[r];y(t,n,i.resolution,i.element)}}),{clearSignal:this._sizeUpdateCanceller.signal,emitCurrentValue:!0})}}},n.autoRefreshSubtitles=function(e){var t=this,n=null,r=u.Z.getCurrent().MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL,i=function(){a(),n=new l.ZP({cancelOn:e});var i=setInterval((function(){return t.refreshSubtitles()}),r);n.signal.register((function(){clearInterval(i)})),t.refreshSubtitles()};function a(){null!==n&&(n.cancel(),n=null)}S(this._videoElement,(function(){a(),t._disableCurrentCues()}),e),b(this._videoElement,i,e),_(this._videoElement,i,e),i()},n.refreshSubtitles=function(){var e,t=u.Z.getCurrent().MAXIMUM_HTML_TEXT_TRACK_UPDATE_INTERVAL;e=this._videoElement.paused||this._videoElement.playbackRate<=0?this._videoElement.currentTime:Math.max(this._videoElement.currentTime+t/1e3/2,0);var n=this._buffer.get(e);0===n.length?this._disableCurrentCues():this._displayCues(n)},t}(d.C)},9059:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(4578),i=n(3666);var a=n(3887);function o(e,t){if(i.vU&&function(e,t){var n=e.activeCues;if(null===n)return!1;for(var r=0;r<n.length;r++)if(n[r]===t)return!0;return!1}(e,t)){var n=e.mode;e.mode="hidden";try{e.removeCue(t)}catch(e){a.Z.warn("Compat: Could not remove cue from text track.")}e.mode=n}else try{e.removeCue(t)}catch(e){a.Z.warn("Compat: Could not remove cue from text track.")}}var s=n(9612),u=n(4309),l=n(7874);var d=function(e){function t(t){var n;a.Z.debug("NTSB: Creating NativeTextSegmentBuffer"),n=e.call(this)||this;var r=function(e){var t,n,r,a="subtitles";if(i.YM){var o=e.textTracks.length;(n=o>0?e.textTracks[o-1]:e.addTextTrack(a)).mode=null!==(t=n.SHOWING)&&void 0!==t?t:"showing"}else r=document.createElement("track"),e.appendChild(r),n=r.track,r.kind=a,n.mode="showing";return{track:n,trackElement:r}}(t),o=r.track,s=r.trackElement;return n.bufferType="text",n._buffered=new u.Z,n._videoElement=t,n._track=o,n._trackElement=s,n}(0,r.Z)(t,e);var n=t.prototype;return n.pushChunk=function(e){var t,n;if(a.Z.debug("NTSB: Appending new native text tracks"),null===e.data.chunk)return Promise.resolve();var r=e.data,i=r.timestampOffset,o=r.appendWindow,s=r.chunk,u=s.start,d=s.end,c=s.data,f=s.type,v=s.language,p=null!==(t=o[0])&&void 0!==t?t:0,h=null!==(n=o[1])&&void 0!==n?n:1/0;try{var m,g,y=function(e,t,n,r){a.Z.debug("NTSB: Finding parser for native text tracks:",e);var i=l.Z.nativeTextTracksParsers[e];if("function"!=typeof i)throw new Error("no parser found for the given text track");a.Z.debug("NTSB: Parser found, parsing...");var o=i(t,n,r);return a.Z.debug("NTSB: Parsed successfully!",o.length),o}(f,c,i,v);if(0!==p&&h!==1/0){for(var _=0;_<y.length&&y[_].endTime<=p;)_++;for(y.splice(0,_),_=0;_<y.length&&y[_].startTime<p;)y[_].startTime=p,_++;for(_=y.length-1;_>=0&&y[_].startTime>=h;)_--;for(y.splice(_,y.length),_=y.length-1;_>=0&&y[_].endTime>h;)y[_].endTime=h,_--}if(void 0!==u)m=Math.max(p,u);else{if(y.length<=0)return a.Z.warn("NTSB: Current text tracks have no cues nor start time. Aborting"),Promise.resolve();a.Z.warn("NTSB: No start time given. Guessing from cues."),m=y[0].startTime}if(void 0!==d)g=Math.min(h,d);else{if(y.length<=0)return a.Z.warn("NTSB: Current text tracks have no cues nor end time. Aborting"),Promise.resolve();a.Z.warn("NTSB: No end time given. Guessing from cues."),g=y[y.length-1].endTime}if(g<=m)return a.Z.warn("NTSB: Invalid text track appended: ","the start time is inferior or equal to the end time."),Promise.resolve();if(y.length>0){var b=y[0],S=this._track.cues;null!==S&&S.length>0&&b.startTime<S[S.length-1].startTime&&this._removeData(b.startTime,1/0);for(var E=0;E<y.length;E++)this._track.addCue(y[E])}this._buffered.insert(m,g),null!==e.inventoryInfos&&this._segmentInventory.insertChunk(e.inventoryInfos)}catch(e){return Promise.reject(e)}return Promise.resolve()},n.removeBuffer=function(e,t){return this._removeData(e,t),Promise.resolve()},n.endOfSegment=function(e){return this._segmentInventory.completeSegment(e,this._buffered),Promise.resolve()},n.getBufferedRanges=function(){return this._buffered},n.dispose=function(){a.Z.debug("NTSB: Aborting NativeTextSegmentBuffer"),this._removeData(0,1/0);var e=this._trackElement,t=this._videoElement;if(void 0!==e&&t.hasChildNodes())try{t.removeChild(e)}catch(e){a.Z.warn("NTSB: Can't remove track element from the video")}this._track.mode="disabled",void 0!==this._trackElement&&(this._trackElement.innerHTML="")},n._removeData=function(e,t){a.Z.debug("NTSB: Removing native text track data",e,t);var n=this._track,r=n.cues;if(null!==r)for(var i=r.length-1;i>=0;i--){var s=r[i],u=s.startTime,l=s.endTime;u>=e&&u<=t&&l<=t&&o(n,s)}this._buffered.remove(e,t)},t}(s.C)},9612:function(e,t,n){"use strict";n.d(t,{C:function(){return _},f:function(){return g}});var r=n(6872),i=n(3887),a=n(520),o=n(5278);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=function(){function e(e,t){this._history=[],this._lifetime=e,this._maxHistoryLength=t}var t=e.prototype;return t.addBufferedSegment=function(e,t){var n=performance.now();this._history.push({date:n,buffered:t,context:e}),this._cleanHistory(n)},t.getHistoryFor=function(e){return this._history.filter((function(t){return(0,a.z)(t.context,e)}))},t._cleanHistory=function(e){for(var t,n=e-this._lifetime,r=0,i=s(this._history);!(t=i()).done;){if(!(t.value.date<n))break;r++}if(r>0&&(this._history=this._history.splice(r)),this._history.length>this._maxHistoryLength){var a=this._history.length-this._maxHistoryLength;this._history=this._history.splice(a)}},e}();function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(){function e(){var e=r.Z.getCurrent(),t=e.BUFFERED_HISTORY_RETENTION_TIME,n=e.BUFFERED_HISTORY_MAXIMUM_ENTRIES;this._inventory=[],this._bufferedHistory=new l(t,n)}var t=e.prototype;return t.reset=function(){this._inventory.length=0},t.synchronizeBuffered=function(e){for(var t=this._inventory,n=0,a=t[0],s=r.Z.getCurrent().MINIMUM_SEGMENT_SIZE,u=null==a?void 0:a.infos.adaptation.type,l=e.length,c=0;c<l;c++){if(void 0===a)return;var f=e.start(c),v=e.end(c);if(v-f<s)i.Z.warn("SI: skipped TimeRange when synchronizing because it was too small",u,f,v);else{for(var p=n;void 0!==a&&(0,o.Z)(a.bufferedEnd,a.end)-f<s;)a=t[++n];var g=null,y=n-p;if(y>0){var _=t[p+y-1];g={end:(0,o.Z)(_.bufferedEnd,_.end),precizeEnd:_.precizeEnd},i.Z.debug("SI: "+y+" segments GCed.",u);for(var b,S=d(t.splice(p,y));!(b=S()).done;){var E=b.value;void 0===E.bufferedStart&&void 0===E.bufferedEnd&&this._bufferedHistory.addBufferedSegment(E.infos,null)}n=p}if(void 0===a)return;if(v-(0,o.Z)(a.bufferedStart,a.start)>=s){if(h(a,f,g,u),n===t.length-1)return void m(a,v,u);a=t[++n];for(var T=(0,o.Z)(a.bufferedStart,a.start),w=(0,o.Z)(a.bufferedEnd,a.end),k=c<l-1?e.start(c+1):void 0;void 0!==a&&v-T>=s&&(void 0===k||v-T>=w-k);){var A=t[n-1];void 0===A.bufferedEnd&&(A.bufferedEnd=a.precizeStart?a.start:A.end,i.Z.debug("SI: calculating buffered end of contiguous segment",u,A.bufferedEnd,A.end)),a.bufferedStart=A.bufferedEnd,void 0!==(a=t[++n])&&(T=(0,o.Z)(a.bufferedStart,a.start),w=(0,o.Z)(a.bufferedEnd,a.end))}}var I=t[n-1];void 0!==I&&m(I,v,u)}}if(null!=a){i.Z.debug("SI: last segments have been GCed",u,n,t.length);for(var R,x=d(t.splice(n,t.length-n));!(R=x()).done;){var Z=R.value;void 0===Z.bufferedStart&&void 0===Z.bufferedEnd&&this._bufferedHistory.addBufferedSegment(Z.infos,null)}}void 0!==u&&i.Z.hasLevel("DEBUG")&&i.Z.debug("SI: current "+u+" inventory timeline:\n"+function(e){var t=1/60,n={},r=[],i=null,a=null;function o(e){var t=String.fromCharCode(r.length+65);return r.push({letter:t,periodId:e.period.id,representationId:e.representation.id,bitrate:e.representation.bitrate}),t}for(var s="",u=0;u<e.length;u++){var l=e[u];if(void 0!==l.bufferedStart&&void 0!==l.bufferedEnd){var d,c=l.infos.period.id,f=l.infos.representation.id,v=n[c],p=void 0;if(void 0===v)p=o(l.infos),n[c]=((d={})[f]=p,d);else void 0===v[f]?(p=o(l.infos),v[f]=p):p=v[f];null===i?s+=l.bufferedStart.toFixed(2)+"|"+p+"|":a===p?i.bufferedEnd+t<l.bufferedStart&&(s+=i.bufferedEnd.toFixed(2)+" ~ "+l.bufferedStart.toFixed(2)+"|"+p+"|"):s+=i.bufferedEnd.toFixed(2)+" ~ "+l.bufferedStart.toFixed(2)+"|"+p+"|",i=l,a=p}}null!==i&&(s+=String(i.end.toFixed(2)));return r.forEach((function(e){var t;s+="\n["+e.letter+"] P: "+e.periodId+" || R: "+e.representationId+"("+(null!==(t=e.bitrate)&&void 0!==t?t:"unknown bitrate")+")"})),s}(this._inventory))},t.insertChunk=function(e){var t=e.period,n=e.adaptation,r=e.representation,a=e.segment,o=e.chunkSize,s=e.start,u=e.end;if(!a.isInit){var l=n.type;if(s>=u)i.Z.warn("SI: Invalid chunked inserted: starts before it ends",l,s,u);else{for(var d=this._inventory,c={partiallyPushed:!0,chunkSize:o,splitted:!1,start:s,end:u,precizeStart:!1,precizeEnd:!1,bufferedStart:void 0,bufferedEnd:void 0,infos:{segment:a,period:t,adaptation:n,representation:r}},f=d.length-1;f>=0;f--){var v=d[f];if(v.start<=s){if(v.end<=s){for(i.Z.debug("SI: Pushing segment strictly after previous one.",l,s,v.end),this._inventory.splice(f+1,0,c),f+=2;f<d.length&&d[f].start<c.end;){if(d[f].end>c.end)return i.Z.debug("SI: Segment pushed updates the start of the next one",l,c.end,d[f].start),d[f].start=c.end,d[f].bufferedStart=void 0,void(d[f].precizeStart=d[f].precizeStart&&c.precizeEnd);i.Z.debug("SI: Segment pushed removes the next one",l,s,u,d[f].start,d[f].end),d.splice(f,1)}return}if(v.start===s){if(v.end<=u){for(i.Z.debug("SI: Segment pushed replace another one",l,s,u,v.end),this._inventory.splice(f,1,c),f+=1;f<d.length&&d[f].start<c.end;){if(d[f].end>c.end)return i.Z.debug("SI: Segment pushed updates the start of the next one",l,c.end,d[f].start),d[f].start=c.end,d[f].bufferedStart=void 0,void(d[f].precizeStart=d[f].precizeStart&&c.precizeEnd);i.Z.debug("SI: Segment pushed removes the next one",l,s,u,d[f].start,d[f].end),d.splice(f,1)}return}return i.Z.debug("SI: Segment pushed ends before another with the same start",l,s,u,v.end),d.splice(f,0,c),v.start=c.end,v.bufferedStart=void 0,void(v.precizeStart=v.precizeStart&&c.precizeEnd)}if(v.end<=c.end){for(i.Z.debug("SI: Segment pushed updates end of previous one",l,s,u,v.start,v.end),this._inventory.splice(f+1,0,c),v.end=c.start,v.bufferedEnd=void 0,v.precizeEnd=v.precizeEnd&&c.precizeStart,f+=2;f<d.length&&d[f].start<c.end;){if(d[f].end>c.end)return i.Z.debug("SI: Segment pushed updates the start of the next one",l,c.end,d[f].start),d[f].start=c.end,d[f].bufferedStart=void 0,void(d[f].precizeStart=d[f].precizeStart&&c.precizeEnd);i.Z.debug("SI: Segment pushed removes the next one",l,s,u,d[f].start,d[f].end),d.splice(f,1)}return}i.Z.warn("SI: Segment pushed is contained in a previous one",l,s,u,v.start,v.end);var p={partiallyPushed:v.partiallyPushed,chunkSize:v.chunkSize,splitted:!0,start:c.end,end:v.end,precizeStart:v.precizeStart&&v.precizeEnd&&c.precizeEnd,precizeEnd:v.precizeEnd,bufferedStart:void 0,bufferedEnd:v.end,infos:v.infos};return v.end=c.start,v.splitted=!0,v.bufferedEnd=void 0,v.precizeEnd=v.precizeEnd&&c.precizeStart,d.splice(f+1,0,c),void d.splice(f+2,0,p)}}var h=this._inventory[0];if(void 0===h)return i.Z.debug("SI: first segment pushed",l,s,u),void this._inventory.push(c);if(!(h.start>=u)){if(h.end<=u){for(i.Z.debug("SI: Segment pushed starts before and completely recovers the previous first one",l,s,u,h.start,h.end),this._inventory.splice(0,1,c);d.length>1&&d[1].start<c.end;){if(d[1].end>c.end)return i.Z.debug("SI: Segment pushed updates the start of the next one",l,c.end,d[1].start),d[1].start=c.end,d[1].bufferedStart=void 0,void(d[1].precizeStart=c.precizeEnd);i.Z.debug("SI: Segment pushed removes the next one",l,s,u,d[1].start,d[1].end),d.splice(1,1)}return}return i.Z.debug("SI: Segment pushed start of the next one",l,s,u,h.start,h.end),h.start=u,h.bufferedStart=void 0,h.precizeStart=c.precizeEnd,void this._inventory.splice(0,0,c)}i.Z.debug("SI: Segment pushed comes before all previous ones",l,s,u,h.start),this._inventory.splice(0,0,c)}}},t.completeSegment=function(e,t){if(!e.segment.isInit){for(var n=this._inventory,r=[],o=0;o<n.length;o++)if((0,a.z)(n[o].infos,e)){var s=!1;r.length>0&&(s=!0,1===r.length&&(i.Z.warn("SI: Completed Segment is splitted.",e.segment.id,e.segment.time,e.segment.end),r[0].splitted=!0));var u=o,l=n[o].chunkSize;for(o+=1;o<n.length&&(0,a.z)(n[o].infos,e);){var c=n[o].chunkSize;void 0!==l&&void 0!==c&&(l+=c),o++}var f=o-1,v=f-u,p=n[f].end,h=n[f].bufferedEnd;v>0&&(this._inventory.splice(u+1,v),o-=v),this._inventory[u].partiallyPushed=!1,this._inventory[u].chunkSize=l,this._inventory[u].end=p,this._inventory[u].bufferedEnd=h,this._inventory[u].splitted=s,r.push(this._inventory[u])}if(0===r.length)i.Z.warn("SI: Completed Segment not found",e.segment.id,e.segment.time);else{this.synchronizeBuffered(t);for(var m,g=d(r);!(m=g()).done;){var y=m.value;void 0!==y.bufferedStart&&void 0!==y.bufferedEnd?this._bufferedHistory.addBufferedSegment(y.infos,{start:y.bufferedStart,end:y.bufferedEnd}):i.Z.debug("SI: buffered range not known after sync. Skipping history.",y.start,y.end)}}}},t.getInventory=function(){return this._inventory},t.getHistoryFor=function(e){return this._bufferedHistory.getHistoryFor(e)},e}();function v(e){if(void 0===e.bufferedStart||e.partiallyPushed)return!1;var t=e.start,n=e.end-t,i=r.Z.getCurrent(),a=i.MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE,o=i.MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE;return Math.abs(t-e.bufferedStart)<=a&&(void 0===e.bufferedEnd||e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-n)<=Math.min(o,n/3))}function p(e){if(void 0===e.bufferedEnd||e.partiallyPushed)return!1;var t=e.start,n=e.end,i=n-t,a=r.Z.getCurrent(),o=a.MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE,s=a.MAX_MANIFEST_BUFFERED_DURATION_DIFFERENCE;return Math.abs(n-e.bufferedEnd)<=o&&null!=e.bufferedStart&&e.bufferedEnd>e.bufferedStart&&Math.abs(e.bufferedEnd-e.bufferedStart-i)<=Math.min(s,i/3)}function h(e,t,n,a){var o=r.Z.getCurrent().MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE;void 0!==e.bufferedStart?(e.bufferedStart<t&&(i.Z.debug("SI: Segment partially GCed at the start",a,e.bufferedStart,t),e.bufferedStart=t),!e.precizeStart&&v(e)&&(e.start=e.bufferedStart,e.precizeStart=!0)):e.precizeStart?(i.Z.debug("SI: buffered start is precize start",a,e.start),e.bufferedStart=e.start):null!==n&&n.end>t&&(n.precizeEnd||e.start-n.end<=o)?(i.Z.debug("SI: buffered start is end of previous segment",a,t,e.start,n.end),e.bufferedStart=n.end,v(e)&&(e.start=n.end,e.precizeStart=!0)):e.start-t<=o?(i.Z.debug("SI: found true buffered start",a,t,e.start),e.bufferedStart=t,v(e)&&(e.start=t,e.precizeStart=!0)):t<e.start?i.Z.debug("SI: range start too far from expected start",a,t,e.start):(i.Z.debug("SI: Segment appears immediately garbage collected at the start",a,e.bufferedStart,t),e.bufferedStart=t)}function m(e,t,n){var a=r.Z.getCurrent().MAX_MANIFEST_BUFFERED_START_END_DIFFERENCE;void 0!==e.bufferedEnd?(e.bufferedEnd>t&&(i.Z.debug("SI: Segment partially GCed at the end",n,e.bufferedEnd,t),e.bufferedEnd=t),!e.precizeEnd&&t-e.end<=a&&p(e)&&(e.precizeEnd=!0,e.end=t)):e.precizeEnd?(i.Z.debug("SI: buffered end is precize end",n,e.end),e.bufferedEnd=e.end):t-e.end<=a?(i.Z.debug("SI: found true buffered end",n,t,e.end),e.bufferedEnd=t,p(e)&&(e.end=t,e.precizeEnd=!0)):t>e.end?(i.Z.debug("SI: range end too far from expected end",n,t,e.end),e.bufferedEnd=e.end):(i.Z.debug("SI: Segment appears immediately garbage collected at the end",n,e.bufferedEnd,t),e.bufferedEnd=t)}var g,y=f,_=function(){function e(){this._segmentInventory=new y}var t=e.prototype;return t.synchronizeInventory=function(){this._segmentInventory.synchronizeBuffered(this.getBufferedRanges())},t.getInventory=function(){return this._segmentInventory.getInventory()},t.getPendingOperations=function(){return[]},t.getSegmentHistory=function(e){return this._segmentInventory.getHistoryFor(e)},e}();!function(e){e[e.Push=0]="Push",e[e.Remove=1]="Remove",e[e.EndOfSegment=2]="EndOfSegment"}(g||(g={}))},4309:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(2829),i=function(){function e(){this._ranges=[],this.length=0}var t=e.prototype;return t.insert=function(e,t){(0,r.kR)(this._ranges,{start:e,end:t}),this.length=this._ranges.length},t.remove=function(e,t){var n=[];e>0&&n.push({start:0,end:e}),t<1/0&&n.push({start:t,end:1/0}),this._ranges=(0,r.tn)(this._ranges,n),this.length=this._ranges.length},t.start=function(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].start},t.end=function(e){if(e>=this._ranges.length)throw new Error("INDEX_SIZE_ERROR");return this._ranges[e].end},e}()},7839:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7326),i=n(4578),a=function(e){function t(n,i,a,o){var s;return s=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(s),t.prototype),s.name="CustomLoaderError",s.message=n,s.canRetry=i,s.isOfflineError=a,s.xhr=o,s}return(0,i.Z)(t,e),t}((0,n(2146).Z)(Error))},5157:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(7326),i=n(4578),a=n(2146),o=n(5992),s=n(7367),u=function(e){function t(n,i,a){var u;return u=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(u),t.prototype),u.name="EncryptedMediaError",u.type=o.ZB.ENCRYPTED_MEDIA_ERROR,u.code=n,u.message=(0,s.Z)(u.name,u.code,i),u.fatal=!1,"string"==typeof(null==a?void 0:a.keyStatuses)&&(u.keyStatuses=a.keyStatuses),u}return(0,i.Z)(t,e),t}((0,a.Z)(Error))},5992:function(e,t,n){"use strict";n.d(t,{SM:function(){return a},ZB:function(){return r},br:function(){return i}});var r={NETWORK_ERROR:"NETWORK_ERROR",MEDIA_ERROR:"MEDIA_ERROR",ENCRYPTED_MEDIA_ERROR:"ENCRYPTED_MEDIA_ERROR",OTHER_ERROR:"OTHER_ERROR"},i={TIMEOUT:"TIMEOUT",ERROR_EVENT:"ERROR_EVENT",ERROR_HTTP_CODE:"ERROR_HTTP_CODE",PARSE_ERROR:"PARSE_ERROR"},a={PIPELINE_LOAD_ERROR:"PIPELINE_LOAD_ERROR",PIPELINE_PARSE_ERROR:"PIPELINE_PARSE_ERROR",INTEGRITY_ERROR:"INTEGRITY_ERROR",MANIFEST_PARSE_ERROR:"MANIFEST_PARSE_ERROR",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"MANIFEST_INCOMPATIBLE_CODECS_ERROR",MANIFEST_UPDATE_ERROR:"MANIFEST_UPDATE_ERROR",MANIFEST_UNSUPPORTED_ADAPTATION_TYPE:"MANIFEST_UNSUPPORTED_ADAPTATION_TYPE",MEDIA_STARTING_TIME_NOT_FOUND:"MEDIA_STARTING_TIME_NOT_FOUND",MEDIA_TIME_BEFORE_MANIFEST:"MEDIA_TIME_BEFORE_MANIFEST",MEDIA_TIME_AFTER_MANIFEST:"MEDIA_TIME_AFTER_MANIFEST",MEDIA_TIME_NOT_FOUND:"MEDIA_TIME_NOT_FOUND",NO_PLAYABLE_REPRESENTATION:"NO_PLAYABLE_REPRESENTATION",MEDIA_IS_ENCRYPTED_ERROR:"MEDIA_IS_ENCRYPTED_ERROR",CREATE_MEDIA_KEYS_ERROR:"CREATE_MEDIA_KEYS_ERROR",KEY_ERROR:"KEY_ERROR",KEY_STATUS_CHANGE_ERROR:"KEY_STATUS_CHANGE_ERROR",KEY_UPDATE_ERROR:"KEY_UPDATE_ERROR",KEY_LOAD_ERROR:"KEY_LOAD_ERROR",KEY_LOAD_TIMEOUT:"KEY_LOAD_TIMEOUT",KEY_GENERATE_REQUEST_ERROR:"KEY_GENERATE_REQUEST_ERROR",INCOMPATIBLE_KEYSYSTEMS:"INCOMPATIBLE_KEYSYSTEMS",INVALID_ENCRYPTED_EVENT:"INVALID_ENCRYPTED_EVENT",INVALID_KEY_SYSTEM:"INVALID_KEY_SYSTEM",LICENSE_SERVER_CERTIFICATE_ERROR:"LICENSE_SERVER_CERTIFICATE_ERROR",MULTIPLE_SESSIONS_SAME_INIT_DATA:"MULTIPLE_SESSIONS_SAME_INIT_DATA",BUFFER_APPEND_ERROR:"BUFFER_APPEND_ERROR",BUFFER_FULL_ERROR:"BUFFER_FULL_ERROR",BUFFER_TYPE_UNKNOWN:"BUFFER_TYPE_UNKNOWN",MEDIA_ERR_BLOCKED_AUTOPLAY:"MEDIA_ERR_BLOCKED_AUTOPLAY",MEDIA_ERR_PLAY_NOT_ALLOWED:"MEDIA_ERR_PLAY_NOT_ALLOWED",MEDIA_ERR_NOT_LOADED_METADATA:"MEDIA_ERR_NOT_LOADED_METADATA",MEDIA_ERR_ABORTED:"MEDIA_ERR_ABORTED",MEDIA_ERR_NETWORK:"MEDIA_ERR_NETWORK",MEDIA_ERR_DECODE:"MEDIA_ERR_DECODE",MEDIA_ERR_SRC_NOT_SUPPORTED:"MEDIA_ERR_SRC_NOT_SUPPORTED",MEDIA_ERR_UNKNOWN:"MEDIA_ERR_UNKNOWN",MEDIA_SOURCE_NOT_SUPPORTED:"MEDIA_SOURCE_NOT_SUPPORTED",MEDIA_KEYS_NOT_SUPPORTED:"MEDIA_KEYS_NOT_SUPPORTED",DISCONTINUITY_ENCOUNTERED:"DISCONTINUITY_ENCOUNTERED",NONE:"NONE"}},7367:function(e,t,n){"use strict";function r(e,t,n){return e+" ("+t+") "+n}n.d(t,{Z:function(){return r}})},8750:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9822),i=n(5389);function a(e,t){var n=t.defaultCode,a=t.defaultReason;if((0,r.Z)(e))return e;var o=e instanceof Error?e.toString():a;return new i.Z(n,o)}},9822:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(5157),i=n(5992),a=n(3714),o=n(9362),s=n(5389);function u(e){return(e instanceof r.Z||e instanceof a.Z||e instanceof s.Z||e instanceof o.Z)&&Object.keys(i.ZB).indexOf(e.type)>=0}},3714:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(7326),i=n(4578),a=n(2146),o=n(5992),s=n(7367),u=function(e){function t(n,i){var a;return a=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(a),t.prototype),a.name="MediaError",a.type=o.ZB.MEDIA_ERROR,a.code=n,a.message=(0,s.Z)(a.name,a.code,i),a.fatal=!1,a}return(0,i.Z)(t,e),t}((0,a.Z)(Error))},9362:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(7326),i=n(4578),a=n(2146),o=n(5992),s=n(7367),u=function(e){function t(n,i){var a;return a=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(a),t.prototype),a.name="NetworkError",a.type=o.ZB.NETWORK_ERROR,a.url=i.url,a.status=i.status,a.errorType=i.type,a.code=n,a.message=(0,s.Z)(a.name,a.code,i.message),a.fatal=!1,a}return(0,i.Z)(t,e),t.prototype.isHttpError=function(e){return this.errorType===o.br.ERROR_HTTP_CODE&&this.status===e},t}((0,a.Z)(Error))},5389:function(e,t,n){"use strict";n.d(t,{Z:function(){return u}});var r=n(7326),i=n(4578),a=n(2146),o=n(5992),s=n(7367),u=function(e){function t(n,i){var a;return a=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(a),t.prototype),a.name="OtherError",a.type=o.ZB.OTHER_ERROR,a.code=n,a.message=(0,s.Z)(a.name,a.code,i),a.fatal=!1,a}return(0,i.Z)(t,e),t}((0,a.Z)(Error))},9105:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7326),i=n(4578),a=function(e){function t(n,i,a){var o;return o=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(o),t.prototype),o.name="RequestError",o.url=n,o.status=i,o.type=a,o.message=a,o}return(0,i.Z)(t,e),t}((0,n(2146).Z)(Error))},7273:function(e,t){"use strict";t.Z={dashParsers:{wasm:null,js:null},directfile:null,ContentDecryptor:null,htmlTextTracksBuffer:null,htmlTextTracksParsers:{},nativeTextTracksBuffer:null,nativeTextTracksParsers:{},transports:{}}},7874:function(e,t,n){"use strict";var r=n(7273);t.Z=r.Z},3887:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(8894),i=new(function(){function e(){this.error=r.Z,this.warn=r.Z,this.info=r.Z,this.debug=r.Z,this._levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},this._currentLevel="NONE"}var t=e.prototype;return t.setLevel=function(e){var t,n=this._levels[e];"number"==typeof n?(t=n,this._currentLevel=e):(t=0,this._currentLevel="NONE"),this.error=t>=this._levels.ERROR?console.error.bind(console):r.Z,this.warn=t>=this._levels.WARNING?console.warn.bind(console):r.Z,this.info=t>=this._levels.INFO?console.info.bind(console):r.Z,this.debug=t>=this._levels.DEBUG?console.log.bind(console):r.Z},t.getLevel=function(){return this._currentLevel},t.hasLevel=function(e){return this._levels[e]>=this._levels[this._currentLevel]},e}())},9665:function(e,t,n){"use strict";n.d(t,{r:function(){return f},Z:function(){return v}});var r=n(3274),i=n(1946),a=n(5288),o=n(3774);var s=n(3887),u=n(4791);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var c=function(){function e(e,t){var n;this.id=e.id,this.bitrate=e.bitrate,this.codec=e.codecs,void 0!==e.height&&(this.height=e.height),void 0!==e.width&&(this.width=e.width),void 0!==e.mimeType&&(this.mimeType=e.mimeType),void 0!==e.contentProtections&&(this.contentProtections=e.contentProtections),void 0!==e.frameRate&&(this.frameRate=e.frameRate),void 0!==e.hdrInfo&&(this.hdrInfo=e.hdrInfo),this.cdnMetadata=e.cdnMetadata,this.index=e.index,this.isSupported="audio"!==t.type&&"video"!==t.type||(n=this.getMimeTypeString(),null!=o.J&&("function"!=typeof o.J.isTypeSupported||o.J.isTypeSupported(n)))}var t=e.prototype;return t.getMimeTypeString=function(){var e,t;return(null!==(e=this.mimeType)&&void 0!==e?e:"")+';codecs="'+(null!==(t=this.codec)&&void 0!==t?t:"")+'"'},t.getEncryptionData=function(e){for(var t,n,r=this.getAllEncryptionData(),i=[],a=0;a<r.length;a++)for(var o=!1,s=r[a],u=0;u<s.values.length;u++)if(s.values[u].systemId.toLowerCase()===e.toLowerCase())if(o)i[i.length-1].values.push(s.values[u]);else{var l=null===(n=null===(t=this.contentProtections)||void 0===t?void 0:t.keyIds)||void 0===n?void 0:n.map((function(e){return e.keyId}));i.push({type:s.type,keyIds:l,values:[s.values[u]]}),o=!0}return i},t.getAllEncryptionData=function(){var e,t;if(void 0===this.contentProtections||0===this.contentProtections.initData.length)return[];var n=null===(t=null===(e=this.contentProtections)||void 0===e?void 0:e.keyIds)||void 0===t?void 0:t.map((function(e){return e.keyId}));return this.contentProtections.initData.map((function(e){return{type:e.type,keyIds:n,values:e.values}}))},t.addProtectionData=function(e,t,n){var r=!1;if(void 0===this.contentProtections)return this.contentProtections={keyIds:void 0!==t?[{keyId:t}]:[],initData:[{type:e,values:n}]},!0;if(void 0!==t){var i=this.contentProtections.keyIds;if(void 0===i)this.contentProtections.keyIds=[{keyId:t}];else{for(var a,o=!1,d=l(i);!(a=d()).done;){var c=a.value;(0,u.Z)(c.keyId,t)&&(o=!0)}o||(s.Z.warn("Manifest: found unanounced key id."),i.push({keyId:t}))}}for(var f=this.contentProtections.initData,v=0;v<f.length;v++)if(f[v].type===e){for(var p=f[v].values,h=0;h<n.length;h++){var m=n[h],g=void 0;for(g=0;g<p.length;g++)if(m.systemId===p[g].systemId){if((0,u.Z)(m.data,p[g].data))break;s.Z.warn("Manifest: different init data for the same system ID")}g===p.length&&(p.push(m),r=!0)}return r}return this.contentProtections.initData.push({type:e,values:n}),!0},t.isPlayable=function(){return this.isSupported&&!1!==this.decipherable},e}(),f=["audio","video","text"],v=function(){function e(t,n){void 0===n&&(n={});var r=t.trickModeTracks,o=n,s=o.representationFilter,u=o.isManuallyAdded;this.id=t.id,this.type=t.type,void 0!==t.isTrickModeTrack&&(this.isTrickModeTrack=t.isTrickModeTrack),void 0!==t.language&&(this.language=t.language,this.normalizedLanguage=(0,a.ZP)(t.language)),void 0!==t.closedCaption&&(this.isClosedCaption=t.closedCaption),void 0!==t.audioDescription&&(this.isAudioDescription=t.audioDescription),void 0!==t.isDub&&(this.isDub=t.isDub),void 0!==t.isSignInterpreted&&(this.isSignInterpreted=t.isSignInterpreted),void 0!==t.label&&(this.label=t.label),void 0!==r&&r.length>0&&(this.trickModeTracks=r.map((function(t){return new e(t)})));for(var l=t.representations,d=[],f=!1,v=0;v<l.length;v++){var p=new c(l[v],{type:this.type});((0,i.Z)(s)||s({id:p.id,bitrate:p.bitrate,codec:p.codec,height:p.height,width:p.width,frameRate:p.frameRate,hdrInfo:p.hdrInfo},{bufferType:this.type,language:this.language,normalizedLanguage:this.normalizedLanguage,isClosedCaption:this.isClosedCaption,isDub:this.isDub,isAudioDescription:this.isAudioDescription,isSignInterpreted:this.isSignInterpreted}))&&(d.push(p),!f&&p.isSupported&&(f=!0))}d.sort((function(e,t){return e.bitrate-t.bitrate})),this.representations=d,this.isSupported=f,this.manuallyAdded=!0===u}var t=e.prototype;return t.getPlayableRepresentations=function(){return this.representations.filter((function(e){return e.isPlayable()}))},t.getRepresentation=function(e){return(0,r.Z)(this.representations,(function(t){var n=t.id;return e===n}))},e}()},8619:function(e,t,n){"use strict";n.d(t,{ZP:function(){return b}});var r,i=n(4578),a=n(3274),o=n(1959),s=n(908),u=n(8806),l=n(3714),d=n(1679),c=n(9665),f=function(){function e(e,t){var n=this;if(this.contentWarnings=[],this.id=e.id,this.adaptations=Object.keys(e.adaptations).reduce((function(r,i){var a=e.adaptations[i];if(null==a)return r;var o=a.map((function(e){var r=new c.Z(e,{representationFilter:t});if(r.representations.length>0&&!r.isSupported){var i=new l.Z("MANIFEST_INCOMPATIBLE_CODECS_ERROR","An Adaptation contains only incompatible codecs.");n.contentWarnings.push(i)}return r})).filter((function(e){return e.representations.length>0}));if(o.every((function(e){return!e.isSupported}))&&a.length>0&&("video"===i||"audio"===i))throw new l.Z("MANIFEST_PARSE_ERROR","No supported "+i+" adaptations");return o.length>0&&(r[i]=o),r}),{}),!Array.isArray(this.adaptations.video)&&!Array.isArray(this.adaptations.audio))throw new l.Z("MANIFEST_PARSE_ERROR","No supported audio and video tracks.");this.duration=e.duration,this.start=e.start,null!=this.duration&&null!=this.start&&(this.end=this.start+this.duration),this.streamEvents=void 0===e.streamEvents?[]:e.streamEvents}var t=e.prototype;return t.getAdaptations=function(){var e=this.adaptations;return(0,d.Z)(e).reduce((function(e,t){return null!=t?e.concat(t):e}),[])},t.getAdaptationsForType=function(e){var t=this.adaptations[e];return null==t?[]:t},t.getAdaptation=function(e){return(0,a.Z)(this.getAdaptations(),(function(t){var n=t.id;return e===n}))},t.getSupportedAdaptations=function(e){if(void 0===e)return this.getAdaptations().filter((function(e){return e.isSupported}));var t=this.adaptations[e];return void 0===t?[]:t.filter((function(e){return e.isSupported}))},t.containsTime=function(e){return e>=this.start&&(void 0===this.end||e<this.end)},e}();!function(e){e[e.Full=0]="Full",e[e.Partial=1]="Partial"}(r||(r={}));var v=n(3887),p=n(5138);function h(e,t,n){e.start=t.start,e.end=t.end,e.duration=t.duration,e.streamEvents=t.streamEvents;for(var i=e.getAdaptations(),o=t.getAdaptations(),s=function(e){var t=i[e],s=(0,a.Z)(o,(function(e){return e.id===t.id}));if(void 0===s)v.Z.warn('Manifest: Adaptation "'+i[e].id+'" not found when merging.');else for(var u=i[e].representations,l=s.representations,d=function(e){var t=u[e],i=(0,a.Z)(l,(function(e){return e.id===t.id}));void 0===i?v.Z.warn('Manifest: Representation "'+u[e].id+'" not found when merging.'):(t.cdnMetadata=i.cdnMetadata,n===r.Full?t.index._replace(i.index):t.index._update(i.index))},c=0;c<u.length;c++)d(c)},u=0;u<i.length;u++)s(u)}function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=(0,s.Z)(),_=function(e){function t(t,n){var r,i;r=e.call(this)||this;var a=n.representationFilter,o=n.manifestUpdateUrl;return r.contentWarnings=[],r.id=y(),r.expired=null!==(i=t.expired)&&void 0!==i?i:null,r.transport=t.transportType,r.clockOffset=t.clockOffset,r.periods=t.periods.map((function(e){var t,n=new f(e,a);return(t=r.contentWarnings).push.apply(t,n.contentWarnings),n})).sort((function(e,t){return e.start-t.start})),r.adaptations=void 0===r.periods[0]?{}:r.periods[0].adaptations,r._timeBounds=t.timeBounds,r.isDynamic=t.isDynamic,r.isLive=t.isLive,r.isLastPeriodKnown=t.isLastPeriodKnown,r.uris=void 0===t.uris?[]:t.uris,r.updateUrl=o,r.lifetime=t.lifetime,r.suggestedPresentationDelay=t.suggestedPresentationDelay,r.availabilityStartTime=t.availabilityStartTime,r.publishTime=t.publishTime,r}(0,i.Z)(t,e);var n=t.prototype;return n.getPeriod=function(e){return(0,a.Z)(this.periods,(function(t){return e===t.id}))},n.getPeriodForTime=function(e){return(0,a.Z)(this.periods,(function(t){return e>=t.start&&(void 0===t.end||t.end>e)}))},n.getNextPeriod=function(e){return(0,a.Z)(this.periods,(function(t){return t.start>e}))},n.getPeriodAfter=function(e){var t=e.end;if(void 0===t)return null;var n=(0,a.Z)(this.periods,(function(e){return void 0===e.end||t<e.end}));return void 0===n?null:n},n.getUrl=function(){return this.uris[0]},n.replace=function(e){this._performUpdate(e,r.Full)},n.update=function(e){this._performUpdate(e,r.Partial)},n.getMinimumSafePosition=function(){var e,t,n=this._timeBounds;if(null===n.timeshiftDepth)return null!==(e=n.minimumSafePosition)&&void 0!==e?e:0;var r,i=n.maximumTimeData;if(n.maximumTimeData.isLinear){var a=performance.now()-i.time;r=i.maximumSafePosition+a/1e3}else r=i.maximumSafePosition;var o=r-n.timeshiftDepth;return Math.max(null!==(t=n.minimumSafePosition)&&void 0!==t?t:0,o)},n.getLivePosition=function(){var e=this._timeBounds.maximumTimeData;if(this.isLive&&void 0!==e.livePosition){if(!e.isLinear)return e.livePosition;var t=performance.now()-e.time;return e.livePosition+t/1e3}},n.getMaximumSafePosition=function(){var e=this._timeBounds.maximumTimeData;if(!e.isLinear)return e.maximumSafePosition;var t=performance.now()-e.time;return e.maximumSafePosition+t/1e3},n.updateRepresentationsDeciperability=function(e){var t=function(e,t){for(var n,r=[],i=m(e.periods);!(n=i()).done;)for(var a,o=n.value,s=m(o.getAdaptations());!(a=s()).done;)for(var u,l=a.value,d=m(l.representations);!(u=d()).done;){var c=u.value,f=t(c);f!==c.decipherable&&(r.push({manifest:e,period:o,adaptation:l,representation:c}),c.decipherable=f)}return r}(this,e);t.length>0&&this.trigger("decipherabilityUpdate",t)},n.getAdaptations=function(){(0,u.Z)("manifest.getAdaptations() is deprecated. Please use manifest.period[].getAdaptations() instead");var e=this.periods[0];if(void 0===e)return[];var t=e.adaptations,n=[];for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];n.push.apply(n,i)}return n},n.getAdaptationsForType=function(e){(0,u.Z)("manifest.getAdaptationsForType(type) is deprecated. Please use manifest.period[].getAdaptationsForType(type) instead");var t=this.periods[0];if(void 0===t)return[];var n=t.adaptations[e];return void 0===n?[]:n},n.getAdaptation=function(e){return(0,u.Z)("manifest.getAdaptation(id) is deprecated. Please use manifest.period[].getAdaptation(id) instead"),(0,a.Z)(this.getAdaptations(),(function(t){var n=t.id;return e===n}))},n._performUpdate=function(e,t){if(this.availabilityStartTime=e.availabilityStartTime,this.expired=e.expired,this.isDynamic=e.isDynamic,this.isLive=e.isLive,this.isLastPeriodKnown=e.isLastPeriodKnown,this.lifetime=e.lifetime,this.contentWarnings=e.contentWarnings,this.suggestedPresentationDelay=e.suggestedPresentationDelay,this.transport=e.transport,this.publishTime=e.publishTime,t===r.Full)this._timeBounds=e._timeBounds,this.uris=e.uris,function(e,t){for(var n=0,i=0;i<t.length;i++){for(var a=t[i],o=n,s=e[o];null!=s&&s.id!==a.id;)s=e[++o];if(null!=s){h(s,a,r.Full);var u=t.slice(n,i),l=o-n;e.splice.apply(e,[n,l].concat(u)),n=i+1}}if(n>e.length)v.Z.error("Manifest: error when updating Periods");else{n<e.length&&e.splice(n,e.length-n);var d=t.slice(n,t.length);d.length>0&&e.push.apply(e,d)}}(this.periods,e.periods);else{this._timeBounds.maximumTimeData=e._timeBounds.maximumTimeData,this.updateUrl=e.uris[0],function(e,t){if(0!==e.length){if(0!==t.length){var n=e[e.length-1];if(n.start<t[0].start){if(n.end!==t[0].start)throw new l.Z("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");e.push.apply(e,t)}else{var i=(0,p.Z)(e,(function(e){return e.id===t[0].id}));if(i<0)throw new l.Z("MANIFEST_UPDATE_ERROR","Cannot perform partial update: incoherent data");h(e[i],t[0],r.Partial);for(var a=i+1,o=1;o<t.length;o++){for(var s=t[o],u=-1,d=a;d<e.length;d++)if(s.id===e[d].id){u=d;break}if(u<0)return void e.splice.apply(e,[a,e.length-a].concat(t.slice(o,t.length)));u>a&&(e.splice(a,u-a),u=a),h(e[u],s,r.Full),a++}a<e.length&&e.splice(a,e.length-a)}}}else e.splice.apply(e,[0,0].concat(t))}(this.periods,e.periods);for(var n=this.getMinimumSafePosition();this.periods.length>0;){var i=this.periods[0];if(void 0===i.end||i.end>n)break;this.periods.shift()}}this.adaptations=void 0===this.periods[0]?{}:this.periods[0].adaptations,this.trigger("manifestUpdate",null)},t}(o.Z);var b=_},520:function(e,t,n){"use strict";n.d(t,{K:function(){return a},z:function(){return i}});var r=n(1946);function i(e,t){return e.segment.id===t.segment.id&&e.representation.id===t.representation.id&&e.adaptation.id===t.adaptation.id&&e.period.id===t.period.id}function a(e){if((0,r.Z)(e))return"";var t=e.period,n=e.adaptation,i=e.representation,a=e.segment;return n.type+" P: "+t.id+" A: "+n.id+" R: "+i.id+" S: "+(a.isInit?"init":a.complete?a.time+"-"+a.duration:""+a.time)}},2689:function(e,t,n){"use strict";n.d(t,{s:function(){return r}});var r=Math.pow(2,32)-1},2297:function(e,t,n){"use strict";n.d(t,{Qy:function(){return f},Xj:function(){return p},iz:function(){return c},lp:function(){return d},nR:function(){return v},t_:function(){return l},vA:function(){return u}});var r=n(3887),i=n(811),a=n(6968);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){for(var n,r=e,i=o(t);!(n=i()).done;){var a=l(r,n.value);if(null===a)return null;r=a}return r}function l(e,t){var n=f(e,t);return null!==n?e.subarray(n[1],n[2]):null}function d(e,t){for(var n=[],r=e;;){var a=f(r,t);if(null===a)return n;(0,i.Z)(0!==a[2]&&0!==r.length),n.push(r.subarray(a[1],a[2])),r=r.subarray(a[2])}}function c(e,t){var n=f(e,t);return null!==n?e.subarray(n[0],n[2]):null}function f(e,t){for(var n,r,i=e.length,o=0,s=0;o+8<=i;){if(r=o,s=(0,a.pX)(e,r),r+=4,n=(0,a.pX)(e,r),r+=4,0===s)s=i-o;else if(1===s){if(r+8>i)return null;s=(0,a.pV)(e,r),r+=8}if(s<0)throw new Error("ISOBMFF: Size out of range");if(n===t)return 1970628964===t&&(r+=16),[o,r,o+s];o+=s}return null}function v(e,t,n,r,i){for(var o,s=e.length,u=0;u<s;u+=o){var l=u;o=(0,a.pX)(e,l),l+=4;var d=(0,a.pX)(e,l);if(l+=4,0===o)o=s-u;else if(1===o){if(l+8>s)return;o=(0,a.pV)(e,l),l+=8}if(1970628964===d&&l+16<=s&&(0,a.pX)(e,l)===t&&(0,a.pX)(e,l+4)===n&&(0,a.pX)(e,l+8)===r&&(0,a.pX)(e,l+12)===i)return l+=16,e.subarray(l,u+o)}}function p(e){var t=e.length;if(t<8)return r.Z.warn("ISOBMFF: box inferior to 8 bytes, cannot find offsets"),null;var n=0,i=(0,a.pX)(e,n);n+=4;var o=(0,a.pX)(e,n);if(n+=4,0===i)i=t;else if(1===i){if(n+8>t)return r.Z.warn("ISOBMFF: box too short, cannot find offsets"),null;i=(0,a.pV)(e,n),n+=8}if(i<0)throw new Error("ISOBMFF: Size out of range");return 1970628964===o&&(n+=16),[0,n,i]}},6807:function(e,t,n){"use strict";n.d(t,{E3:function(){return u},Le:function(){return o},XA:function(){return i},fs:function(){return s},uq:function(){return a}});var r=n(2297);function i(e){var t=(0,r.t_)(e,1836019558);return null===t?null:(0,r.t_)(t,1953653094)}function a(e){return(0,r.lp)(e,1836019558).reduce((function(e,t){var n=(0,r.t_)(t,1953653094);return null!==n&&e.push(n),e}),[])}function o(e){return(0,r.t_)(e,1835295092)}function s(e){var t=(0,r.t_)(e,1836019574);if(null===t)return null;var n=(0,r.t_)(t,1953653099);return null===n?null:(0,r.t_)(n,1835297121)}function u(e,t){return void 0===t&&(t=0),(0,r.t_)(e.subarray(t),1701671783)}},6490:function(e,t,n){"use strict";n.d(t,{Z:function(){return s},Y:function(){return u}});var r=n(3887);var i="function"==typeof Uint8Array.prototype.slice?function(e,t,n){return e.slice(t,n)}:function(e,t,n){return new Uint8Array(Array.prototype.slice.call(e,t,n))},a=n(3635),o=n(2297);function s(e){var t=0,n=(0,o.t_)(e,1836019574);if(null===n)return[];for(var a=[];t<n.length;){var s=void 0;try{s=(0,o.Qy)(n,1886614376)}catch(e){var l=e instanceof Error?e:"";return r.Z.warn("Error while removing PSSH from ISOBMFF",l),a}if(null==s)return a;var d=i(n,s[0],s[2]),c=u(d,s[1]-s[0]);void 0!==c&&a.push({systemId:c,data:d}),n[s[0]+4]=102,n[s[0]+5]=114,n[s[0]+6]=101,n[s[0]+7]=101,t=s[2]}return a}function u(e,t){if(e[t]>1)r.Z.warn("ISOBMFF: un-handled PSSH version");else{var n=t+4;if(!(n+16>e.length)){var o=i(e,n,n+16);return(0,a.ci)(o)}}}},4644:function(e,t,n){"use strict";n.d(t,{J6:function(){return m},LD:function(){return h},MM:function(){return p},Qx:function(){return f},R0:function(){return y},Wf:function(){return c},s9:function(){return g}});var r=n(3887),i=n(6968),a=n(3635),o=n(2689),s=n(2297),u=n(6807);function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){var n=(0,s.Qy)(e,1936286840);if(null===n)return null;var r=t,a=n[2]-n[0],o=n[1],u=e[o];o+=8;var l,d=(0,i.pX)(e,o);if(o+=4,0===u)l=(0,i.pX)(e,o),o+=4,r+=(0,i.pX)(e,o)+a,o+=4;else{if(1!==u)return null;l=(0,i.pV)(e,o),o+=8,r+=(0,i.pV)(e,o)+a,o+=8}var c=[];o+=2;var f=(0,i.zK)(e,o);for(o+=2;--f>=0;){var v=(0,i.pX)(e,o);o+=4;var p=2147483647&v;if(1===(2147483648&v)>>>31)throw new Error("sidx with reference_type `1` not yet implemented");var h=(0,i.pX)(e,o);o+=4,o+=4,c.push({time:l,duration:h,timescale:d,range:[r,r+p-1]}),l+=h,r+=p}return c}function f(e){var t=(0,u.XA)(e);if(null!==t){var n=(0,s.t_)(t,1952867444);if(null!==n){var r=n[0];return 1===r?(0,i.pV)(n,4):0===r?(0,i.pX)(n,4):void 0}}}function v(e){var t=(0,s.t_)(e,1952868452);if(null!==t){var n=1,r=(0,i.QI)(t,n);if(n+=3,(8&r)>0)return n+=4,(1&r)>0&&(n+=8),(2&r)>0&&(n+=4),(0,i.pX)(t,n)}}function p(e){var t=(0,u.uq)(e);if(0!==t.length){for(var n,r=0,a=l(t);!(n=a()).done;){var o=n.value,d=(0,s.t_)(o,1953658222);if(null===d)return;var c=0,f=d[c];if(c+=1,f>1)return;var p=(0,i.QI)(d,c);c+=3;var h=(256&p)>0,m=0;if(!h&&void 0===(m=v(o)))return;var g=(1&p)>0,y=(4&p)>0,_=(512&p)>0,b=(1024&p)>0,S=(2048&p)>0,E=(0,i.pX)(d,c);c+=4,g&&(c+=4),y&&(c+=4);for(var T=E,w=0;T-- >0;)h?(w+=(0,i.pX)(d,c),c+=4):w+=m,_&&(c+=4),b&&(c+=4),S&&(c+=4);r+=w}return r}}function h(e){var t=(0,u.fs)(e);if(null!==t){var n=(0,s.t_)(t,1835296868);if(null!==n){var r=0,a=n[r];return r+=4,1===a?(0,i.pX)(n,r+16):0===a?(0,i.pX)(n,r+8):void 0}}}function m(e){var t=e.length;if(t<4)throw new Error("Cannot update box length: box too short");var n=(0,i.pX)(e,0);if(0===n){if(t>o.s){var r=new Uint8Array(t+8);return r.set((0,i.kh)(1),0),r.set(e.subarray(4,8),4),r.set((0,i.el)(t+8),8),r.set(e.subarray(8,t),16),r}return e.set((0,i.kh)(t),0),e}if(1===n){if(t<16)throw new Error("Cannot update box length: box too short");return e.set((0,i.el)(t),8),e}if(t<=o.s)return e.set((0,i.kh)(t),0),e;var a=new Uint8Array(t+8);return a.set((0,i.kh)(1),0),a.set(e.subarray(4,8),4),a.set((0,i.el)(t+8),8),a.set(e.subarray(8,t),16),a}function g(e){for(var t=[],n=0;n<e.length;){var o=(0,u.E3)(e,n);if(null===o)break;var s=o.length;n+=s;var l=o[0];if(0!==l)r.Z.warn("ISOBMFF: EMSG version "+l.toString()+" not supported.");else{var d=4,c=(0,a.DM)(o,d),f=c.end,v=c.string;d=f;var p=(0,a.DM)(o,d),h=p.end,m=p.string;d=h;var g=(0,i.pX)(o,d);d+=4;var y=(0,i.pX)(o,d);d+=4;var _=(0,i.pX)(o,d);d+=4;var b=(0,i.pX)(o,d);d+=4;var S={schemeIdUri:v,value:m,timescale:g,presentationTimeDelta:y,eventDuration:_,id:b,messageData:o.subarray(d,s)};t.push(S)}}if(0!==t.length)return t}function y(e){var t=(0,s.vA)(e,[1836019574,1953653099,1835297121,1835626086,1937007212,1937011556]);if(null===t)return null;var n=t.subarray(8),r=(0,s.t_)(n,1701733238),i=0;if(null===r?(i=28,r=(0,s.t_)(n,1701733217)):i=78,null===r)return null;var a=(0,s.vA)(r.subarray(i),[1936289382,1935894633,1952804451]);return null===a||a.byteLength<24?null:a.subarray(8,24)}},5904:function(e,t,n){"use strict";n.d(t,{Z:function(){return Xe}});var r=n(7904),i=n(1946),a=n(6872),o=n(3887),s=n(3274),u=n(9829);function l(e){var t=Date.parse(e)-performance.now();if(!isNaN(t))return t;o.Z.warn("DASH Parser: Invalid clock received: ",e)}function d(e){for(var t=e.representations,n=null,r=0;r<t.length;r++){var i=t[r].index.getLastAvailablePosition();if(void 0===i)return;null!==i&&(n=null==n?i:Math.min(n,i))}return null===n?null:n}function c(e){for(var t=e.representations,n=null,r=0;r<t.length;r++){var i=t[r].index.getFirstAvailablePosition();if(void 0===i)return;null!==i&&(n=null==n?i:Math.max(n,i))}return null===n?null:n}function f(e){if(0===e.length)throw new Error("DASH Parser: no period available for a dynamic content");var t=function(e){for(var t=0;t<=e.length-1;t++){var n=e[t].adaptations,r=void 0===n.audio?void 0:n.audio[0],i=void 0===n.video?void 0:n.video[0];if(void 0!==r||void 0!==i){var a=null,s=null;if(void 0!==r){var u=c(r);if(void 0===u)return;a=u}if(void 0!==i){var l=c(i);if(void 0===l)return;s=l}if(void 0!==r&&null===a||void 0!==i&&null===s)return void o.Z.info("Parser utils: found Period with no segment. ","Going to next one to calculate first position");if(null!==s)return null!==a?Math.max(a,s):s;if(null!==a)return a}}}(e),n=function(e){for(var t=e.length-1;t>=0;t--){var n=e[t].adaptations,r=void 0===n.audio?void 0:n.audio[0],i=void 0===n.video?void 0:n.video[0];if(void 0!==r||void 0!==i){var a=null,s=null;if(void 0!==r){var u=d(r);if(void 0===u)return{safe:void 0,unsafe:void 0};a=u}if(void 0!==i){var l=d(i);if(void 0===l)return{safe:void 0,unsafe:void 0};s=l}if(void 0!==r&&null===a||void 0!==i&&null===s)return o.Z.info("Parser utils: found Period with no segment. ","Going to previous one to calculate last position"),{safe:void 0,unsafe:void 0};if(null!==s)return null!==a?{safe:Math.min(a,s),unsafe:Math.max(a,s)}:{safe:s,unsafe:s};if(null!==a)return{safe:a,unsafe:a}}}return{safe:void 0,unsafe:void 0}}(e);return{minimumSafePosition:t,maximumSafePosition:n.safe,maximumUnsafePosition:n.unsafe}}var v=n(9592),p=n(908),h=n(1679),m=n(3635);var g=function(){function e(e){this._isDynamic=e.isDynamic,this._timeShiftBufferDepth=e.isDynamic&&void 0!==e.timeShiftBufferDepth?e.timeShiftBufferDepth:null}var t=e.prototype;return t.setLastPosition=function(e,t){this._lastPosition=e,this._positionTime=t},t.lastPositionIsKnown=function(){return this._isDynamic?null!=this._positionTime&&null!=this._lastPosition:null!=this._lastPosition},t.estimateMinimumBound=function(){if(!this._isDynamic||null===this._timeShiftBufferDepth)return 0;var e=this.estimateMaximumBound();return void 0!==e?e-this._timeShiftBufferDepth:void 0},t.estimateMaximumBound=function(){return this._isDynamic&&null!=this._positionTime&&null!=this._lastPosition?Math.max(this._lastPosition-this._positionTime+performance.now()/1e3,0):this._lastPosition},e}(),y=n(9665),_=n(5138),b=n(7714),S=n(6923);function E(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var w=function(e,t){for(var n,r=E(t);!(n=r()).done;)for(var i,a=n.value,o=a.adaptation,s=E(a.trickModeAttachedAdaptationIds);!(i=s()).done;)for(var u,l=i.value,d=E(y.r);!(u=d()).done;){var c=e[u.value];if(void 0!==c)for(var f,v=E(c);!(f=v()).done;){var p=f.value;p.id===l&&(void 0===p.trickModeTracks&&(p.trickModeTracks=[]),p.trickModeTracks.push(o))}}},k=["subtitle","caption"];function A(e,t,n,r){function i(e,t){var n=e.split("/")[0];return(0,b.Z)(y.r,n)?n:"application/ttml+xml"===e||"application/mp4"===e&&null!=t&&null!=(0,s.Z)(t,(function(e){return"urn:mpeg:dash:role:2011"===e.schemeIdUri&&(0,b.Z)(k,e.value)}))?"text":void 0}function a(e){switch(e.substring(0,3)){case"avc":case"hev":case"hvc":case"vp8":case"vp9":case"av1":return"video";case"vtt":return"text"}switch(e.substring(0,4)){case"mp4a":return"audio";case"wvtt":case"stpp":return"text"}}if(null!==t){var o=i(t,r);if(void 0!==o)return o}if(null!==n){var u=a(n);if(void 0!==u)return u}for(var l=0;l<e.length;l++){var d=e[l].attributes,c=d.mimeType,f=d.codecs;if(void 0!==c){var v=i(c,r);if(void 0!==v)return v}if(void 0!==f){var p=a(f);if(void 0!==p)return p}}}var I=n(8026);var R=n(3911);function x(e,t){var n,r=e.initialization,i={};return void 0!==t&&(i.isEMSGWhitelisted=t),{id:"init",isInit:!0,time:0,end:0,duration:0,timescale:1,range:null!=r?r.range:void 0,indexRange:e.indexRange,url:null!==(n=null==r?void 0:r.url)&&void 0!==n?n:null,complete:!0,privateInfos:i,timestampOffset:-e.indexTimeOffset/e.timescale}}function Z(e){return function(t,n,r){var i,a,o,s=(0,S.Z)(r)?parseInt(r,10):1;return i=String(e),a=s,(o=i.toString()).length>=a?o:(new Array(a+1).join("0")+o).slice(-a)}}function P(e,t,n){return function(e,t,n){return-1===e.indexOf("$")?e:e.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,String(t)).replace(/\$Bandwidth(\%0(\d+)d)?\$/g,Z(void 0===n?0:n))}(e,t,n)}function M(e,t){return function(n){return-1===n.indexOf("$")?n:n.replace(/\$\$/g,"$").replace(/\$Number(\%0(\d+)d)?\$/g,(function(e,n,r){if(void 0===t)throw new Error("Segment number not defined in a $Number$ scheme");return Z(t)(e,n,r)})).replace(/\$Time(\%0(\d+)d)?\$/g,(function(t,n,r){if(void 0===e)throw new Error("Segment time not defined in a $Time$ scheme");return Z(e)(t,n,r)}))}}function C(e,t,n,r,i){for(var a,o,s=(0,R.gT)(t,e),u=(0,R.gT)(t+n,e),l=e.timeline,d=e.timescale,c=e.segmentUrlTemplate,f=e.startNumber,v=null!=f?f:1,p=[],h=l.length,m=0;m<h;m++){for(var g=l[m],y=g.duration,_=g.start,b=g.range,S=(0,R.KF)(g,l[m+1],i),E=!1!==e.availabilityTimeComplete||m!==h-1&&0!==S,T=(a=y,o=void 0,(o=s-_)>0?Math.floor(o/a):0),w=_+T*y;w<u&&T<=S;){var k=v+T,A=null===c?null:M(w,k)(c),I=w-e.indexTimeOffset,x=y;I<0&&(x=y+I,I=0);var Z={id:String(w),time:I/d,end:(I+x)/d,duration:x/d,isInit:!1,range:b,timescale:1,url:A,number:k,timestampOffset:-e.indexTimeOffset/d,complete:E,privateInfos:{isEMSGWhitelisted:r}};p.push(Z),w=_+ ++T*y}if(w>=u)return p;v+=S+1}return p}function D(e,t){if(t.timescale!==e.timescale){var n=e.timescale;e.timeline.push({start:t.time/t.timescale*n,duration:t.duration/t.timescale*n,repeatCount:void 0===t.count?0:t.count,range:t.range})}else e.timeline.push({start:t.time,duration:t.duration,repeatCount:void 0===t.count?0:t.count,range:t.range});return!0}var O=function(){function e(e,t){var n,r,i,a=t.periodStart,o=t.periodEnd,s=t.representationId,u=t.representationBitrate,l=t.isEMSGWhitelisted,d=null!==(n=e.timescale)&&void 0!==n?n:1,c=(null!=e.presentationTimeOffset?e.presentationTimeOffset:0)-a*d,f=void 0===(null===(r=e.initialization)||void 0===r?void 0:r.media)?null:P(e.initialization.media,s,u),v=void 0===e.media?null:P(e.media,s,u),p=void 0!==e.initialization?e.initialization.range:void 0!==e.indexRange?[0,e.indexRange[0]-1]:void 0;this._index={indexRange:e.indexRange,indexTimeOffset:c,initialization:{url:f,range:p},segmentUrlTemplate:v,startNumber:e.startNumber,timeline:null!==(i=e.timeline)&&void 0!==i?i:[],timescale:d},this._scaledPeriodStart=(0,R.gT)(a,this._index),this._scaledPeriodEnd=null==o?void 0:(0,R.gT)(o,this._index),this._isInitialized=this._index.timeline.length>0,this._isEMSGWhitelisted=l}var t=e.prototype;return t.getInitSegment=function(){return x(this._index,this._isEMSGWhitelisted)},t.getSegments=function(e,t){return C(this._index,e,t,this._isEMSGWhitelisted,this._scaledPeriodEnd)},t.shouldRefresh=function(){return!1},t.getFirstAvailablePosition=function(){var e=this._index;return 0===e.timeline.length?null:(0,R.zG)(Math.max(this._scaledPeriodStart,e.timeline[0].start),e)},t.getLastAvailablePosition=function(){var e,t=this._index.timeline;if(0===t.length)return null;var n=t[t.length-1],r=Math.min((0,R.jH)(n,null,this._scaledPeriodEnd),null!==(e=this._scaledPeriodEnd)&&void 0!==e?e:1/0);return(0,R.zG)(r,this._index)},t.getEnd=function(){return this.getLastAvailablePosition()},t.awaitSegmentBetween=function(){return!1},t.isSegmentStillAvailable=function(){return!0},t.checkDiscontinuity=function(){return null},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){return!0},t.isInitialized=function(){return this._isInitialized},t.initialize=function(e){if(!this._isInitialized){for(var t=0;t<e.length;t++)D(this._index,e[t]);this._isInitialized=!0}},t.addPredictedSegments=function(){o.Z.warn("Cannot add predicted segments to a `BaseRepresentationIndex`")},t._replace=function(e){this._index=e._index,this._isInitialized=e._isInitialized,this._scaledPeriodEnd=e._scaledPeriodEnd,this._isEMSGWhitelisted=e._isEMSGWhitelisted},t._update=function(){o.Z.error("Base RepresentationIndex: Cannot update a SegmentList")},e}(),N=function(){function e(e,t){var n,r;if(void 0===e.duration)throw new Error("Invalid SegmentList: no duration");var i=t.periodStart,a=t.periodEnd,o=t.representationId,s=t.representationBitrate,u=t.isEMSGWhitelisted;this._isEMSGWhitelisted=u,this._periodStart=i,this._periodEnd=a;var l=null!=e.presentationTimeOffset?e.presentationTimeOffset:0,d=null!==(n=e.timescale)&&void 0!==n?n:1,c=l-i*d,f=void 0===(null===(r=e.initialization)||void 0===r?void 0:r.media)?null:P(e.initialization.media,o,s),v=e.list.map((function(e){return{url:void 0===e.media?null:P(e.media,o,s),mediaRange:e.mediaRange}}));this._index={list:v,timescale:d,duration:e.duration,indexTimeOffset:c,indexRange:e.indexRange,initialization:null==e.initialization?void 0:{url:f,range:e.initialization.range}}}var t=e.prototype;return t.getInitSegment=function(){var e=x(this._index);return void 0===e.privateInfos&&(e.privateInfos={}),e.privateInfos.isEMSGWhitelisted=this._isEMSGWhitelisted,e},t.getSegments=function(e,t){for(var n=this._index,r=n.duration,i=n.list,a=n.timescale,o=r/a,s=e-this._periodStart,u=(0,R.PZ)(s,t,a),l=u[0],d=u[1],c=Math.min(i.length-1,Math.floor(d/r)),f=[],v=Math.floor(l/r);v<=c;){var p=i[v].mediaRange,h=i[v].url,m=v*o+this._periodStart,g={id:String(v),time:m,isInit:!1,range:p,duration:o,timescale:1,end:m+o,url:h,timestampOffset:-n.indexTimeOffset/a,complete:!0,privateInfos:{isEMSGWhitelisted:this._isEMSGWhitelisted}};f.push(g),v++}return f},t.shouldRefresh=function(e,t){return!1},t.getFirstAvailablePosition=function(){return this._periodStart},t.getLastAvailablePosition=function(){var e,t=this._index,n=t.duration,r=t.list;return Math.min(r.length*n/t.timescale+this._periodStart,null!==(e=this._periodEnd)&&void 0!==e?e:1/0)},t.getEnd=function(){return this.getLastAvailablePosition()},t.awaitSegmentBetween=function(){return!1},t.isSegmentStillAvailable=function(){return!0},t.checkDiscontinuity=function(){return null},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){return!0},t.isInitialized=function(){return!0},t.initialize=function(){o.Z.error("A `ListRepresentationIndex` does not need to be initialized")},t.addPredictedSegments=function(){o.Z.warn("Cannot add predicted segments to a `ListRepresentationIndex`")},t._replace=function(e){this._index=e._index},t._update=function(){o.Z.error("A `ListRepresentationIndex` cannot be updated")},e}(),L=n(9362),U=n(811),B=n(8232),F=n(1091),z=n(5505);function V(e){return a.Z.getCurrent().DEFAULT_MAXIMUM_TIME_ROUNDING_ERROR*e}function K(e,t,n){var r=e.start,a=e.duration,s=e.repeatCount;return void 0===r&&(null===t?r=0:(0,i.Z)(t.duration)||(r=t.start+t.duration*(t.repeatCount+1))),void 0!==a&&!isNaN(a)||null===n||void 0===n.start||isNaN(n.start)||void 0===r||isNaN(r)||(a=n.start-r),void 0===r||isNaN(r)||void 0===a||isNaN(a)||void 0!==s&&isNaN(s)?(o.Z.warn('DASH: A "S" Element could not have been parsed.'),null):{start:r,duration:a,repeatCount:void 0===s?0:s}}function G(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"t":var i=parseInt(r.value,10);isNaN(i)?o.Z.warn('DASH: invalid t ("'+r.value+'")'):t.start=i;break;case"d":var a=parseInt(r.value,10);isNaN(a)?o.Z.warn('DASH: invalid d ("'+r.value+'")'):t.duration=a;break;case"r":var s=parseInt(r.value,10);isNaN(s)?o.Z.warn('DASH: invalid r ("'+r.value+'")'):t.repeatCount=s}}return t}function W(e){for(var t=[],n=0;n<e.length;n++)t.push(G(e[n]));for(var r=[],i=0;i<t.length;i++){var a=K(t[i],void 0===r[r.length-1]?null:r[r.length-1],void 0===t[i+1]?null:t[i+1]);null!==a&&r.push(a)}return r}function H(e,t){var n,r=function(e,t){if(0===e.length||0===t.length)return null;var n=e[0].start,r=t[0].getAttribute("t"),i=null===r?null:parseInt(r,10);if(null===i||Number.isNaN(i))return null;if(n===i)return{prevSegmentsIdx:0,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(n<i)for(var a=e[0],o=0;;){if(a.repeatCount>0){var s=i-a.start;if(s%a.duration==0&&s/a.duration<=a.repeatCount)return{repeatNumberInPrevSegments:s/a.duration,prevSegmentsIdx:o,newElementsIdx:0,repeatNumberInNewElements:0}}if(++o>=e.length)return null;if((a=e[o]).start===i)return{prevSegmentsIdx:o,newElementsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(a.start>i)return null}else for(var u=0,l=t[0],d=i;;){var c=l.getAttribute("d"),f=null===c?null:parseInt(c,10);if(null===f||Number.isNaN(f))return null;var v=l.getAttribute("r"),p=null===v?null:parseInt(v,10);if(null!==p){if(Number.isNaN(p)||p<0)return null;if(p>0){var h=n-d;if(h%f==0&&h/f<=p)return{repeatNumberInPrevSegments:0,repeatNumberInNewElements:h/f,prevSegmentsIdx:0,newElementsIdx:u}}d+=f*(p+1)}else d+=f;if(++u>=t.length)return null;var m=(l=t[u]).getAttribute("t"),g=null===m?null:parseInt(m,10);if(null!==g){if(Number.isNaN(g))return null;d=g}if(d===n)return{newElementsIdx:u,prevSegmentsIdx:0,repeatNumberInPrevSegments:0,repeatNumberInNewElements:0};if(d>i)return null}}(t,e);if(null===r)return o.Z.warn('DASH: Cannot perform "based" update. Common segment not found.'),W(e);var i=r.prevSegmentsIdx,a=r.newElementsIdx,s=r.repeatNumberInPrevSegments,u=r.repeatNumberInNewElements,l=t.length-i+a-1;if(l>=e.length)return o.Z.info('DASH: Cannot perform "based" update. New timeline too short'),W(e);var d=t.slice(i);if(s>0){var c=d[0];c.start+=c.duration*s,d[0].repeatCount-=s}if(u>0&&0!==a)return o.Z.info('DASH: Cannot perform "based" update. The new timeline has a different form.'),W(e);var f=d[d.length-1],v=G(e[l]),p=(null!==(n=v.repeatCount)&&void 0!==n?n:0)-u;if(v.duration!==f.duration||f.repeatCount>p)return o.Z.info('DASH: Cannot perform "based" update. The new timeline has a different form at the beginning.'),W(e);void 0!==v.repeatCount&&v.repeatCount>f.repeatCount&&(f.repeatCount=v.repeatCount);for(var h=[],m=[],g=l+1;g<e.length;g++)m.push(G(e[g]));for(var y=0;y<m.length;y++){var _=K(m[y],void 0===h[h.length-1]?f:h[h.length-1],void 0===m[y+1]?null:m[y+1]);null!==_&&h.push(_)}return d.concat(h)}var j=function(){function e(t,n){var r,i,a,o;if(!e.isTimelineIndexArgument(t))throw new Error("The given index is not compatible with a TimelineRepresentationIndex.");var s=n.availabilityTimeComplete,u=n.manifestBoundsCalculator,l=n.isDynamic,d=n.isLastPeriod,c=n.representationId,f=n.representationBitrate,v=n.periodStart,p=n.periodEnd,h=n.isEMSGWhitelisted,m=null!==(r=t.timescale)&&void 0!==r?r:1,g=(null!=t.presentationTimeOffset?t.presentationTimeOffset:0)-v*m;this._manifestBoundsCalculator=u,this._isEMSGWhitelisted=h,this._isLastPeriod=d,this._lastUpdate=null==n.receivedTime?performance.now():n.receivedTime,this._unsafelyBaseOnPreviousIndex=null,null!==n.unsafelyBaseOnPreviousRepresentation&&n.unsafelyBaseOnPreviousRepresentation.index instanceof e&&(n.unsafelyBaseOnPreviousRepresentation.index._unsafelyBaseOnPreviousIndex=null,this._unsafelyBaseOnPreviousIndex=n.unsafelyBaseOnPreviousRepresentation.index),this._isDynamic=l,this._parseTimeline=null!==(i=t.timelineParser)&&void 0!==i?i:null;var y=void 0===(null===(a=t.initialization)||void 0===a?void 0:a.media)?null:P(t.initialization.media,c,f),_=void 0===t.media?null:P(t.media,c,f);this._index={availabilityTimeComplete:s,indexRange:t.indexRange,indexTimeOffset:g,initialization:null==t.initialization?void 0:{url:y,range:t.initialization.range},segmentUrlTemplate:_,startNumber:t.startNumber,timeline:null!==(o=t.timeline)&&void 0!==o?o:null,timescale:m},this._scaledPeriodStart=(0,R.gT)(v,this._index),this._scaledPeriodEnd=void 0===p?void 0:(0,R.gT)(p,this._index)}var t=e.prototype;return t.getInitSegment=function(){return x(this._index,this._isEMSGWhitelisted)},t.getSegments=function(e,t){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var n=this._index;return C({segmentUrlTemplate:n.segmentUrlTemplate,startNumber:n.startNumber,timeline:n.timeline,timescale:n.timescale,indexTimeOffset:n.indexTimeOffset},e,t,this._isEMSGWhitelisted,this._scaledPeriodEnd)},t.shouldRefresh=function(){return!1},t.getFirstAvailablePosition=function(){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var e=this._index.timeline;return 0===e.length?null:(0,R.zG)(Math.max(this._scaledPeriodStart,e[0].start),this._index)},t.getLastAvailablePosition=function(){this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var t=e.getIndexEnd(this._index.timeline,this._scaledPeriodEnd);return null===t?null:(0,R.zG)(t,this._index)},t.getEnd=function(){if(!this._isDynamic||!this._isLastPeriod)return this.getLastAvailablePosition()},t.awaitSegmentBetween=function(e,t){var n;if((0,U.Z)(e<=t),!this._isDynamic||!this._isLastPeriod)return!1;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var r=this._index,i=r.timeline,a=V(r.timescale),o=(0,R.gT)(t,this._index);if(i.length>0){var s=i[i.length-1];if((0,R.jH)(s,null,this._scaledPeriodEnd)+a>=Math.min(o,null!==(n=this._scaledPeriodEnd)&&void 0!==n?n:1/0))return!1}return void 0===this._scaledPeriodEnd?o+a>this._scaledPeriodStart&&void 0:(0,R.gT)(e,this._index)-a<this._scaledPeriodEnd&&o+a>this._scaledPeriodStart},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;this._refreshTimeline(),null===this._index.timeline&&(this._index.timeline=this._getTimeline());var t=this._index,n=t.timeline,r=t.timescale,i=t.indexTimeOffset;return(0,F.Z)(e,n,r,i)},t.checkDiscontinuity=function(e){this._refreshTimeline();var t=this._index.timeline;return null===t&&(t=this._getTimeline(),this._index.timeline=t),(0,R._j)({timeline:t,timescale:this._index.timescale,indexTimeOffset:this._index.indexTimeOffset},e,this._scaledPeriodEnd)},t.canBeOutOfSyncError=function(e){return!!this._isDynamic&&(e instanceof L.Z&&e.isHttpError(404))},t._replace=function(e){this._parseTimeline=e._parseTimeline,this._index=e._index,this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate,this._manifestBoundsCalculator=e._manifestBoundsCalculator,this._isLastPeriod=e._isLastPeriod},t._update=function(e){null===this._index.timeline&&(this._index.timeline=this._getTimeline()),null===e._index.timeline&&(e._index.timeline=e._getTimeline()),(0,z.Z)(this._index.timeline,e._index.timeline)&&(this._index.startNumber=e._index.startNumber),this._isDynamic=e._isDynamic,this._scaledPeriodStart=e._scaledPeriodStart,this._scaledPeriodEnd=e._scaledPeriodEnd,this._lastUpdate=e._lastUpdate,this._isLastPeriod=e._isLastPeriod},t.isFinished=function(){if(!this._isDynamic||!this._isLastPeriod)return!0;null===this._index.timeline&&(this._index.timeline=this._getTimeline());var e=this._index.timeline;if(void 0===this._scaledPeriodEnd||0===e.length)return!1;var t=e[e.length-1];return(0,R.jH)(t,null,this._scaledPeriodEnd)+V(this._index.timescale)>=this._scaledPeriodEnd},t.isInitialized=function(){return!0},t.initialize=function(){o.Z.error("A `TimelineRepresentationIndex` does not need to be initialized")},t.addPredictedSegments=function(){o.Z.warn("Cannot add predicted segments to a `TimelineRepresentationIndex`")},e.isTimelineIndexArgument=function(e){return"function"==typeof e.timelineParser||Array.isArray(e.timeline)},t._refreshTimeline=function(){if(null===this._index.timeline&&(this._index.timeline=this._getTimeline()),this._isDynamic){var e=this._manifestBoundsCalculator.estimateMinimumBound();if(null!=e){var t=(0,R.gT)(e,this._index),n=(0,B.Z)(this._index.timeline,t);void 0!==this._index.startNumber&&(this._index.startNumber+=n)}}},e.getIndexEnd=function(e,t){return e.length<=0?null:Math.min((0,R.jH)(e[e.length-1],null,t),null!=t?t:1/0)},t._getTimeline=function(){if(null===this._parseTimeline)return null!==this._index.timeline?this._index.timeline:(o.Z.error("DASH: Timeline already lazily parsed."),[]);var e=this._parseTimeline();this._parseTimeline=null;var t,n=a.Z.getCurrent().MIN_DASH_S_ELEMENTS_TO_PARSE_UNSAFELY;return null===this._unsafelyBaseOnPreviousIndex||e.length<n?W(e):(null===this._unsafelyBaseOnPreviousIndex._index.timeline?(t=this._unsafelyBaseOnPreviousIndex._getTimeline(),this._unsafelyBaseOnPreviousIndex._index.timeline=t):t=this._unsafelyBaseOnPreviousIndex._index.timeline,this._unsafelyBaseOnPreviousIndex=null,H(e,t))},e}(),q=j,Y=function(){function e(e,t){var n,r,i=t.availabilityTimeOffset,a=t.manifestBoundsCalculator,o=t.isDynamic,s=t.periodEnd,u=t.periodStart,l=t.representationId,d=t.representationBitrate,c=t.isEMSGWhitelisted,f=null!==(n=e.timescale)&&void 0!==n?n:1;this._availabilityTimeOffset=i,this._manifestBoundsCalculator=a;var v=null!=e.presentationTimeOffset?e.presentationTimeOffset:0,p=v-u*f;if(void 0===e.duration)throw new Error("Invalid SegmentTemplate: no duration");var h=void 0===(null===(r=e.initialization)||void 0===r?void 0:r.media)?null:P(e.initialization.media,l,d),m=void 0===e.media?null:P(e.media,l,d);this._index={duration:e.duration,timescale:f,indexRange:e.indexRange,indexTimeOffset:p,initialization:null==e.initialization?void 0:{url:h,range:e.initialization.range},url:m,presentationTimeOffset:v,startNumber:e.startNumber},this._isDynamic=o,this._periodStart=u,this._scaledRelativePeriodEnd=void 0===s?void 0:(s-u)*f,this._isEMSGWhitelisted=c}var t=e.prototype;return t.getInitSegment=function(){return x(this._index,this._isEMSGWhitelisted)},t.getSegments=function(e,t){var n=this._index,r=n.duration,i=n.startNumber,a=n.timescale,o=n.url,s=this._periodStart*a,u=this._scaledRelativePeriodEnd,l=e*a-s,d=(e+t)*a-s,c=this._getFirstSegmentStart(),f=this._getLastSegmentStart();if(null==c||null==f)return[];var v=Math.max(c,l),p=Math.min(f,d);if(p+r<=v)return[];for(var h=[],m=null!=i?i:1,g=Math.floor(v/r),y=g*r;y<=p;y+=r){var _=g+m,b=null!=u&&y+r>u?u-y:r,S=y+s,E=y+this._index.presentationTimeOffset,T=null===o?null:M(E,_)(o),w={id:String(_),number:_,time:S/a,end:(S+b)/a,duration:b/a,timescale:1,isInit:!1,scaledDuration:b/a,url:T,timestampOffset:-n.indexTimeOffset/a,complete:!0,privateInfos:{isEMSGWhitelisted:this._isEMSGWhitelisted}};h.push(w),g++}return h},t.getFirstAvailablePosition=function(){var e=this._getFirstSegmentStart();return null==e?e:e/this._index.timescale+this._periodStart},t.getLastAvailablePosition=function(){var e,t=this._getLastSegmentStart();return null==t?t:Math.min(t+this._index.duration,null!==(e=this._scaledRelativePeriodEnd)&&void 0!==e?e:1/0)/this._index.timescale+this._periodStart},t.getEnd=function(){if(!this._isDynamic)return this.getLastAvailablePosition();if(void 0!==this._scaledRelativePeriodEnd){var e=this._index.timescale;return(this._scaledRelativePeriodEnd+this._periodStart*e)/this._index.timescale}},t.awaitSegmentBetween=function(e,t){if((0,U.Z)(e<=t),!this._isDynamic)return!1;var n=this._index.timescale,r=V(n),i=this._periodStart*n,a=t*n-i;return(void 0===this._scaledRelativePeriodEnd||e*n-i-r<this._scaledRelativePeriodEnd)&&a+r>=0},t.shouldRefresh=function(){return!1},t.checkDiscontinuity=function(){return null},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;var t=this.getSegments(e.time,.1);return 0!==t.length&&(t[0].time===e.time&&t[0].end===e.end&&t[0].number===e.number)},t.canBeOutOfSyncError=function(){return!1},t.isFinished=function(){if(!this._isDynamic)return!0;if(void 0===this._scaledRelativePeriodEnd)return!1;var e=this._index.timescale,t=this._getLastSegmentStart();return null!=t&&t+this._index.duration+V(e)>=this._scaledRelativePeriodEnd},t.isInitialized=function(){return!0},t.initialize=function(){o.Z.error("A `TemplateRepresentationIndex` does not need to be initialized")},t.addPredictedSegments=function(){o.Z.warn("Cannot add predicted segments to a `TemplateRepresentationIndex`")},t._replace=function(e){this._index=e._index,this._isDynamic=e._isDynamic,this._periodStart=e._periodStart,this._scaledRelativePeriodEnd=e._scaledRelativePeriodEnd,this._manifestBoundsCalculator=e._manifestBoundsCalculator},t._update=function(e){this._replace(e)},t._getFirstSegmentStart=function(){if(!this._isDynamic)return 0;if(0===this._scaledRelativePeriodEnd||void 0===this._scaledRelativePeriodEnd){var e=this._manifestBoundsCalculator.estimateMaximumBound();if(void 0!==e&&e<this._periodStart)return null}var t=this._index,n=t.duration,r=t.timescale,i=this._manifestBoundsCalculator.estimateMinimumBound();if(void 0!==i){var a=i>this._periodStart?(i-this._periodStart)*r:0;return Math.floor(a/n)*n}},t._getLastSegmentStart=function(){var e,t=this._index,n=t.duration,r=t.timescale;if(this._isDynamic){var i=this._manifestBoundsCalculator.estimateMaximumBound();if(void 0===i)return;if(void 0!==this._scaledRelativePeriodEnd&&this._scaledRelativePeriodEnd<(i-this._periodStart)*this._index.timescale)return this._scaledRelativePeriodEnd<n?null:(Math.floor(this._scaledRelativePeriodEnd/n)-1)*n;var o=(i-this._periodStart)*r;if(o<0)return null;var s=(void 0!==this._availabilityTimeOffset?this._availabilityTimeOffset:0)*r,u=Math.floor((o+s)/n);return u<=0?null:(u-1)*n}var l=null!==(e=this._scaledRelativePeriodEnd)&&void 0!==e?e:0,d=Math.ceil(l/n)-1,c=d*n;return l-c>a.Z.getCurrent().MINIMUM_SEGMENT_SIZE*r||0===d?c:(d-1)*n},e}();function X(e,t){var n;if(0===t.length)return e;var r=t.map((function(e){return{url:e.value}}));if(0===e.length)return r;for(var i=[],a=0;a<e.length;a++)for(var o=e[a],s=0;s<r.length;s++){var l=r[s],d=(0,u.Z)(o.url,l.url);i.push({url:d,serviceLocation:null!==(n=l.serviceLocation)&&void 0!==n?n:o.serviceLocation})}return i}function $(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Q(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function J(e){var t=e.adaptationProfiles,n=e.manifestProfiles,r=e.codecs;if(void 0!==r)return-1===((null!=t?t:"")+(null!=n?n:"")).indexOf("http://dashif.org/guidelines/dash-if-uhd#hevc-hdr-pq10")||"hvc1.2.4.L153.B0"!==r&&"hev1.2.4.L153.B0"!==r?/^vp(08|09|10)/.exec(r)?function(e){var t,n,r,i=e.split("."),a=i[0],o=(i[1],i[2],i[3]),s=(i[4],i[5]),u=i[6],l=i[7];if(("vp08"===a||"vp09"===a||"vp10"===a)&&((void 0!==o&&"10"===o||"12"===o)&&(t=parseInt(o,10)),void 0!==u&&("16"===u?n="pq":"18"===u&&(n="hlg")),void 0!==s&&void 0!==l&&"09"===s&&"09"===l&&(r="rec2020"),void 0!==t&&void 0!==n))return{colorDepth:t,eotf:n,colorSpace:r}}(r):void 0:{colorDepth:10,eotf:"pq",colorSpace:"rec2020"}}function ee(e,t,n){for(var r,i,a,u,l,d=[],c=function(){for(var e=l.value,c=null!=e.attributes.id?e.attributes.id:String(e.attributes.bitrate)+(null!=e.attributes.height?"-"+e.attributes.height:"")+(null!=e.attributes.width?"-"+e.attributes.width:"")+(null!=e.attributes.mimeType?"-"+e.attributes.mimeType:"")+(null!=e.attributes.codecs?"-"+e.attributes.codecs:"");d.some((function(e){return e.id===c}));)c+="-dup";var f=null!==(i=null===(r=n.unsafelyBaseOnPreviousAdaptation)||void 0===r?void 0:r.getRepresentation(c))&&void 0!==i?i:null,v=function(e,t){var n=[];if(void 0!==e.children.inbandEventStreams&&n.push.apply(n,e.children.inbandEventStreams),void 0!==t.children.inbandEventStreams&&n.push.apply(n,t.children.inbandEventStreams),0!==n.length)return n}(e,t),p=null!==(a=e.attributes.availabilityTimeComplete)&&void 0!==a?a:n.availabilityTimeComplete,h=(null!==(u=e.attributes.availabilityTimeOffset)&&void 0!==u?u:0)+n.availabilityTimeOffset,m=function(e,t){var n,r,i,a=t.availabilityTimeOffset,o=t.manifestBoundsCalculator,s=t.isDynamic,u=t.end,l=t.start,d=t.receivedTime,c=t.timeShiftBufferDepth,f=t.unsafelyBaseOnPreviousRepresentation,v=t.inbandEventStreams,p={availabilityTimeComplete:!0,availabilityTimeOffset:a,unsafelyBaseOnPreviousRepresentation:f,isEMSGWhitelisted:function(e){return void 0!==v&&v.some((function(t){return t.schemeIdUri===e.schemeIdUri}))},isLastPeriod:t.isLastPeriod,manifestBoundsCalculator:o,isDynamic:s,periodEnd:u,periodStart:l,receivedTime:d,representationBitrate:e.attributes.bitrate,representationId:e.attributes.id,timeShiftBufferDepth:c};if(void 0!==e.children.segmentBase){var h=e.children.segmentBase;i=new O(h,p)}else if(void 0!==e.children.segmentList){var m=e.children.segmentList;i=new N(m,p)}else if(void 0!==e.children.segmentTemplate||t.parentSegmentTemplates.length>0){var g=t.parentSegmentTemplates.slice(),y=e.children.segmentTemplate;void 0!==y&&g.push(y);var _=I.Z.apply(void 0,[{}].concat(g));p.availabilityTimeComplete=null!==(n=_.availabilityTimeComplete)&&void 0!==n?n:t.availabilityTimeComplete,p.availabilityTimeOffset=(null!==(r=_.availabilityTimeOffset)&&void 0!==r?r:0)+t.availabilityTimeOffset,i=q.isTimelineIndexArgument(_)?new q(_,p):new Y(_,p)}else{var b=t.adaptation.children;if(void 0!==b.segmentBase){var S=b.segmentBase;i=new O(S,p)}else if(void 0!==b.segmentList){var E=b.segmentList;i=new N(E,p)}else i=new Y({duration:Number.MAX_VALUE,timescale:1,startNumber:0,media:""},p)}return i}(e,(0,I.Z)({},n,{availabilityTimeOffset:h,availabilityTimeComplete:p,unsafelyBaseOnPreviousRepresentation:f,adaptation:t,inbandEventStreams:v})),g=void 0;null==e.attributes.bitrate?(o.Z.warn("DASH: No usable bitrate found in the Representation."),g=0):g=e.attributes.bitrate;var y={bitrate:g,cdnMetadata:X(n.baseURLs,e.children.baseURLs).map((function(e){return{baseUrl:e.url,id:e.serviceLocation}})),index:m,id:c},_=void 0;null!=e.attributes.codecs?_=e.attributes.codecs:null!=t.attributes.codecs&&(_=t.attributes.codecs),null!=_&&(_="mp4a.40.02"===_?"mp4a.40.2":_,y.codecs=_),null!=e.attributes.frameRate?y.frameRate=e.attributes.frameRate:null!=t.attributes.frameRate&&(y.frameRate=t.attributes.frameRate),null!=e.attributes.height?y.height=e.attributes.height:null!=t.attributes.height&&(y.height=t.attributes.height),null!=e.attributes.mimeType?y.mimeType=e.attributes.mimeType:null!=t.attributes.mimeType&&(y.mimeType=t.attributes.mimeType),null!=e.attributes.width?y.width=e.attributes.width:null!=t.attributes.width&&(y.width=t.attributes.width);var b=void 0!==t.children.contentProtections?t.children.contentProtections:[];if(void 0!==e.children.contentProtections&&b.push.apply(b,e.children.contentProtections),b.length>0){var S=b.reduce((function(e,t){var n;if(void 0!==t.attributes.schemeIdUri&&"urn:uuid:"===t.attributes.schemeIdUri.substring(0,9)&&(n=t.attributes.schemeIdUri.substring(9).replace(/-/g,"").toLowerCase()),void 0!==t.attributes.keyId&&t.attributes.keyId.length>0){var r={keyId:t.attributes.keyId,systemId:n};void 0===e.keyIds?e.keyIds=[r]:e.keyIds.push(r)}if(void 0!==n){for(var i,a=[],o=$(t.children.cencPssh);!(i=o()).done;){var u=i.value;a.push({systemId:n,data:u})}if(a.length>0){var l,d=(0,s.Z)(e.initData,(function(e){return"cenc"===e.type}));if(void 0===d)e.initData.push({type:"cenc",values:a});else(l=d.values).push.apply(l,a)}}return e}),{keyIds:void 0,initData:[]});(Object.keys(S.initData).length>0||void 0!==S.keyIds&&S.keyIds.length>0)&&(y.contentProtections=S)}y.hdrInfo=J({adaptationProfiles:t.attributes.profiles,manifestProfiles:n.manifestProfiles,codecs:_}),d.push(y)},f=$(e);!(l=f()).done;)c();return d}function te(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ne(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function re(e){if(void 0===e)return!1;var t="urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"1"===e.value,n="urn:mpeg:dash:role:2011"===e.schemeIdUri&&"description"===e.value;return t||n}function ie(e){return void 0!==e&&("urn:tva:metadata:cs:AudioPurposeCS:2007"===e.schemeIdUri&&"2"===e.value)}function ae(e){return void 0!==e&&("urn:mpeg:dash:role:2011"===e.schemeIdUri&&"sign"===e.value)}function oe(e,t){if((0,S.Z)(e.attributes.id))return e.attributes.id;var n=t.isClosedCaption,r=t.isAudioDescription,i=t.isSignInterpreted,a=t.isTrickModeTrack,o=t.type;return(0,S.Z)(e.attributes.language)&&(o+="-"+e.attributes.language),!0===n&&(o+="-cc"),!0===r&&(o+="-ad"),!0===i&&(o+="-si"),a&&(o+="-trickMode"),(0,S.Z)(e.attributes.contentType)&&(o+="-"+e.attributes.contentType),(0,S.Z)(e.attributes.codecs)&&(o+="-"+e.attributes.codecs),(0,S.Z)(e.attributes.mimeType)&&(o+="-"+e.attributes.mimeType),void 0!==e.attributes.frameRate&&(o+="-"+String(e.attributes.frameRate)),o}function se(e){if(null!=e.children.supplementalProperties)for(var t,n=te(e.children.supplementalProperties);!(t=n()).done;){var r=t.value;if("urn:mpeg:dash:adaptation-set-switching:2016"===r.schemeIdUri&&null!=r.value)return r.value.split(",").map((function(e){return e.trim()})).filter((function(e){return e}))}return[]}function ue(e,t){var n=t[1].priority-e[1].priority;return 0!==n?n:e[1].isMainAdaptation!==t[1].isMainAdaptation?e[1].isMainAdaptation?-1:1:e[1].indexInMpd-t[1].indexInMpd}function le(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ce=(0,p.Z)();function fe(e,t){var n,r,i,a,u,l,d=[],c=function(e,t){var n=[];return e.forEach((function(r,i){var a,o;if(null!=r.attributes.start)a=r.attributes.start;else if(0===i)a=t.isDynamic&&null!=t.availabilityStartTime?t.availabilityStartTime:0;else{var s=n[n.length-1];if(null==s||null==s.periodEnd)throw new Error("Missing start time when parsing periods.");a=s.periodEnd}var u=e[i+1];null!=r.attributes.duration?o=r.attributes.duration:i===e.length-1?o=t.duration:null!=u.attributes.start&&(o=u.attributes.start-a);var l=null!=o?a+o:void 0;n.push({periodStart:a,periodDuration:o,periodEnd:l})})),n}(e,t);if(c.length!==e.length)throw new Error("MPD parsing error: the time information are incoherent.");var f=t.isDynamic,p=t.timeShiftBufferDepth,E=new g({isDynamic:f,timeShiftBufferDepth:p});f||null==t.duration||E.setLastPosition(t.duration);for(var T=function(g){var T=g===e.length-1,k=e[g],I=t.xlinkInfos.get(k),R=X(t.baseURLs,k.children.baseURLs),x=c[g],Z=x.periodStart,P=x.periodDuration,M=x.periodEnd,C=void 0;for(null==k.attributes.id?(o.Z.warn("DASH: No usable id found in the Period. Generating one."),C="gen-dash-period-"+ce()):C=k.attributes.id;d.some((function(e){return e.id===C}));)C+="-dup";var D=void 0!==I?I.receivedTime:t.receivedTime,O=null!==(r=null===(n=t.unsafelyBaseOnPreviousManifest)||void 0===n?void 0:n.getPeriod(C))&&void 0!==r?r:null,N=null===(i=k.attributes.availabilityTimeComplete)||void 0===i||i,L=null!==(a=k.attributes.availabilityTimeOffset)&&void 0!==a?a:0,U=t.manifestProfiles,B=k.children.segmentTemplate,F={availabilityTimeComplete:N,availabilityTimeOffset:L,baseURLs:R,manifestBoundsCalculator:E,end:M,isDynamic:f,isLastPeriod:T,manifestProfiles:U,receivedTime:D,segmentTemplate:B,start:Z,timeShiftBufferDepth:p,unsafelyBaseOnPreviousPeriod:O},z=function(e,t){for(var n,r,i,a,u,l,d,c,f={video:[],audio:[],text:[]},v=[],p={},h=[],m=-1,g=0;g<e.length;g++){var E=e[g],T=E.children,k=T.essentialProperties,I=T.roles,R=T.label,x=Array.isArray(I)&&I.some((function(e){return"main"===e.value}))&&I.some((function(e){return"urn:mpeg:dash:role:2011"===e.schemeIdUri})),Z=E.children.representations,P=null!==(n=E.attributes.availabilityTimeComplete)&&void 0!==n?n:t.availabilityTimeComplete,M=(null!==(r=E.attributes.availabilityTimeOffset)&&void 0!==r?r:0)+t.availabilityTimeOffset,C=E.attributes.mimeType,D=E.attributes.codecs,O=A(Z,(0,S.Z)(C)?C:null,(0,S.Z)(D)?D:null,null!=T.roles?T.roles:null);if(void 0!==O){var N=null!==(i=E.attributes.selectionPriority)&&void 0!==i?i:1,L=E.attributes.id,U=void 0,B=se(E),F=[];void 0!==t.segmentTemplate&&F.push(t.segmentTemplate),void 0!==E.children.segmentTemplate&&F.push(E.children.segmentTemplate);var z={availabilityTimeComplete:P,availabilityTimeOffset:M,baseURLs:X(t.baseURLs,T.baseURLs),manifestBoundsCalculator:t.manifestBoundsCalculator,end:t.end,isDynamic:t.isDynamic,isLastPeriod:t.isLastPeriod,manifestProfiles:t.manifestProfiles,parentSegmentTemplates:F,receivedTime:t.receivedTime,start:t.start,timeShiftBufferDepth:t.timeShiftBufferDepth,unsafelyBaseOnPreviousAdaptation:null},V=Array.isArray(k)?(0,s.Z)(k,(function(e){return"http://dashif.org/guidelines/trickmode"===e.schemeIdUri})):void 0,K=null===(a=null==V?void 0:V.value)||void 0===a?void 0:a.split(" "),G=void 0!==K;if("video"===O&&x&&m>=0&&f.video.length>m&&!G){var W,H=f.video[m][0];z.unsafelyBaseOnPreviousAdaptation=null!==(l=null===(u=t.unsafelyBaseOnPreviousPeriod)||void 0===u?void 0:u.getAdaptation(H.id))&&void 0!==l?l:null;var j=ee(Z,E,z);(W=H.representations).push.apply(W,j),U=H.id}else{var q=T.accessibilities,Y=void 0;void 0!==I&&I.some((function(e){return"dub"===e.value}))&&(Y=!0);var $=void 0;"text"!==O?$=!1:void 0!==q&&($=q.some(ie));var Q=void 0;"audio"!==O?Q=!1:void 0!==q&&(Q=q.some(re));var J=void 0;"video"!==O?J=!1:void 0!==q&&(J=q.some(ae));for(var ne=oe(E,{isAudioDescription:Q,isClosedCaption:$,isSignInterpreted:J,isTrickModeTrack:G,type:O});(0,b.Z)(h,ne);)ne+="-dup";U=ne,h.push(ne),z.unsafelyBaseOnPreviousAdaptation=null!==(c=null===(d=t.unsafelyBaseOnPreviousPeriod)||void 0===d?void 0:d.getAdaptation(ne))&&void 0!==c?c:null;var le={id:ne,representations:ee(Z,E,z),type:O,isTrickModeTrack:G};if(null!=E.attributes.language&&(le.language=E.attributes.language),null!=$&&(le.closedCaption=$),null!=Q&&(le.audioDescription=Q),!0===Y&&(le.isDub=!0),!0===J&&(le.isSignInterpreted=!0),void 0!==R&&(le.label=R),void 0!==K)v.push({adaptation:le,trickModeAttachedAdaptationIds:K});else{for(var de,ce=-1,fe=function(){var e=de.value,t=p[e];if(void 0!==t&&t.newID!==U&&(0,b.Z)(t.adaptationSetSwitchingIDs,L)){ce=(0,_.Z)(f[O],(function(t){return t[0].id===e}));var n,r=f[O][ce];void 0!==r&&r[0].audioDescription===le.audioDescription&&r[0].closedCaption===le.closedCaption&&r[0].language===le.language&&(o.Z.info('DASH Parser: merging "switchable" AdaptationSets',L,e),(n=r[0].representations).push.apply(n,le.representations),"video"===O&&x&&!r[1].isMainAdaptation&&(m=Math.max(m,ce)),r[1]={priority:Math.max(N,r[1].priority),isMainAdaptation:x||r[1].isMainAdaptation,indexInMpd:Math.min(g,r[1].indexInMpd)})}},ve=te(B);!(de=ve()).done;)fe();ce<0&&(f[O].push([le,{priority:N,isMainAdaptation:x,indexInMpd:g}]),"video"===O&&x&&(m=f.video.length-1))}}null!=L&&null==p[L]&&(p[L]={newID:U,adaptationSetSwitchingIDs:B})}}var pe=y.r.reduce((function(e,t){var n=f[t];return n.length>0&&(n.sort(ue),e[t]=n.map((function(e){return e[0]}))),e}),{});return f.video.sort(ue),w(pe,v),pe}(k.children.adaptations,F),V=(null!==(u=t.xmlNamespaces)&&void 0!==u?u:[]).concat(null!==(l=k.attributes.namespaces)&&void 0!==l?l:[]),K=function(e,t,n){for(var r,i,a,o=[],s=le(e);!(a=s()).done;)for(var u,l=a.value,d=l.attributes,c=d.schemeIdUri,f=void 0===c?"":c,v=d.timescale,p=void 0===v?1:v,h=n.concat(null!==(r=l.attributes.namespaces)&&void 0!==r?r:[]),g=le(l.children.events);!(u=g()).done;){var y=u.value;if(void 0!==y.eventStreamData){var _=(null!==(i=y.presentationTime)&&void 0!==i?i:0)/p+t,b=void 0===y.duration?void 0:_+y.duration/p,S=void 0;if(y.eventStreamData instanceof Element)S=y.eventStreamData;else{var E=h.reduce((function(e,t){return e+"xmlns:"+t.key+'="'+t.value+'" '}),"<toremove ");E+=">";var T=(0,m.uR)(new Uint8Array(y.eventStreamData));S=(new DOMParser).parseFromString(E+T+"</toremove>","application/xml").documentElement.childNodes[0]}o.push({start:_,end:b,id:y.id,data:{type:"dash-event-stream",value:{schemeIdUri:f,timescale:p,element:S}}})}}return o}(k.children.eventStreams,Z,V),G={id:C,start:Z,end:M,duration:P,adaptations:z,streamEvents:K};if(d.unshift(G),!E.lastPositionIsKnown()){var W=function(e){for(var t,n=null,r=!0,i=(0,h.Z)(e).filter((function(e){return null!=e})),a=le((0,v.Z)(i,(function(e){return e})));!(t=a()).done;)for(var o,s=le(t.value.representations);!(o=s()).done;){var u=o.value.index.getLastAvailablePosition();null!==u&&(r=!1,"number"==typeof u&&(n=null==n?u:Math.max(n,u)))}if(null!=n)return n;if(r)return null;return}(z);if(f)if("number"==typeof W){var H=performance.now()/1e3;E.setLastPosition(W,H)}else{var j=ve(t,Z);if(void 0!==j){var q=j[0],Y=j[1];E.setLastPosition(q,Y)}}else"number"==typeof W&&E.setLastPosition(W)}},k=e.length-1;k>=0;k--)T(k);if(t.isDynamic&&!E.lastPositionIsKnown()){var I=ve(t,0);if(void 0!==I){var R=I[0],x=I[1];E.setLastPosition(R,x)}}return function(e){if(0===e.length)return[];for(var t=[e[0]],n=1;n<e.length;n++){for(var r=e[n],i=t[t.length-1];(void 0===i.duration||i.start+i.duration>r.start)&&(o.Z.warn("DASH: Updating overlapping Periods.",null==i?void 0:i.start,r.start),i.duration=r.start-i.start,i.end=r.start,!(i.duration>0));)t.pop(),i=t[t.length-1];t.push(r)}return t}(d)}function ve(e,t){if(null!=e.clockOffset){var n=e.clockOffset/1e3-e.availabilityStartTime,r=performance.now()/1e3,i=r+n;if(i>=t)return[i,r]}else{var a=Date.now()/1e3;if(a>=t)return o.Z.warn("DASH Parser: no clock synchronization mechanism found. Using the system clock instead."),[a-e.availabilityStartTime,performance.now()/1e3]}}function pe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var me=function e(t,n,r,i,d){void 0===d&&(d=new WeakMap);var c=t.children,v=t.attributes;if(null==n.externalClockOffset){var p="dynamic"===v.type,h=(0,s.Z)(c.utcTimings,(function(e){return"urn:mpeg:dash:utc:direct:2014"===e.schemeIdUri&&null!=e.value})),m=null!=h&&null!=h.value?l(h.value):void 0,g=null==m||isNaN(m)?void 0:m;if(null!=g&&!0!==i)n.externalClockOffset=g;else if(p&&!0!==i){var y=function(e){var t=e.children.utcTimings.filter((function(e){return("urn:mpeg:dash:utc:http-iso:2014"===e.schemeIdUri||"urn:mpeg:dash:utc:http-xsdate:2014"===e.schemeIdUri)&&void 0!==e.value}));return t.length>0?t[0].value:void 0}(t);if(null!=y&&y.length>0)return{type:"needs-clock",value:{url:y,continue:function(i){return i.success?(n.externalClockOffset=l(i.data),e(t,n,r,!0)):(r.push(i.error),o.Z.warn("DASH Parser: Error on fetching the clock ressource",i.error),e(t,n,r,!0))}}}}}for(var _=[],b=0;b<c.periods.length;b++){var S=c.periods[b].attributes,E=S.xlinkHref,T=S.xlinkActuate;null!=E&&"onLoad"===T&&_.push({index:b,ressource:E})}return 0===_.length?function(e,t,n,r){var i,s,l,d,c,v,p=e.children,h=e.attributes,m="dynamic"===h.type,g=X(void 0!==t.url?[{url:t.url.substring(0,(0,u.$)(t.url))}]:[],p.baseURLs),y=function(e,t){return"dynamic"!==e.type?0:null==e.availabilityStartTime?null==t?0:t:e.availabilityStartTime}(h,t.referenceDateTime),_=h.timeShiftBufferDepth,b=t.externalClockOffset,S=t.unsafelyBaseOnPreviousManifest,E={availabilityStartTime:y,baseURLs:g,clockOffset:b,duration:h.duration,isDynamic:m,manifestProfiles:e.attributes.profiles,receivedTime:t.manifestReceivedTime,timeShiftBufferDepth:_,unsafelyBaseOnPreviousManifest:S,xlinkInfos:r,xmlNamespaces:e.attributes.namespaces},T=fe(p.periods,E),w=h.duration,k=null;void 0!==h.minimumUpdatePeriod&&h.minimumUpdatePeriod>=0&&(d=0===h.minimumUpdatePeriod?a.Z.getCurrent().DASH_FALLBACK_LIFETIME_WHEN_MINIMUM_UPDATE_PERIOD_EQUAL_0:h.minimumUpdatePeriod);var A=f(T),I=A.minimumSafePosition,R=A.maximumSafePosition,x=A.maximumUnsafePosition,Z=performance.now();if(m){var P,M;if(c=I,k=null!=_?_:null,void 0!==x&&(M=x),void 0!==R)P=R;else{var C=null!=y?y:0,D=t.externalClockOffset;if(void 0===D)o.Z.warn("DASH Parser: use system clock to define maximum position"),P=Date.now()/1e3-C;else P=(performance.now()+D)/1e3-C}void 0===M&&(M=P),v={isLinear:!0,maximumSafePosition:P,livePosition:M,time:Z},null!==k&&void 0!==c&&P-c>k&&(k=P-c)}else{c=void 0!==I?I:void 0!==(null===(i=T[0])||void 0===i?void 0:i.start)?T[0].start:0;var O=null!=w?w:1/0;if(void 0!==T[T.length-1]){var N=T[T.length-1],L=null!==(s=N.end)&&void 0!==s?s:void 0!==N.duration?N.start+N.duration:void 0;void 0!==L&&L<O&&(O=L)}void 0!==R&&R<O&&(O=R),v={isLinear:!1,maximumSafePosition:O,livePosition:void 0,time:Z}}var U=!m||void 0===e.attributes.minimumUpdatePeriod&&(void 0!==(null===(l=T[T.length-1])||void 0===l?void 0:l.end)||void 0!==e.attributes.duration);return{type:"done",value:{parsed:{availabilityStartTime:y,clockOffset:t.externalClockOffset,isDynamic:m,isLive:m,isLastPeriodKnown:U,periods:T,publishTime:h.publishTime,suggestedPresentationDelay:h.suggestedPresentationDelay,transportType:"dash",timeBounds:{minimumSafePosition:c,timeshiftDepth:k,maximumTimeData:v},lifetime:d,uris:null==t.url?p.locations:[t.url].concat(p.locations)},warnings:n}}}(t,n,r,d):{type:"needs-xlinks",value:{xlinksUrls:_.map((function(e){return e.ressource})),continue:function(a){if(a.length!==_.length)throw new Error("DASH parser: wrong number of loaded ressources.");for(var o=a.length-1;o>=0;o--){var s,u=_[o].index,l=a[o],f=l.parsed,v=l.warnings,p=l.receivedTime,h=l.sendingTime,m=l.url;v.length>0&&r.push.apply(r,v);for(var g,y=pe(f);!(g=y()).done;){var b=g.value;d.set(b,{receivedTime:p,sendingTime:h,url:m})}(s=c.periods).splice.apply(s,[u,1].concat(f))}return e(t,n,r,i,d)}}}};function ge(e){var t=e.textContent,n=[];return null===t||0===t.length?[void 0,n]:[{value:t},n]}function ye(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"id":t.id=r.value;break;case"lang":t.language=r.value;break;case"contentType":t.contentType=r.value;break;case"par":t.par=r.value}}return t}var _e=n(7326),be=n(4578),Se=n(2146),Ee=n(9689),Te=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,we=/([0-9]+)-([0-9]+)/;function ke(e,t){return"true"===e?[!0,null]:"false"===e?[!1,null]:[!1,new Ne("`"+t+'` property is not a boolean value but "'+e+'"')]}function Ae(e,t){var n=parseInt(e,10);return isNaN(n)?[null,new Ne("`"+t+'` property is not an integer value but "'+e+'"')]:[n,null]}function Ie(e,t){if("INF"===e)return[1/0,null];var n=parseFloat(e);return isNaN(n)?[null,new Ne("`"+t+'` property is invalid: "'+e+'"')]:[n,null]}function Re(e,t){if("true"===e)return[!0,null];if("false"===e)return[!1,null];var n=parseInt(e,10);return isNaN(n)?[null,new Ne("`"+t+'` property is not a boolean nor an integer but "'+e+'"')]:[n,null]}function xe(e,t){var n=Date.parse(e);return isNaN(n)?[null,new Ne("`"+t+'` is in an invalid date format: "'+e+'"')]:[new Date(Date.parse(e)).getTime()/1e3,null]}function Ze(e,t){if(!(0,S.Z)(e))return[0,new Ne("`"+t+"` property is empty")];var n=Te.exec(e);return null===n?[null,new Ne("`"+t+'` property has an unrecognized format "'+e+'"')]:[365*parseFloat((0,S.Z)(n[2])?n[2]:"0")*24*60*60+30*parseFloat((0,S.Z)(n[4])?n[4]:"0")*24*60*60+24*parseFloat((0,S.Z)(n[6])?n[6]:"0")*60*60+60*parseFloat((0,S.Z)(n[8])?n[8]:"0")*60+60*parseFloat((0,S.Z)(n[10])?n[10]:"0")+parseFloat((0,S.Z)(n[12])?n[12]:"0"),null]}function Pe(e,t){var n=we.exec(e);return null===n?[null,new Ne("`"+t+'` property has an unrecognized format "'+e+'"')]:[[+n[1],+n[2]],null]}function Me(e,t){try{return[(0,Ee.K)(e),null]}catch(n){return[null,new Ne("`"+t+'` is not a valid base64 string: "'+e+'"')]}}function Ce(e,t){var n=/^(\d+)\/(\d+)$/.exec(e);return null!==n?[+n[1]/+n[2],null]:Ie(e,t)}function De(e){for(var t,n,r=0;r<e.attributes.length;r++){var i=e.attributes[r];switch(i.name){case"schemeIdUri":t=i.value;break;case"value":n=i.value}}return{schemeIdUri:t,value:n}}function Oe(e,t){return function(n,r){var i=r.asKey,a=(0,r.parser)(n,r.dashName),s=a[0],u=a[1];null!==u&&(o.Z.warn(u.message),t.push(u)),null!==s&&(e[i]=s)}}var Ne=function(e){function t(n){var r;return r=e.call(this)||this,Object.setPrototypeOf((0,_e.Z)(r),t.prototype),r.name="MPDError",r.message=n,r}return(0,be.Z)(t,e),t}((0,Se.Z)(Error));function Le(e){var t=function(e){for(var t=[],n=[],r=0;r<e.length;r++)if(e[r].nodeType===Node.ELEMENT_NODE){var i=e[r];if("cenc:pssh"===i.nodeName){var a=i.textContent;if(null!==a&&a.length>0){var s=Me(a,"cenc:pssh"),u=s[0],l=s[1];null!==l&&(o.Z.warn(l.message),t.push(l)),null!==u&&n.push(u)}}}return[{cencPssh:n},t]}(e.childNodes),n=t[0],r=t[1];return[{children:n,attributes:function(e){for(var t={},n=0;n<e.attributes.length;n++){var r=e.attributes[n];switch(r.name){case"schemeIdUri":t.schemeIdUri=r.value;break;case"value":t.value=r.value;break;case"cenc:default_KID":t.keyId=(0,m.nr)(r.value.replace(/-/g,""))}}return t}(e)},r]}function Ue(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"range":r(a.value,{asKey:"range",parser:Pe,dashName:"range"});break;case"sourceURL":t.media=a.value}}return[t,n]}function Be(e){for(var t={},n=[],r=Oe(t,n),i=e.childNodes,a=0;a<i.length;a++)if(i[a].nodeType===Node.ELEMENT_NODE){var o=i[a];if("Initialization"===o.nodeName){var s=Ue(o),u=s[0],l=s[1];t.initialization=u,n=n.concat(l)}}for(var d=0;d<e.attributes.length;d++){var c=e.attributes[d];switch(c.name){case"timescale":r(c.value,{asKey:"timescale",parser:Ae,dashName:"timescale"});break;case"presentationTimeOffset":r(c.value,{asKey:"presentationTimeOffset",parser:Ie,dashName:"presentationTimeOffset"});break;case"indexRange":r(c.value,{asKey:"indexRange",parser:Pe,dashName:"indexRange"});break;case"indexRangeExact":r(c.value,{asKey:"indexRangeExact",parser:ke,dashName:"indexRangeExact"});break;case"availabilityTimeOffset":r(c.value,{asKey:"availabilityTimeOffset",parser:Ie,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":r(c.value,{asKey:"availabilityTimeComplete",parser:ke,dashName:"availabilityTimeComplete"});break;case"duration":r(c.value,{asKey:"duration",parser:Ae,dashName:"duration"});break;case"startNumber":r(c.value,{asKey:"startNumber",parser:Ae,dashName:"startNumber"})}}return[t,n]}function Fe(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"media":t.media=a.value;break;case"indexRange":r(a.value,{asKey:"indexRange",parser:Pe,dashName:"indexRange"});break;case"index":t.index=a.value;break;case"mediaRange":r(a.value,{asKey:"mediaRange",parser:Pe,dashName:"mediaRange"})}}return[t,n]}function ze(e){for(var t=Be(e),n=t[0],r=t[1],i=[],a=e.childNodes,o=0;o<a.length;o++)if(a[o].nodeType===Node.ELEMENT_NODE){var s=a[o];if("SegmentURL"===s.nodeName){var u=Fe(s),l=u[0],d=u[1];i.push(l),r=r.concat(d)}}return[(0,I.Z)(n,{list:i}),r]}function Ve(e){var t=null;return function(){if(null===t){var n=e.getElementsByTagName("S");return t=n,n}return t}}function Ke(e){for(var t,n=Be(e),r=n[0],i=n[1],a=0;a<e.childNodes.length;a++)if(e.childNodes[a].nodeType===Node.ELEMENT_NODE){var o=e.childNodes[a];"SegmentTimeline"===o.nodeName&&(t=Ve(o))}for(var s=(0,I.Z)({},r,{duration:r.duration,timelineParser:t}),u=Oe(s,i),l=0;l<e.attributes.length;l++){var d=e.attributes[l];switch(d.nodeName){case"initialization":null==s.initialization&&(s.initialization={media:d.value});break;case"index":s.index=d.value;break;case"availabilityTimeOffset":u(d.value,{asKey:"availabilityTimeOffset",parser:Ie,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":u(d.value,{asKey:"availabilityTimeComplete",parser:ke,dashName:"availabilityTimeComplete"});break;case"media":s.media=d.value;break;case"bitstreamSwitching":u(d.value,{asKey:"bitstreamSwitching",parser:ke,dashName:"bitstreamSwitching"})}}return[s,i]}function Ge(e){var t=function(e){for(var t={baseURLs:[]},n=[],r=[],i=0;i<e.length;i++)if(e[i].nodeType===Node.ELEMENT_NODE){var a=e[i];switch(a.nodeName){case"BaseURL":var o=ge(a),s=o[0],u=o[1];void 0!==s&&t.baseURLs.push(s),r=r.concat(u);break;case"InbandEventStream":void 0===t.inbandEventStreams&&(t.inbandEventStreams=[]),t.inbandEventStreams.push(De(a));break;case"SegmentBase":var l=Be(a),d=l[0],c=l[1];t.segmentBase=d,c.length>0&&(r=r.concat(c));break;case"SegmentList":var f=ze(a),v=f[0],p=f[1];r=r.concat(p),t.segmentList=v;break;case"SegmentTemplate":var h=Ke(a),m=h[0],g=h[1];r=r.concat(g),t.segmentTemplate=m;break;case"ContentProtection":var y=Le(a),_=y[0],b=y[1];b.length>0&&(r=r.concat(b)),void 0!==_&&n.push(_)}}return n.length>0&&(t.contentProtections=n),[t,r]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"audioSamplingRate":t.audioSamplingRate=a.value;break;case"bandwidth":r(a.value,{asKey:"bitrate",parser:Ae,dashName:"bandwidth"});break;case"codecs":t.codecs=a.value;break;case"codingDependency":r(a.value,{asKey:"codingDependency",parser:ke,dashName:"codingDependency"});break;case"frameRate":r(a.value,{asKey:"frameRate",parser:Ce,dashName:"frameRate"});break;case"height":r(a.value,{asKey:"height",parser:Ae,dashName:"height"});break;case"id":t.id=a.value;break;case"maxPlayoutRate":r(a.value,{asKey:"maxPlayoutRate",parser:Ie,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":r(a.value,{asKey:"maximumSAPPeriod",parser:Ie,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=a.value;break;case"profiles":t.profiles=a.value;break;case"qualityRanking":r(a.value,{asKey:"qualityRanking",parser:Ae,dashName:"qualityRanking"});break;case"segmentProfiles":t.segmentProfiles=a.value;break;case"width":r(a.value,{asKey:"width",parser:Ae,dashName:"width"});break;case"availabilityTimeOffset":r(a.value,{asKey:"availabilityTimeOffset",parser:Ie,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":r(a.value,{asKey:"availabilityTimeComplete",parser:ke,dashName:"availabilityTimeComplete"})}}return void 0===t.bitrate&&n.push(new Ne("No bitrate found on a Representation")),[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}function We(e){var t=function(e){for(var t={baseURLs:[],representations:[]},n=[],r=[],i=0;i<e.length;i++)if(e[i].nodeType===Node.ELEMENT_NODE){var a=e[i];switch(a.nodeName){case"Accessibility":void 0===t.accessibilities?t.accessibilities=[De(a)]:t.accessibilities.push(De(a));break;case"BaseURL":var o=ge(a),s=o[0],u=o[1];void 0!==s&&t.baseURLs.push(s),u.length>0&&(r=r.concat(u));break;case"ContentComponent":t.contentComponent=ye(a);break;case"EssentialProperty":null==t.essentialProperties?t.essentialProperties=[De(a)]:t.essentialProperties.push(De(a));break;case"InbandEventStream":void 0===t.inbandEventStreams&&(t.inbandEventStreams=[]),t.inbandEventStreams.push(De(a));break;case"Label":var l=a.textContent;null!=l&&(t.label=l);break;case"Representation":var d=Ge(a),c=d[0],f=d[1];t.representations.push(c),f.length>0&&(r=r.concat(f));break;case"Role":null==t.roles?t.roles=[De(a)]:t.roles.push(De(a));break;case"SupplementalProperty":null==t.supplementalProperties?t.supplementalProperties=[De(a)]:t.supplementalProperties.push(De(a));break;case"SegmentBase":var v=Be(a),p=v[0],h=v[1];t.segmentBase=p,h.length>0&&(r=r.concat(h));break;case"SegmentList":var m=ze(a),g=m[0],y=m[1];t.segmentList=g,y.length>0&&(r=r.concat(y));break;case"SegmentTemplate":var _=Ke(a),b=_[0],S=_[1];t.segmentTemplate=b,S.length>0&&(r=r.concat(S));break;case"ContentProtection":var E=Le(a),T=E[0],w=E[1];w.length>0&&(r=r.concat(w)),void 0!==T&&n.push(T)}}return n.length>0&&(t.contentProtections=n),[t,r]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"group":r(a.value,{asKey:"group",parser:Ae,dashName:"group"});break;case"lang":t.language=a.value;break;case"contentType":t.contentType=a.value;break;case"par":t.par=a.value;break;case"minBandwidth":r(a.value,{asKey:"minBitrate",parser:Ae,dashName:"minBandwidth"});break;case"maxBandwidth":r(a.value,{asKey:"maxBitrate",parser:Ae,dashName:"maxBandwidth"});break;case"minWidth":r(a.value,{asKey:"minWidth",parser:Ae,dashName:"minWidth"});break;case"maxWidth":r(a.value,{asKey:"maxWidth",parser:Ae,dashName:"maxWidth"});break;case"minHeight":r(a.value,{asKey:"minHeight",parser:Ae,dashName:"minHeight"});break;case"maxHeight":r(a.value,{asKey:"maxHeight",parser:Ae,dashName:"maxHeight"});break;case"minFrameRate":r(a.value,{asKey:"minFrameRate",parser:Ce,dashName:"minFrameRate"});break;case"maxFrameRate":r(a.value,{asKey:"maxFrameRate",parser:Ce,dashName:"maxFrameRate"});break;case"selectionPriority":r(a.value,{asKey:"selectionPriority",parser:Ae,dashName:"selectionPriority"});break;case"segmentAlignment":r(a.value,{asKey:"segmentAlignment",parser:Re,dashName:"segmentAlignment"});break;case"subsegmentAlignment":r(a.value,{asKey:"subsegmentAlignment",parser:Re,dashName:"subsegmentAlignment"});break;case"bitstreamSwitching":r(a.value,{asKey:"bitstreamSwitching",parser:ke,dashName:"bitstreamSwitching"});break;case"audioSamplingRate":t.audioSamplingRate=a.value;break;case"codecs":t.codecs=a.value;break;case"codingDependency":r(a.value,{asKey:"codingDependency",parser:ke,dashName:"codingDependency"});break;case"frameRate":r(a.value,{asKey:"frameRate",parser:Ce,dashName:"frameRate"});break;case"height":r(a.value,{asKey:"height",parser:Ae,dashName:"height"});break;case"maxPlayoutRate":r(a.value,{asKey:"maxPlayoutRate",parser:Ie,dashName:"maxPlayoutRate"});break;case"maximumSAPPeriod":r(a.value,{asKey:"maximumSAPPeriod",parser:Ie,dashName:"maximumSAPPeriod"});break;case"mimeType":t.mimeType=a.value;break;case"profiles":t.profiles=a.value;break;case"segmentProfiles":t.segmentProfiles=a.value;break;case"width":r(a.value,{asKey:"width",parser:Ae,dashName:"width"});break;case"availabilityTimeOffset":r(a.value,{asKey:"availabilityTimeOffset",parser:Ie,dashName:"availabilityTimeOffset"});break;case"availabilityTimeComplete":r(a.value,{asKey:"availabilityTimeComplete",parser:ke,dashName:"availabilityTimeComplete"})}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}function He(e){for(var t={children:{events:[]},attributes:{}},n=[],r=Oe(t.attributes,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"schemeIdUri":t.attributes.schemeIdUri=a.value;break;case"timescale":r(a.value,{asKey:"timescale",parser:Ae,dashName:"timescale"});break;case"value":t.attributes.value=a.value}}for(var o=0;o<e.childNodes.length;o++)if(e.childNodes[o].nodeType===Node.ELEMENT_NODE){var s=e.childNodes[o];if("Event"===s.nodeName){var u=je(s),l=u[0],d=u[1];t.children.events.push(l),d.length>0&&(n=n.concat(d))}}return[t,n]}function je(e){for(var t={eventStreamData:e},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"presentationTime":r(a.value,{asKey:"presentationTime",parser:Ae,dashName:"presentationTime"});break;case"duration":r(a.value,{asKey:"duration",parser:Ae,dashName:"duration"});break;case"id":t.id=a.value}}return[t,n]}function qe(e){var t=function(e){for(var t,n=[],r=[],i=[],a=[],o=0;o<e.length;o++)if(e[o].nodeType===Node.ELEMENT_NODE){var s=e[o];switch(s.nodeName){case"BaseURL":var u=ge(s),l=u[0],d=u[1];void 0!==l&&n.push(l),i=i.concat(d);break;case"AdaptationSet":var c=We(s),f=c[0],v=c[1];r.push(f),i=i.concat(v);break;case"EventStream":var p=He(s),h=p[0],m=p[1];a.push(h),i=i.concat(m);break;case"SegmentTemplate":var g=Ke(s),y=g[0],_=g[1];t=y,_.length>0&&(i=i.concat(_))}}return[{baseURLs:n,adaptations:r,eventStreams:a,segmentTemplate:t},i]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"start":r(a.value,{asKey:"start",parser:Ze,dashName:"start"});break;case"duration":r(a.value,{asKey:"duration",parser:Ze,dashName:"duration"});break;case"bitstreamSwitching":r(a.value,{asKey:"bitstreamSwitching",parser:ke,dashName:"bitstreamSwitching"});break;case"xlink:href":t.xlinkHref=a.value;break;case"xlink:actuate":t.xlinkActuate=a.value}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}function Ye(e){var t=function(e){for(var t=[],n=[],r=[],i=[],a=[],o=0;o<e.length;o++)if(e[o].nodeType===Node.ELEMENT_NODE){var s=e[o];switch(s.nodeName){case"BaseURL":var u=ge(s),l=u[0],d=u[1];void 0!==l&&t.push(l),a=a.concat(d);break;case"Location":n.push(null===s.textContent?"":s.textContent);break;case"Period":var c=qe(s),f=c[0],v=c[1];r.push(f),a=a.concat(v);break;case"UTCTiming":var p=De(s);i.push(p)}}return[{baseURLs:t,locations:n,periods:r,utcTimings:i},a]}(e.childNodes),n=t[0],r=t[1],i=function(e){for(var t={},n=[],r=Oe(t,n),i=0;i<e.attributes.length;i++){var a=e.attributes[i];switch(a.name){case"id":t.id=a.value;break;case"profiles":t.profiles=a.value;break;case"type":t.type=a.value;break;case"availabilityStartTime":r(a.value,{asKey:"availabilityStartTime",parser:xe,dashName:"availabilityStartTime"});break;case"availabilityEndTime":r(a.value,{asKey:"availabilityEndTime",parser:xe,dashName:"availabilityEndTime"});break;case"publishTime":r(a.value,{asKey:"publishTime",parser:xe,dashName:"publishTime"});break;case"mediaPresentationDuration":r(a.value,{asKey:"duration",parser:Ze,dashName:"mediaPresentationDuration"});break;case"minimumUpdatePeriod":r(a.value,{asKey:"minimumUpdatePeriod",parser:Ze,dashName:"minimumUpdatePeriod"});break;case"minBufferTime":r(a.value,{asKey:"minBufferTime",parser:Ze,dashName:"minBufferTime"});break;case"timeShiftBufferDepth":r(a.value,{asKey:"timeShiftBufferDepth",parser:Ze,dashName:"timeShiftBufferDepth"});break;case"suggestedPresentationDelay":r(a.value,{asKey:"suggestedPresentationDelay",parser:Ze,dashName:"suggestedPresentationDelay"});break;case"maxSegmentDuration":r(a.value,{asKey:"maxSegmentDuration",parser:Ze,dashName:"maxSegmentDuration"});break;case"maxSubsegmentDuration":r(a.value,{asKey:"maxSubsegmentDuration",parser:Ze,dashName:"maxSubsegmentDuration"})}}return[t,n]}(e),a=i[0],o=i[1];return[{children:n,attributes:a},r.concat(o)]}var Xe=function(e,t){var n=e.documentElement;if((0,i.Z)(n)||"MPD"!==n.nodeName)throw new Error("DASH Parser: document root should be MPD");var a=Ye(n),o=a[0],s=a[1];return function e(t){if("done"===t.type)return t;if("needs-clock"===t.type)return{type:"needs-resources",value:{urls:[t.value.url],format:"string",continue:function(n){if(1!==n.length)throw new Error("DASH parser: wrong number of loaded ressources.");var r=t.value.continue(n[0].responseData);return e(r)}}};if("needs-xlinks"===t.type)return{type:"needs-resources",value:{urls:t.value.xlinksUrls,format:"string",continue:function(n){for(var r=[],i=0;i<n.length;i++){var a=n[i],o=a.responseData,s=a.receivedTime,u=a.sendingTime,l=a.url;if(!o.success)throw o.error;var d="<root>"+o.data+"</root>",c=(new DOMParser).parseFromString(d,"text/xml");if(null==c||0===c.children.length)throw new Error("DASH parser: Invalid external ressources");for(var f=c.children[0].children,v=[],p=[],h=0;h<f.length;h++)if(f[h].nodeType===Node.ELEMENT_NODE){var m,g=qe(f[h]),y=g[0],_=g[1];(m=p).push.apply(m,_),v.push(y)}r.push({url:l,receivedTime:s,sendingTime:u,parsed:v,warnings:p})}var b=t.value.continue(r);return e(b)}}};(0,r.Z)(t)}(me(o,t,s))}},8232:function(e,t,n){"use strict";function r(e,t){for(var n=0;e.length>0;){var r=e[0];if(r.start>=t)return n;if(-1===r.repeatCount)return n;if(0===r.repeatCount)e.shift(),n+=1;else{var i=e[1];if(void 0!==i&&i.start<=t)e.shift(),n+=1;else{if(r.duration<=0)return n;for(var a=r.start+r.duration,o=1;a<t&&o<=r.repeatCount;)a+=r.duration,o++;if(!(o>r.repeatCount)){var s=r.repeatCount-o;return r.start=a,r.repeatCount=s,n+=o}e.shift(),n=r.repeatCount+1}}}return n}n.d(t,{Z:function(){return r}})},3911:function(e,t,n){"use strict";n.d(t,{KF:function(){return i},PZ:function(){return u},_j:function(){return l},gT:function(){return o},jH:function(){return a},zG:function(){return s}});var r=n(1946);function i(e,t,n){var i,a=e.repeatCount;return a>=0?a:(i=(0,r.Z)(t)?void 0!==n?n:Number.MAX_VALUE:t.start,Math.ceil((i-e.start)/e.duration)-1)}function a(e,t,n){var r=e.start,a=e.duration;return a<=0?r:r+(i(e,t,n)+1)*a}function o(e,t){var n;return e*t.timescale+(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0)}function s(e,t){var n;return(e-(null!==(n=t.indexTimeOffset)&&void 0!==n?n:0))/t.timescale}function u(e,t,n){return[e*n,(e+t)*n]}function l(e,t,n){var r=e.timeline,i=o(t,e);if(i<0)return null;var u=function(e,t){for(var n=0,r=e.length;n<r;){var i=n+r>>>1;e[i].start<=t?n=i+1:r=i}return n-1}(r,i);if(u<0||u>=r.length-1)return null;var l=r[u];if(l.duration<=0)return null;var d=r[u+1];if(void 0===d)return null;var c=d.start;return i>=a(l,d,n)&&i<c?s(c,e):null}},1091:function(e,t,n){"use strict";function r(e,t,n,r){for(var i=0;i<t.length;i++){var a=t[i],o=(a.start-r)/n;if(o>e.time)return!1;if(o===e.time)return void 0===a.range?void 0===e.range:null!=e.range&&a.range[0]===e.range[0]&&a.range[1]===e.range[1];if(a.repeatCount>=0&&void 0!==a.duration){var s=(o-a.start)/a.duration-1;return s%1==0&&s<=a.repeatCount}}return!1}n.d(t,{Z:function(){return r}})},5505:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3714),i=n(3887),a=n(3911);function o(e,t){if(0===e.length)return e.push.apply(e,t),!0;if(0===t.length)return!1;var n=e.length,o=t[0].start,s=e[n-1];if((0,a.jH)(s,t[0])<o)throw new r.Z("MANIFEST_UPDATE_ERROR","Cannot perform partial update: not enough data");for(var u=n-1;u>=0;u--){var l=e[u].start;if(l===o){var d=n-u;return e.splice.apply(e,[u,d].concat(t)),!1}if(l<o){var c=e[u];if(c.start+c.duration>o)return i.Z.warn("RepresentationIndex: Manifest update removed all previous segments"),e.splice.apply(e,[0,n].concat(t)),!0;if(void 0===c.repeatCount||c.repeatCount<=0)return c.repeatCount<0&&(c.repeatCount=Math.floor((o-c.start)/c.duration)-1),e.splice.apply(e,[u+1,n-(u+1)].concat(t)),!1;if(c.start+c.duration*(c.repeatCount+1)<=o)return e.splice.apply(e,[u+1,n-(u+1)].concat(t)),!1;var f=(o-c.start)/c.duration-1;if(f%1==0&&c.duration===t[0].duration){var v=t[0].repeatCount<0?-1:t[0].repeatCount+f+1;return e.splice.apply(e,[u,n-u].concat(t)),e[u].start=c.start,e[u].repeatCount=v,!1}return i.Z.warn("RepresentationIndex: Manifest update removed previous segments"),e[u].repeatCount=Math.floor(f),e.splice.apply(e,[u+1,n-(u+1)].concat(t)),!1}}var p=e[e.length-1],h=t[t.length-1];return void 0!==p.repeatCount&&p.repeatCount<0?p.start>h.start?(i.Z.warn("RepresentationIndex: The new index is older than the previous one"),!1):(i.Z.warn('RepresentationIndex: The new index is "bigger" than the previous one'),e.splice.apply(e,[0,n].concat(t)),!0):p.start+p.duration*(p.repeatCount+1)>=h.start+h.duration*(h.repeatCount+1)?(i.Z.warn("RepresentationIndex: The new index is older than the previous one"),!1):(i.Z.warn('RepresentationIndex: The new index is "bigger" than the previous one'),e.splice.apply(e,[0,n].concat(t)),!0)}},5734:function(e,t,n){"use strict";var r=n(6923),i=/&#([0-9]+);/g,a=/<br>/gi,o=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,s=/\s*<p (?:class=([^>]+))?>(.*)/i,u=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function l(e,t){var n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}t.Z=function(e,t,n){var d,c,f=/<sync[ >]/gi,v=/<sync[ >]|<\/body>/gi,p=[],h=o.exec(e),m=Array.isArray(h)?h[1]:"";v.exec(e);var g,y=function(e){for(var t=/\.(\S+)\s*{([^}]*)}/gi,n={},r=t.exec(e);null!==r;){var i=r[1],a=l(r[2],"lang");null!=i&&null!=a&&(n[a]=i),r=t.exec(e)}return n}(m),_=function(e){var t=/p\s*{([^}]*)}/gi.exec(e);return null===t?"":t[1]}(m);if((0,r.Z)(n)&&void 0===(g=y[n]))throw new Error("sami: could not find lang "+n+" in CSS");for(;d=f.exec(e),c=v.exec(e),null!==d||null!==c;){if(null===d||null===c||d.index>=c.index)throw new Error("parse error");var b=e.slice(d.index,c.index),S=u.exec(b);if(!Array.isArray(S))throw new Error("parse error (sync time attribute)");var E=+S[1];if(isNaN(E))throw new Error("parse error (sync time attribute NaN)");T(b.split("\n"),E/1e3)}return p;function T(e,n){for(var o=e.length;--o>=0;){var u=s.exec(e[o]);if(Array.isArray(u)){var l=u[1],d=u[2];if(g===l)if("&nbsp;"===d)p[p.length-1].end=n;else{var c=document.createElement("DIV");c.className="rxp-texttrack-region";var f=document.createElement("DIV");f.className="rxp-texttrack-div",f.style.position="absolute",f.style.bottom="0",f.style.width="100%",f.style.color="#fff",f.style.textShadow="-1px -1px 0 #000,1px -1px 0 #000,-1px 1px 0 #000,1px 1px 0 #000";var v=document.createElement("div");v.className="rxp-texttrack-p",(0,r.Z)(_)&&(v.style.cssText=_);for(var h=d.split(a),m=0;m<h.length;m++){0!==m&&v.appendChild(document.createElement("BR"));var y=document.createElement("SPAN");y.className="rxp-texttrack-span",y.textContent=h[m].replace(i,(function(e,t){return String.fromCharCode(Number(t))})),v.appendChild(y)}f.appendChild(v),c.appendChild(f),p.push({element:c,start:n+t,end:-1})}}}}}},1812:function(e,t,n){"use strict";var r=n(7253),i=n(6923),a=/&#([0-9]+);/g,o=/<br>/gi,s=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,u=/\s*<p (?:class=([^>]+))?>(.*)/i,l=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;function d(e,t){var n=new RegExp("\\s*"+t+":\\s*(\\S+);","i").exec(e);return Array.isArray(n)?n[1]:null}t.Z=function(e,t,n){var c,f,v=/<sync[ >]/gi,p=/<sync[ >]|<\/body>/gi,h=[],m=s.exec(e),g=null!==m?m[1]:"";p.exec(e);var y,_=function(e){for(var t=/\.(\S+)\s*{([^}]*)}/gi,n={},r=t.exec(e);Array.isArray(r);){var i=r[1],a=d(r[2],"lang");null!=i&&null!=a&&(n[a]=i),r=t.exec(e)}return n}(g);if((0,i.Z)(n)&&void 0===(y=_[n]))throw new Error("sami: could not find lang "+n+" in CSS");for(;c=v.exec(e),f=p.exec(e),null!==c||null!==f;){if(null===c||null===f||c.index>=f.index)throw new Error("parse error");var b=e.slice(c.index,f.index),S=l.exec(b);if(null===S)throw new Error("parse error (sync time attribute)");var E=+S[1];if(isNaN(E))throw new Error("parse error (sync time attribute NaN)");T(b.split("\n"),E/1e3)}return function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n],o=a.start,s=a.end,u=a.text;if((0,i.Z)(u)&&null!=s){var l=(0,r.Z)(o,s,u);null!=l&&t.push(l)}}return t}(h);function T(e,n){for(var r,i,s=e.length;--s>=0;)if(null!==(r=u.exec(e[s]))){var l=r,d=l[1],c=l[2];y===d&&("&nbsp;"===c?h[h.length-1].end=n:h.push({text:(i=c,i.replace(o,"\n").replace(a,(function(e,t){return String.fromCharCode(Number(t))}))),start:n+t}))}}}},2061:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(6923);function i(e,t){for(var n=t+1;(0,r.Z)(e[n]);)n++;return n}function a(e){for(var t=[],n=0;n<e.length;n++)if((0,r.Z)(e[n])){var a=i(e,n),o=e.slice(n,a);o.length>0&&(1===o.length?o[0].indexOf("--\x3e")>=0&&t.push(o):(o[1].indexOf("--\x3e")>=0||o[0].indexOf("--\x3e")>=0)&&t.push(o)),n=a}return t}},8675:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(2061),i=n(788);function a(e,t){for(var n=e.split(/\r\n|\n|\r/),a=(0,r.Z)(n),s=[],u=0;u<a.length;u++){var l=(0,i.Z)(a[u],t);if(null!=l){var d=o(l);null!=d&&s.push(d)}}return s}function o(e){var t=e.start,n=e.end,r=e.payload,i=document.createElement("div");i.className="rxp-texttrack-p",i.style.fontSize="28px",i.style.position="absolute",i.style.bottom="5%",i.style.width="100%",i.style.textAlign="center",i.style.color="#fff",i.style.textShadow="-1px -1px 2px #000,1px -1px 2px #000,-1px 1px 2px #000,1px 1px 2px #000";for(var a=0;a<r.length;a++){0!==a&&i.appendChild(document.createElement("br"));var o=s(r[a]);i.appendChild(o)}return{start:t,end:n,element:i}}function s(e){var t=document.createElement("div");t.innerHTML=e;return function e(t){var n=t.childNodes,r=document.createElement("span");r.className="rxp-texttrack-span";for(var i=0;i<n.length;i++){var a=n[i];if("#text"===a.nodeName){for(var o=a.wholeText.split("\n"),s=0;s<o.length;s++)if(0!==s&&r.appendChild(document.createElement("br")),o[s].length>0){var l=document.createTextNode(o[s]);r.appendChild(l)}}else if("B"===a.nodeName){var d=e(a);d.style.fontWeight="bold",r.appendChild(d)}else if("I"===a.nodeName){var c=e(a);c.style.fontStyle="italic",r.appendChild(c)}else if("U"===a.nodeName){var f=e(a);f.style.textDecoration="underline",r.appendChild(f)}else if(u(a)&&"string"==typeof a.color){var v=e(a);v.style.color=a.color,r.appendChild(v)}else{var p=e(a);r.appendChild(p)}}return r}(t)}function u(e){return"FONT"===e.nodeName&&"color"in e}},8057:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7253),i=n(2061),a=n(788);function o(e,t){for(var n,o,s,u,l,d=e.split(/\r\n|\n|\r/),c=(0,i.Z)(d),f=[],v=0;v<c.length;v++){var p=(0,a.Z)(c[v],t);if(null!==p){var h=(o=void 0,s=void 0,u=void 0,l=void 0,o=(n=p).start,s=n.end,u=n.payload,l=u.join("\n"),(0,r.Z)(o,s,l));null!==h&&f.push(h)}}return f}},788:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(6923);function i(e){var t=e.split(":");if((0,r.Z)(t[2])){var n=parseInt(t[0],10),i=parseInt(t[1],10),a=parseFloat(t[2].replace(",","."));if(isNaN(n)||isNaN(i)||isNaN(a))return;return 60*n*60+60*i+a}}function a(e,t){if(0===e.length)return null;var n,a,o=[];if((0,r.Z)(e[1])&&-1!==e[1].indexOf("--\x3e")){var s=e[1].split("--\x3e").map((function(e){return e.trim()}));n=s[0],a=s[1],o=e.slice(2,e.length)}if(!(0,r.Z)(n)||!(0,r.Z)(a)){var u=e[0].split("--\x3e").map((function(e){return e.trim()}));n=u[0],a=u[1],o=e.slice(1,e.length)}if(!(0,r.Z)(n)||!(0,r.Z)(a))return null;var l=i(n),d=i(a);return void 0===l||void 0===d?null:{start:l+t,end:d+t,payload:o}}},3791:function(e,t,n){"use strict";n.d(t,{U:function(){return s},b:function(){return u}});var r=n(3274),i=n(7714),a=n(6923),o=n(9252);function s(e,t,n,o){for(var s={},u=e.slice(),l=0;l<=t.length-1;l++){var d=t[l];if(void 0!==d){var c=function(){var e=void 0,t=void 0;if(d.nodeType===Node.ELEMENT_NODE)for(var l=d,c=0;c<=l.attributes.length-1;c++){var f=l.attributes[c],v=f.name;if("style"===v)e=f.value;else if("region"===v)t=f.value;else{var p=v.substring(4);if((0,i.Z)(u,p)&&(s[p]=f.value,u.splice(c,1),0===u.length))return{v:s}}}if((0,a.Z)(e)){var h=(0,r.Z)(n,(function(t){return t.id===e}));if(void 0!==h)for(var m=0;m<=u.length-1;m++){var g=u[m];if(!(0,a.Z)(s[g])&&(0,a.Z)(h.style[g])){if(s[g]=h.style[g],u.splice(m,1),0===u.length)return{v:s};m--}}}if((0,a.Z)(t)){var y=(0,r.Z)(o,(function(e){return e.id===t}));if(void 0!==y)for(var _=0;_<=u.length-1;_++){var b=u[_];if(!(0,a.Z)(s[b])&&(0,a.Z)(y.style[b])){if(s[b]=y.style[b],u.splice(_,1),0===u.length)return{v:s};_--}}}}();if("object"==typeof c)return c.v}}return s}function u(e){if(e.nodeType!==Node.ELEMENT_NODE)return{};for(var t=e,n={},r=0;r<=t.attributes.length-1;r++){var i=t.attributes[r];if((0,o.Z)(i.name,"tts"))n[i.name.substring(4)]=i.value}return n}},6177:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(6923),i=n(5336);function a(e,t){var n=e.exec(t);if(null===n||""===n[0])return null;var r=Number(n[1]);isNaN(r)&&(r=0);var i=Number(n[2]);isNaN(i)&&(i=0);var a=Number(n[3]);isNaN(a)&&(a=0);var o=Number(n[4]);return isNaN(o)&&(o=0),o/1e3+a+60*i+3600*r}var o=function(e,t){return i.gu.test(e)?function(e,t){var n=i.gu.exec(t),r=Number(n[1]),a=Number(n[2]),o=Number(n[3]),s=Number(n[4]),u=Number(n[5]);isNaN(u)&&(u=0);return s+=u/e.subFrameRate,(o+=s/e.frameRate)+60*a+3600*r}(t,e):i.KO.test(e)?a(i.KO,e):i.wf.test(e)?a(i.wf,e):i.jb.test(e)?function(e,t){var n=i.jb.exec(t);return Number(n[1])/e.frameRate}(t,e):i.Du.test(e)?function(e,t){var n=i.Du.exec(t);return Number(n[1])/e.tickRate}(t,e):i.te.test(e)?a(i.te,e):void 0};function s(e,t){var n=e.getAttribute("begin"),i=e.getAttribute("dur"),a=e.getAttribute("end"),s=(0,r.Z)(n)?o(n,t):null,u=(0,r.Z)(i)?o(i,t):null,l=(0,r.Z)(a)?o(a,t):null;if(null==s||null==l&&null==u)throw new Error("Invalid text cue");return{start:s,end:null==l?s+u:l}}},7439:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var r=n(959);function i(e){return void 0===e.extent&&void 0===e.origin&&void 0===e.displayAlign&&void 0===e.display&&void 0===e.textAlign&&void 0===e.fontSize}function a(e){e.extent="70% 20%",e.fontSize="1c",e.origin="15% 80%",e.displayAlign="before",e.textAlign="center"}var o,s=n(6177);function u(e,t){(void 0===o&&(o=void 0!==e.classList&&"function"==typeof e.classList.add),o)?e.classList.add(t):(" "+e.className+" ").indexOf(" "+t+" ")<0&&(e.className+=" "+t)}var l=n(6923),d=n(8026),c=n(3791),f=n(1594),v=n(3887),p=n(5336);function h(e,t){var n=t;return(0,l.Z)(t)&&t.trim().endsWith("%")&&(n=t.trim().slice(0,-1),n=(parseInt(n,10)/100).toString()+"em"),"-1px -1px "+n+" "+e+",1px -1px "+n+" "+e+",-1px 1px "+n+" "+e+",1px 1px "+n+" "+e}function m(e){var t;return null!=(t=p.Dq.exec(e))?"rgba("+String(parseInt(t[1],16))+","+String(parseInt(t[2],16))+","+String(parseInt(t[3],16))+","+String(parseInt(t[4],16)/255)+")":null!=(t=p.YU.exec(e))?"rgba("+String(parseInt(t[1]+t[1],16))+","+String(parseInt(t[2]+t[2],16))+","+String(parseInt(t[3]+t[3],16))+","+String(parseInt(t[4]+t[4],16)/255)+")":null!=(t=p.GK.exec(e))?"rgb("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+")":null!=(t=p.ev.exec(e))?"rgba("+String(+t[1])+","+String(+t[2])+","+String(+t[3])+","+String(+t[4]/255)+")":e}var g=["color","direction","display","fontFamily","fontSize","fontStyle","fontWeight","textDecoration","textOutline","unicodeBidi","visibility","wrapOption"];function y(e,t,n){var r=t.color;(0,l.Z)(r)&&(e.style.color=m(r));var i=t.backgroundColor;(0,l.Z)(i)&&(e.style.backgroundColor=m(i));var a=t.textOutline;if((0,l.Z)(a)){var o=a.trim().replace(/\s+/g," ").split(" "),s=o.length;if(3===s){var d=m(o[0]),c=o[1];e.style.textShadow=h(d,c)}else if((0,l.Z)(r)&&1===s){var f=o[0];e.style.textShadow=h(r,f)}else if(2===s){var g=/^[#A-Z]/i.test(o[0]);if(g!==/^[0-9]/.test(o[0]))if(g){var y=m(o[0]),_=o[1];e.style.textShadow=h(y,_)}else if((0,l.Z)(r)){var b=o[0];e.style.textShadow=h(r,b)}}}var S=t.textDecoration;if((0,l.Z)(S))switch(S){case"noUnderline":case"noLineThrough":case"noOverline":e.style.textDecoration="none";break;case"lineThrough":e.style.textDecoration="line-through";break;default:e.style.textDecoration=S}var E=t.fontFamily;if((0,l.Z)(E))switch(E){case"proportionalSansSerif":e.style.fontFamily="Arial, Helvetica, Liberation Sans, sans-serif";break;case"monospaceSansSerif":case"sansSerif":e.style.fontFamily="sans-serif";break;case"monospaceSerif":case"default":e.style.fontFamily="Courier New, Liberation Mono, monospace";break;case"proportionalSerif":e.style.fontFamily="serif";break;default:e.style.fontFamily=E}var T=t.fontStyle;(0,l.Z)(T)&&(e.style.fontStyle=T);var w=t.fontWeight;(0,l.Z)(w)&&(e.style.fontWeight=w);var k=t.fontSize;(0,l.Z)(k)?function(e,t){var n=t.trim().split(" ");if(0!==n.length){var r=p.eT.exec(n[0]);if(null!==r)if("px"===r[2]||"em"===r[2])e.style.fontSize=r[1]+r[2];else if("c"===r[2])e.style.position="relative",u(e,"proportional-style"),e.setAttribute("data-proportional-font-size",r[1]);else if("%"===r[2]){var i=Number(r[1]);isNaN(i)?v.Z.warn('TTML Parser: could not parse fontSize value "'+r[1]+'" into a number'):(e.style.position="relative",u(e,"proportional-style"),e.setAttribute("data-proportional-font-size",String(i/100)))}else v.Z.warn("TTML Parser: unhandled fontSize unit:",r[2])}}(e,k):(u(e,"proportional-style"),e.setAttribute("data-proportional-font-size","1"));var A=t.direction;(0,l.Z)(A)&&(e.style.direction=A);var I=t.unicodeBidi;if((0,l.Z)(I))switch(I){case"bidiOverride":e.style.unicodeBidi="bidi-override";break;case"embed":e.style.unicodeBidi="embed";break;default:e.style.unicodeBidi="normal"}var R=t.visibility;(0,l.Z)(R)&&(e.style.visibility=R),"none"===t.display&&(e.style.display="none");var x=t.wrapOption;e.style.whiteSpace="noWrap"===x?n?"nowrap":"pre":n?"normal":"pre-wrap"}function _(e,t){e.style.color="white",e.style.position="absolute";var n=t.extent;(0,l.Z)(n)&&function(e,t){var n=t.trim();if("auto"!==n){var r=n.split(" ");if(2===r.length){var i=p.eT.exec(r[0]),a=p.eT.exec(r[1]);null!==i&&null!==a&&("px"===i[2]||"%"===i[2]||"em"===i[2]?e.style.width=i[1]+i[2]:"c"===i[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-width",i[1])):v.Z.warn("TTML Parser: unhandled extent unit:",i[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.height=a[1]+a[2]:"c"===a[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-height",a[1])):v.Z.warn("TTML Parser: unhandled extent unit:",a[2]))}}}(e,n);var r=t.writingMode;(0,l.Z)(r);var i=t.overflow;e.style.overflow=(0,l.Z)(i)?i:"hidden";var a=t.padding;(0,l.Z)(a)&&function(e,t){var n=t.trim().split(" ");if(!(n.length<1)){var r=p.eT.exec(n[0]);if(null!==r){if("px"===r[2]||"%"===r[2]||"em"===r[2]){var i=r[1]+r[2];1===n.length?e.style.padding=i:2===n.length?(e.style.paddingTop=i,e.style.paddingBottom=i):e.style.paddingTop=i}else"c"===r[2]?(u(e,"proportional-style"),1===n.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1]),e.setAttribute("data-proportional-padding-left",r[1]),e.setAttribute("data-proportional-padding-right",r[1])):2===n.length?(e.setAttribute("data-proportional-padding-top",r[1]),e.setAttribute("data-proportional-padding-bottom",r[1])):e.setAttribute("data-proportional-padding-top",r[1])):v.Z.warn("TTML Parser: unhandled padding unit:",r[2]);if(1!==n.length){var a=p.eT.exec(n[1]);if(null!==a){if("px"===a[2]||"%"===a[2]||"em"===a[2]){var o=a[1]+a[2];n.length<4?(e.style.paddingLeft=o,e.style.paddingRight=o):e.style.paddingRight=o}else"c"===a[2]?(u(e,"proportional-style"),n.length<4?(e.setAttribute("data-proportional-padding-left",a[1]),e.setAttribute("data-proportional-padding-right",a[1])):e.setAttribute("data-proportional-padding-right",a[1])):v.Z.warn("TTML Parser: unhandled padding unit:",a[2]);if(2!==n.length){var s=p.eT.exec(n[2]);if(null!==s){if("px"===s[2]||"%"===s[2]||"em"===s[2]){var l=s[1]+s[2];e.style.paddingBottom=l}else"c"===s[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-padding-bottom",s[1])):v.Z.warn("TTML Parser: unhandled padding unit:",s[2]);if(3!==n.length){var d=p.eT.exec(n[3]);if(null!==d)if("px"===d[2]||"%"===d[2]||"em"===d[2]){var c=d[1]+d[2];e.style.paddingLeft=c}else"c"===d[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-padding-left",d[1])):v.Z.warn("TTML Parser: unhandled padding unit:",d[2])}}}}}}}}(e,a);var o=t.origin;(0,l.Z)(o)&&function(e,t){var n=t.trim();if("auto"!==n){var r=n.split(" ");if(2===r.length){var i=p.eT.exec(r[0]),a=p.eT.exec(r[1]);null!==i&&null!==a&&("px"===i[2]||"%"===i[2]||"em"===i[2]?e.style.left=i[1]+i[2]:"c"===i[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-left",i[1])):v.Z.warn("TTML Parser: unhandled origin unit:",i[2]),"px"===a[2]||"%"===a[2]||"em"===a[2]?e.style.top=a[1]+a[2]:"c"===a[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-top",a[1])):v.Z.warn("TTML Parser: unhandled origin unit:",a[2]))}}}(e,o);var s=t.displayAlign;if((0,l.Z)(s))switch(e.style.display="flex",e.style.flexDirection="column",s){case"before":e.style.justifyContent="flex-start";break;case"center":e.style.justifyContent="center";break;case"after":e.style.justifyContent="flex-end"}var d=t.opacity;(0,l.Z)(d)&&(e.style.opacity=d);var c=t.visibility;(0,l.Z)(c)&&(e.style.visibility=c),"none"===t.display&&(e.style.display="none")}function b(e,t){e.style.margin="0px";var n=t.backgroundColor;(0,l.Z)(n)&&(e.style.backgroundColor=m(n));var r=t.lineHeight;(0,l.Z)(r)&&function(e,t){var n=t.trim();if("auto"!==n){var r=p.eT.exec(n[0]);null!==r&&("px"===r[2]||"%"===r[2]||"em"===r[2]?e.style.lineHeight=r[1]+r[2]:"c"===r[2]?(u(e,"proportional-style"),e.setAttribute("data-proportional-line-height",r[1])):v.Z.warn("TTML Parser: unhandled lineHeight unit:",r[2]))}}(e,r);var i=t.textAlign;if((0,l.Z)(i))switch(i){case"center":e.style.textAlign="center";break;case"left":case"start":e.style.textAlign="left";break;case"right":case"end":e.style.textAlign="right"}}function S(e,t,n){var r=document.createElement("span"),i=null===e.textContent?"":e.textContent;if(n){var a=i.trim();i=a=a.replace(/\s+/g," ")}var o=document.createTextNode(i);return r.appendChild(o),r.className="rxp-texttrack-span",y(r,t,n),r}function E(e,t,n,r,i,a){var o=a.cellResolution,s=a.shouldTrimWhiteSpace,u=(0,f.jF)(e),v=document.createElement("DIV");if(v.className="rxp-texttrack-region",v.setAttribute("data-resolution-columns",String(o.columns)),v.setAttribute("data-resolution-rows",String(o.rows)),_(v,i),null!==t){var p=(0,c.U)(["backgroundColor"],[].concat(u,[t]),r,n).bodyBackgroundColor;(0,l.Z)(p)&&(v.style.backgroundColor=m(p))}var h=document.createElement("p");h.className="rxp-texttrack-p",b(h,i);for(var y=function(e,t,n,r,i){return function e(r,i,a,o){for(var s=r.childNodes,u=[],v=0;v<s.length;v++){var p=s[v];if("#text"===p.nodeName){var h=(0,c.U)(["backgroundColor"],a,n,t).backgroundColor;(0,l.Z)(h)?i.backgroundColor=h:delete i.backgroundColor;var m=S(p,i,o);u.push(m)}else if((0,f.OE)(p)){var y=document.createElement("BR");u.push(y)}else if((0,f.jg)(p)&&p.nodeType===Node.ELEMENT_NODE&&p.childNodes.length>0){var _=p.getAttribute("xml:space"),b=(0,l.Z)(_)?"default"===_:o,E=(0,d.Z)({},i,(0,c.U)(g,[p],n,t));u.push.apply(u,e(p,E,[p].concat(a),b))}}return u}(e,(0,d.Z)({},r),[],i)}(e,n,r,i,s),E=0;E<y.length;E++)h.appendChild(y[E]);return v.appendChild(h),v}function T(e){var t=e.paragraph,n=e.ttParams,r=e.body,i=e.regionStyles,a=e.idStyles,o=e.paragraphStyle,u=e.timeOffset,l=e.shouldTrimWhiteSpace;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;var d=n.cellResolution,c=(0,s.Z)(t,n);return{start:c.start+u,end:c.end+u,element:E(t,r,i,a,o,{cellResolution:d,shouldTrimWhiteSpace:l})}}var w=function(e,t){for(var n=(0,r.Z)(e,t),o=[],s=0;s<n.length;s++){var u=n[s].paragraphStyle;i(u)&&a(u);var l=T(n[s]);null!==l&&o.push(l)}return o}},1570:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(959),i=n(7253),a=n(1988),o=n(6923),s=n(6177),u=n(5336),l=n(1594),d={left:"start",center:"center",right:"end",start:"start",end:"end"},c={left:"line-left",center:"center",right:"line-right"};function f(e){var t=e.paragraph,n=e.timeOffset,r=e.paragraphStyle,f=e.ttParams,v=e.shouldTrimWhiteSpace;if(!t.hasAttribute("begin")&&!t.hasAttribute("end")&&/^\s*$/.test(null===t.textContent?"":t.textContent))return null;var p=(0,s.Z)(t,f),h=p.start,m=p.end,g=function(e,t){function n(e,t){for(var r=e.childNodes,i="",a=0;a<r.length;a++){var s=r[a];if("#text"===s.nodeName){var u=s.textContent;if(null===u&&(u=""),t){var d=u.trim();u=d=d.replace(/\s+/g," ")}i+=u.replace(/&|\u0026/g,"&amp;").replace(/<|\u003C/g,"&lt;").replace(/>|\u2265/g,"&gt;").replace(/\u200E/g,"&lrm;").replace(/\u200F/g,"&rlm;").replace(/\u00A0/g,"&nbsp;")}else if((0,l.OE)(s))i+="\n";else if((0,l.jg)(s)&&s.nodeType===Node.ELEMENT_NODE&&s.childNodes.length>0){var c=s.getAttribute("xml:space");i+=n(s,(0,o.Z)(c)?"default"===c:t)}}return i}return n(e,t)}(t,v),y=(0,i.Z)(h+n,m+n,g);return null===y?null:((0,a.Z)(y)&&function(e,t){var n=t.extent;if((0,o.Z)(n)){var r=u._0.exec(n);null!=r&&(e.size=Number(r[1]))}switch(t.writingMode){case"tb":case"tblr":e.vertical="lr";break;case"tbrl":e.vertical="rl"}var i=t.origin;if((0,o.Z)(i))u._0.exec(i);var a=t.align;if((0,o.Z)(a)){e.align=a,"center"===a&&("center"!==e.align&&(e.align="middle"),e.position="auto");var s=c[a];e.positionAlign=void 0===s?"":s;var l=d[a];e.lineAlign=void 0===l?"":l}}(y,r),y)}var v=function(e,t){for(var n=(0,r.Z)(e,t),i=[],a=0;a<n.length;a++){var o=f(n[a]);null!==o&&i.push(o)}return i}},959:function(e,t,n){"use strict";n.d(t,{Z:function(){return v}});var r=n(3274),i=n(6923),a=n(8026),o=n(3887),s=/(\d+) (\d+)/;var u=n(3791),l=n(5138),d=n(7714);var c=n(1594),f=["align","backgroundColor","color","direction","display","displayAlign","extent","fontFamily","fontSize","fontStyle","fontWeight","lineHeight","opacity","origin","overflow","padding","textAlign","textDecoration","textOutline","unicodeBidi","visibility","wrapOption","writingMode"];function v(e,t){var n=[],v=(new DOMParser).parseFromString(e,"text/xml");if(null!=v){var p=v.getElementsByTagName("tt")[0];if(void 0===p)if(void 0===(p=v.getElementsByTagNameNS("*","tt")[0]))throw new Error("invalid XML");for(var h=(0,c.H)(p),m=(0,c.vU)(p),g=(0,c.DM)(p),y=(0,c.kd)(p),_=function(e){var t=e.getAttribute("ttp:frameRate"),n=e.getAttribute("ttp:subFramRate"),r=e.getAttribute("ttp:tickRate"),a=e.getAttribute("ttp:frameRateMultiplier"),u=e.getAttribute("xml:space"),l=e.getAttribute("ttp:cellResolution"),d={columns:32,rows:15};if(null!==l){var c=s.exec(l);if(null===c||c.length<3)o.Z.warn("TTML Parser: Invalid cellResolution");else{var f=parseInt(c[1],10),v=parseInt(c[2],10);isNaN(f)||isNaN(v)?o.Z.warn("TTML Parser: Invalid cellResolution"):d={columns:f,rows:v}}}if((0,i.Z)(u)&&"default"!==u&&"preserve"!==u)throw new Error("Invalid spacing style");var p=Number(t);(isNaN(p)||p<=0)&&(p=30);var h=Number(n);(isNaN(h)||h<=0)&&(h=1);var m=Number(r);(isNaN(m)||m<=0)&&(m=void 0);var g=p,y=null!=h?h:1,_=null!==u?u:"default",b=void 0!==m?m:p*h;if(null!==a){var S=/^(\d+) (\d+)$/g.exec(a);null!==S&&(g=p*(Number(S[1])/Number(S[2])))}return{cellResolution:d,tickRate:b,frameRate:g,subFrameRate:y,spaceStyle:_}}(p),b=[],S=0;S<=m.length-1;S++){var E=m[S];if(E instanceof Element){var T=E.getAttribute("xml:id");if(null!==T){var w=E.getAttribute("style"),k=null===w?[]:w.split(" ");b.push({id:T,style:(0,u.b)(E),extendsStyles:k})}}}!function(e){var t=[];function n(r,i){t.push(i);for(var s=function(i){var s=r.extendsStyles[i],u=(0,l.Z)(e,(function(e){return e.id===s}));if(u<0)o.Z.warn("TTML Parser: unknown style inheritance: "+s);else{var c=e[u];(0,d.Z)(t,u)?o.Z.warn("TTML Parser: infinite style inheritance loop avoided"):n(c,u),r.style=(0,a.Z)({},c.style,r.style)}},u=0;u<r.extendsStyles.length;u++)s(u);r.extendsStyles.length=0}for(var r=0;r<e.length;r++)n(e[r],r),t.length=0}(b);for(var A=[],I=0;I<=g.length-1;I++){var R=g[I];if(R instanceof Element){var x=R.getAttribute("xml:id");null!==x&&function(){var e=(0,u.b)(R),t=R.getAttribute("style");if((0,i.Z)(t)){var n=(0,r.Z)(b,(function(e){return e.id===t}));void 0!==n&&(e=(0,a.Z)({},n.style,e))}A.push({id:x,style:e,extendsStyles:[]})}()}}for(var Z=(0,u.U)(f,null!==h?[h]:[],b,A),P="default"===(null!==h?h.getAttribute("xml:space"):void 0)||"default"===_.spaceStyle,M=0;M<y.length;M++){var C=y[M];if(C instanceof Element){var D=(0,c.jF)(C),O=(0,a.Z)({},Z,(0,u.U)(f,[C].concat(D),b,A)),N=C.getAttribute("xml:space"),L=(0,i.Z)(N)?"default"===N:P,U={paragraph:C,timeOffset:t,idStyles:b,regionStyles:A,body:h,paragraphStyle:O,ttParams:_,shouldTrimWhiteSpace:L};null!==U&&n.push(U)}}}return n}},5336:function(e,t,n){"use strict";n.d(t,{Dq:function(){return c},Du:function(){return s},GK:function(){return v},KO:function(){return i},YU:function(){return f},_0:function(){return l},eT:function(){return d},ev:function(){return p},gu:function(){return r},jb:function(){return o},te:function(){return u},wf:function(){return a}});var r=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,i=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,a=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d{2,})$/,o=/^(\d*\.?\d*)f$/,s=/^(\d*\.?\d*)t$/,u=/^(?:(\d*\.?\d*)h)?(?:(\d*\.?\d*)m)?(?:(\d*\.?\d*)s)?(?:(\d*\.?\d*)ms)?$/,l=/^(\d{1,2}|100)% (\d{1,2}|100)%$/,d=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%|rh|rw)$/,c=/^#([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})([0-9A-f]{2})$/,f=/^#([0-9A-f])([0-9A-f])([0-9A-f])([0-9A-f])$/,v=/^rgb\( *(\d+) *, *(\d+) *, *(\d+) *\)/,p=/^rgba\( *(\d+) *, *(\d+) *, *(\d+) *, *(\d+) *\)/},1594:function(e,t,n){"use strict";function r(e,t){if(!(e.parentNode instanceof Element))return[];return function e(n){var r=[];n.tagName.toLowerCase()===t.toLowerCase()&&r.push(n);var i=n.parentNode;return i instanceof Element&&r.push.apply(r,e(i)),r}(e.parentNode)}function i(e){var t=r(e,"div");if(0===t.length){var n=r(e,"tt:div");n.length>0&&(t=n)}return t}function a(e){var t=e.getElementsByTagName("body");if(t.length>0)return t[0];var n=e.getElementsByTagName("tt:body");return n.length>0?n[0]:null}function o(e){var t=e.getElementsByTagName("style");if(t.length>0)return t;var n=e.getElementsByTagName("tt:style");return n.length>0?n:t}function s(e){var t=e.getElementsByTagName("region");if(t.length>0)return t;var n=e.getElementsByTagName("tt:region");return n.length>0?n:t}function u(e){var t=e.getElementsByTagName("p");if(t.length>0)return t;var n=e.getElementsByTagName("tt:p");return n.length>0?n:t}function l(e){return"br"===e.nodeName||"tt:br"===e.nodeName}function d(e){return"span"===e.nodeName||"tt:span"===e.nodeName}n.d(t,{DM:function(){return s},H:function(){return a},OE:function(){return l},jF:function(){return i},jg:function(){return d},kd:function(){return u},vU:function(){return o}})},1138:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(6923),i=n(360);function a(e,t){for(var n=[],a=t;a<e.length;a++)if((0,i.tq)(e,a)){var o=(0,i.$4)(e,a);n.push(e.slice(a,o)),a=o}else if((0,r.Z)(e[a]))for(;(0,r.Z)(e[a]);)a++;return n}},4099:function(e,t,n){"use strict";n.d(t,{Z:function(){return I}});var r=n(1138),i=n(6923),a=n(360);var o=n(9525),s={white:"#ffffff",lime:"#00ff00",cyan:"#00ffff",red:"#ff0000",yellow:"#ffff00",magenta:"#ff00ff",blue:"#0000ff",black:"#000000"};function u(e){var t=Object.keys(s).reduce((function(e,t){return e[t]="color: "+s[t]+";",e["bg_"+t]="background-color: "+s[t]+";",e}),{}),n="";return e.forEach((function(e){if(e.length>=2)for(var r=1;r<e.length;r++){var a=e[r];if(Array.isArray(/::cue {/.exec(a)))for(a=e[++r];(0,i.Z)(a)&&!Array.isArray(/}/.exec(a))&&0!==a.length;)n+=a,a=e[++r];else!function(){for(var n=[],o=/::cue\(\.?(.*?)\)(?:,| {)/.exec(a);(0,i.Z)(a)&&Array.isArray(o);)n.push(o[1]),a=e[++r],o=/::cue\(\.?(.*?)\)(?:,| {)/.exec(a);for(var s="";(0,i.Z)(a)&&!Array.isArray(/}/.exec(a))&&0!==a.length;)s+=a,a=e[++r];n.forEach((function(e){void 0===t[e]?t[e]=s:t[e]+=s}))}()}})),{classes:t,global:n}}var l=n(7714);function d(e,t){var n,r=["u","i","b"],a=e.nodeName.toLowerCase().split(".")[0];if((0,l.Z)(["u","i","b","c","#text"],a))if("#text"===a){var o=e.wholeText.split("\n");n=document.createElement("span");for(var s=0;s<o.length;s++)if(s>0&&n.appendChild(document.createElement("br")),o[s].length>0){var u=document.createTextNode(o[s]);n.appendChild(u)}}else{var c=e.nodeName.toLowerCase().split("."),f=[];if(c.forEach((function(e){(0,i.Z)(t[e])&&f.push(t[e])})),0!==f.length){var v=document.createAttribute("style");f.forEach((function(e){v.value+=e}));var p=(0,l.Z)(r,a)?a:"span";(n=document.createElement(p)).setAttributeNode(v)}else{var h=(0,l.Z)(r,a)?a:"span";n=document.createElement(h)}for(var m=0;m<e.childNodes.length;m++){var g=d(e.childNodes[m],t);n.appendChild(g)}}else{n=document.createElement("span");for(var y=0;y<e.childNodes.length;y++){var _=d(e.childNodes[y],t);n.appendChild(_)}}return n}var c=n(1679);var f,v,p,h=function(e){if(!(void 0!==e&&0!==(0,c.Z)(e).length))return"text-align:center";var t=m(e),n=_(e);return"position: absolute;margin: 0;transform: translate("+t.offset+"%,"+n.offset+"%);width: "+T(e.size)+"%;left: "+t.position+"%;top: "+(null!==n.position?n.position+"%":"auto")+";text-align: "+E(e.align)+";"};!function(e){e.LINE_LEFT="line-left",e.CENTER="center",e.LINE_RIGHT="line-right"}(f||(f={})),function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(v||(v={})),function(e){e.START="start",e.CENTER="center",e.END="end"}(p||(p={}));var m=function(e){return{position:g(e),offset:y(e)}},g=function(e){var t,n=k(e.position);if(null!==n)return n;var r=E(e.align);return((t={})[v.LEFT]=0,t[v.CENTER]=50,t[v.RIGHT]=100,t)[r]},y=function(e){var t,n,r,i,a=((t={})[f.LINE_LEFT]=0,t[f.CENTER]=-50,t[f.LINE_RIGHT]=-100,t),o=void 0!==e.position?(r=e.position,i=/,(line-left|line-right|center)/.exec(r),!Array.isArray(i)||i.length<2?null:i[1]):null;return null!==o?a[o]:((n={})[v.LEFT]=0,n[v.CENTER]=-50,n[v.RIGHT]=-100,n)[void 0!==e.align?E(e.align):v.CENTER]},_=function(e){return{position:b(e.line),offset:S(e.line)}},b=function(e){return k(e)},S=function(e){var t,n=((t={})[p.START]=0,t[p.CENTER]=-50,t[p.END]=-100,t);if(void 0===e)return n[p.START];var r,i=(r=/,(start|center|end)/.exec(e),!Array.isArray(r)||r.length<2?null:r[1]);return null!==i?n[i]:n[p.START]},E=function(e){switch(e){case"left":case"start":return"left";case"right":case"end":return"right";default:return"center"}},T=function(e){return w(e,100)},w=function(e,t){var n=k(e);return null!==n?n:t},k=function(e){if(void 0===e)return null;var t=/^([\d.]+)%/.exec(e);return!Array.isArray(t)||t.length<2?null:parseInt(t[1],10)};function A(e,t){var n=e.start,r=e.end,a=e.settings,o=e.header,s=e.payload,u=document.createElement("div"),l=document.createAttribute("style");l.value="width:100%;height:100%;display:flex;flex-direction:column;justify-content:flex-end;align-items:center;",u.setAttributeNode(l);var c=document.createElement("p"),f=function(e){var t=document.createAttribute("style");return t.value=h(e),t}(a);c.setAttributeNode(f);var v=document.createElement("span"),p=document.createAttribute("style");p.value="background-color:rgba(0,0,0,0.8);color:white;",v.setAttributeNode(p);var m=t.global,g=t.classes,y=[m,(0,i.Z)(o)?g[o]:void 0].filter((function(e){return void 0!==e})).join("");return p.value+=y,v.setAttributeNode(p),function(e,t){for(var n=e.replace(/<[0-9]{2}:[0-9]{2}.[0-9]{3}>/,"").replace(/<([u,i,b,c])(\..*?)?(?: .*?)?>(.*?)<\/\1>/g,"<$1$2>$3</$1$2>"),r=(new DOMParser).parseFromString(n,"text/html").body.childNodes,i=[],a=0;a<r.length;a++)i.push(d(r[a],t));return i}(s.join("\n"),g).forEach((function(e){v.appendChild(e)})),u.appendChild(c),c.appendChild(v),{start:n,end:r,element:u}}var I=function(e,t){var n=e.split(/\r\n|\n|\r/g),s=[];if(null===/^WEBVTT( |\t|\n|\r|$)/.exec(n[0]))throw new Error("Can't parse WebVTT: Invalid File.");for(var l=(0,a.yE)(n),d=function(e,t){for(var n=[],r=t;r<e.length;r++)if((0,a.JF)(e,r)){var o=r;for(r++;(0,i.Z)(e[r]);)r++;var s=e.slice(o,r);n.push(s)}else if((0,i.Z)(e[r]))for(;(0,i.Z)(e[r]);)r++;return n}(n,l),c=(0,r.Z)(n,l),f=u(d),v=0;v<c.length;v++){var p=(0,o.Z)(c[v],t);if(null!=p){var h=A(p,f);s.push(h)}}return s}},9405:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(1988),i=n(1138),a=n(9525),o=n(360),s=n(7714),u=n(6923);function l(e,t){if(!(0,u.Z)(e.vertical)||"rl"!==e.vertical&&"lr"!==e.vertical||(t.vertical=e.vertical),(0,u.Z)(e.line)){var n=/^(\d+(\.\d+)?)%(,([a-z]+))?/.exec(e.line);if(Array.isArray(n))t.line=Number(n[1]),t.snapToLines=!1,(0,s.Z)(["start","center","end"],n[4])&&(t.lineAlign=n[4]);else{var r=/^(-?\d+)(,([a-z]+))?/.exec(e.line);Array.isArray(r)&&(t.line=Number(r[1]),t.snapToLines=!0,(0,s.Z)(["start","center","end"],r[3])&&(t.lineAlign=r[3]))}}if((0,u.Z)(e.position)){var i=/^([\d\.]+)%(?:,(line-left|line-right|center))?$/.exec(e.position);if(Array.isArray(i)&&i.length>=2){var a=parseInt(i[1],10);isNaN(a)||(t.position=a,void 0!==i[2]&&(t.positionAlign=i[2]))}}(0,u.Z)(e.size)&&(t.size=e.size),"string"==typeof e.align&&(0,s.Z)(["start","center","end","left"],e.align)&&(t.align=e.align)}var d=n(7253);var c=function(e,t){var n=e.split(/\r\n|\n|\r/);if(!/^WEBVTT($| |\t)/.test(n[0]))throw new Error("Can't parse WebVTT: Invalid file.");for(var s,u,c,f,v=(0,o.yE)(n),p=(0,i.Z)(n,v),h=[],m=0;m<p.length;m++){var g=(0,a.Z)(p[m],t);if(null!=g){var y=(u=void 0,c=void 0,f=void 0,u=(s=g).start,c=s.end,f=s.payload.join("\n"),(0,d.Z)(u,c,f));null!=y&&((0,r.Z)(y)&&l(g.settings,y),h.push(y))}}return h}},9525:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(6923);function i(e){var t=e.split(":").reverse();if((0,r.Z)(t[2])||(0,r.Z)(t[1])){var n=(0,r.Z)(t[2])?parseInt(t[2],10):0,i=parseInt(t[1],10),a=parseFloat(t[0].replace(",","."));if(isNaN(n)||isNaN(i)||isNaN(a))return;return 60*n*60+60*i+a}}function a(e,t){var n,r,a,o=/-->/;if(o.test(e[0]))n=e[0],r=e.slice(1,e.length);else{if(!o.test(e[1]))return null;a=e[0],n=e[1],r=e.slice(2,e.length)}var s=function(e){var t=/^([\d:.]+)[ |\t]+-->[ |\t]+([\d:.]+)[ |\t]*(.*)$/.exec(e);if(null===t)return null;var n=i(t[1]),r=i(t[2]);return null==n||null==r?null:{start:n,end:r,settings:t[3].split(/ |\t/).reduce((function(e,t){var n=t.split(":");return 2===n.length&&(e[n[0]]=n[1]),e}),{})}}(n);return null===s?null:{start:s.start+t,end:s.end+t,settings:s.settings,payload:r,header:a}}},360:function(e,t,n){"use strict";n.d(t,{$4:function(){return s},JF:function(){return a},tq:function(){return o},yE:function(){return i}});var r=n(6923);function i(e){for(var t=0;t<e.length;){if(""===e[t])return t+1;t++}return t}function a(e,t){return"string"==typeof e[t]&&/^STYLE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}function o(e,t){var n=e[t];if(void 0===n||""===n||a(e,t)||function(e,t){return"string"==typeof e[t]&&/^REGION( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}(e,t)||function(e,t){return"string"==typeof e[t]&&/^NOTE( .*)?$/g.test(e[t])&&(void 0===e[t+1]||e[t+1].indexOf("--\x3e")<0)}(e,t))return!1;if(n.indexOf("--\x3e")>=0)return!0;var r=e[t+1];return void 0!==r&&r.indexOf("--\x3e")>=0}function s(e,t){for(var n=t+1;(0,r.Z)(e[n]);)n++;return n}},2047:function(e,t,n){"use strict";n.d(t,{Z:function(){return te}});var r=n(7874),i=n(8791),a=n(6872),o=n(8750),s=n(3887),u=n(8619),l=n(8026),d=n(4597),c=n(3635);function f(e){var t=e.referenceDateTime,n=void 0!==e.serverSyncInfos?e.serverSyncInfos.serverTimestamp-e.serverSyncInfos.clientTime:void 0;return function(i,f,v,p,h){var m,g=i.responseData,y=f.externalClockOffset,_=null!==(m=i.url)&&void 0!==m?m:f.originalUrl,b=null!=n?n:y,S={unsafelyBaseOnPreviousManifest:f.unsafeMode?f.previousManifest:null,url:_,referenceDateTime:t,externalClockOffset:b},E=r.Z.dashParsers;if(null===E.wasm||"uninitialized"===E.wasm.status||"failure"===E.wasm.status)return s.Z.debug("DASH: WASM MPD Parser not initialized. Running JS one."),w();var T=function(e){if(e instanceof ArrayBuffer)return e;if("string"==typeof e)return(0,c.tG)(e).buffer;if(e instanceof Document)return(0,c.tG)(e.documentElement.innerHTML).buffer;throw new Error("DASH Manifest Parser: Unrecognized Manifest format")}(g);return function(e){var t=new DataView(e);if(61371===t.getUint16(0)&&191===t.getUint8(2))return!0;if(65279===t.getUint16(0)||65534===t.getUint16(0))return!1;return!0}(T)?"initialized"===E.wasm.status?(s.Z.debug("DASH: Running WASM MPD Parser."),k(E.wasm.runWasmParser(T,S))):(s.Z.debug("DASH: Awaiting WASM initialization before parsing the MPD."),E.wasm.waitForInitialization().catch((function(){})).then((function(){return null===E.wasm||"initialized"!==E.wasm.status?(s.Z.warn("DASH: WASM MPD parser initialization failed. Running JS parser instead"),w()):(s.Z.debug("DASH: Running WASM MPD Parser."),k(E.wasm.runWasmParser(T,S)))}))):(s.Z.info("DASH: MPD doesn't seem to be UTF-8-encoded. Running JS parser instead of the WASM one."),w());function w(){if(null===E.js)throw new Error("No MPD parser is imported");var e=function(e){if(e instanceof ArrayBuffer)return(new DOMParser).parseFromString((0,c.uR)(new Uint8Array(e)),"text/xml");if("string"==typeof e)return(new DOMParser).parseFromString(e,"text/xml");if(e instanceof Document)return e;throw new Error("DASH Manifest Parser: Unrecognized Manifest format")}(g);return k(E.js(e,S))}function k(t){if("done"===t.type)return t.value.warnings.length>0&&v(t.value.warnings),p.isCancelled?Promise.reject(p.cancellationError):{manifest:new u.ZP(t.value.parsed,e),url:_};var n=t.value,r=n.urls.map((function(e){return h((function(){var t=a.Z.getCurrent().DEFAULT_REQUEST_TIMEOUT;return"string"===n.format?(0,d.ZP)({url:e,responseType:"text",timeout:t,cancelSignal:p}):(0,d.ZP)({url:e,responseType:"arraybuffer",timeout:t,cancelSignal:p})})).then((function(e){if("string"===n.format){if("string"!=typeof e.responseData)throw new Error("External DASH resources should have been a string");return(0,l.Z)(e,{responseData:{success:!0,data:e.responseData}})}if(!(e.responseData instanceof ArrayBuffer))throw new Error("External DASH resources should have been ArrayBuffers");return(0,l.Z)(e,{responseData:{success:!0,data:e.responseData}})}),(function(e){var t=(0,o.Z)(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"An unknown error occured when parsing ressources."});return(0,l.Z)({},{size:void 0,requestDuration:void 0,responseData:{success:!1,error:t}})}))}));return Promise.all(r).then((function(e){return n.format,k(n.continue(e))}))}}}var v=n(7839),p=n(5861),h=n(4687),m=n.n(h),g=n(9105),y=n(5992),_=n(1946),b="function"==typeof Headers?Headers:null,S="function"==typeof AbortController?AbortController:null;function E(){return"function"==typeof window.fetch&&!(0,_.Z)(S)&&!(0,_.Z)(b)}var T=n(8806),w=n(281);function k(e,t){return"audio"===e||"video"===e?"video/mp4"===t||"audio/mp4"===t?"mp4":"video/webm"===t||"audio/webm"===t?"webm":void 0:"text"===e&&"application/mp4"===t?"mp4":void 0}var A=n(288),I=n(4460);function R(e){return function(t,n,r,i,a){return new Promise((function(s,u){var l=new A.ZP({cancelOn:i}),d=l.signal.register(u);e(t,n,r,l.signal,Object.assign(Object.assign({},a),{onNewChunk:function(e){try{o(e),a.onNewChunk(e)}catch(e){d(),l.cancel(),u(e)}}})).then((function(e){if(!l.isUsed){if(d(),"segment-loaded"===e.resultType)try{o(e.resultData.responseData)}catch(e){return void u(e)}s(e)}}),(function(e){d(),u(e)}))}));function o(e){(e instanceof ArrayBuffer||e instanceof Uint8Array)&&"mp4"===k(n.type,n.mimeType)&&(0,I.Z)(new Uint8Array(e),n.segment.isInit)}}}var x=n(9829);function Z(e,t){return null===e?null:null===t.url?e.baseUrl:(0,x.Z)(e.baseUrl,t.url)}var P=n(6968);function M(e,t,n,r,i){if(void 0===t.range)return(0,d.ZP)({url:e,responseType:"arraybuffer",timeout:n.timeout,cancelSignal:r,onProgress:i.onProgress}).then((function(e){return{resultType:"segment-loaded",resultData:e}}));if(void 0===t.indexRange)return(0,d.ZP)({url:e,headers:{Range:(0,w.Z)(t.range)},responseType:"arraybuffer",timeout:n.timeout,cancelSignal:r,onProgress:i.onProgress}).then((function(e){return{resultType:"segment-loaded",resultData:e}}));if(t.range[1]+1===t.indexRange[0])return(0,d.ZP)({url:e,headers:{Range:(0,w.Z)([t.range[0],t.indexRange[1]])},responseType:"arraybuffer",timeout:n.timeout,cancelSignal:r,onProgress:i.onProgress}).then((function(e){return{resultType:"segment-loaded",resultData:e}}));var a=(0,d.ZP)({url:e,headers:{Range:(0,w.Z)(t.range)},responseType:"arraybuffer",timeout:n.timeout,cancelSignal:r,onProgress:i.onProgress}),o=(0,d.ZP)({url:e,headers:{Range:(0,w.Z)(t.indexRange)},responseType:"arraybuffer",timeout:n.timeout,cancelSignal:r,onProgress:i.onProgress});return Promise.all([a,o]).then((function(t){var n=t[0],r=t[1],i=(0,P.zo)(new Uint8Array(n.responseData),new Uint8Array(r.responseData)),a=Math.min(n.sendingTime,r.sendingTime),o=Math.max(n.receivedTime,r.receivedTime);return{resultType:"segment-loaded",resultData:{url:e,responseData:i,size:n.size+r.size,requestDuration:o-a,sendingTime:a,receivedTime:o}}}))}var C=n(8766);function D(e,t,n,r,i){var a=t.segment,o=void 0!==a.range?{Range:(0,w.Z)(a.range)}:void 0,u=null;return function(e){var t;if(!(0,_.Z)(e.headers))if((0,_.Z)(b))t=e.headers;else{t=new b;for(var n=Object.keys(e.headers),r=0;r<n.length;r++){var i=n[r];t.append(i,e.headers[i])}}s.Z.debug("Fetch: Called with URL",e.url);var a,o=null,u=!1,l=performance.now(),d=(0,_.Z)(S)?null:new S;function c(){(0,_.Z)(d)?s.Z.warn("Fetch: AbortController API not available."):d.abort()}void 0!==e.timeout&&(a=window.setTimeout((function(){u=!0,c()}),e.timeout));var f=e.cancelSignal.register((function(e){o=e,c()})),v={method:"GET"};return void 0!==t&&(v.headers=t),v.signal=(0,_.Z)(d)?null:d.signal,fetch(e.url,v).then((function(t){if((0,_.Z)(a)||clearTimeout(a),t.status>=300)throw s.Z.warn("Fetch: Request HTTP Error",t.status,t.url),new g.Z(t.url,t.status,y.br.ERROR_HTTP_CODE);if((0,_.Z)(t.body))throw new g.Z(t.url,t.status,y.br.PARSE_ERROR);var n=t.headers.get("Content-Length"),r=(0,_.Z)(n)||isNaN(+n)?void 0:+n,i=t.body.getReader(),o=0;return u();function u(){return d.apply(this,arguments)}function d(){return(d=(0,p.Z)(m().mark((function n(){var a,s,d,c,v;return m().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,i.read();case 2:if((a=n.sent).done||(0,_.Z)(a.value)){n.next=11;break}return o+=a.value.byteLength,s=performance.now(),d={url:t.url,currentTime:s,duration:s-l,sendingTime:l,chunkSize:a.value.byteLength,chunk:a.value.buffer,size:o,totalSize:r},e.onData(d),n.abrupt("return",u());case 11:if(!a.done){n.next=16;break}return f(),c=performance.now(),v=c-l,n.abrupt("return",{requestDuration:v,receivedTime:c,sendingTime:l,size:o,status:t.status,url:t.url});case 16:return n.abrupt("return",u());case 17:case"end":return n.stop()}}),n)})))).apply(this,arguments)}})).catch((function(t){if(null!==o)throw o;if(f(),u)throw s.Z.warn("Fetch: Request timeouted."),new g.Z(e.url,0,y.br.TIMEOUT);if(t instanceof g.Z)throw t;throw s.Z.warn("Fetch: Request Error",t instanceof Error?t.toString():""),new g.Z(e.url,0,y.br.ERROR_EVENT)}))}({url:e,headers:o,onData:function(e){var t=new Uint8Array(e.chunk),n=function(e){for(var t=0,n=[];t<e.length;){var r=e.subarray(t,1/0),i=(0,C.Z)(r,1836019558);if(i<0)return[n,r];var a=t+i+(0,P.pX)(e,i+t);if(a>e.length)return[n,r];var o=(0,C.Z)(r,1835295092);if(o<0)return[n,r];var s=t+o+(0,P.pX)(e,o+t);if(s>e.length)return[n,r];var u=Math.max(a,s),l=e.subarray(t,u);n.push(l),t=u}return[n,null]}(null!==u?(0,P.zo)(u,t):t),a=n[0];u=n[1];for(var o=0;o<a.length;o++)if(r.onNewChunk(a[o]),i.isCancelled)return;r.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize}),i.isCancelled},timeout:n.timeout,cancelSignal:i}).then((function(e){return{resultType:"chunk-complete",resultData:e}}))}function O(e,t,n,r,i,a){if(t.segment.isInit)return M(e,t.segment,r,a,i);var o=k(t.type,t.mimeType);if(n&&("mp4"===o||void 0===o)){if(E())return D(e,t,r,i,a);(0,T.Z)("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}var s=t.segment;return(0,d.ZP)({url:e,responseType:"arraybuffer",headers:void 0!==s.range?{Range:(0,w.Z)(s.range)}:void 0,timeout:r.timeout,cancelSignal:a,onProgress:i.onProgress}).then((function(e){return{resultType:"segment-loaded",resultData:e}}))}var N=n(6490),L=n(4644),U=408125543,B=357149030;function F(e,t,n,r){for(var i=r[0],a=r[1],o=i;o<a;){var s=G(n,o);if(null==s)return null;var u=s.value,l=o+s.length,d=W(n,l);if(null==d)return null;var c=d,f=l+c.length,v=f+c.value;if(u===e)return[f,v];if(t.length>0)for(var p=0;p<t.length;p++){if(u===t[p])return F(e,t.slice(p+1,t.length),n,[f,v])}o=v}return null}function z(e,t){var n=F(2807729,[U,B],e,[t,e.length]);if(null==n)return null;var r=n[1]-n[0];return 1e9/H(e,n[0],r)}function V(e,t){var n=F(17545,[U,B],e,[t,e.length]);if(null==n)return null;var r=n[1]-n[0];return 4===r?function(e,t){return new DataView(e.buffer).getFloat32(t)}(e,n[0]):8===r?function(e,t){return new DataView(e.buffer).getFloat64(t)}(e,n[0]):null}function K(e,t){for(var n=1;n<=8;n++)if(e[t]>=Math.pow(2,8-n))return n}function G(e,t){var n=K(e,t);if(null==n)return s.Z.warn("webm: unrepresentable length"),null;if(t+n>e.length)return s.Z.warn("webm: impossible length"),null;for(var r=0,i=0;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return{length:n,value:r}}function W(e,t){var n=K(e,t);if(null==n)return s.Z.warn("webm: unrepresentable length"),null;if(t+n>e.length)return s.Z.warn("webm: impossible length"),null;for(var r=(e[t]&(1<<8-n)-1)*Math.pow(2,8*(n-1)),i=1;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return{length:n,value:r}}function H(e,t,n){for(var r=0,i=0;i<n;i++)r=e[t+i]*Math.pow(2,8*(n-i-1))+r;return r}var j=n(5278);function q(e,t,n,r){var i=(0,L.Qx)(e);if(void 0===i||void 0===r)return null;var a,o=void 0!==n.timestampOffset?i+n.timestampOffset*r:i,u=(0,L.MM)(e);if(o<0&&(void 0!==u&&(u+=o),o=0),t||!n.complete)return void 0===u&&s.Z.warn("DASH: Chunked segments should indicate a duration through their trun boxes"),{time:o/r,duration:void 0!==u?u/r:void 0};var l=n.duration*r,d=Math.min(.9*r,l/4);return void 0!==u&&Math.abs(u-l)<=d&&(a=u),{time:o/r,duration:void 0!==a?a/r:a}}function Y(e,t){if(0!==e.length){var n=e.reduce((function(e,t){return"urn:mpeg:dash:event:2012"===t.schemeIdUri&&"1"===t.value?(void 0===e.manifestRefreshEventsFromEMSGs&&(e.manifestRefreshEventsFromEMSGs=[]),e.manifestRefreshEventsFromEMSGs.push(t)):(void 0===e.EMSGs&&(e.EMSGs=[]),e.EMSGs.push(t)),e}),{manifestRefreshEventsFromEMSGs:void 0,EMSGs:void 0}),r=n.manifestRefreshEventsFromEMSGs,i=n.EMSGs,a=null==i?void 0:i.map((function(e){return{type:"emsg",value:e}})),o=void 0!==t&&void 0!==r&&function(e,t){if(e.length<=0)return!1;for(var n=e.length,r=0;r<n;r++){var i=t,a=e[r].messageData,o=(0,c.uR)(a),s=Date.parse(o);if(void 0===i||void 0===s||isNaN(s)||s>=i)return!0}return!1}(r,t);return{inbandEvents:a,needsManifestRefresh:o}}}function X(e){var t=e.__priv_patchLastSegmentInSidx;return function(e,n,r){var i,a=n.segment,o=n.periodStart,s=n.periodEnd,u=e.data,l=e.isChunked,d=[o,s];if(null===u)return a.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkSize:0,chunkInfos:null,chunkOffset:0,protectionData:[],appendWindow:d};var c=u instanceof Uint8Array?u:new Uint8Array(u),f=k(n.type,n.mimeType),v="mp4"===f||void 0===f,p=[];if(v){var h,m=(0,N.Z)(c);a.isInit&&(h=null!==(i=(0,L.R0)(c))&&void 0!==i?i:void 0),(m.length>0||void 0!==h)&&p.push({initDataType:"cenc",keyId:h,initData:m})}if(!a.isInit){var g=v?q(c,l,a,r):null,y=(0,j.Z)(a.timestampOffset,0);if(v){var b=(0,L.s9)(c);if(void 0!==b){var S=Y(b.filter((function(e){return void 0!==a.privateInfos&&void 0!==a.privateInfos.isEMSGWhitelisted&&a.privateInfos.isEMSGWhitelisted(e)})),n.manifestPublishTime);if(void 0!==S){var E=S.needsManifestRefresh,T=S.inbandEvents;return{segmentType:"media",chunkData:c,chunkSize:c.length,chunkInfos:g,chunkOffset:y,appendWindow:d,inbandEvents:T,protectionData:p,needsManifestRefresh:E}}}}return{segmentType:"media",chunkData:c,chunkSize:c.length,chunkInfos:g,chunkOffset:y,protectionData:p,appendWindow:d}}var w,A=a.indexRange;if("webm"===f)w=function(e,t){var n=F(U,[],e,[t,e.length]);if(null==n)return null;var r=n[0],i=n[1],a=z(e,r);if(null==a)return null;var o=V(e,r);if(null==o)return null;var s=F(475249515,[],e,[r,i]);if(null==s)return null;for(var u=[],l=s[0];l<s[1];){var d=F(187,[],e,[l,s[1]]);if(null==d)break;var c=F(179,[],e,[d[0],d[1]]);if(null==c)return null;var f=H(e,c[0],c[1]-c[0]),v=F(241,[183],e,[d[0],d[1]]);if(null==v)return null;var p=H(e,v[0],v[1]-v[0])+r;u.push({time:f,rangeStart:p}),l=d[1]}for(var h=[],m=0;m<u.length;m++){var g=u[m];m===u.length-1?h.push({time:g.time,timescale:a,duration:0===m?o:o-g.time,range:[g.rangeStart,1/0]}):h.push({time:g.time,timescale:a,duration:u[m+1].time-g.time,range:[g.rangeStart,u[m+1].rangeStart-1]})}return h}(c,0);else if(v&&(w=(0,L.Wf)(c,Array.isArray(A)?A[0]:0),!0===t&&null!==w&&w.length>0)){var I=w[w.length-1];Array.isArray(I.range)&&(I.range[1]=1/0)}var R=v?(0,L.LD)(c):"webm"===f?z(c,0):void 0,x=(0,_.Z)(R)?void 0:R;return{segmentType:"init",initializationData:c,initializationDataSize:c.length,protectionData:p,initTimescale:x,segmentList:null!=w?w:void 0}}}var $=n(6807);function Q(e,t,n,r){var i,a,o=e.segment,u=e.language,l=e.codecs;if(o.isInit)return null;null===n?r?(i=o.time,a=o.end):s.Z.warn("Transport: Unavailable time data for current text track."):(i=n.time,void 0!==n.duration?a=i+n.duration:!r&&o.complete&&(a=i+o.duration));var d=function(e){if(void 0===e)throw new Error("Cannot parse subtitles: unknown format");switch(e.toLowerCase()){case"stpp":case"stpp.ttml.im1t":return"ttml";case"wvtt":return"vtt"}throw new Error('The codec used for the subtitles "'+e+'" is not managed yet.')}(l),f=function(e){var t=(0,$.Le)(e);return null===t?"":(0,c.uR)(t)}(t);return{data:f,type:d,language:u,start:i,end:a}}function J(e,t,n){var r,i,a=e.segment;return a.isInit?null:(n?s.Z.warn("Transport: Unavailable time data for current text track."):(r=a.time,a.complete&&(i=a.time+a.duration)),{data:t,type:function(e,t){switch(t){case"application/ttml+xml":return"ttml";case"application/x-sami":case"application/smil":return"sami";case"text/vtt":return"vtt"}if(void 0!==e&&"srt"===e.toLowerCase())return"srt";throw new Error("could not find a text-track parser for the type "+(null!=t?t:""))}(e.codecs,e.mimeType),language:e.language,start:r,end:i})}function ee(e){var t=e.__priv_patchLastSegmentInSidx;return function(e,n,r){var i,a=n.periodStart,o=n.periodEnd,s=n.segment,u=e.data,l=e.isChunked;if(null===u)return s.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkSize:0,chunkInfos:null,chunkOffset:null!==(i=s.timestampOffset)&&void 0!==i?i:0,protectionData:[],appendWindow:[a,o]};var d=k(n.type,n.mimeType);if("webm"===d)throw new Error("Text tracks with a WEBM container are not yet handled.");return"mp4"===d?function(e,t,n,r,i){var a=n.segment,o=a.isInit,s=a.indexRange,u="string"==typeof e?(0,c.tG)(e):e instanceof Uint8Array?e:new Uint8Array(e);if(o){var l=(0,L.Wf)(u,Array.isArray(s)?s[0]:0);if(!0===i&&null!==l&&l.length>0){var d=l[l.length-1];Array.isArray(d.range)&&(d.range[1]=1/0)}return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:(0,L.LD)(u),segmentList:null!=l?l:void 0}}var f=q(u,t,a,r),v=Q(n,u,f,t),p=(0,j.Z)(a.timestampOffset,0);return{segmentType:"media",chunkData:v,chunkSize:u.length,chunkInfos:f,chunkOffset:p,protectionData:[],appendWindow:[n.periodStart,n.periodEnd]}}(u,l,n,r,t):function(e,t,n){var r,i,a=n.periodStart,o=n.periodEnd,s=n.segment,u=s.timestampOffset,l=void 0===u?0:u;if(s.isInit)return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0};if("string"!=typeof e){var d=e instanceof Uint8Array?e:new Uint8Array(e);r=(0,c.uR)(d),i=d.length}else r=e;return{segmentType:"media",chunkData:J(n,r,t),chunkSize:i,chunkInfos:null,chunkOffset:l,protectionData:[],appendWindow:[a,o]}}(u,l,n)}}var te=function(e){var t=(0,i.Z)({customManifestLoader:e.manifestLoader},null===r.Z.dashParsers.wasm||"initialized"!==r.Z.dashParsers.wasm.status&&"initializing"!==r.Z.dashParsers.wasm.status?"arraybuffer":"text"),n=f(e),a=function(e){var t=e.lowLatencyMode,n=e.segmentLoader;return!0!==e.checkMediaSegmentIntegrity?r:R(r);function r(e,r,i,a,o){var s=Z(e,r.segment);return null==s?Promise.resolve({resultType:"segment-created",resultData:null}):t||void 0===n?O(s,r,t,i,o,a):new Promise((function(e,u){var l=!1,d={reject:function(e){var t,n,r;if(!l&&!a.isCancelled){l=!0,a.deregister(p);var i=e,o=null!==(t=null==i?void 0:i.message)&&void 0!==t?t:"Unknown error when fetching a DASH segment through a custom segmentLoader.",s=new v.Z(o,null!==(n=null==i?void 0:i.canRetry)&&void 0!==n&&n,null!==(r=null==i?void 0:i.isOfflineError)&&void 0!==r&&r,null==i?void 0:i.xhr);u(s)}},resolve:function(t){l||a.isCancelled||(l=!0,a.deregister(p),e({resultType:"segment-loaded",resultData:{responseData:t.data,size:t.size,requestDuration:t.duration}}))},progress:function(e){l||a.isCancelled||o.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize})},fallback:function(){l||a.isCancelled||(l=!0,a.deregister(p),O(s,r,t,i,o,a).then(e,u))}},c={isInit:r.segment.isInit,timeout:i.timeout,range:r.segment.range,indexRange:r.segment.indexRange,type:r.type,url:s},f=n(c,d);function p(e){l||(l=!0,"function"==typeof f&&f(),u(e))}a.register(p)}))}}(e),o=X(e),s=function(e){var t=e.lowLatencyMode;return!0!==e.checkMediaSegmentIntegrity?n:R(n);function n(e,n,r,i,a){var o=n.segment,s=o.range,u=Z(e,o);if(null===u)return Promise.resolve({resultType:"segment-created",resultData:null});if(o.isInit)return M(u,o,r,i,a);var l=k(n.type,n.mimeType),c="mp4"===l||void 0===l;if(t&&c){if(E())return D(u,n,r,a,i);(0,T.Z)("DASH: Your browser does not have the fetch API. You will have a higher chance of rebuffering when playing close to the live edge")}return c?(0,d.ZP)({url:u,responseType:"arraybuffer",headers:Array.isArray(s)?{Range:(0,w.Z)(s)}:null,timeout:r.timeout,onProgress:a.onProgress,cancelSignal:i}).then((function(e){return{resultType:"segment-loaded",resultData:e}})):(0,d.ZP)({url:u,responseType:"text",headers:Array.isArray(s)?{Range:(0,w.Z)(s)}:null,timeout:r.timeout,onProgress:a.onProgress,cancelSignal:i}).then((function(e){return{resultType:"segment-loaded",resultData:e}}))}}(e);return{manifest:{loadManifest:t,parseManifest:n},audio:{loadSegment:a,parseSegment:o},video:{loadSegment:a,parseSegment:o},text:{loadSegment:s,parseSegment:ee(e)}}}},5418:function(e,t,n){"use strict";n.d(t,{Z:function(){return le}});var r=n(3887),i=n(8619),a=n(6807),o=n(9665),s=n(7714),u=n(811),l=n(6968),d=n(6923),c=n(8026),f=n(9829),v=n(3635),p=n(5278),h=n(2689),m={};function g(e){if(null!=m[e])return m[e];var t=(0,v.tG)(e);return m[e]=t,t}function y(e,t){var n=t.length+8;return n<=h.s?(0,l.zo)((0,l.kh)(n),g(e),t):(0,l.zo)((0,l.kh)(1),g(e),(0,l.el)(n+8),t)}function _(e,t){return y(e,l.zo.apply(void 0,t))}function b(e){var t=[];e.periods.forEach((function(n){var i=n.id;if((0,s.Z)(t,i)){r.Z.warn("Two periods with the same ID found. Updating.");var a=i+"-dup";n.id=a,b(e),t.push(a)}else t.push(i);var o=n.adaptations,u=[];Object.keys(o).forEach((function(t){var n=o[t];void 0!==n&&n.forEach((function(t){var n=t.id;if((0,s.Z)(u,n)){r.Z.warn("Two adaptations with the same ID found. Updating.",n);var i=n+"-dup";t.id=i,b(e),u.push(i)}else u.push(n);var a=[];t.representations.forEach((function(t){var n=t.id;if((0,s.Z)(a,n)){r.Z.warn("Two representations with the same ID found. Updating.",n);var i=n+"-dup";t.id=i,b(e),a.push(i)}else a.push(n)}))}))}))}))}var S=n(9689);function E(e){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:(0,l.zo)([8,1,18,16],e)}]}function T(e,t){if(void 0===t&&(t=E),null===e.firstElementChild||"ProtectionHeader"!==e.firstElementChild.nodeName)throw new Error("Protection should have ProtectionHeader child");var n=e.firstElementChild,r=(0,S.K)(null===n.textContent?"":n.textContent),i=function(e){var t=(0,l.qb)(e,8),n=(0,v.wV)(e.subarray(10,t+10)),r=(new DOMParser).parseFromString(n,"application/xml").querySelector("KID");if(null===r)throw new Error("Cannot parse PlayReady private data: invalid XML");var i=null===r.textContent?"":r.textContent,a=(0,v.wO)((0,S.K)(i));return(0,v.ci)(a).toLowerCase()}(r),a=(0,v.nr)(i),o=n.getAttribute("SystemID");return{keyId:a,keySystems:[{systemId:(null!==o?o:"").toLowerCase().replace(/\{|\}/g,""),privateData:r}].concat(t(a))}}var w=n(9362),k=n(3911),A=n(1091);function I(e,t){return e.replace(/\{start time\}/g,String(t))}function R(e,t,n){var r=t-e;return r>0?Math.floor(r/n):0}function x(e,t){var n=e.repeatCount;if(void 0!==e.duration&&n<0){var r=void 0!==t?t.start:1/0;n=Math.ceil((r-e.start)/e.duration)-1}return n}var Z=function(){function e(e){var t=e.isLive,n=e.segmentPrivateInfos,r=e.media,i=e.sharedSmoothTimeline;if(this._sharedSmoothTimeline=i,this._initSegmentInfos={bitsPerSample:n.bitsPerSample,channels:n.channels,codecPrivateData:n.codecPrivateData,packetSize:n.packetSize,samplingRate:n.samplingRate,timescale:i.timescale,height:n.height,width:n.width,protection:n.protection},this._isLive=t,this._media=r,0!==i.timeline.length&&t){var a=i.timeline,o=i.validityTime,s=a[a.length-1],u=(0,k.jH)(s,null),l=o/1e3*i.timescale;this._scaledLiveGap=l-u}}var t=e.prototype;return t.getInitSegment=function(){return{id:"init",isInit:!0,privateInfos:{smoothInitSegment:this._initSegmentInfos},url:null,time:0,end:0,duration:0,timescale:1,complete:!0}},t.getSegments=function(e,t){this._refreshTimeline();for(var n,r=this._sharedSmoothTimeline,i=r.timescale,a=r.timeline,o=function(e,t,n){var r=void 0===e||0===e?1:e;return{up:t*r,to:(t+n)*r}}(i,e,t),s=o.up,u=o.to,l=this._media,d=[],c=a.length,f=void 0===this._scaledLiveGap?void 0:performance.now()/1e3*i-this._scaledLiveGap,v=0;v<c;v++){for(var p=a[v],h=p.duration,m=p.start,g=x(p,a[v+1]),y=R(m,s,h),_=m+y*h,b=h;_<u&&y<=g&&(void 0===f||_+b<=f);){var S=_,E=void 0!==n?n+y:void 0,T={id:String(_),isInit:!1,time:S/i,end:(S+h)/i,duration:h/i,timescale:1,number:E,url:I(l,S),complete:!0,privateInfos:{smoothMediaSegment:{time:S,duration:h}}};d.push(T),_=m+ ++y*h}if(_>=u)return d;void 0!==n&&(n+=g+1)}return d},t.shouldRefresh=function(e,t){if(this._refreshTimeline(),!this._isLive)return!1;var n=this._sharedSmoothTimeline,r=n.timeline,i=n.timescale,a=r[r.length-1];if(void 0===a)return!1;var o=a.repeatCount,s=a.start+(o+1)*a.duration;return!(t*i<s)&&(e*i>=s||e*i>a.start+o*a.duration)},t.getFirstAvailablePosition=function(){this._refreshTimeline();var e=this._sharedSmoothTimeline,t=e.timeline,n=e.timescale;return 0===t.length?null:t[0].start/n},t.getLastAvailablePosition=function(){this._refreshTimeline();var e=this._sharedSmoothTimeline,t=e.timeline,n=e.timescale;if(void 0===this._scaledLiveGap){var r=t[t.length-1];return(0,k.jH)(r,null)/n}for(var i=t.length-1;i>=0;i--)for(var a=t[i],o=performance.now()/1e3*n,s=a.start,u=a.duration,l=a.repeatCount;l>=0;l--){var d=s+u*(l+1);if(d<=o-this._scaledLiveGap)return d/n}},t.getEnd=function(){if(!this._isLive)return this.getLastAvailablePosition()},t.awaitSegmentBetween=function(e,t){var n;if((0,u.Z)(e<=t),this.isFinished())return!1;var r=this.getLastAvailablePosition();return!(void 0!==r&&t<r)&&(t>(null!==(n=this.getFirstAvailablePosition())&&void 0!==n?n:0)&&void 0)},t.checkDiscontinuity=function(e){return this._refreshTimeline(),(0,k._j)(this._sharedSmoothTimeline,e,void 0)},t.isSegmentStillAvailable=function(e){if(e.isInit)return!0;this._refreshTimeline();var t=this._sharedSmoothTimeline,n=t.timeline,r=t.timescale;return(0,A.Z)(e,n,r,0)},t.canBeOutOfSyncError=function(e){return!!this._isLive&&(e instanceof w.Z&&(e.isHttpError(404)||e.isHttpError(412)))},t._replace=function(e){this._initialScaledLastPosition=e._initialScaledLastPosition,this._scaledLiveGap=e._scaledLiveGap,this._sharedSmoothTimeline.replace(e._sharedSmoothTimeline)},t._update=function(e){this._scaledLiveGap=e._scaledLiveGap,this._sharedSmoothTimeline.update(e._sharedSmoothTimeline)},t.isFinished=function(){return!this._isLive},t.isInitialized=function(){return!0},t.initialize=function(){r.Z.error("A `SmoothRepresentationIndex` does not need to be initialized")},t.addPredictedSegments=function(e,t){this._sharedSmoothTimeline.addPredictedSegments(e,t)},t._refreshTimeline=function(){this._sharedSmoothTimeline.refresh()},e}(),P=n(8232),M=n(5505);function C(e,t,n,r){var i=e[e.length-1],a=n.timescale===t?{time:n.time,duration:n.duration}:{time:n.time/n.timescale*t,duration:n.duration/n.timescale*t};return!(r.time===a.time)&&(a.time>=(0,k.jH)(i,null)&&(i.duration===a.duration?i.repeatCount++:e.push({duration:a.duration,start:a.time,repeatCount:0}),!0))}var D=function(){function e(e){var t=e.timeline,n=e.timescale,r=e.timeShiftBufferDepth,i=e.manifestReceivedTime;this.timeline=t,this.timescale=n;var a=null!=i?i:performance.now();if(this.validityTime=a,this._timeShiftBufferDepth=r,0!==t.length){var o=t[t.length-1],s=(0,k.jH)(o,null);this._initialScaledLastPosition=s}}var t=e.prototype;return t.refresh=function(){if(void 0!==this._initialScaledLastPosition){var e=this._timeShiftBufferDepth,t=(performance.now()-this.validityTime)/1e3+this._initialScaledLastPosition/this.timescale;if(void 0!==e){var n=(t-e)*this.timescale;(0,P.Z)(this.timeline,n)}}},t.replace=function(e){var t=this.timeline,n=e.timeline,i=this.timescale,a=e.timescale;if(this._initialScaledLastPosition=e._initialScaledLastPosition,this.validityTime=e.validityTime,0!==t.length&&0!==n.length&&i===a){var o=t[t.length-1],s=n[n.length-1],u=(0,k.jH)(s,null);if(!((0,k.jH)(o,null)<=u))for(var l=0;l<t.length;l++){var d=t[l],c=(0,k.jH)(d,null);if(c===u)return void(this.timeline=this.timeline.concat(t.slice(l+1)));if(c>u){if(d.duration!==s.duration)return;var f=u-d.start;if(0===f)return r.Z.warn("Smooth Parser: a discontinuity detected in the previous manifest has been resolved."),void(this.timeline=this.timeline.concat(t.slice(l)));if(f<0||f%d.duration!=0)return;var v=f/d.duration-1,p=d.repeatCount-v;if(p<0)return;s.repeatCount+=p;var h=t.slice(l+1);return void(this.timeline=this.timeline.concat(h))}}}},t.update=function(e){(0,M.Z)(this.timeline,e.timeline),this._initialScaledLastPosition=e._initialScaledLastPosition,this.validityTime=e.validityTime},t.addPredictedSegments=function(e,t){var n;if(void 0!==(null===(n=t.privateInfos)||void 0===n?void 0:n.smoothMediaSegment)){this.refresh();for(var i=0;i<e.length;i++)C(this.timeline,this.timescale,e[i],t.privateInfos.smoothMediaSegment)}else r.Z.warn("Smooth Parser: should only encounter SmoothRepresentationIndex")},e}();function O(e,t,n){for(var r=e.firstElementChild,i=n;null!==r;)i=t(i,r.nodeName,r),r=r.nextElementSibling;return i}var N={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},L={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4",DFXP:"application/ttml+xml+mp4"};var U=function(e){void 0===e&&(e={});var t=void 0===e.referenceDateTime?Date.UTC(1970,0,1,0,0,0,0)/1e3:e.referenceDateTime,n=void 0===e.minRepresentationBitrate?0:e.minRepresentationBitrate,i=e.serverSyncInfos,a=void 0!==i?i.serverTimestamp-i.clientTime:void 0;function h(e,t){var n=O(e,(function(e,t,n){return"CustomAttributes"===t&&e.push.apply(e,O(n,(function(e,t,n){if("Attribute"===t){var r=n.getAttribute("Name"),i=n.getAttribute("Value");null!==r&&null!==i&&e.push(r+"="+i)}return e}),[])),e}),[]);function i(t){var n=e.getAttribute(t);return null==n?void 0:n}switch(t){case"audio":var a=i("AudioTag"),o=i("BitsPerSample"),s=i("Channels"),u=i("CodecPrivateData"),l=i("FourCC"),c=i("PacketSize"),f=i("SamplingRate"),v=i("Bitrate"),h=void 0===v||isNaN(parseInt(v,10))?0:parseInt(v,10);if(void 0!==l&&void 0===L[l]||void 0===u)return r.Z.warn("Smooth parser: Unsupported audio codec. Ignoring quality level."),null;var m=function(e,t){var n;return 0==(n="AACH"===t?5:(0,d.Z)(e)?(248&parseInt(e.substring(0,2),16))>>3:2)?"mp4a.40.2":"mp4a.40."+n}(u,l);return{audiotag:void 0!==a?parseInt(a,10):a,bitrate:h,bitsPerSample:void 0!==o?parseInt(o,10):o,channels:void 0!==s?parseInt(s,10):s,codecPrivateData:u,codecs:m,customAttributes:n,mimeType:void 0!==l?L[l]:l,packetSize:void 0!==c?parseInt(c,10):c,samplingRate:void 0!==f?parseInt(f,10):f};case"video":var g=i("CodecPrivateData"),y=i("FourCC"),_=i("MaxWidth"),b=i("MaxHeight"),S=i("Bitrate"),E=void 0===S||isNaN(parseInt(S,10))?0:parseInt(S,10);if(void 0!==y&&void 0===L[y]||void 0===g)return r.Z.warn("Smooth parser: Unsupported video codec. Ignoring quality level."),null;var T=function(e){var t=/00000001\d7([0-9a-fA-F]{6})/.exec(e);return null!==t&&(0,d.Z)(t[1])?"avc1."+t[1]:"avc1.4D401E"}(g);return{bitrate:E,customAttributes:n,mimeType:void 0!==y?L[y]:y,codecPrivateData:g,codecs:T,width:void 0!==_?parseInt(_,10):void 0,height:void 0!==b?parseInt(b,10):void 0};case"text":var w=i("CodecPrivateData"),k=i("FourCC"),A=i("Bitrate");return{bitrate:void 0===A||isNaN(parseInt(A,10))?0:parseInt(A,10),customAttributes:n,mimeType:void 0!==k?L[k]:k,codecPrivateData:(0,p.Z)(w,"")};default:return r.Z.error("Smooth Parser: Unrecognized StreamIndex type: "+t),null}}function m(e){var t=e.root,i=e.timescale,a=e.baseUrl,f=e.protections,p=e.timeShiftBufferDepth,m=e.manifestReceivedTime,g=e.isLive,_=t.getAttribute("Timescale"),b=null===_||isNaN(+_)?i:+_,S=t.getAttribute("Type");if(null===S)throw new Error("StreamIndex without type.");(0,s.Z)(o.r,S)||r.Z.warn("Smooth Parser: Unrecognized adaptation type:",S);var E=S,T=t.getAttribute("Subtype"),w=t.getAttribute("Language"),k=t.getAttribute("Url"),A=null===k?"":k;var I,R=O(t,(function(e,t,r){switch(t){case"QualityLevel":var i=h(r,E);if(null===i)return e;("video"!==E||i.bitrate>n)&&e.qualityLevels.push(i);break;case"c":e.cNodes.push(r)}return e}),{qualityLevels:[],cNodes:[]}),x=R.qualityLevels,P=R.cNodes,M=new D({timeline:(I=P,I.reduce((function(e,t,n){var r=t.getAttribute("d"),i=t.getAttribute("t"),a=t.getAttribute("r"),o=null!==a?+a-1:0,s=null!==i?+i:void 0,u=null!==r?+r:void 0;if(0===n)s=void 0===s||isNaN(s)?0:s;else{var l=e[n-1];if(null==s||isNaN(s)){if(null==l.duration||isNaN(l.duration))throw new Error("Smooth: Invalid CNodes. Missing timestamp.");s=l.start+l.duration*(l.repeatCount+1)}}if(null==u||isNaN(u)){var c=I[n+1];if(void 0===c)return e;var f=c.getAttribute("t"),v=(0,d.Z)(f)?+f:null;if(null===v)throw new Error("Can't build index timeline from Smooth Manifest.");u=v-s}return e.push({duration:u,start:s,repeatCount:o}),e}),[])),timescale:b,timeShiftBufferDepth:p,manifestReceivedTime:m});(0,u.Z)(0!==x.length,"Adaptation should have at least one playable representation.");var C=E+((0,d.Z)(w)?"_"+w:""),L=x.map((function(e){var t,n,r,i,o=(t=A,n=e.bitrate,r=e.customAttributes,t.replace(/\{bitrate\}/g,String(n)).replace(/{CustomAttributes}/g,r.length>0?r[0]:"")),s=(0,d.Z)(e.mimeType)?e.mimeType:N[E],u=e.codecs,p=C+"_"+(null!=E?E+"-":"")+(null!=s?s+"-":"")+(null!=u?u+"-":"")+String(e.bitrate),h=[];f.length>0&&(i=f[0],f.forEach((function(e){var t=e.keyId;e.keySystems.forEach((function(e){h.push({keyId:t,systemId:e.systemId})}))})));var m={bitsPerSample:e.bitsPerSample,channels:e.channels,codecPrivateData:e.codecPrivateData,packetSize:e.packetSize,samplingRate:e.samplingRate,height:e.height,width:e.width,protection:null!=i?{keyId:i.keyId}:void 0},_=new Z({isLive:g,sharedSmoothTimeline:M,media:o,segmentPrivateInfos:m}),b=(0,c.Z)({},e,{index:_,cdnMetadata:[{baseUrl:a}],mimeType:s,codecs:u,id:p});if(h.length>0||void 0!==i){var S=void 0===i?[]:i.keySystems.map((function(e){var t=e.systemId,n=e.privateData,r=t.replace(/-/g,""),i=function(e,t){if(32!==e.length)throw new Error("HSS: wrong system id length");var n=0;return y("pssh",(0,l.zo)([n,0,0,0],(0,v.nr)(e),(0,l.kh)(t.length),t))}(r,n);return{systemId:r,data:i}}));if(S.length>0){var T=[{type:"cenc",values:S}];b.contentProtections={keyIds:h,initData:T}}else b.contentProtections={keyIds:h,initData:[]}}return b}));if("ADVT"===T)return null;var U={id:C,type:E,representations:L,language:null==w?void 0:w};return"text"===E&&"DESC"===T&&(U.closedCaption=!0),U}return function(n,r,i){var o="";if(void 0!==r){var s=(0,f.$)(r);o=r.substring(0,s)}var u=n.documentElement;if(null==u||"SmoothStreamingMedia"!==u.nodeName)throw new Error("document root should be SmoothStreamingMedia");var l=u.getAttribute("MajorVersion"),c=u.getAttribute("MinorVersion");if(null===l||null===c||!/^[2]-[0-2]$/.test(l+"-"+c))throw new Error("Version should be 2.0, 2.1 or 2.2");var v,p,h=u.getAttribute("Timescale"),g=(0,d.Z)(h)?isNaN(+h)?1e7:+h:1e7,y=O(u,(function(t,n,r){switch(n){case"Protection":t.protections.push(T(r,e.keySystems));break;case"StreamIndex":t.adaptationNodes.push(r)}return t}),{adaptationNodes:[],protections:[]}),_=y.protections,S=y.adaptationNodes,E="boolean"==typeof(v=u.getAttribute("IsLive"))?v:"string"==typeof v&&"TRUE"===v.toUpperCase();if(E){var w=u.getAttribute("DVRWindowLength");null==w||isNaN(+w)||0==+w||(p=+w/g)}var k,A,I,R,x,Z,P,M=S.reduce((function(e,t){var n=m({root:t,baseUrl:o,timescale:g,protections:_,isLive:E,timeShiftBufferDepth:p,manifestReceivedTime:i});if(null===n)return e;var r=n.type,a=e[r];return void 0===a?e[r]=[n]:a.push(n),e}),{}),C=null,D=void 0!==M.video?M.video[0]:void 0,N=void 0!==M.audio?M.audio[0]:void 0;if(void 0!==D||void 0!==N){var L=[],U=[];if(void 0!==D){var B=D.representations[0];if(void 0!==B){var F=B.index.getFirstAvailablePosition(),z=B.index.getLastAvailablePosition();null!=F&&L.push(F),null!=z&&U.push(z)}}if(void 0!==N){var V=N.representations[0];if(void 0!==V){var K=V.index.getFirstAvailablePosition(),G=V.index.getLastAvailablePosition();null!=K&&L.push(K),null!=G&&U.push(G)}}L.length>0&&(x=Math.max.apply(Math,L)),U.length>0&&(Z=Math.min.apply(Math,U),P=Math.max.apply(Math,U))}var W=u.getAttribute("Duration"),H=null!==W&&0!=+W?+W/g:void 0;if(E){k=e.suggestedPresentationDelay,A=t,I=null!=x?x:A;var j=P;void 0===j&&(j=Date.now()/1e3-A);var q=Z;void 0===q&&(q=j),R={isLinear:!0,maximumSafePosition:q,livePosition:j,time:performance.now()},C=null!=p?p:null}else{I=null!=x?x:0,R={isLinear:!1,maximumSafePosition:void 0!==Z?Z:void 0!==H?I+H:1/0,livePosition:void 0,time:performance.now()}}var Y=E?0:I,X=E?void 0:R.maximumSafePosition,$={availabilityStartTime:void 0===A?0:A,clockOffset:a,isLive:E,isDynamic:E,isLastPeriodKnown:!0,timeBounds:{minimumSafePosition:I,timeshiftDepth:C,maximumTimeData:R},periods:[{adaptations:M,duration:void 0!==X?X-Y:H,end:X,id:"gen-smooth-period-0",start:Y}],suggestedPresentationDelay:k,transportType:"smooth",uris:null==r?[]:[r]};return b($),$}},B=U,F=n(4597),z=n(4460),V=n(8791),K=n(4644),G=n(2297);function W(e,t,n,i,o){var s,u,d,c=[];if(o){var f=(0,a.XA)(e);null!==f?(d=function(e){var t=(0,G.nR)(e,3565190898,3392751253,2387879627,2655430559);if(void 0===t)return[];for(var n=[],r=t[0],i=t[4],a=0;a<i;a++){var o=void 0,s=void 0;1===r?(s=(0,l.pV)(t,16*a+5),o=(0,l.pV)(t,16*a+5+8)):(s=(0,l.pX)(t,8*a+5),o=(0,l.pX)(t,8*a+5+4)),n.push({time:s,duration:o})}return n}(f),u=function(e){var t=(0,G.nR)(e,1830656773,1121273062,2162299933,2952222642);if(void 0!==t)return{duration:(0,l.pV)(t,12),time:(0,l.pV)(t,4)}}(f)):r.Z.warn("smooth: could not find traf atom")}if(void 0!==d)for(var v=0;v<d.length;v++)c.push({time:d[v].time,duration:d[v].duration,timescale:n});if(void 0!==u)return{nextSegments:c,chunkInfos:{time:u.time/n,duration:u.duration/n},scaledSegmentTime:u.time};if(t||!i.complete)return{nextSegments:c,chunkInfos:null,scaledSegmentTime:void 0};var p=i.duration*n,h=Math.min(.9*n,p/4),m=(0,K.MM)(e),g=void 0!==(null===(s=i.privateInfos)||void 0===s?void 0:s.smoothMediaSegment)?i.privateInfos.smoothMediaSegment.time:Math.round(i.time*n);return{nextSegments:c,chunkInfos:void 0!==m&&Math.abs(m-p)<=h?{time:i.time,duration:m/n}:{time:i.time,duration:i.duration},scaledSegmentTime:g}}function H(e){return"string"==typeof e&&e.indexOf("mp4")>=0}var j=n(3666);function q(e,t){return y("schm",(0,l.zo)(4,(0,v.tG)(e),(0,l.kh)(t)))}function Y(e){return y("frma",(0,v.tG)(e))}function X(e){var t=[7,[e.length]];return y("stsd",l.zo.apply(void 0,t.concat(e)))}function $(e,t,n){return y("tenc",(0,l.zo)(6,[e,t],n))}function Q(e,t,n,r,i){var a=[e,t,n];return void 0!==i&&a.push(y("senc",i),function(e){if(0===e.length)return y("saiz",new Uint8Array(0));var t=(0,l.pX)(e,0),n=(0,l.pX)(e,4),r=new Uint8Array(n+9);r.set((0,l.kh)(n),5);for(var i,a,o=9,s=8;s<e.length;)s+=8,2==(2&t)?(a=2,s+=6*(i=(0,l.zK)(e,s))+2):(i=0,a=0),r[o]=6*i+8+a,o++;return y("saiz",r)}(i),function(e,t,n,r){return y("saio",(0,l.zo)(4,[0,0,0,1],(0,l.kh)(e.length+t.length+n.length+r.length+8+8+8+8)))}(r,e,t,n)),_("traf",a)}function J(e,t){var n=(0,G.Qy)(e,1836019558);if(null===n)throw new Error("Smooth: Invalid ISOBMFF given");var r=e.subarray(n[1],n[2]),i=(0,G.iz)(r,1835427940),a=(0,G.t_)(r,1953653094);if(null===a||null===i)throw new Error("Smooth: Invalid ISOBMFF given");var o=(0,G.Qy)(a,1952868452),s=(0,G.Qy)(a,1953658222);if(null===o||null===s)throw new Error("Smooth: Invalid ISOBMFF given");var u=a.subarray(o[0],o[2]),d=a.subarray(s[0],s[2]);u.set([0,0,0,1],o[1]-o[0]+4);var c=function(e){return y("tfdt",(0,l.zo)([1,0,0,0],(0,l.el)(e)))}(t),f=function(e,t){if((1&e[t+3])>0)return e;var n=new Uint8Array(e.length+4);return n.set(e.subarray(0,t+8),0),n[t+3]=1|n[t+3],n.set([0,0,0,0],t+8),n.set(e.subarray(t+8,e.length),t+12),(0,K.J6)(n)}(d,s[1]-s[0]),v=Q(u,c,f,i,(0,G.nR)(a,2721664850,1520127764,2722393154,2086964724)),p=_("moof",[i,v]),h=(0,G.Qy)(p,1836019558),m=(0,G.Qy)(v,1953653094),g=(0,G.Qy)(f,1953658222);if(null===h||null===m||null===g)throw new Error("Smooth: Invalid moof, trun or traf generation");var b=h[1]-h[0]+i.length+(m[1]-m[0])+u.length+c.length+(g[1]-g[0])+8,S=n[2]-n[0],E=p.length-S,T=(0,G.Qy)(e,1835295092);if(null===T)throw new Error("Smooth: Invalid ISOBMFF given");if(!j.YM&&(0===E||E<=-8)){var w=T[1];return p.set((0,l.kh)(w),b),e.set(p,n[0]),E<=-8&&e.set(y("free",new Uint8Array(-E-8)),p.length),e}var k=T[1]+E;p.set((0,l.kh)(k),b);var A=new Uint8Array(e.length+E),I=e.subarray(0,n[0]),R=e.subarray(n[2],e.length);return A.set(I,0),A.set(p,I.length),A.set(R,I.length+p.length),A}var ee=n(7839),te=n(281);function ne(e,t,n,r,i,a){var o,s,u,d=_("stbl",[n,y("stts",new Uint8Array(8)),y("stsc",new Uint8Array(8)),y("stsz",new Uint8Array(12)),y("stco",new Uint8Array(8))]),c=function(e){return y("dref",(0,l.zo)(7,[1],e))}(y("url ",new Uint8Array([0,0,0,1]))),f=_("dinf",[c]),p=_("minf",[r,f,d]),h=function(e){var t,n;switch(e){case"video":t="vide",n="VideoHandler";break;case"audio":t="soun",n="SoundHandler";break;default:t="hint",n=""}return y("hdlr",(0,l.zo)(8,(0,v.tG)(t),12,(0,v.tG)(n),1))}(t),m=function(e){return y("mdhd",(0,l.zo)(12,(0,l.kh)(e),8))}(e),g=_("mdia",[m,h,p]),b=function(e,t,n){return y("tkhd",(0,l.zo)((0,l.kh)(7),8,(0,l.kh)(n),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],(0,l.XT)(e),2,(0,l.XT)(t),2))}(i,a,1),S=_("trak",[b,g]),E=_("mvex",[(o=1,y("trex",(0,l.zo)(4,(0,l.kh)(o),[0,0,0,1],12)))]),T=function(e,t){return y("mvhd",(0,l.zo)(12,(0,l.kh)(e),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,(0,l.XT)(t+1)))}(e,1),w=function(e,t,n){return _("moov",[e,t,n])}(T,E,S),k=(s="isom",u=["isom","iso2","iso6","avc1","dash"],y("ftyp",l.zo.apply(void 0,[(0,v.tG)(s),[0,0,0,1]].concat(u.map(v.tG)))));return(0,l.zo)(k,w)}function re(e,t,n,r,i,a,o,s){var u=o.split("00000001"),d=u[1],c=u[2];if(void 0===d||void 0===c)throw new Error("Smooth: unsupported codec private data.");var f,p,h=function(e,t,n){var r=2===n?1:4===n?3:0,i=e[1],a=e[2],o=e[3];return y("avcC",(0,l.zo)([1,i,a,o,252|r,225],(0,l.XT)(e.length),e,[1],(0,l.XT)(t.length),t))}((0,v.nr)(d),(0,v.nr)(c),a);if(void 0===s){var m=function(e,t,n,r,i,a,o){return y("avc1",(0,l.zo)(6,(0,l.XT)(1),16,(0,l.XT)(e),(0,l.XT)(t),(0,l.XT)(n),2,(0,l.XT)(r),6,[0,1,i.length],(0,v.tG)(i),31-i.length,(0,l.XT)(a),[255,255],o))}(t,n,r,i,"AVC Coding",24,h);f=X([m])}else{var g=_("schi",[$(1,8,s)]),b=q("cenc",65536),S=function(e,t,n,r,i,a,o,s){return y("encv",(0,l.zo)(6,(0,l.XT)(1),16,(0,l.XT)(e),(0,l.XT)(t),(0,l.XT)(n),2,(0,l.XT)(r),6,[0,1,i.length],(0,v.tG)(i),31-i.length,(0,l.XT)(a),[255,255],o,s))}(t,n,r,i,"AVC Coding",24,h,_("sinf",[Y("avc1"),b,g]));f=X([S])}return ne(e,"video",f,((p=new Uint8Array(12))[3]=1,y("vmhd",p)),t,n)}var ie=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];function ae(e,t,n,r,i,a,o){var s,u,d,c=function(e,t){return y("esds",(0,l.zo)(4,[3,25],(0,l.XT)(e),[0,4,17,64,21],11,[5,2],(0,v.nr)(t),[6,1,2]))}(1,0===a.length?(s=i,u=t,d=((d=((d=(63&2)<<4)|31&ie.indexOf(s))<<4)|31&u)<<3,(0,v.ci)((0,l.XT)(d))):a),f=function(){if(void 0===o){var e=function(e,t,n,r,i,a){return y("mp4a",(0,l.zo)(6,(0,l.XT)(e),8,(0,l.XT)(t),(0,l.XT)(n),2,(0,l.XT)(r),(0,l.XT)(i),2,a))}(1,t,n,r,i,c);return X([e])}var a=_("schi",[$(1,8,o)]),s=q("cenc",65536),u=_("sinf",[Y("mp4a"),s,a]),d=function(e,t,n,r,i,a,o){return y("enca",(0,l.zo)(6,(0,l.XT)(e),8,(0,l.XT)(t),(0,l.XT)(n),2,(0,l.XT)(r),(0,l.XT)(i),2,a,o))}(1,t,n,r,i,c,u);return X([d])}();return ne(e,"audio",f,y("smhd",new Uint8Array(8)),0,0)}function oe(e,t,n,r,i,a){var o,s=t.segment.range;return Array.isArray(s)&&(o={Range:(0,te.Z)(s)}),(0,F.ZP)({url:e,responseType:"arraybuffer",headers:o,timeout:r.timeout,cancelSignal:i,onProgress:n.onProgress}).then((function(e){if(!H(t.mimeType)||!0!==a)return{resultType:"segment-loaded",resultData:e};var n=new Uint8Array(e.responseData);return(0,z.Z)(n,t.segment.isInit),{resultType:"segment-loaded",resultData:Object.assign(Object.assign({},e),{responseData:n})}}))}var se=function(e){var t=e.checkMediaSegmentIntegrity,n=e.customSegmentLoader;return function(e,r,i,a,o){var s=r.segment;if(s.isInit){if(void 0===s.privateInfos||void 0===s.privateInfos.smoothInitSegment)throw new Error("Smooth: Invalid segment format");var u,l=s.privateInfos.smoothInitSegment,d=l.codecPrivateData,c=l.timescale,f=l.height,v=l.width,p=l.protection,h=void 0===p?{keyId:void 0,keySystems:void 0}:p;if(void 0===d)throw new Error("Smooth: no codec private data.");switch(r.type){case"video":u=re(c,null!=v?v:0,null!=f?f:0,72,72,4,d,h.keyId);break;case"audio":var m=l.channels,g=void 0===m?0:m,y=l.bitsPerSample,_=void 0===y?0:y,b=l.packetSize,S=void 0===b?0:b,E=l.samplingRate;u=ae(c,g,_,S,void 0===E?0:E,d,h.keyId);break;default:0,u=new Uint8Array(0)}return Promise.resolve({resultType:"segment-created",resultData:u})}return null===e?Promise.resolve({resultType:"segment-created",resultData:null}):"function"!=typeof n?oe(e,r,o,i,a,t):new Promise((function(s,u){var l=!1,d={reject:function(e){var t,n,r;if(!l&&!a.isCancelled){l=!0,a.deregister(v);var i=e,o=null!==(t=null==i?void 0:i.message)&&void 0!==t?t:"Unknown error when fetching a Smooth segment through a custom segmentLoader.",s=new ee.Z(o,null!==(n=null==i?void 0:i.canRetry)&&void 0!==n&&n,null!==(r=null==i?void 0:i.isOfflineError)&&void 0!==r&&r,null==i?void 0:i.xhr);u(s)}},resolve:function(e){if(!l&&!a.isCancelled){l=!0,a.deregister(v),H(r.mimeType)&&!0===t||s({resultType:"segment-loaded",resultData:{responseData:e.data,size:e.size,requestDuration:e.duration}});var n=e.data instanceof Uint8Array?e.data:new Uint8Array(e.data);(0,z.Z)(n,r.segment.isInit),s({resultType:"segment-loaded",resultData:{responseData:n,size:e.size,requestDuration:e.duration}})}},fallback:function(){l||a.isCancelled||(l=!0,a.deregister(v),oe(e,r,o,i,a,t).then(s,u))},progress:function(e){l||a.isCancelled||o.onProgress({duration:e.duration,size:e.size,totalSize:e.totalSize})}},c={isInit:r.segment.isInit,timeout:i.timeout,range:r.segment.range,indexRange:r.segment.indexRange,type:r.type,url:e},f=n(c,d);function v(e){l||((l=!0)||"function"!=typeof f||f(),u(e))}a.register(v)}))}};function ue(e,t){return null===e?null:null===t.url?e.baseUrl:(0,f.Z)(e.baseUrl,t.url)}var le=function(e){var t=B(e),n=se(e),o={customManifestLoader:e.manifestLoader},s={loadSegment:function(e,t,r,i,a){var o=ue(e,t.segment);return n(o,t,r,i,a)},parseSegment:function(e,t,n){var r,i,a=t.segment,o=e.data,s=e.isChunked;if(null===o)return a.isInit?{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0}:{segmentType:"media",chunkData:null,chunkInfos:null,chunkOffset:0,chunkSize:0,protectionData:[],appendWindow:[void 0,void 0]};var u=o instanceof Uint8Array?o:new Uint8Array(o);if(a.isInit){var l=null===(i=null===(r=a.privateInfos)||void 0===r?void 0:r.smoothInitSegment)||void 0===i?void 0:i.timescale;return{segmentType:"init",initializationData:o,initializationDataSize:o.byteLength,initTimescale:l,protectionData:[]}}var d=void 0!==n?W(u,s,n,a,t.isLive):null;if(null===d||null===d.chunkInfos||void 0===d.scaledSegmentTime)throw new Error("Smooth Segment without time information");var c=d.nextSegments,f=d.chunkInfos,v=J(u,d.scaledSegmentTime),p=c.length>0?c:void 0;return{segmentType:"media",chunkData:v,chunkInfos:f,chunkOffset:0,chunkSize:v.length,protectionData:[],predictedSegments:p,appendWindow:[void 0,void 0]}}};return{manifest:{loadManifest:(0,V.Z)(o,"text"),parseManifest:function(n,r){var a,o=null!==(a=n.url)&&void 0!==a?a:r.originalUrl,s=n.receivedTime,u=n.responseData,l="string"==typeof u?(new DOMParser).parseFromString(u,"text/xml"):u,d=t(l,o,s);return{manifest:new i.ZP(d,{representationFilter:e.representationFilter}),url:o}}},audio:s,video:s,text:{loadSegment:function(t,n,r,i,a){var o=n.segment,s=ue(t,o);return o.isInit||null===s?Promise.resolve({resultType:"segment-created",resultData:null}):H(n.mimeType)?(0,F.ZP)({url:s,responseType:"arraybuffer",timeout:r.timeout,cancelSignal:i,onProgress:a.onProgress}).then((function(t){if(!0!==e.checkMediaSegmentIntegrity)return{resultType:"segment-loaded",resultData:t};var r=new Uint8Array(t.responseData);return(0,z.Z)(r,n.segment.isInit),{resultType:"segment-loaded",resultData:Object.assign(Object.assign({},t),{responseData:r})}})):(0,F.ZP)({url:s,responseType:"text",timeout:r.timeout,cancelSignal:i,onProgress:a.onProgress}).then((function(e){return{resultType:"segment-loaded",resultData:e}}))},parseSegment:function(e,t,n){var i,o,s,u=t.segment,l=t.language,d=t.mimeType,c=void 0===d?"":d,f=t.codecs,p=void 0===f?"":f,h=H(t.mimeType),m=e.data,g=e.isChunked;if(u.isInit)return{segmentType:"init",initializationData:null,initializationDataSize:0,protectionData:[],initTimescale:void 0};if(null===m)return{segmentType:"media",chunkData:null,chunkInfos:null,chunkOffset:0,chunkSize:0,protectionData:[],appendWindow:[void 0,void 0]};var y,_,b,S,E=null;if(h){var T;o=(T="string"==typeof m?(0,v.tG)(m):m instanceof Uint8Array?m:new Uint8Array(m)).length;var w=void 0!==n?W(T,g,n,u,t.isLive):null;s=null==w?void 0:w.nextSegments,null===(E=null!==(i=null==w?void 0:w.chunkInfos)&&void 0!==i?i:null)?g?r.Z.warn("Smooth: Unavailable time data for current text track."):(y=u.time,_=u.end):(y=E.time,_=void 0!==E.duration?E.time+E.duration:u.end);var k=p.toLowerCase();if("application/ttml+xml+mp4"===c||"stpp"===k||"stpp.ttml.im1t"===k)S="ttml";else{if("wvtt"!==k)throw new Error("could not find a text-track parser for the type "+c);S="vtt"}var A=(0,a.Le)(T);b=null===A?"":(0,v.uR)(A)}else{var I;if(y=u.time,_=u.end,"string"!=typeof m){var R=m instanceof Uint8Array?m:new Uint8Array(m);o=R.length,I=(0,v.uR)(R)}else I=m;switch(c){case"application/x-sami":case"application/smil":S="sami";break;case"application/ttml+xml":S="ttml";break;case"text/vtt":S="vtt"}if(void 0===S){if("srt"!==p.toLowerCase())throw new Error("could not find a text-track parser for the type "+c);S="srt"}b=I}return{segmentType:"media",chunkData:{type:S,data:b,start:y,end:_,language:l},chunkSize:o,chunkInfos:E,chunkOffset:null!=y?y:0,protectionData:[],predictedSegments:Array.isArray(s)&&s.length>0?s:void 0,appendWindow:[void 0,void 0]}}}}}},281:function(e,t,n){"use strict";function r(e){var t=e[0],n=e[1];return n===1/0?"bytes="+t+"-":"bytes="+t+"-"+n}n.d(t,{Z:function(){return r}})},4460:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5389),i=n(8766);function a(e,t){if(t){if((0,i.Z)(e,1718909296)<0)throw new r.Z("INTEGRITY_ERROR","Incomplete `ftyp` box");if((0,i.Z)(e,1836019574)<0)throw new r.Z("INTEGRITY_ERROR","Incomplete `moov` box")}else{if((0,i.Z)(e,1836019558)<0)throw new r.Z("INTEGRITY_ERROR","Incomplete `moof` box");if((0,i.Z)(e,1835295092)<0)throw new r.Z("INTEGRITY_ERROR","Incomplete `mdat` box")}}},8766:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(6968);function i(e,t){for(var n=e.length,i=0;i+8<=n;){var a=(0,r.pX)(e,i);if(0===a)a=n-i;else if(1===a){if(i+16>n)return-1;a=(0,r.pV)(e,i+8)}if(isNaN(a)||a<=0)return-1;if((0,r.pX)(e,i+4)===t)return i+a<=n?i:-1;i+=a}return-1}},8791:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7904),i=n(4597),a=n(7839);function o(e,t){var n=e.customManifestLoader,o=function(e){return function(t,n,a){if(void 0===t)throw new Error("Cannot perform HTTP(s) request. URL not known");switch(e){case"arraybuffer":return(0,i.ZP)({url:t,responseType:"arraybuffer",timeout:n.timeout,cancelSignal:a});case"text":return(0,i.ZP)({url:t,responseType:"text",timeout:n.timeout,cancelSignal:a});case"document":return(0,i.ZP)({url:t,responseType:"document",timeout:n.timeout,cancelSignal:a});default:(0,r.Z)(e)}}}(t);return"function"!=typeof n?o:function(e,t){return function(n,r,i){return new Promise((function(o,s){var u=Date.now()-performance.now(),l=!1,d={reject:function(e){var t,n,r;if(!l&&!i.isCancelled){l=!0,i.deregister(f);var o=e,u=null!==(t=null==o?void 0:o.message)&&void 0!==t?t:"Unknown error when fetching the Manifest through a custom manifestLoader.",d=new a.Z(u,null!==(n=null==o?void 0:o.canRetry)&&void 0!==n&&n,null!==(r=null==o?void 0:o.isOfflineError)&&void 0!==r&&r,null==o?void 0:o.xhr);s(d)}},resolve:function(e){if(!l&&!i.isCancelled){l=!0,i.deregister(f);var t=void 0!==e.receivingTime?e.receivingTime-u:void 0,n=void 0!==e.sendingTime?e.sendingTime-u:void 0;o({responseData:e.data,size:e.size,requestDuration:e.duration,url:e.url,receivedTime:t,sendingTime:n})}},fallback:function(){l||i.isCancelled||(l=!0,i.deregister(f),t(n,r,i).then(o,s))}},c=e({url:n,timeout:r.timeout},d);function f(e){l||(l=!0,"function"==typeof c&&c(),s(e))}i.register(f)}))}}(n,o)}},4791:function(e,t,n){"use strict";function r(e,t){if(e.length!==t.length)return!1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return!1;return!0}n.d(t,{Z:function(){return r}})},3274:function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.find)return e.find(t,n);for(var r=e.length>>>0,i=0;i<r;i++){var a=e[i];if(t.call(n,a,i,e))return a}}n.d(t,{Z:function(){return r}})},5138:function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.findIndex)return e.findIndex(t,n);for(var r=e.length>>>0,i=0;i<r;i++)if(t.call(n,e[i],i,e))return i;return-1}n.d(t,{Z:function(){return r}})},7714:function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof Array.prototype.includes)return e.includes(t,n);var r=e.length>>>0;if(0===r)return!1;for(var i,a,o=0|n,s=o>=0?Math.min(o,r-1):Math.max(r+o,0);s<r;){if((i=e[s])===(a=t)||"number"==typeof i&&"number"==typeof a&&isNaN(i)&&isNaN(a))return!0;s++}return!1}n.d(t,{Z:function(){return r}})},811:function(e,t,n){"use strict";n.d(t,{Z:function(){return i},u:function(){return a}});var r=n(1946);function i(e,t){0}function a(e,t,n){for(var a in void 0===n&&(n="object"),i((0,r.Z)(e)),t)t.hasOwnProperty(a)&&i((e[a],t[a]),t[a])}},7904:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(7326),i=n(4578),a=function(e){function t(n){var i;return i=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(i),t.prototype),i.name="AssertionError",i.message=n,i}return(0,i.Z)(t,e),t}((0,n(2146).Z)(Error));function o(e){throw new a("Unreachable path taken")}},9689:function(e,t,n){"use strict";n.d(t,{J:function(){return s},K:function(){return u}});var r=n(3887),i=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],a=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function o(e){if(e>=a.length)throw new Error("Unable to parse base64 string.");var t=a[e];if(255===t)throw new Error("Unable to parse base64 string.");return t}function s(e){var t,n="",r=e.length;for(t=2;t<r;t+=3)n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4|e[t-1]>>4],n+=i[(15&e[t-1])<<2|e[t]>>6],n+=i[63&e[t]];return t===r+1&&(n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4],n+="=="),t===r&&(n+=i[e[t-2]>>2],n+=i[(3&e[t-2])<<4|e[t-1]>>4],n+=i[(15&e[t-1])<<2],n+="="),n}function u(e){var t=e.length%4,n=e;0!==t&&(r.Z.warn("base64ToBytes: base64 given miss padding"),n+=3===t?"=":2===t?"==":"===");var i=n.indexOf("=");if(-1!==i&&i<n.length-2)throw new Error("Unable to parse base64 string.");for(var a,s=n.endsWith("==")?2:n.endsWith("=")?1:0,u=n.length,l=new Uint8Array(u/4*3),d=0,c=0;d<u;d+=4,c+=3)a=o(n.charCodeAt(d))<<18|o(n.charCodeAt(d+1))<<12|o(n.charCodeAt(d+2))<<6|o(n.charCodeAt(d+3)),l[c]=a>>16,l[c+1]=a>>8&255,l[c+2]=255&a;return l.subarray(0,l.length-s)}},6968:function(e,t,n){"use strict";function r(){for(var e,t=arguments.length,n=-1,r=0;++n<t;)r+="number"==typeof(e=n<0||arguments.length<=n?void 0:arguments[n])?e:e.length;var i=new Uint8Array(r),a=0;for(n=-1;++n<t;)"number"==typeof(e=n<0||arguments.length<=n?void 0:arguments[n])?a+=e:e.length>0&&(i.set(e,a),a+=e.length);return i}function i(e,t){return(e[t+0]<<8)+(e[t+1]<<0)}function a(e,t){return 65536*e[t+0]+256*e[t+1]+e[t+2]}function o(e,t){return 16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3]}function s(e,t){return 4294967296*(16777216*e[t+0]+65536*e[t+1]+256*e[t+2]+e[t+3])+16777216*e[t+4]+65536*e[t+5]+256*e[t+6]+e[t+7]}function u(e){return new Uint8Array([e>>>8&255,255&e])}function l(e){return new Uint8Array([e>>>24&255,e>>>16&255,e>>>8&255,255&e])}function d(e){var t=e%4294967296,n=(e-t)/4294967296;return new Uint8Array([n>>>24&255,n>>>16&255,n>>>8&255,255&n,t>>>24&255,t>>>16&255,t>>>8&255,255&t])}function c(e,t){return(e[t+0]<<0)+(e[t+1]<<8)}function f(e,t){return e[t+0]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]}function v(e){return new Uint8Array([255&e,e>>>8&255,e>>>16&255,e>>>24&255])}function p(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer)}n.d(t,{O_:function(){return v},QI:function(){return a},XT:function(){return u},_f:function(){return p},dN:function(){return f},el:function(){return d},kh:function(){return l},pV:function(){return s},pX:function(){return o},qb:function(){return c},zK:function(){return i},zo:function(){return r}})},7864:function(e,t,n){"use strict";function r(e,t){return new Promise((function(n,r){var i=setTimeout((function(){a(),n()}),e),a=t.register((function(e){clearTimeout(i),r(e)}))}))}n.d(t,{Z:function(){return r}})},1959:function(e,t,n){"use strict";n.d(t,{R:function(){return s},Z:function(){return o}});var r=n(1480),i=n(3887),a=n(1946),o=function(){function e(){this._listeners={}}var t=e.prototype;return t.addEventListener=function(e,t,n){var r=this,i=this._listeners[e];Array.isArray(i)?i.push(t):this._listeners[e]=[t],void 0!==n&&n.register((function(){r.removeEventListener(e,t)}))},t.removeEventListener=function(e,t){if((0,a.Z)(e))this._listeners={};else{var n=this._listeners[e];if(Array.isArray(n))if((0,a.Z)(t))delete this._listeners[e];else{var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&delete this._listeners[e]}}},t.trigger=function(e,t){var n=this._listeners[e];Array.isArray(n)&&n.slice().forEach((function(e){try{e(t)}catch(e){i.Z.error("EventEmitter: listener error",e instanceof Error?e:null)}}))},e}();function s(e,t){return new r.y((function(n){function r(e){n.next(e)}return e.addEventListener(t,r),function(){e.removeEventListener(t,r)}}))}},9592:function(e,t,n){"use strict";function r(e,t){return"function"==typeof Array.prototype.flatMap?e.flatMap(t):e.reduce((function(e,n){var r=t(n);return Array.isArray(r)?(e.push.apply(e,r),e):(e.push(r),e)}),[])}n.d(t,{Z:function(){return r}})},2572:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});function r(e){return e*(.3*(2*Math.random()-1)+1)}},2870:function(e,t,n){"use strict";function r(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e[n],t&=t;return t}n.d(t,{Z:function(){return r}})},908:function(e,t,n){"use strict";function r(){var e="",t=-1;return function(){return++t>=Number.MAX_SAFE_INTEGER&&(e+="0",t=0),e+String(t)}}n.d(t,{Z:function(){return r}})},6923:function(e,t,n){"use strict";function r(e){return"string"==typeof e&&e.length>0}n.d(t,{Z:function(){return r}})},1946:function(e,t,n){"use strict";function r(e){return null==e}n.d(t,{Z:function(){return r}})},5288:function(e,t,n){"use strict";n.d(t,{ZP:function(){return u}});var r=n(6923),i=n(1946),a={aa:"aar",ab:"abk",ae:"ave",af:"afr",ak:"aka",am:"amh",an:"arg",ar:"ara",as:"asm",av:"ava",ay:"aym",az:"aze",ba:"bak",be:"bel",bg:"bul",bi:"bis",bm:"bam",bn:"ben",bo:"bod",br:"bre",bs:"bos",ca:"cat",ce:"che",ch:"cha",co:"cos",cr:"cre",cs:"ces",cu:"chu",cv:"chv",cy:"cym",da:"dan",de:"deu",dv:"div",dz:"dzo",ee:"ewe",el:"ell",en:"eng",eo:"epo",es:"spa",et:"est",eu:"eus",fa:"fas",ff:"ful",fi:"fin",fj:"fij",fo:"fao",fr:"fra",fy:"fry",ga:"gle",gd:"gla",gl:"glg",gn:"grn",gu:"guj",gv:"glv",ha:"hau",he:"heb",hi:"hin",ho:"hmo",hr:"hrv",ht:"hat",hu:"hun",hy:"hye",hz:"her",ia:"ina",id:"ind",ie:"ile",ig:"ibo",ii:"iii",ik:"ipk",io:"ido",is:"isl",it:"ita",iu:"iku",ja:"jpn",jv:"jav",ka:"kat",kg:"kon",ki:"kik",kj:"kua",kk:"kaz",kl:"kal",km:"khm",kn:"kan",ko:"kor",kr:"kau",ks:"kas",ku:"kur",kv:"kom",kw:"cor",ky:"kir",la:"lat",lb:"ltz",lg:"lug",li:"lim",ln:"lin",lo:"lao",lt:"lit",lu:"lub",lv:"lav",mg:"mlg",mh:"mah",mi:"mri",mk:"mkd",ml:"mal",mn:"mon",mr:"mar",ms:"msa",mt:"mlt",my:"mya",na:"nau",nb:"nob",nd:"nde",ne:"nep",ng:"ndo",nl:"nld",nn:"nno",no:"nor",nr:"nbl",nv:"nav",ny:"nya",oc:"oci",oj:"oji",om:"orm",or:"ori",os:"oss",pa:"pan",pi:"pli",pl:"pol",ps:"pus",pt:"por",qu:"que",rm:"roh",rn:"run",ro:"ron",ru:"rus",rw:"kin",sa:"san",sc:"srd",sd:"snd",se:"sme",sg:"sag",si:"sin",sk:"slk",sl:"slv",sm:"smo",sn:"sna",so:"som",sq:"sqi",sr:"srp",ss:"ssw",st:"sot",su:"sun",sv:"swe",sw:"swa",ta:"tam",te:"tel",tg:"tgk",th:"tha",ti:"tir",tk:"tuk",tl:"tgl",tn:"tsn",to:"ton",tr:"tur",ts:"tso",tt:"tat",tw:"twi",ty:"tah",ug:"uig",uk:"ukr",ur:"urd",uz:"uzb",ve:"ven",vi:"vie",vo:"vol",wa:"wln",wo:"wol",xh:"xho",yi:"yid",yo:"yor",za:"zha",zh:"zho",zu:"zul"},o={alb:"sqi",arm:"hye",baq:"eus",bur:"mya",chi:"zho",cze:"ces",dut:"nld",fre:"fra",geo:"kat",ger:"deu",gre:"ell",ice:"isl",mac:"mkd",mao:"mri",may:"msa",per:"fas",slo:"slk",rum:"ron",tib:"bod",wel:"cym"};function s(e){if((0,i.Z)(e)||""===e)return"";var t=function(e){var t;switch(e.length){case 2:t=a[e];break;case 3:t=o[e]}return t}((""+e).toLowerCase().split("-")[0]);return(0,r.Z)(t)?t:e}var u=s},8894:function(e,t,n){"use strict";function r(){}n.d(t,{Z:function(){return r}})},8026:function(e,t){"use strict";t.Z="function"==typeof Object.assign?Object.assign:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=0;n<(arguments.length<=1?0:arguments.length-1);n++){var r=n+1<1||arguments.length<=n+1?void 0:arguments[n+1];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}},1679:function(e,t,n){"use strict";t.Z="function"==typeof Object.values?Object.values:function(e){return Object.keys(e).map((function(t){return e[t]}))}},2829:function(e,t,n){"use strict";n.d(t,{A1:function(){return o},F_:function(){return v},JN:function(){return d},L7:function(){return p},Ti:function(){return s},XS:function(){return f},kR:function(){return h},rx:function(){return c},tn:function(){return g},uH:function(){return y}});function r(e,t){return Math.abs(e-t)<.016666666666666666}function i(e,t){return{start:Math.min(e.start,t.start),end:Math.max(e.end,t.end)}}function a(e,t){return e.end<=t.start}function o(e,t){for(var n=0;n<e.length;n++)if(s(e[n],t))return!0;return!1}function s(e,t){var n=e.start,r=e.end;return n<=t&&t<r}function u(e,t){return s(e,t.start)||e.start<t.end&&t.end<e.end||s(t,e.start)}function l(e,t){return r(t.start,e.end)||r(t.end,e.start)}function d(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}function c(e,t){for(var n=e.length-1;n>=0;n--){var r=e.start(n);if(t>=r){var i=e.end(n);if(t<i)return{start:r,end:i}}}return null}function f(e,t){for(var n=e.length,r=0;r<n;r++){var i=e.start(r);if(t<i)return i-t}return 1/0}function v(e,t){for(var n=null,r=[],i=0;i<e.length;i++){var a=e.start(i),o=e.end(i);t<a||t>=o?r.push({start:a,end:o}):n={start:a,end:o}}return{outerRanges:r,innerRange:n}}function p(e,t){var n=c(e,t);return null!==n?n.end-t:1/0}function h(e,t){if(t.start===t.end)return e;for(var n=t,r=0;r<e.length;r++){var o=e[r],s=u(n,o),d=l(n,o);if(s||d)n=i(n,o),e.splice(r--,1);else if(0===r){if(a(n,e[0]))break}else if(a(e[r-1],n)&&a(n,o))break}return e.splice(r,0,n),function(e){for(var t=1;t<e.length;t++){var n=e[t-1],r=e[t];if(l(n,r)){var a=i(n,r);e.splice(--t,2,a)}}return e}(function(e){for(var t=0;t<e.length;t++){var n=e[t];n.start===n.end&&e.splice(t--,1)}return e}(e))}function m(e,t){for(var n=[],r=0;r<t.length;r++)u(e,t[r])&&n.push(t[r]);return n}function g(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],a=m(i,t);if(a.length>0)for(var o=0;o<a.length;o++){var s=a[o];n.push({start:Math.max(i.start,s.start),end:Math.min(i.end,s.end)})}}return n}function y(e,t){for(var n=[],r=0;r<e.length;r++){var i=e[r],a=[],o=m(i,t);if(o.length>0)for(var s=0;s<o.length;s++){var u=o[s];a.push({start:Math.max(i.start,u.start),end:Math.min(i.end,u.end)})}if(0===a.length)n.push(i);else{for(var l=i.start,d=0;d<a.length;d++)a[d].start>l&&n.push({start:l,end:a[d].start}),l=a[d].end;l<i.end&&n.push({start:l,end:i.end})}}return n}},5095:function(e,t,n){"use strict";n.d(t,{$l:function(){return o},ZP:function(){return o},lR:function(){return s}});var r=n(1480);function i(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e){var t=e,n=[],a=!1;return{getValue:function(){return t},setValue:function(e){if(!a&&(t=e,0!==n.length))for(var r,o=i(n.slice());!(r=o()).done;){var s=r.value;try{s.hasBeenCleared||s.trigger(e,s.complete)}catch(e){}}},setValueIfChanged:function(e){e!==t&&this.setValue(e)},asObservable:function(e){return new r.y((function(r){if(!0!==e&&r.next(t),!a){var i={trigger:r.next.bind(r),complete:r.complete.bind(r),hasBeenCleared:!1};return n.push(i),function(){if(!i.hasBeenCleared){i.hasBeenCleared=!0;var e=n.indexOf(i);e>=0&&n.splice(e,1)}}}r.complete()}))},onUpdate:function(e,r){var i={trigger:e,complete:o,hasBeenCleared:!1};function o(){if(!i.hasBeenCleared){i.hasBeenCleared=!0;var e=n.indexOf(i);e>=0&&n.splice(e,1)}}n.push(i),!0===(null==r?void 0:r.emitCurrentValue)&&e(t,o),a||i.hasBeenCleared?o():void 0!==(null==r?void 0:r.clearSignal)&&r.clearSignal.register(o)},waitUntilDefined:function(e,n){void 0!==t?e(t):a||this.onUpdate((function(n,r){void 0!==n&&(r(),e(t))}),{clearSignal:null==n?void 0:n.clearSignal})},finish:function(){a=!0;for(var e,t=i(n.slice());!(e=t()).done;){var r=e.value;try{r.hasBeenCleared||(r.complete(),r.hasBeenCleared=!0)}catch(e){}}n.length=0}}}function s(e,t,n){var r=o(t(e.getValue()));return e.onUpdate((function(e){r.setValue(t(e))}),{clearSignal:n}),void 0!==n&&n.register((function(){r.finish()})),r}},4597:function(e,t,n){"use strict";n.d(t,{ZP:function(){return o}});var r=n(9105),i=n(6923),a=n(1946);var o=function(e){var t={url:e.url,headers:e.headers,responseType:(0,a.Z)(e.responseType)?"json":e.responseType,timeout:e.timeout};return new Promise((function(n,o){var s,u=e.onProgress,l=e.cancelSignal,d=t.url,c=t.headers,f=t.responseType,v=t.timeout,p=new XMLHttpRequest;if(p.open("GET",d,!0),void 0!==v&&(p.timeout=v,s=window.setTimeout((function(){_(),o(new r.Z(d,p.status,"TIMEOUT"))}),v+3e3)),p.responseType=f,"document"===p.responseType&&p.overrideMimeType("text/xml"),!(0,a.Z)(c)){var h=c;for(var m in h)h.hasOwnProperty(m)&&p.setRequestHeader(m,h[m])}var g=performance.now(),y=null;function _(){void 0!==s&&clearTimeout(s),null!==y&&y()}void 0!==l&&(y=l.register((function(e){_(),(0,a.Z)(p)||4===p.readyState||p.abort(),o(e)})),l.isCancelled)||(p.onerror=function(){_(),o(new r.Z(d,p.status,"ERROR_EVENT"))},p.ontimeout=function(){_(),o(new r.Z(d,p.status,"TIMEOUT"))},void 0!==u&&(p.onprogress=function(e){var t=performance.now();u({url:d,duration:t-g,sendingTime:g,currentTime:t,size:e.loaded,totalSize:e.total})}),p.onload=function(e){if(4===p.readyState)if(_(),p.status>=200&&p.status<300){var t,s=performance.now(),u=p.response instanceof ArrayBuffer?p.response.byteLength:e.total,l=p.status,c=p.responseType,f=(0,i.Z)(p.responseURL)?p.responseURL:d;if(t="json"===c?"object"==typeof p.response?p.response:function(e){try{return JSON.parse(e)}catch(e){return null}}(p.responseText):p.response,(0,a.Z)(t))return void o(new r.Z(d,p.status,"PARSE_ERROR"));n({status:l,url:f,responseType:c,sendingTime:g,receivedTime:s,requestDuration:s-g,size:u,responseData:t})}else o(new r.Z(d,p.status,"ERROR_HTTP_CODE"))},p.send())}))}},9829:function(e,t,n){"use strict";n.d(t,{$:function(){return s},Z:function(){return o}});var r=/^(?:[a-z]+:)?\/\//i,i=/\/\.{1,2}\//;function a(e){if(!i.test(e))return e;for(var t=[],n=e.split("/"),r=0,a=n.length;r<a;r++)if(".."===n[r])t.pop();else{if("."===n[r])continue;t.push(n[r])}return t.join("/")}function o(){var e=arguments.length;if(0===e)return"";for(var t="",n=0;n<e;n++){var i=n<0||arguments.length<=n?void 0:arguments[n];"string"==typeof i&&""!==i&&(r.test(i)?t=i:("/"===i[0]&&(i=i.substring(1)),"/"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t=t+"/"+i))}return a(t)}function s(e){var t=e.lastIndexOf("/");if(t<0)return e.length;if(r.test(e)){var n=e.indexOf("/");if(n>=0&&t===n+1)return e.length}var i=e.indexOf("?");return i>=0&&i<t?s(e.substring(0,i)):t+1}},9252:function(e,t,n){"use strict";function r(e,t,n){if("function"==typeof String.prototype.startsWith)return e.startsWith(t,n);var r="number"==typeof n?Math.max(n,0):0;return e.substring(r,r+t.length)===t}n.d(t,{Z:function(){return r}})},3635:function(e,t,n){"use strict";n.d(t,{DM:function(){return h},TZ:function(){return s},ci:function(){return v},nr:function(){return f},tG:function(){return l},uR:function(){return c},wO:function(){return p},wV:function(){return u}});var r=n(3887),i=n(811),a="object"==typeof window&&"function"==typeof window.TextDecoder,o="object"==typeof window&&"function"==typeof window.TextEncoder;function s(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint8Array(t),r=0;r<n.length;r+=2){var i=e.charCodeAt(r/2);n[r]=255&i,n[r+1]=i>>8&255}return n}function u(e){if(a)try{return new TextDecoder("utf-16le").decode(e)}catch(e){var t=e instanceof Error?e:"";r.Z.warn("Utils: could not use TextDecoder to parse UTF-16LE, fallbacking to another implementation",t)}for(var n="",i=0;i<e.length;i+=2)n+=String.fromCharCode((e[i+1]<<8)+e[i]);return n}function l(e){if(o)try{return(new TextEncoder).encode(e)}catch(e){var t=e instanceof Error?e:"";r.Z.warn("Utils: could not use TextEncoder to encode string into UTF-8, fallbacking to another implementation",t)}var n,i=encodeURIComponent(e);if("function"==typeof unescape)n=unescape(i);else{var a=/[0-9a-fA-F]/,s=i.length;n="";for(var u=0;u<i.length;u++){var l=!1;if("%"===i[u])if(u<=s-6&&"u"===i[u+1]&&a.test(i[u+2])&&a.test(i[u+3])&&a.test(i[u+4])&&a.test(i[u+5])){var d=parseInt(i.substring(u+1,u+6),16);n+=String.fromCharCode(d),l=!0,u+=5}else if(u<=s-3&&a.test(i[u+1])&&a.test(i[u+2])){var c=parseInt(i.substring(u+1,u+3),16);n+=String.fromCharCode(c),l=!0,u+=2}l||(n+=i[u])}}for(var f=new Uint8Array(n.length),v=0;v<n.length;v++)f[v]=255&n.charCodeAt(v);return f}function d(e,t){var n=e.toString(16);return n.length>=t?n:new Array(t-n.length+1).join("0")+n}function c(e){if(a)try{return(new TextDecoder).decode(e)}catch(e){var t=e instanceof Error?e:"";r.Z.warn("Utils: could not use TextDecoder to parse UTF-8, fallbacking to another implementation",t)}var n=e;239===n[0]&&187===n[1]&&191===n[2]&&(n=n.subarray(3));var i,o=function(e){for(var t="",n=0;n<e.length;n+=16e3){var r=e.subarray(n,n+16e3);t+=String.fromCharCode.apply(null,r)}return t}(n);if("function"==typeof escape)i=escape(o);else{var s=/[A-Za-z0-9*_\+-\.\/]/;i="";for(var u=0;u<o.length;u++)if(s.test(o[u]))i+=o[u];else{var l=o.charCodeAt(u);i+=l>=256?"%u"+d(l,4):"%"+d(l,2)}}return decodeURIComponent(i)}function f(e){for(var t=e.length,n=new Uint8Array(t/2),r=0,i=0;r<t;r+=2,i++)n[i]=255&parseInt(e.substring(r,r+2),16);return n}function v(e,t){void 0===t&&(t="");for(var n="",r=0;r<e.byteLength;r++)n+=(e[r]>>>4).toString(16),n+=(15&e[r]).toString(16),t.length>0&&r<e.byteLength-1&&(n+=t);return n}function p(e){(0,i.Z)(16===e.length,"GUID length should be 16");var t=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],u=e[6],l=e[7],d=new Uint8Array(16);return d[0]=a,d[1]=r,d[2]=n,d[3]=t,d[4]=s,d[5]=o,d[6]=l,d[7]=u,d.set(e.subarray(8,16),8),d}function h(e,t){for(var n=t;n<e.length;){if(0===e[n])break;n+=1}return{end:n+1,string:c(e.subarray(t,n))}}},5278:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1946);function i(){for(var e=0,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(var a=n.length;e<a;){var o=n[e];if(!(0,r.Z)(o))return o;e++}}},288:function(e,t,n){"use strict";n.d(t,{FU:function(){return d},XG:function(){return l},ZP:function(){return u}});var r=n(7326),i=n(4578),a=n(2146),o=n(811),s=n(8894),u=function(){function e(e){var t,n=this,r=(t=s.Z,[function(e){t(e)},function(e){t=e}]),i=r[0],a=r[1];if(this.isUsed=!1,this._trigger=i,this.signal=new l(a),void 0!==(null==e?void 0:e.cancelOn)){var o=e.cancelOn.register((function(){n.cancel()}));this.signal.register(o)}}return e.prototype.cancel=function(e){if(!this.isUsed){this.isUsed=!0;var t=null!=e?e:new d;this._trigger(t)}},e.isCancellationError=function(e){return e instanceof d},e}(),l=function(){function e(e){var t=this;this.isCancelled=!1,this.cancellationError=null,this._listeners=[],e((function(e){for(t.cancellationError=e,t.isCancelled=!0;t._listeners.length>0;){(0,t._listeners.splice(t._listeners.length-1,1)[0])(e)}}))}var t=e.prototype;return t.register=function(e){var t=this;return this.isCancelled&&((0,o.Z)(null!==this.cancellationError),e(this.cancellationError)),this._listeners.push(e),function(){return t.deregister(e)}},t.deregister=function(e){if(!this.isCancelled)for(var t=0;t<this._listeners.length;t++)if(this._listeners[t]===e)return void this._listeners.splice(t,1)},e}(),d=function(e){function t(){var n;return n=e.call(this)||this,Object.setPrototypeOf((0,r.Z)(n),t.prototype),n.name="CancellationError",n.message="This task was cancelled.",n}return(0,i.Z)(t,e),t}((0,a.Z)(Error))},8806:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(7714),i=[];function a(e){(0,r.Z)(i,e)||(console.warn(e),i.push(e))}},7473:function(e){"use strict";var t=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e},n=function(e){var n,r,i=document.createTextNode(""),a=0;return new e((function(){var e;if(n)r&&(n=r.concat(n));else{if(!r)return;n=r}if(r=n,n=null,"function"==typeof r)return e=r,r=null,void e();for(i.data=a=++a%2;r;)e=r.shift(),r.length||(r=null),e()})).observe(i,{characterData:!0}),function(e){t(e),n?"function"==typeof n?n=[n,e]:n.push(e):(n=e,i.data=a=++a%2)}};e.exports=function(){if("object"==typeof process&&process&&"function"==typeof process.nextTick)return process.nextTick;if("function"==typeof queueMicrotask)return function(e){queueMicrotask(t(e))};if("object"==typeof document&&document){if("function"==typeof MutationObserver)return n(MutationObserver);if("function"==typeof WebKitMutationObserver)return n(WebKitMutationObserver)}return"function"==typeof setImmediate?function(e){setImmediate(t(e))}:"function"==typeof setTimeout||"object"==typeof setTimeout?function(e){setTimeout(t(e),0)}:null}()},1480:function(e,t,n){"use strict";n.d(t,{y:function(){return c}});var r=n(6267),i=n(5720),a=n(6766),o=n(278);function s(e){return 0===e.length?o.y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var u=n(3912),l=n(8474),d=n(8846),c=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var a,o=this,s=(a=e)&&a instanceof r.Lv||function(e){return e&&(0,l.m)(e.next)&&(0,l.m)(e.error)&&(0,l.m)(e.complete)}(a)&&(0,i.Nn)(a)?e:new r.Hp(e,t,n);return(0,d.x)((function(){var e=o,t=e.operator,n=e.source;s.add(t?t.call(s,n):n?o._subscribe(s):o._trySubscribe(s))})),s},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=f(t))((function(t,i){var a=new r.Hp({next:function(t){try{e(t)}catch(e){i(e),a.unsubscribe()}},error:i,complete:t});n.subscribe(a)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[a.L]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=f(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function f(e){var t;return null!==(t=null!=e?e:u.v.Promise)&&void 0!==t?t:Promise}},6716:function(e,t,n){"use strict";n.d(t,{x:function(){return l}});var r=n(5987),i=n(1480),a=n(5720),o=(0,n(1819).d)((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),s=n(3699),u=n(8846),l=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return(0,r.ZT)(t,e),t.prototype.lift=function(e){var t=new d(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new o},t.prototype.next=function(e){var t=this;(0,u.x)((function(){var n,i;if(t._throwIfClosed(),!t.isStopped){t.currentObservers||(t.currentObservers=Array.from(t.observers));try{for(var a=(0,r.XA)(t.currentObservers),o=a.next();!o.done;o=a.next()){o.value.next(e)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}}))},t.prototype.error=function(e){var t=this;(0,u.x)((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var n=t.observers;n.length;)n.shift().error(e)}}))},t.prototype.complete=function(){var e=this;(0,u.x)((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,n=this,r=n.hasError,i=n.isStopped,o=n.observers;return r||i?a.Lc:(this.currentObservers=null,o.push(e),new a.w0((function(){t.currentObservers=null,(0,s.P)(o,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,n=t.hasError,r=t.thrownError,i=t.isStopped;n?e.error(r):i&&e.complete()},t.prototype.asObservable=function(){var e=new i.y;return e.source=this,e},t.create=function(e,t){return new d(e,t)},t}(i.y),d=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return(0,r.ZT)(t,e),t.prototype.next=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===n||n.call(t,e)},t.prototype.error=function(e){var t,n;null===(n=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===n||n.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,n;return null!==(n=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==n?n:a.Lc},t}(l)},6267:function(e,t,n){"use strict";n.d(t,{Hp:function(){return g},Lv:function(){return v}});var r=n(5987),i=n(8474),a=n(5720),o=n(3912),s=n(5),u=n(2967),l=d("C",void 0,void 0);function d(e,t,n){return{kind:e,value:t,error:n}}var c=n(8380),f=n(8846),v=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,(0,a.Nn)(t)&&t.add(n)):n.destination=b,n}return(0,r.ZT)(t,e),t.create=function(e,t,n){return new g(e,t,n)},t.prototype.next=function(e){this.isStopped?_(function(e){return d("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?_(d("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?_(l,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(a.w0),p=Function.prototype.bind;function h(e,t){return p.call(e,t)}var m=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(e){y(e)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(e){y(e)}else y(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(e){y(e)}},e}(),g=function(e){function t(t,n,r){var a,s,u=e.call(this)||this;(0,i.m)(t)||!t?a={next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:u&&o.v.useDeprecatedNextContext?((s=Object.create(t)).unsubscribe=function(){return u.unsubscribe()},a={next:t.next&&h(t.next,s),error:t.error&&h(t.error,s),complete:t.complete&&h(t.complete,s)}):a=t;return u.destination=new m(a),u}return(0,r.ZT)(t,e),t}(v);function y(e){o.v.useDeprecatedSynchronousErrorHandling?(0,f.O)(e):(0,s.h)(e)}function _(e,t){var n=o.v.onStoppedNotification;n&&c.z.setTimeout((function(){return n(e,t)}))}var b={closed:!0,next:u.Z,error:function(e){throw e},complete:u.Z}},5720:function(e,t,n){"use strict";n.d(t,{Lc:function(){return u},w0:function(){return s},Nn:function(){return l}});var r=n(5987),i=n(8474),a=(0,n(1819).d)((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}})),o=n(3699),s=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,o,s;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var l=(0,r.XA)(u),c=l.next();!c.done;c=l.next()){c.value.remove(this)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}else u.remove(this);var f=this.initialTeardown;if((0,i.m)(f))try{f()}catch(e){s=e instanceof a?e.errors:[e]}var v=this._finalizers;if(v){this._finalizers=null;try{for(var p=(0,r.XA)(v),h=p.next();!h.done;h=p.next()){var m=h.value;try{d(m)}catch(e){s=null!=s?s:[],e instanceof a?s=(0,r.ev)((0,r.ev)([],(0,r.CR)(s)),(0,r.CR)(e.errors)):s.push(e)}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}if(s)throw new a(s)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)d(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&(0,o.P)(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&(0,o.P)(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),u=s.EMPTY;function l(e){return e instanceof s||e&&"closed"in e&&(0,i.m)(e.remove)&&(0,i.m)(e.add)&&(0,i.m)(e.unsubscribe)}function d(e){(0,i.m)(e)?e():e.unsubscribe()}},3912:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var r={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2034:function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var r=n(4367);function i(){return(0,r.J)(1)}var a=n(2457),o=n(3102);function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i()((0,o.D)(e,(0,a.yG)(e)))}},9917:function(e,t,n){"use strict";n.d(t,{P:function(){return a}});var r=n(1480),i=n(7878);function a(e){return new r.y((function(t){(0,i.Xf)(e()).subscribe(t)}))}},1545:function(e,t,n){"use strict";n.d(t,{E:function(){return r}});var r=new(n(1480).y)((function(e){return e.complete()}))},3102:function(e,t,n){"use strict";n.d(t,{D:function(){return S}});var r=n(7878),i=n(7845),a=n(6798),o=n(2566);function s(e,t){return void 0===t&&(t=0),(0,a.e)((function(n,r){n.subscribe((0,o.x)(r,(function(n){return(0,i.f)(r,e,(function(){return r.next(n)}),t)}),(function(){return(0,i.f)(r,e,(function(){return r.complete()}),t)}),(function(n){return(0,i.f)(r,e,(function(){return r.error(n)}),t)})))}))}var u=n(8720);var l=n(1480);var d=n(9768),c=n(8474);function f(e,t){if(!e)throw new Error("Iterable cannot be null");return new l.y((function(n){(0,i.f)(n,t,(function(){var r=e[Symbol.asyncIterator]();(0,i.f)(n,t,(function(){r.next().then((function(e){e.done?n.complete():n.next(e.value)}))}),0,!0)}))}))}var v=n(1764),p=n(3841),h=n(5685),m=n(1837),g=n(8430),y=n(8729),_=n(8671);function b(e,t){if(null!=e){if((0,v.c)(e))return function(e,t){return(0,r.Xf)(e).pipe((0,u.R)(t),s(t))}(e,t);if((0,h.z)(e))return function(e,t){return new l.y((function(n){var r=0;return t.schedule((function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())}))}))}(e,t);if((0,p.t)(e))return function(e,t){return(0,r.Xf)(e).pipe((0,u.R)(t),s(t))}(e,t);if((0,g.D)(e))return f(e,t);if((0,m.T)(e))return function(e,t){return new l.y((function(n){var r;return(0,i.f)(n,t,(function(){r=e[d.h](),(0,i.f)(n,t,(function(){var e,t,i;try{t=(e=r.next()).value,i=e.done}catch(e){return void n.error(e)}i?n.complete():n.next(t)}),0,!0)})),function(){return(0,c.m)(null==r?void 0:r.return)&&r.return()}}))}(e,t);if((0,_.L)(e))return function(e,t){return f((0,_.Q)(e),t)}(e,t)}throw(0,y.z)(e)}function S(e,t){return t?b(e,t):(0,r.Xf)(e)}},7878:function(e,t,n){"use strict";n.d(t,{Xf:function(){return h}});var r=n(5987),i=n(5685),a=n(3841),o=n(1480),s=n(1764),u=n(8430),l=n(8729),d=n(1837),c=n(8671),f=n(8474),v=n(5),p=n(6766);function h(e){if(e instanceof o.y)return e;if(null!=e){if((0,s.c)(e))return y=e,new o.y((function(e){var t=y[p.L]();if((0,f.m)(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")}));if((0,i.z)(e))return g=e,new o.y((function(e){for(var t=0;t<g.length&&!e.closed;t++)e.next(g[t]);e.complete()}));if((0,a.t)(e))return h=e,new o.y((function(e){h.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,v.h)}));if((0,u.D)(e))return m(e);if((0,d.T)(e))return n=e,new o.y((function(e){var t,i;try{for(var a=(0,r.XA)(n),o=a.next();!o.done;o=a.next()){var s=o.value;if(e.next(s),e.closed)return}}catch(e){t={error:e}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}e.complete()}));if((0,c.L)(e))return t=e,m((0,c.Q)(t))}var t,n,h,g,y;throw(0,l.z)(e)}function m(e){return new o.y((function(t){(function(e,t){var n,i,a,o;return(0,r.mG)(this,void 0,void 0,(function(){var s,u;return(0,r.Jh)(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=(0,r.KL)(e),l.label=1;case 1:return[4,n.next()];case 2:if((i=l.sent()).done)return[3,4];if(s=i.value,t.next(s),t.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return u=l.sent(),a={error:u},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(o=n.return)?[4,o.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(a)throw a.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}}))}))})(e,t).catch((function(e){return t.error(e)}))}))}},3071:function(e,t,n){"use strict";n.d(t,{T:function(){return u}});var r=n(4367),i=n(7878),a=n(1545),o=n(2457),s=n(3102);function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,o.yG)(e),u=(0,o._6)(e,1/0),l=e;return l.length?1===l.length?(0,i.Xf)(l[0]):(0,r.J)(u)((0,s.D)(l,n)):a.E}},2817:function(e,t,n){"use strict";n.d(t,{of:function(){return a}});var r=n(2457),i=n(3102);function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,r.yG)(e);return(0,i.D)(e,n)}},2566:function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var r=n(5987);function i(e,t,n,r,i){return new a(e,t,n,r,i)}var a=function(e){function t(t,n,r,i,a,o){var s=e.call(this,t)||this;return s.onFinalize=a,s.shouldUnsubscribe=o,s._next=n?function(e){try{n(e)}catch(e){t.error(e)}}:e.prototype._next,s._error=i?function(e){try{i(e)}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._error,s._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,s}return(0,r.ZT)(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(n(6267).Lv)},9878:function(e,t,n){"use strict";n.d(t,{K:function(){return o}});var r=n(7878),i=n(2566),a=n(6798);function o(e){return(0,a.e)((function(t,n){var a,s=null,u=!1;s=t.subscribe((0,i.x)(n,void 0,void 0,(function(i){a=(0,r.Xf)(e(i,o(e)(t))),s?(s.unsubscribe(),s=null,a.subscribe(n)):u=!0}))),u&&(s.unsubscribe(),s=null,a.subscribe(n))}))}},533:function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var r=n(6798),i=n(2566),a=n(2967);function o(){return(0,r.e)((function(e,t){e.subscribe((0,i.x)(t,a.Z))}))}},9127:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(6798),i=n(2566);function a(e,t){return(0,r.e)((function(n,r){var a=0;n.subscribe((0,i.x)(r,(function(n){r.next(e.call(t,n,a++))})))}))}},4367:function(e,t,n){"use strict";n.d(t,{J:function(){return a}});var r=n(7877),i=n(278);function a(e){return void 0===e&&(e=1/0),(0,r.z)(i.y,e)}},7877:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(9127),i=n(7878),a=n(6798),o=n(7845),s=n(2566);var u=n(8474);function l(e,t,n){return void 0===n&&(n=1/0),(0,u.m)(t)?l((function(n,a){return(0,r.U)((function(e,r){return t(n,e,a,r)}))((0,i.Xf)(e(n,a)))}),n):("number"==typeof t&&(n=t),(0,a.e)((function(t,r){return function(e,t,n,r,a,u,l,d){var c=[],f=0,v=0,p=!1,h=function(){!p||c.length||f||t.complete()},m=function(e){return f<r?g(e):c.push(e)},g=function(e){u&&t.next(e),f++;var d=!1;(0,i.Xf)(n(e,v++)).subscribe((0,s.x)(t,(function(e){null==a||a(e),u?m(e):t.next(e)}),(function(){d=!0}),void 0,(function(){if(d)try{f--;for(var e=function(){var e=c.shift();l?(0,o.f)(t,l,(function(){return g(e)})):g(e)};c.length&&f<r;)e();h()}catch(e){t.error(e)}})))};return e.subscribe((0,s.x)(t,m,(function(){p=!0,h()}))),function(){null==d||d()}}(t,r,e,n)})))}},8720:function(e,t,n){"use strict";n.d(t,{R:function(){return i}});var r=n(6798);function i(e,t){return void 0===t&&(t=0),(0,r.e)((function(n,r){r.add(e.schedule((function(){return n.subscribe(r)}),t))}))}},3505:function(e,t,n){"use strict";n.d(t,{R:function(){return s}});var r=n(6798),i=n(2566),a=n(7878),o=n(2967);function s(e){return(0,r.e)((function(t,n){(0,a.Xf)(e).subscribe((0,i.x)(n,(function(){return n.complete()}),o.Z)),!n.closed&&t.subscribe(n)}))}},2006:function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var r=n(8474),i=n(6798),a=n(2566),o=n(278);function s(e,t,n){var s=(0,r.m)(e)||t||n?{next:e,error:t,complete:n}:e;return s?(0,i.e)((function(e,t){var n;null===(n=s.subscribe)||void 0===n||n.call(s);var r=!0;e.subscribe((0,a.x)(t,(function(e){var n;null===(n=s.next)||void 0===n||n.call(s,e),t.next(e)}),(function(){var e;r=!1,null===(e=s.complete)||void 0===e||e.call(s),t.complete()}),(function(e){var n;r=!1,null===(n=s.error)||void 0===n||n.call(s,e),t.error(e)}),(function(){var e,t;r&&(null===(e=s.unsubscribe)||void 0===e||e.call(s)),null===(t=s.finalize)||void 0===t||t.call(s)})))})):o.y}},8337:function(e,t,n){"use strict";n.d(t,{o:function(){return s}});var r=n(5987),i=function(e){function t(t,n){return e.call(this)||this}return(0,r.ZT)(t,e),t.prototype.schedule=function(e,t){return void 0===t&&(t=0),this},t}(n(5720).w0),a={setInterval:function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=a.delegate;return(null==o?void 0:o.setInterval)?o.setInterval.apply(o,(0,r.ev)([e,t],(0,r.CR)(n))):setInterval.apply(void 0,(0,r.ev)([e,t],(0,r.CR)(n)))},clearInterval:function(e){var t=a.delegate;return((null==t?void 0:t.clearInterval)||clearInterval)(e)},delegate:void 0},o=n(3699),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r.pending=!1,r}return(0,r.ZT)(t,e),t.prototype.schedule=function(e,t){var n;if(void 0===t&&(t=0),this.closed)return this;this.state=e;var r=this.id,i=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(i,r,t)),this.pending=!0,this.delay=t,this.id=null!==(n=this.id)&&void 0!==n?n:this.requestAsyncId(i,this.id,t),this},t.prototype.requestAsyncId=function(e,t,n){return void 0===n&&(n=0),a.setInterval(e.flush.bind(e,this),n)},t.prototype.recycleAsyncId=function(e,t,n){if(void 0===n&&(n=0),null!=n&&this.delay===n&&!1===this.pending)return t;null!=t&&a.clearInterval(t)},t.prototype.execute=function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(e,t){var n,r=!1;try{this.work(e)}catch(e){r=!0,n=e||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),n},t.prototype.unsubscribe=function(){if(!this.closed){var t=this.id,n=this.scheduler,r=n.actions;this.work=this.state=this.scheduler=null,this.pending=!1,(0,o.P)(r,this),null!=t&&(this.id=this.recycleAsyncId(n,t,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(i)},9682:function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var r=n(5987),i=n(4318),a=function(){function e(t,n){void 0===n&&(n=e.now),this.schedulerActionCtor=t,this.now=n}return e.prototype.schedule=function(e,t,n){return void 0===t&&(t=0),new this.schedulerActionCtor(this,e).schedule(n,t)},e.now=i.l.now,e}(),o=function(e){function t(t,n){void 0===n&&(n=a.now);var r=e.call(this,t,n)||this;return r.actions=[],r._active=!1,r}return(0,r.ZT)(t,e),t.prototype.flush=function(e){var t=this.actions;if(this._active)t.push(e);else{var n;this._active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}},t}(a)},4318:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var r={now:function(){return(r.delegate||Date).now()},delegate:void 0}},8380:function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var r=n(5987),i={setTimeout:function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var o=i.delegate;return(null==o?void 0:o.setTimeout)?o.setTimeout.apply(o,(0,r.ev)([e,t],(0,r.CR)(n))):setTimeout.apply(void 0,(0,r.ev)([e,t],(0,r.CR)(n)))},clearTimeout:function(e){var t=i.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0}},9768:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var r="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},6766:function(e,t,n){"use strict";n.d(t,{L:function(){return r}});var r="function"==typeof Symbol&&Symbol.observable||"@@observable"},2457:function(e,t,n){"use strict";n.d(t,{_6:function(){return u},jO:function(){return o},yG:function(){return s}});var r=n(8474),i=n(4865);function a(e){return e[e.length-1]}function o(e){return(0,r.m)(a(e))?e.pop():void 0}function s(e){return(0,i.K)(a(e))?e.pop():void 0}function u(e,t){return"number"==typeof a(e)?e.pop():t}},3699:function(e,t,n){"use strict";function r(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}n.d(t,{P:function(){return r}})},1819:function(e,t,n){"use strict";function r(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}n.d(t,{d:function(){return r}})},8846:function(e,t,n){"use strict";n.d(t,{O:function(){return o},x:function(){return a}});var r=n(3912),i=null;function a(e){if(r.v.useDeprecatedSynchronousErrorHandling){var t=!i;if(t&&(i={errorThrown:!1,error:null}),e(),t){var n=i,a=n.errorThrown,o=n.error;if(i=null,a)throw o}}else e()}function o(e){r.v.useDeprecatedSynchronousErrorHandling&&i&&(i.errorThrown=!0,i.error=e)}},7845:function(e,t,n){"use strict";function r(e,t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=!1);var a=t.schedule((function(){n(),i?e.add(this.schedule(null,r)):this.unsubscribe()}),r);if(e.add(a),!i)return a}n.d(t,{f:function(){return r}})},278:function(e,t,n){"use strict";function r(e){return e}n.d(t,{y:function(){return r}})},5685:function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var r=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e}},8430:function(e,t,n){"use strict";n.d(t,{D:function(){return i}});var r=n(8474);function i(e){return Symbol.asyncIterator&&(0,r.m)(null==e?void 0:e[Symbol.asyncIterator])}},8474:function(e,t,n){"use strict";function r(e){return"function"==typeof e}n.d(t,{m:function(){return r}})},1764:function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var r=n(6766),i=n(8474);function a(e){return(0,i.m)(e[r.L])}},1837:function(e,t,n){"use strict";n.d(t,{T:function(){return a}});var r=n(9768),i=n(8474);function a(e){return(0,i.m)(null==e?void 0:e[r.h])}},3841:function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var r=n(8474);function i(e){return(0,r.m)(null==e?void 0:e.then)}},8671:function(e,t,n){"use strict";n.d(t,{L:function(){return o},Q:function(){return a}});var r=n(5987),i=n(8474);function a(e){return(0,r.FC)(this,arguments,(function(){var t,n,i;return(0,r.Jh)(this,(function(a){switch(a.label){case 0:t=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,(0,r.qq)(t.read())];case 3:return n=a.sent(),i=n.value,n.done?[4,(0,r.qq)(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,(0,r.qq)(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}function o(e){return(0,i.m)(null==e?void 0:e.getReader)}},4865:function(e,t,n){"use strict";n.d(t,{K:function(){return i}});var r=n(8474);function i(e){return e&&(0,r.m)(e.schedule)}},6798:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var r=n(8474);function i(e){return function(t){if(function(e){return(0,r.m)(null==e?void 0:e.lift)}(t))return t.lift((function(t){try{return e(t,this)}catch(e){this.error(e)}}));throw new TypeError("Unable to lift unknown Observable type")}}},3211:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5987),i=n(9127),a=Array.isArray;function o(e){return(0,i.U)((function(t){return function(e,t){return a(t)?e.apply(void 0,(0,r.ev)([],(0,r.CR)(t))):e(t)}(e,t)}))}},2967:function(e,t,n){"use strict";function r(){}n.d(t,{Z:function(){return r}})},5:function(e,t,n){"use strict";n.d(t,{h:function(){return a}});var r=n(3912),i=n(8380);function a(e){i.z.setTimeout((function(){var t=r.v.onUnhandledError;if(!t)throw e;t(e)}))}},8729:function(e,t,n){"use strict";function r(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}n.d(t,{z:function(){return r}})},5987:function(e,t,n){"use strict";n.d(t,{CR:function(){return u},FC:function(){return c},Jh:function(){return o},KL:function(){return f},XA:function(){return s},ZT:function(){return i},ev:function(){return l},mG:function(){return a},qq:function(){return d}});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}Object.create;function s(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function l(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}function d(e){return this instanceof d?(this.v=e,this):new d(e)}function c(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof d?Promise.resolve(n.value.v).then(u,l):c(a[0][2],n)}catch(e){c(a[0][3],e)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function c(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function f(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=s(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}}Object.create},7061:function(e,t,n){var r=n(8698).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,a=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),o=new A(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(i,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw a;return R()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=T(o,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),a}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=c;var v={};function p(){}function h(){}function m(){}var g={};d(g,s,(function(){return this}));var y=Object.getPrototypeOf,_=y&&y(y(I([])));_&&_!==n&&a.call(_,s)&&(g=_);var b=m.prototype=p.prototype=Object.create(g);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(i,o,s,u){var l=f(e[i],e,o);if("throw"!==l.type){var d=l.arg,c=d.value;return c&&"object"==r(c)&&a.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(c).then((function(e){d.value=e,s(d)}),(function(e){return n("throw",e,s,u)}))}u(l.arg)}var i;this._invoke=function(e,r){function a(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(a,a):a()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=f(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,v;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,v):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function I(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:R}}function R(){return{value:void 0,done:!0}}return h.prototype=m,d(b,"constructor",m),d(m,"constructor",h),h.displayName=d(m,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},t.awrap=function(e){return{__await:e}},S(E.prototype),d(E.prototype,u,(function(){return this})),t.AsyncIterator=E,t.async=function(e,n,r,i,a){void 0===a&&(a=Promise);var o=new E(c(e,n,r,i),a);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(b),d(b,l,"Generator"),d(b,s,(function(){return this})),d(b,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=I,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),u=a.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),v}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,n){var r=n(7061)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,a){var o=e.apply(t,n);function s(e){r(o,i,a,s,u,"next",e)}function u(e){r(o,i,a,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return i}})},3144:function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}n.d(t,{Z:function(){return i}})},4578:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611);function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.Z)(e,t)}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},2146:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return s}});var i=n(9611);function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,t,n){return o=a()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&(0,i.Z)(a,n.prototype),a},o.apply(null,arguments)}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return o(e,arguments,r(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),(0,i.Z)(a,e)},s(e)}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var r={};return function(){"use strict";n.d(r,{default:function(){return Cr}});var e=n(3144),t=n(4578),i=n(6716),a=n(1545),o=n(6798),s=n(2566);function u(e){return e<=0?function(){return a.E}:(0,o.e)((function(t,n){var r=0;t.subscribe((0,s.x)(n,(function(t){++r<=e&&(n.next(t),e<=r&&n.complete())})))}))}var l=n(2453);function d(e){var t=e;if("function"==typeof t.getStartDate){var n=t.getStartDate();if("object"==typeof n&&null!==n){var r=+n;if(!isNaN(r))return r/1e3}else if("number"==typeof n&&!isNaN(n))return n}}var c=n(3666),f=n(3887);function v(){if(!c.vU)return!0;var e=function(){if(!c.vU)return f.Z.warn("Compat: Can't access Firefox version on no firefox browser."),null;var e=navigator.userAgent,t=/Firefox\/([0-9]+)\./.exec(e);if(null===t)return-1;var n=parseInt(t[1],10);return isNaN(n)?-1:n}();if(null===e||e<67)return!0;var t=null===HTMLVideoElement||void 0===HTMLVideoElement?void 0:HTMLVideoElement.prototype;return void 0!==(null==t?void 0:t.requirePictureInPicture)}var p=n(6872),h=n(3714),m=n(8750),g=n(5992),y=n(7874),_=n(811),b=n(1959),S=n(1946),E=n(8026),T=n(2829),w=n(5095),k=n(288),A=n(5861),I=n(4687),R=n.n(I),x=n(6139),Z=n(770);function P(e){return M.apply(this,arguments)}function M(){return(M=(0,A.Z)(R().mark((function e(t){var n,r;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(n=Z.Z.getState(t))){e.next=3;break}return e.abrupt("return");case 3:return f.Z.info("DRM: Disposing of the current MediaKeys"),r=n.loadedSessionsStore,Z.Z.clearState(t),e.next=8,r.closeAllSessions();case 8:(0,x.Y)(t,null);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){var t=Z.Z.getState(e);return null==t?null:t.keySystemOptions.type}function D(e){if(f.Z.info("DRM: Clearing-up DRM session."),c.fq)return f.Z.info("DRM: disposing current MediaKeys."),P(e);var t=Z.Z.getState(e);return null!==t&&!0===t.keySystemOptions.closeSessionsOnStop?(f.Z.info("DRM: closing all current sessions."),t.loadedSessionsStore.closeAllSessions()):(f.Z.info("DRM: Nothing to clear. Returning right away. No state =",null===t),Promise.resolve())}var O=n(8619),N=n(7904),L=n(8894),U=n(5278),B=n(5138);function F(e){var t=e.map((function(t){return Math.log(t/e[0])})),n=t.map((function(e){return e-t[0]+1})),r=(n[n.length-1]-1)/(2*e.length+10),i=1/r;return e.map((function(e,t){return a(t)}));function a(t){if(0===t)return 0;var o=Math.min(Math.max(1,t),e.length-1);return e[o]===e[o-1]?a(t-1):i*(r+(e[o]*n[o-1]-e[o-1]*n[o])/(e[o]-e[o-1]))+4}}var z=function(){function e(e){this._levelsMap=F(e),this._bitrates=e,f.Z.debug("ABR: Steps for buffer based chooser.",this._levelsMap.map((function(t,n){return"bufferLevel: "+t+", bitrate: "+e[n]})).join(" ,"))}return e.prototype.getEstimate=function(e){var t=this._levelsMap,n=this._bitrates,r=e.bufferGap,i=e.currentBitrate,a=e.currentScore,o=e.speed;if(null==i)return n[0];var s,u=(0,B.Z)(n,(function(e){return e===i}));if(u<0||n.length!==t.length)return f.Z.error("ABR: Current Bitrate not found in the calculated levels"),n[0];if(null!=a&&(s=0===o?a:a/o),null!=s&&s>1){var l=t[u],d=function(){for(var e=u+1;e<t.length;e++)if(t[e]>l)return e}();if(null!=d)if(r>=t[d])return n[d]}if((null==s||s<1.15)&&r<t[u]){for(var c=u-1;c>=0;c--)if(n[c]<i)return n[c];return i}return i},e}(),V=n(3274),K=function(){function e(e){this._alpha=Math.exp(Math.log(.5)/e),this._lastEstimate=0,this._totalWeight=0}var t=e.prototype;return t.addSample=function(e,t){var n=Math.pow(this._alpha,e),r=t*(1-n)+n*this._lastEstimate;isNaN(r)||(this._lastEstimate=r,this._totalWeight+=e)},t.getEstimate=function(){var e=1-Math.pow(this._alpha,this._totalWeight);return this._lastEstimate/e},e}();function G(e){if(!(e.progress.length<5)){for(var t=new K(2),n=e.progress,r=1;r<n.length;r++){var i=n[r].size-n[r-1].size,a=n[r].timestamp-n[r-1].timestamp,o=8*i/(a/1e3);t.addSample(a/1e3,o)}return t.getEstimate()}}function W(e,t){var n=8*(e.totalSize-e.size);return Math.max(n/t,0)}var H=function(){function e(e,t){var n=p.Z.getCurrent(),r=n.ABR_STARVATION_GAP,i=n.OUT_OF_STARVATION_GAP,a=n.ABR_STARVATION_FACTOR,o=n.ABR_REGULAR_FACTOR;this._initialBitrate=e,this._inStarvationMode=!1,this._lowLatencyMode=t,this._config=t?{starvationGap:r.LOW_LATENCY,outOfStarvationGap:i.LOW_LATENCY,starvationBitrateFactor:a.LOW_LATENCY,regularBitrateFactor:o.LOW_LATENCY}:{starvationGap:r.DEFAULT,outOfStarvationGap:i.DEFAULT,starvationBitrateFactor:a.DEFAULT,regularBitrateFactor:o.DEFAULT}}var t=e.prototype;return t.getBandwidthEstimate=function(e,t,n,r,i){var a,o,s=this._config,u=e.bufferGap,l=e.position,d=e.duration,c=isFinite(u)?u:0,v=p.Z.getCurrent().ABR_STARVATION_DURATION_DELTA;return isNaN(d)||c+l.last<d-v?!this._inStarvationMode&&c<=s.starvationGap?(f.Z.info("ABR: enter starvation mode."),this._inStarvationMode=!0):this._inStarvationMode&&c>=s.outOfStarvationGap&&(f.Z.info("ABR: exit starvation mode."),this._inStarvationMode=!1):this._inStarvationMode&&(f.Z.info("ABR: exit starvation mode."),this._inStarvationMode=!1),this._inStarvationMode&&(o=function(e,t,n,r,i){if(!r){var a=t.bufferGap,o=t.speed,s=t.position,u=isFinite(a)?a:0,l=function(e,t){for(var n=-1,r=0;r<e.length;r++){var i=e[r].content.segment;if(!(i.duration<=0)){var a=i.time+i.duration;if(!i.complete&&r===e.length-1&&t-i.time>-1.2){n=r;break}if(a>t&&t-i.time>-1.2){n=r;break}}}if(n<0)return[];for(var o=e[n],s=o.content.segment.time,u=[o],l=n+1;l<e.length&&e[l].content.segment.time===s;l++)u.push(e[l]);return u}(e,s.last+u);if(1===l.length){var d=l[0],c=performance.now(),f=d.progress.length>0?d.progress[d.progress.length-1]:void 0,v=G(d);if(void 0!==f&&void 0!==v){var p=W(f,v);if((c-f.timestamp)/1e3<=p&&p-u/o>2e3)return v}if(d.content.segment.complete){var h=d.content.segment.duration,m=(c-d.requestTimestamp)/1e3;if(null!=n&&!(m<=(1.5*h+2)/o)){var g=h/m,y=n.bitrate*Math.min(.7,g);return void 0===i||y<i?y:void 0}}}}}(r,e,n,this._lowLatencyMode,i),null!=o&&(f.Z.info("ABR: starvation mode emergency estimate:",o),t.reset(),a=null==n?o:Math.min(o,n.bitrate))),null==a&&(a=null!=(o=t.getEstimate())?o*(this._inStarvationMode?s.starvationBitrateFactor:s.regularBitrateFactor):null!=i?i*(this._inStarvationMode?s.starvationBitrateFactor:s.regularBitrateFactor):this._initialBitrate),e.speed>1&&(a/=e.speed),{bandwidthEstimate:o,bitrateChosen:a}},t.isUrgent=function(e,t,n,r){return null===t||e!==t.bitrate&&(e>t.bitrate?!this._inStarvationMode:function(e,t,n){if(n)return!0;var r=isFinite(e.bufferGap)?e.bufferGap:0,i=e.position.last+r,a=(0,V.Z)(t,(function(e){var t=e.content;return t.segment.duration>0&&t.segment.time+t.segment.duration>i}));if(void 0===a)return!0;var o=performance.now(),s=a.progress.length>0?a.progress[a.progress.length-1]:void 0,u=G(a);if(void 0===s||void 0===u)return!0;var l=W(s,u);return(o-s.timestamp)/1e3>1.2*l||l-r/e.speed>-1.5}(r,n,this._lowLatencyMode))},e}();function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Y=function(){function e(e,t){this._scoreCalculator=e,this._lastAbrEstimate=t,this._consecutiveWrongGuesses=0,this._blockGuessesUntil=0,this._lastMaintanableBitrate=null}var t=e.prototype;return t.getGuess=function(e,t,n,r,i){var a=t.bufferGap,o=t.speed,s=this._lastAbrEstimate.representation;if(null===s)return null;if(r>s.bitrate)return 2===this._lastAbrEstimate.algorithmType&&(null!==this._lastAbrEstimate.representation&&(this._lastMaintanableBitrate=this._lastAbrEstimate.representation.bitrate),this._consecutiveWrongGuesses=0),null;var u=this._scoreCalculator.getEstimate(n);if(2!==this._lastAbrEstimate.algorithmType){if(void 0===u)return null;if(this._canGuessHigher(a,o,u)){var l=X(e,n);if(null!==l)return l}return null}if(this._isLastGuessValidated(s,r,u)&&(f.Z.debug("ABR: Guessed Representation validated",s.bitrate),this._lastMaintanableBitrate=s.bitrate,this._consecutiveWrongGuesses=0),n.id!==s.id)return s;if(this._shouldStopGuess(n,u,a,i))return this._consecutiveWrongGuesses++,this._blockGuessesUntil=performance.now()+Math.min(15e3*this._consecutiveWrongGuesses,12e4),function(e,t){var n=(0,B.Z)(e,(function(e){return e.id===t.id}));if(n<0)return f.Z.error("ABR: Current Representation not found."),null;for(;--n>=0;)if(e[n].bitrate<t.bitrate)return e[n];return null}(e,n);if(void 0===u)return n;if(this._canGuessHigher(a,o,u)){var d=X(e,n);if(null!==d)return d}return n},t._canGuessHigher=function(e,t,n){var r=n[0],i=n[1];return isFinite(e)&&e>=2.5&&performance.now()>this._blockGuessesUntil&&1===i&&r/t>1.01},t._shouldStopGuess=function(e,t,n,r){if(void 0!==t&&t[0]<1.01)return!0;if((void 0===t||t[0]<1.2)&&n<.6)return!0;for(var i,a=r.filter((function(t){return t.content.representation.id===e.id})),o=performance.now(),s=j(a);!(i=s()).done;){var u=i.value,l=o-u.requestTimestamp;if(u.content.segment.isInit){if(l>1e3)return!0}else{if(l>1e3*u.content.segment.duration+200)return!0;var d=G(u);if(void 0!==d&&d<.8*e.bitrate)return!0}}return!1},t._isLastGuessValidated=function(e,t,n){return void 0!==n&&1===n[1]&&n[0]>1.5||t>=e.bitrate&&(null===this._lastMaintanableBitrate||this._lastMaintanableBitrate<e.bitrate)},e}();function X(e,t){var n=e.length,r=(0,B.Z)(e,(function(e){return e.id===t.id}));if(r<0)return f.Z.error("ABR: Current Representation not found."),null;for(;++r<n;)if(e[r].bitrate>t.bitrate)return e[r];return null}var $=function(){function e(){var e=p.Z.getCurrent(),t=e.ABR_FAST_EMA,n=e.ABR_SLOW_EMA;this._fastEWMA=new K(t),this._slowEWMA=new K(n),this._bytesSampled=0}var t=e.prototype;return t.addSample=function(e,t){if(!(t<p.Z.getCurrent().ABR_MINIMUM_CHUNK_SIZE)){var n=8e3*t/e,r=e/1e3;this._bytesSampled+=t,this._fastEWMA.addSample(r,n),this._slowEWMA.addSample(r,n)}},t.getEstimate=function(){var e=p.Z.getCurrent().ABR_MINIMUM_TOTAL_BYTES;if(!(this._bytesSampled<e))return Math.min(this._fastEWMA.getEstimate(),this._slowEWMA.getEstimate())},t.reset=function(){var e=p.Z.getCurrent(),t=e.ABR_FAST_EMA,n=e.ABR_SLOW_EMA;this._fastEWMA=new K(t),this._slowEWMA=new K(n),this._bytesSampled=0},e}();var Q=function(){function e(){this.bandwidth=void 0,this.representation=null,this.algorithmType=3}return e.prototype.update=function(e,t,n){this.representation=e,this.bandwidth=t,this.algorithmType=n},e}(),J=n(1679),ee=function(){function e(){this._currentRequests={}}var t=e.prototype;return t.add=function(e){var t=e.id,n=e.requestTimestamp,r=e.content;this._currentRequests[t]={requestTimestamp:n,progress:[],content:r}},t.addProgress=function(e){var t=this._currentRequests[e.id];null!=t?t.progress.push(e):f.Z.warn("ABR: progress for a request not added")},t.remove=function(e){null==this._currentRequests[e]&&f.Z.warn("ABR: can't remove unknown request"),delete this._currentRequests[e]},t.getRequests=function(){return(0,J.Z)(this._currentRequests).filter((function(e){return null!=e})).sort((function(e,t){return e.content.segment.time-t.content.segment.time}))},e}(),te=function(){function e(){this._currentRepresentationData=null,this._lastRepresentationWithGoodScore=null}var t=e.prototype;return t.addSample=function(e,t,n){var r,i=n/t,a=this._currentRepresentationData;null!==a&&a.representation.id===e.id?(r=a.ewma,a.ewma.addSample(t,i),a.loadedDuration+=n,a.loadedSegments++):((r=new K(5)).addSample(t,i),this._currentRepresentationData={representation:e,ewma:r,loadedDuration:n,loadedSegments:0}),r.getEstimate()>1&&this._lastRepresentationWithGoodScore!==e&&(f.Z.debug("ABR: New last stable representation",e.bitrate),this._lastRepresentationWithGoodScore=e)},t.getEstimate=function(e){if(null!==this._currentRepresentationData&&this._currentRepresentationData.representation.id===e.id){var t=this._currentRepresentationData,n=t.ewma,r=t.loadedSegments,i=t.loadedDuration;return[n.getEstimate(),r>=5&&i>=10?1:0]}},t.getLastStableRepresentation=function(){return this._lastRepresentationWithGoodScore},e}();function ne(e,t,n,r){var i=t<=n?n:t>=r?r:t,a=(0,B.Z)(e,(function(e){return e.bitrate>i}));return-1===a?e[e.length-1]:0===a?e[0]:e[a-1]}var re=function(e){var t={},n=e.manualBitrates,r=e.minAutoBitrates,i=e.maxAutoBitrates,a=e.initialBitrates,o=e.throttlers,s=e.lowLatencyMode;return function(e,u,l,d,c){var v=e.adaptation.type,p=function(e){var n=t[e];if(null==n){f.Z.debug("ABR: Creating new BandwidthEstimator for ",e);var r=new $;return t[e]=r,r}return n}(v),h=(0,U.Z)(n[v],(0,w.ZP)(-1)),m=(0,U.Z)(r[v],(0,w.ZP)(0)),g=(0,U.Z)(i[v],(0,w.ZP)(1/0)),y=(0,U.Z)(a[v],0);return function(e,t){var n=e.bandwidthEstimator,r=e.context,i=e.currentRepresentation,a=e.filters,o=e.initialBitrate,s=e.lowLatencyMode,u=e.manualBitrate,l=e.maxAutoBitrate,d=e.minAutoBitrate,c=e.playbackObserver,v=e.representations,p=new te,h=new H(null!=o?o:0,s),m=new ee,g=L.Z,y={metrics:A,requestBegin:I,requestProgress:R,requestEnd:x,addedSegment:function(e){g(e)}},_=new k.ZP({cancelOn:t}),b=S(u.getValue(),v.getValue(),_.signal);return u.onUpdate(E,{clearSignal:t}),v.onUpdate(E,{clearSignal:t}),{estimates:b,callbacks:y};function S(e,t,o){if(e>=0){var u=ne(t,e,0,1/0);return(0,w.ZP)({representation:u,bitrate:void 0,knownStableBitrate:void 0,manual:!0,urgent:!0})}if(1===t.length)return(0,w.ZP)({bitrate:void 0,representation:t[0],manual:!1,urgent:!0,knownStableBitrate:void 0});var v,y=!1,_=t.map((function(e){return e.bitrate})),b=new z(_),S=new Q,E=new Y(p,S),k=c.getReference().getValue(),A=(0,w.ZP)(R());return c.listen((function(e){k=e,I()}),{includeLastObservation:!1,clearSignal:o}),g=function(e){if(null!==k){var t=k,n=t.position,r=t.speed,i=e.buffered,a=(0,T.L7)(i,n.last),o=e.content.representation,s=p.getEstimate(o),u=null==s?void 0:s[0],l={bufferGap:a,currentBitrate:o.bitrate,currentScore:u,speed:r};v=b.getEstimate(l),I()}},o.register((function(){g=L.Z})),d.onUpdate(I,{clearSignal:o}),l.onUpdate(I,{clearSignal:o}),a.limitWidth.onUpdate(I,{clearSignal:o}),a.limitWidth.onUpdate(I,{clearSignal:o}),A;function I(){A.setValue(R())}function R(){var e=k,o=e.bufferGap,u=e.position,c=e.maximumPosition,g=a.limitWidth.getValue(),_=a.throttleBitrate.getValue(),b=i.getValue(),T=d.getValue(),w=l.getValue(),A=function(e,t,n){var r=e;n<1/0&&(r=function(e,t){if(0===e.length)return[];e.sort((function(e,t){return e.bitrate-t.bitrate}));var n=e[0].bitrate,r=Math.max(t,n),i=(0,B.Z)(e,(function(e){return e.bitrate>r}));return-1===i?e:e.slice(0,i)}(r,n));void 0!==t&&(r=function(e,t){var n=e.slice().sort((function(e,t){return(0,U.Z)(e.width,0)-(0,U.Z)(t.width,0)})),r=(0,V.Z)(n,(function(e){return"number"==typeof e.width&&e.width>=t}));if(void 0===r)return e;var i="number"==typeof r.width?r.width:0;return e.filter((function(e){return"number"!=typeof e.width||e.width<=i}))}(r,t));return r}(t,g,_),I=m.getRequests(),R=h.getBandwidthEstimate(k,n,b,I,S.bandwidth),x=R.bandwidthEstimate,Z=R.bitrateChosen,P=p.getLastStableRepresentation(),M=null===P?void 0:P.bitrate/(k.speed>0?k.speed:1);y&&o<=5?y=!1:!y&&isFinite(o)&&o>10&&(y=!0);var C=ne(A,Z,T,w),D=C.bitrate,O=null;y&&void 0!==v&&v>D&&(D=(O=ne(A,v,T,w)).bitrate);var N=null;return s&&null!==b&&r.manifest.isDynamic&&c-u.last<40&&(N=E.getGuess(t,k,b,D,I)),null!==N&&N.bitrate>D?(f.Z.debug("ABR: Choosing representation with guess-based estimation.",N.bitrate,N.id),S.update(N,x,2),{bitrate:x,representation:N,urgent:null===b||N.bitrate<b.bitrate,manual:!1,knownStableBitrate:M}):null!==O?(f.Z.debug("ABR: Choosing representation with buffer-based estimation.",O.bitrate,O.id),S.update(O,x,0),{bitrate:x,representation:O,urgent:h.isUrgent(O.bitrate,b,I,k),manual:!1,knownStableBitrate:M}):(f.Z.debug("ABR: Choosing representation with bandwidth estimation.",C.bitrate,C.id),S.update(C,x,1),{bitrate:x,representation:C,urgent:h.isUrgent(C.bitrate,b,I,k),manual:!1,knownStableBitrate:M})}}function E(){var e=u.getValue(),n=v.getValue();_.cancel(),S(e,n,(_=new k.ZP({cancelOn:t})).signal).onUpdate((function(e){b.setValue(e)}),{clearSignal:_.signal,emitCurrentValue:!0})}function A(e){var t=e.requestDuration,r=e.segmentDuration,i=e.size,a=e.content;if(n.addSample(t,i),!a.segment.isInit){var o=a.segment,s=a.representation;if(void 0===r&&!o.complete)return;var u=null!=r?r:o.duration;p.addSample(s,t/1e3,u)}}function I(e){m.add(e)}function R(e){m.addProgress(e)}function x(e){m.remove(e.id)}}({bandwidthEstimator:p,context:e,currentRepresentation:u,filters:{limitWidth:(0,U.Z)(o.limitWidth[v],(0,w.ZP)(void 0)),throttleBitrate:(0,U.Z)(o.throttleBitrate[v],(0,w.ZP)(1/0))},initialBitrate:y,manualBitrate:h,minAutoBitrate:m,maxAutoBitrate:g,playbackObserver:d,representations:l,lowLatencyMode:s},c)}},ie=n(9105),ae=n(9362);function oe(e){return e instanceof ie.Z?new ae.Z("PIPELINE_LOAD_ERROR",e):(0,m.Z)(e,{defaultCode:"PIPELINE_LOAD_ERROR",defaultReason:"Unknown error when fetching the Manifest"})}var se=n(7839),ue=n(9822),le=n(7864),de=n(2572);function ce(e){return e instanceof ie.Z?e.type===g.br.ERROR_HTTP_CODE?e.status>=500||404===e.status||415===e.status||412===e.status:e.type===g.br.TIMEOUT||e.type===g.br.ERROR_EVENT:e instanceof se.Z?"boolean"==typeof e.canRetry?e.canRetry:void 0!==e.xhr&&(e.xhr.status>=500||404===e.xhr.status||415===e.xhr.status||412===e.xhr.status):(0,ue.Z)(e)&&"INTEGRITY_ERROR"===e.code}function fe(e){return e instanceof ie.Z?e.type===g.br.ERROR_EVENT&&!1===navigator.onLine:e instanceof se.Z&&e.isOfflineError}function ve(e){return fe(e)?2:1}function pe(e,t,n,r,i){return he.apply(this,arguments)}function he(){return he=(0,A.Z)(R().mark((function e(t,n,r,i,a){var o,s,u,l,d,c,v,p,h,m,g,y,_,b;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b=function(e){var t;if(0===c.size)return e[0];var n=performance.now();return null===(t=e.filter((function(e){var t;return!0!==(null===(t=c.get(e))||void 0===t?void 0:t.isBlacklisted)})).reduce((function(e,t){var r,i=null===(r=c.get(t))||void 0===r?void 0:r.blockedUntil;return void 0!==i&&i<=n&&(i=void 0),void 0===e?[t,i]:void 0===i?void 0===e[1]?e:[t,void 0]:void 0===e[1]?e:i<e[1]?[t,i]:e}),void 0))||void 0===t?void 0:t[0]},_=function(e,t){var r=c.get(e);if(void 0===r||void 0===r.blockedUntil)return h(e);var i=performance.now(),o=r.blockedUntil-i;if(o<=0)return h(e);var s=new k.ZP({cancelOn:a});return new Promise((function(r,i){null==n||n.addEventListener("priorityChange",(function(){var n=p();if(a.isCancelled)throw a.cancellationError;if(void 0===n)return i(t);n!==e&&(s.cancel(),_(n,t).then(r,i))}),s.signal),(0,le.Z)(o,s.signal).then((function(){return h(e).then(r,i)}),L.Z)}))},y=function(){return(y=(0,A.Z)(R().mark((function e(t){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p(),!a.isCancelled){e.next=3;break}throw a.cancellationError;case 3:if(void 0!==n){e.next=5;break}throw t;case 5:if(d(t),!a.isCancelled){e.next=8;break}throw a.cancellationError;case 8:return e.abrupt("return",_(n,t));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)},g=function(e){return y.apply(this,arguments)},m=function(){return(m=(0,A.Z)(R().mark((function e(t){var i,d,f,v,p,h,m;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(t,a);case 3:return i=e.sent,e.abrupt("return",i);case 7:if(e.prev=7,e.t0=e.catch(0),!k.ZP.isCancellationError(e.t0)){e.next=11;break}throw e.t0;case 11:if(null!==t&&null!==n&&n.downgradeCdn(t),d=ve(e.t0),void 0===(f=c.get(t))?(f={errorCounter:1,lastErrorType:d,blockedUntil:void 0,isBlacklisted:!1},c.set(t,f)):d!==f.lastErrorType?(f.errorCounter=1,f.lastErrorType=d):f.errorCounter++,ce(e.t0)){e.next=19;break}return f.blockedUntil=void 0,f.isBlacklisted=!0,e.abrupt("return",g(e.t0));case 19:return v=2===d?l:u,f.errorCounter>v?(f.blockedUntil=void 0,f.isBlacklisted=!0):(p=f.errorCounter,h=Math.min(o*Math.pow(2,p-1),s),m=(0,de.Z)(h),f.blockedUntil=performance.now()+m),e.abrupt("return",g(e.t0));case 22:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)},h=function(e){return m.apply(this,arguments)},p=function(){if(null===t){var e=c.get(null);if(void 0!==e&&e.isBlacklisted)return;return null}if(null===n)return b(t);var r=n.getCdnPreferenceForResource(t);return b(r)},null===a.cancellationError){e.next=9;break}return e.abrupt("return",Promise.reject(a.cancellationError));case 9:if(o=i.baseDelay,s=i.maxDelay,u=i.maxRetryRegular,l=i.maxRetryOffline,d=i.onRetry,null!==t&&0===t.length&&f.Z.warn("Fetchers: no CDN given to `scheduleRequestWithCdns`."),c=new Map,void 0!==(v=p())){e.next=15;break}throw new Error("No CDN to request");case 15:return e.abrupt("return",h(v));case 16:case"end":return e.stop()}}),e)}))),he.apply(this,arguments)}function me(e,t,n){return pe(null,null,e,t,n)}function ge(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ye(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _e=function(){function e(e,t,n){this._manifestUrl=e,this._pipelines=t.manifest,this._settings=n}var t=e.prototype;return t.fetch=function(){var e=(0,A.Z)(R().mark((function e(t,n,r){var i,a,o,s,u,l,d=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=function(e){var t=a.loadManifest,n=(0,S.Z)(i.requestTimeout)?p.Z.getCurrent().DEFAULT_REQUEST_TIMEOUT:i.requestTimeout;n<0&&(n=void 0);return me((function(){return t(e,{timeout:n},r)}),s,r)},i=this._settings,a=this._pipelines,o=null!=t?t:this._manifestUrl,s=this._getBackoffSetting((function(e){n(oe(e))})),e.prev=5,e.next=8,l(o);case 8:return u=e.sent,e.abrupt("return",{parse:function(e){return d._parseLoadedManifest(u,e,n,r)}});case 12:if(e.prev=12,e.t0=e.catch(5),!(e.t0 instanceof k.XG)){e.next=16;break}throw e.t0;case 16:throw oe(e.t0);case 17:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(t,n,r){return e.apply(this,arguments)}}(),t.parse=function(e,t,n,r){return this._parseLoadedManifest({responseData:e,size:void 0,requestDuration:void 0},t,n,r)},t._parseLoadedManifest=function(){var e=(0,A.Z)(R().mark((function e(t,n,r,i){var a,o,s,u,l,d,c,v,p,h,g,y,_;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_=function(e){y(e.contentWarnings);var t=performance.now()-a;return f.Z.info("MF: Manifest parsed in "+t+"ms"),{manifest:e,sendingTime:s,receivedTime:u,parsingTime:t}},y=function(e){for(var t,n=ge(e);!(t=n()).done;){var i=t.value;if(o.isUsed)return;var a=(0,m.Z)(i,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"});r(a)}},g=function(){return(g=(0,A.Z)(R().mark((function e(t){var n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,me(t,l,i);case 3:return n=e.sent,e.abrupt("return",n);case 7:throw e.prev=7,e.t0=e.catch(0),oe(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)},h=function(e){return g.apply(this,arguments)},a=performance.now(),o=new k.ZP,s=t.sendingTime,u=t.receivedTime,l=this._getBackoffSetting((function(e){r(oe(e))})),d={externalClockOffset:n.externalClockOffset,unsafeMode:n.unsafeMode,previousManifest:n.previousManifest,originalUrl:this._manifestUrl},e.prev=9,c=this._pipelines.parseManifest(t,d,y,i,h),c instanceof Promise){e.next=15;break}return e.abrupt("return",_(c.manifest));case 15:return e.next=17,c;case 17:return v=e.sent,p=v.manifest,e.abrupt("return",_(p));case 20:e.next=26;break;case 22:throw e.prev=22,e.t0=e.catch(9),(0,m.Z)(e.t0,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown error when parsing the Manifest"});case 26:case"end":return e.stop()}}),e,this,[[9,22]])})));return function(t,n,r,i){return e.apply(this,arguments)}}(),t._getBackoffSetting=function(e){var t=p.Z.getCurrent(),n=t.DEFAULT_MAX_MANIFEST_REQUEST_RETRY,r=t.DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE,i=t.INITIAL_BACKOFF_DELAY_BASE,a=t.MAX_BACKOFF_DELAY_BASE,o=this._settings,s=o.lowLatencyMode,u=o.maxRetryRegular,l=o.maxRetryOffline;return{onRetry:e,baseDelay:s?i.LOW_LATENCY:i.REGULAR,maxDelay:s?a.LOW_LATENCY:a.REGULAR,maxRetryRegular:null!=u?u:n,maxRetryOffline:null!=l?l:r}},e}();var be=_e;function Se(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ee(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=function(e){function n(t){var n;return(n=e.call(this)||this)._downgradedCdnList={metadata:[],timeouts:[]},t.register((function(){for(var e,t=Se(n._downgradedCdnList.timeouts);!(e=t()).done;){var r=e.value;clearTimeout(r)}n._downgradedCdnList={metadata:[],timeouts:[]}})),n}(0,t.Z)(n,e);var r=n.prototype;return r.getCdnPreferenceForResource=function(e){return e.length<=1?e:this._innerGetCdnPreferenceForResource(e)},r.downgradeCdn=function(e){var t=this,n=we(this._downgradedCdnList.metadata,e);n>=0&&this._removeIndexFromDowngradeList(n);var r=p.Z.getCurrent().DEFAULT_CDN_DOWNGRADE_TIME;this._downgradedCdnList.metadata.push(e);var i=window.setTimeout((function(){var n=we(t._downgradedCdnList.metadata,e);n>=0&&t._removeIndexFromDowngradeList(n),t.trigger("priorityChange",null)}),r);this._downgradedCdnList.timeouts.push(i),this.trigger("priorityChange",null)},r._innerGetCdnPreferenceForResource=function(e){var t=this,n=e.reduce((function(e,n){return t._downgradedCdnList.metadata.some((function(e){return e.id===n.id&&e.baseUrl===n.baseUrl}))?e[1].push(n):e[0].push(n),e}),[[],[]]),r=n[0],i=n[1];return r.concat(i)},r._removeIndexFromDowngradeList=function(e){this._downgradedCdnList.metadata.splice(e,1);var t=this._downgradedCdnList.timeouts.splice(e,1);clearTimeout(t[0])},n}(b.Z);function we(e,t){return 0===e.length?-1:void 0!==t.id?(0,B.Z)(e,(function(e){return e.id===t.id})):(0,B.Z)(e,(function(e){return e.baseUrl===t.baseUrl}))}var ke=n(520),Ae=n(7714),Ie=n(908),Re=function(){function e(){this._cache=new WeakMap}var t=e.prototype;return t.add=function(e,t){var n=e.representation;e.segment.isInit&&this._cache.set(n,t)},t.get=function(e){var t=e.representation;if(e.segment.isInit){var n=this._cache.get(t);if(void 0!==n)return n}return null},e}(),xe=(0,Ie.Z)();var Ze=function(){function e(e){var t=e.prioritySteps;if(this._minPendingPriority=null,this._waitingQueue=[],this._pendingTasks=[],this._prioritySteps=t,this._prioritySteps.high>=this._prioritySteps.low)throw new Error("TP: the max high level priority should be given a lowerpriority number than the min low priority.")}var t=e.prototype;return t.create=function(e,t,n,r){var i,a=this;return new Promise((function(o,s){var u=r.register((function(e){a._endTask(i),s(e)})),l=function(){u(),a._endTask(i)},d=function(e){n.beforeEnded(),l(),o(e)},c=function(e){l(),s(e)};i={hasEnded:!1,priority:t,trigger:function(){if(i.hasEnded)u();else{var e=new k.ZP({cancelOn:r});i.interrupter=e,e.signal.register((function(){i.interrupter=null,r.isCancelled||n.beforeInterrupted()})),a._minPendingPriority=null===a._minPendingPriority?i.priority:Math.min(a._minPendingPriority,i.priority),a._pendingTasks.push(i),i.taskFn(e.signal).then(d).catch((function(t){!r.isCancelled&&e.isUsed&&t instanceof k.FU||c(t)}))}},taskFn:e,interrupter:null},a._canBeStartedNow(i)?(i.trigger(),a._isRunningHighPriorityTasks()&&a._interruptCancellableTasks()):a._waitingQueue.push(i)}))},t._endTask=function(e){e.hasEnded=!0;var t=Pe(e.taskFn,this._waitingQueue);if(t>=0)this._waitingQueue.splice(t,1);else{var n=Pe(e.taskFn,this._pendingTasks);if(n<0)return;this._pendingTasks.splice(n,1),this._pendingTasks.length>0?this._minPendingPriority===e.priority&&(this._minPendingPriority=Math.min.apply(Math,this._pendingTasks.map((function(e){return e.priority})))):this._minPendingPriority=null,this._loopThroughWaitingQueue()}},t.updatePriority=function(e,t){var n=Pe(e,this._waitingQueue);if(n>=0){var r=this._waitingQueue[n];if(r.priority===t)return;if(r.priority=t,!this._canBeStartedNow(r))return;return this._findAndRunWaitingQueueTask(n),void(this._isRunningHighPriorityTasks()&&this._interruptCancellableTasks())}var i=Pe(e,this._pendingTasks);if(i<0)f.Z.warn("TP: request to update the priority of a non-existent task");else{var a=this._pendingTasks[i];if(a.priority!==t){var o=a.priority;a.priority=t,null===this._minPendingPriority||t<this._minPendingPriority?this._minPendingPriority=t:this._minPendingPriority===o&&(1===this._pendingTasks.length?this._minPendingPriority=t:this._minPendingPriority=Math.min.apply(Math,this._pendingTasks.map((function(e){return e.priority}))),this._loopThroughWaitingQueue()),this._isRunningHighPriorityTasks()&&this._interruptCancellableTasks()}}},t._loopThroughWaitingQueue=function(){var e=this._waitingQueue.reduce((function(e,t){return null===e||e>t.priority?t.priority:e}),null);if(!(null===e||null!==this._minPendingPriority&&this._minPendingPriority<e))for(var t=0;t<this._waitingQueue.length;t++){var n=null===this._minPendingPriority?e:Math.min(this._minPendingPriority,e);this._waitingQueue[t].priority<=n&&(this._findAndRunWaitingQueueTask(t),t--)}},t._interruptCancellableTasks=function(){for(var e=0;e<this._pendingTasks.length;e++){var t=this._pendingTasks[e];if(t.priority>=this._prioritySteps.low)return this._interruptPendingTask(t),this._interruptCancellableTasks()}},t._findAndRunWaitingQueueTask=function(e){return e>=this._waitingQueue.length||e<0?(f.Z.warn("TP : Tried to start a non existing task"),!1):(this._waitingQueue.splice(e,1)[0].trigger(),!0)},t._interruptPendingTask=function(e){var t,n=Pe(e.taskFn,this._pendingTasks);n<0?f.Z.warn("TP: Interrupting a non-existent pending task. Aborting..."):(this._pendingTasks.splice(n,1),this._waitingQueue.push(e),0===this._pendingTasks.length?this._minPendingPriority=null:this._minPendingPriority===e.priority&&(this._minPendingPriority=Math.min.apply(Math,this._pendingTasks.map((function(e){return e.priority})))),null===(t=e.interrupter)||void 0===t||t.cancel())},t._canBeStartedNow=function(e){return null===this._minPendingPriority||e.priority<=this._minPendingPriority},t._isRunningHighPriorityTasks=function(){return null!==this._minPendingPriority&&this._minPendingPriority<=this._prioritySteps.high},e}();function Pe(e,t){return(0,B.Z)(t,(function(t){return t.taskFn===e}))}var Me=function(){function e(e,t,n){var r=new Te(n),i=p.Z.getCurrent(),a=i.MIN_CANCELABLE_PRIORITY,o=i.MAX_HIGH_PRIORITY_LEVEL;this._transport=e,this._prioritizer=new Ze({prioritySteps:{high:o,low:a}}),this._cdnPrioritizer=r,this._backoffOptions=t}return e.prototype.createSegmentFetcher=function(e,t){var n,r,i,a,o,s,u,l,d,c,v,h,g,y,_=(n=this._backoffOptions,r=n.maxRetryRegular,i=n.maxRetryOffline,a=n.lowLatencyMode,o=n.requestTimeout,s=p.Z.getCurrent(),u=s.DEFAULT_MAX_REQUESTS_RETRY_ON_ERROR,l=s.DEFAULT_REQUEST_TIMEOUT,d=s.DEFAULT_MAX_REQUESTS_RETRY_ON_OFFLINE,c=s.INITIAL_BACKOFF_DELAY_BASE,v=s.MAX_BACKOFF_DELAY_BASE,{maxRetryRegular:null!=r?r:u,maxRetryOffline:null!=i?i:d,baseDelay:a?c.LOW_LATENCY:c.REGULAR,maxDelay:a?v.LOW_LATENCY:v.REGULAR,requestTimeout:(0,S.Z)(o)?l:o}),b=function(e,t,n,r,i){var a={timeout:i.requestTimeout<0?void 0:i.requestTimeout},o=(0,Ae.Z)(["audio","video"],e)?new Re:void 0,s=t.loadSegment,u=t.parseSegment;return function(){var e=(0,A.Z)(R().mark((function e(t,l,d){var c,v,p,h,g,y,_,b,T,w,A,I,x,Z,P,M,C,D,O,N,L,U;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(U=function(){var e;x||!(0,S.Z)(w)&&void 0!==w.size&&void 0!==w.requestDuration&&A.length>0&&A.every((function(e){return e}))&&(x=!0,null===(e=r.onMetrics)||void 0===e||e.call(r,{size:w.size,requestDuration:w.requestDuration,content:t,segmentDuration:I}))},L=function(e){l.onRetry(oe(e))},N=function(e,t){A.push(!1);var n=A.length-1;return function(r){var i={data:e,isChunked:t};try{var a=u(i,Z,r);return A[n]||(I=void 0!==I&&"media"===a.segmentType&&null!==a.chunkInfos&&void 0!==a.chunkInfos.duration?I+a.chunkInfos.duration:void 0,A[n]=!0,U()),a}catch(e){throw(0,m.Z)(e,{defaultCode:"PIPELINE_PARSE_ERROR",defaultReason:"Unknown parsing error"})}}},O=function(e){return s(e,Z,a,d,P)},p=t.segment,h=t.adaptation,g=t.representation,y=t.manifest,_=t.period,b=(0,ke.K)(t),T=xe(),A=[],I=0,x=!1,Z={segment:p,type:h.type,language:h.language,isLive:y.isLive,periodStart:_.start,periodEnd:_.end,mimeType:g.mimeType,codecs:g.codec,manifestPublishTime:y.publishTime},P={onProgress:function(e){var t;void 0===w&&void 0!==e.totalSize&&e.size<e.totalSize&&(null===(t=r.onProgress)||void 0===t||t.call(r,{duration:e.duration,size:e.size,totalSize:e.totalSize,timestamp:performance.now(),id:T}))},onNewChunk:function(e){l.onChunk(N(e,!0))}},null===(M=void 0!==o?o.get(t):null)){e.next=17;break}return f.Z.debug("SF: Found wanted segment in cache",b),l.onChunk(N(M,!1)),e.abrupt("return",Promise.resolve());case 17:return f.Z.debug("SF: Beginning request",b),null===(c=r.onRequestBegin)||void 0===c||c.call(r,{requestTimestamp:performance.now(),id:T,content:t}),d.register((function(){var e;void 0===w&&(f.Z.debug("SF: Segment request cancelled",b),w=null,null===(e=r.onRequestEnd)||void 0===e||e.call(r,{id:T}))})),e.prev=20,e.next=23,pe(t.representation.cdnMetadata,n,O,(0,E.Z)({onRetry:L},i),d);case 23:"segment-loaded"===(C=e.sent).resultType?(D=C.resultData.responseData,void 0!==o&&o.add(t,C.resultData.responseData),l.onChunk(N(D,!1))):"segment-created"===C.resultType&&l.onChunk(N(C.resultData,!1)),f.Z.debug("SF: Segment request ended with success",b),l.onAllChunksReceived(),"segment-created"!==C.resultType?(w=C.resultData,U()):w=null,d.isCancelled||null===(v=r.onRequestEnd)||void 0===v||v.call(r,{id:T}),e.next=39;break;case 31:if(e.prev=31,e.t0=e.catch(20),w=null,!(e.t0 instanceof k.FU)){e.next=37;break}throw f.Z.debug("SF: Segment request aborted",b),e.t0;case 37:throw f.Z.debug("SF: Segment request failed",b),oe(e.t0);case 39:case"end":return e.stop()}}),e,null,[[20,31]])})));return function(t,n,r){return e.apply(this,arguments)}}()}(e,this._transport[e],this._cdnPrioritizer,t,_);return h=this._prioritizer,g=b,y=new WeakMap,{createRequest:function(e,t,n,r){var i=function(t){return g(e,n,t)},a=h.create(i,t,n,r);return y.set(a,i),a},updatePriority:function(e,t){var n=y.get(e);void 0!==n?h.updatePriority(n,t):f.Z.warn("Fetchers: Cannot update the priority of a request: task not found.")}}},e}(),Ce=Me,De=n(7326);var Oe=n(4791),Ne=n(6968),Le=n(2870),Ue=n(9612);var Be=function(e){function n(t,n,r){var i;i=e.call(this)||this;var a=r.addSourceBuffer(n);i._canceller=new k.ZP,i.bufferType=t,i._mediaSource=r,i._sourceBuffer=a,i._queue=[],i._pendingTask=null,i._lastInitSegment=null,i.codec=n;var o=i._onPendingTaskError.bind((0,De.Z)(i)),s=i._flush.bind((0,De.Z)(i)),u=p.Z.getCurrent().SOURCE_BUFFER_FLUSHING_INTERVAL,l=setInterval(s,u);return i._sourceBuffer.addEventListener("error",o),i._sourceBuffer.addEventListener("updateend",s),i._canceller.signal.register((function(){clearInterval(l),i._sourceBuffer.removeEventListener("error",o),i._sourceBuffer.removeEventListener("updateend",s)})),i}(0,t.Z)(n,e);var r=n.prototype;return r.pushChunk=function(e,t){return f.Z.debug("AVSB: receiving order to push data to the SourceBuffer",this.bufferType,(0,ke.K)(e.inventoryInfos)),this._addToQueue({type:Ue.f.Push,value:e},t)},r.removeBuffer=function(e,t,n){return f.Z.debug("AVSB: receiving order to remove data from the SourceBuffer",this.bufferType,e,t),this._addToQueue({type:Ue.f.Remove,value:{start:e,end:t}},n)},r.endOfSegment=function(e,t){return f.Z.debug("AVSB: receiving order for validating end of segment",this.bufferType,(0,ke.K)(e)),this._addToQueue({type:Ue.f.EndOfSegment,value:e},t)},r.getBufferedRanges=function(){return this._sourceBuffer.buffered},r.getPendingOperations=function(){var e=function(e){switch(e.type){case Ue.f.Push:case Ue.f.Remove:case Ue.f.EndOfSegment:return{type:e.type,value:e.value}}},t=this._queue.map(e);return null===this._pendingTask?t:[e(this._pendingTask)].concat(t)},r.dispose=function(){for(this._canceller.cancel(),null!==this._pendingTask&&(this._pendingTask.reject(new k.FU),this._pendingTask=null);this._queue.length>0;){var e=this._queue.shift();void 0!==e&&e.reject(new k.FU)}if("open"===this._mediaSource.readyState)try{this._sourceBuffer.abort()}catch(e){f.Z.warn("AVSB: Failed to abort a "+this.bufferType+" SourceBuffer:",e instanceof Error?e:"")}},r._onPendingTaskError=function(e){if(this._lastInitSegment=null,null!==this._pendingTask){var t=e instanceof Error?e:new Error("An unknown error occured when doing operations on the SourceBuffer");this._pendingTask.reject(t)}},r._addToQueue=function(e,t){var n=this;return new Promise((function(r,i){if(null!==t.cancellationError)return i(t.cancellationError);var a=0===n._queue.length&&null===n._pendingTask,o=(0,E.Z)({resolve:r,reject:i},e);n._queue.push(o),t.register((function(e){var t=n._queue.indexOf(o);t>=0&&n._queue.splice(t,1),o.resolve=L.Z,o.reject=L.Z,i(e)})),a&&n._flush()}))},r._flush=function(){if(!this._sourceBuffer.updating){if(null!==this._pendingTask){var e=this._pendingTask;if(e.type!==Ue.f.Push||0===e.data.length){switch(e.type){case Ue.f.Push:null!==e.inventoryData&&this._segmentInventory.insertChunk(e.inventoryData);break;case Ue.f.EndOfSegment:this._segmentInventory.completeSegment(e.value,this.getBufferedRanges());break;case Ue.f.Remove:this.synchronizeInventory();break;default:(0,N.Z)(e)}var t=e.resolve;return this._pendingTask=null,t(),void this._flush()}}else{var n=this._queue.shift();if(void 0===n)return;if(n.type!==Ue.f.Push)this._pendingTask=n;else{var r,i=n.value;try{r=this._preparePushOperation(i.data)}catch(e){this._pendingTask=(0,E.Z)({data:[],inventoryData:i.inventoryInfos},n);var a=e instanceof Error?e:new Error("An unknown error occured when preparing a push operation");return this._lastInitSegment=null,void n.reject(a)}this._pendingTask=(0,E.Z)({data:r,inventoryData:i.inventoryInfos},n)}}try{switch(this._pendingTask.type){case Ue.f.EndOfSegment:return f.Z.debug("AVSB: Acknowledging complete segment",(0,ke.K)(this._pendingTask.value)),void this._flush();case Ue.f.Push:var o=this._pendingTask.data.shift();if(void 0===o)return void this._flush();f.Z.debug("AVSB: pushing segment",this.bufferType,(0,ke.K)(this._pendingTask.inventoryData)),this._sourceBuffer.appendBuffer(o);break;case Ue.f.Remove:var s=this._pendingTask.value,u=s.start,l=s.end;f.Z.debug("AVSB: removing data from SourceBuffer",this.bufferType,u,l),this._sourceBuffer.remove(u,l);break;default:(0,N.Z)(this._pendingTask)}}catch(e){this._onPendingTaskError(e)}}},r._preparePushOperation=function(e){var t=[],n=e.codec,r=e.timestampOffset,i=e.appendWindow,a=!1;if(void 0!==n&&n!==this.codec&&(f.Z.debug("AVSB: updating codec",n),a=function(e,t){if("function"==typeof e.changeType){try{e.changeType(t)}catch(e){return f.Z.warn("Could not call 'changeType' on the given SourceBuffer:",e instanceof Error?e:""),!1}return!0}return!1}(this._sourceBuffer,n),a?this.codec=n:f.Z.debug("AVSB: could not update codec",n,this.codec)),this._sourceBuffer.timestampOffset!==r){var o=r;f.Z.debug("AVSB: updating timestampOffset",this.bufferType,this._sourceBuffer.timestampOffset,o),this._sourceBuffer.timestampOffset=o}if(void 0===i[0]?this._sourceBuffer.appendWindowStart>0&&(this._sourceBuffer.appendWindowStart=0):i[0]!==this._sourceBuffer.appendWindowStart&&(i[0]>=this._sourceBuffer.appendWindowEnd&&(this._sourceBuffer.appendWindowEnd=i[0]+1),this._sourceBuffer.appendWindowStart=i[0]),void 0===i[1]?this._sourceBuffer.appendWindowEnd!==1/0&&(this._sourceBuffer.appendWindowEnd=1/0):i[1]!==this._sourceBuffer.appendWindowEnd&&(this._sourceBuffer.appendWindowEnd=i[1]),null!==e.initSegment&&(a||!this._isLastInitSegment(e.initSegment))){var s=e.initSegment;t.push(s);var u=(0,Ne._f)(s);this._lastInitSegment={data:u,hash:(0,Le.Z)(u)}}return null!==e.chunk&&t.push(e.chunk),t},r._isLastInitSegment=function(e){if(null===this._lastInitSegment)return!1;if(this._lastInitSegment.data===e)return!0;var t=this._lastInitSegment.data;if(t.byteLength===e.byteLength){var n=(0,Ne._f)(e);if((0,Le.Z)(n)===this._lastInitSegment.hash&&(0,Oe.Z)(t,n))return!0}return!1},n}(Ue.C),Fe=["audio","video","text"];function ze(e){return"audio"===e||"video"===e}var Ve=function(){function e(e,t){this._mediaElement=e,this._mediaSource=t,this._initializedSegmentBuffers={},this._onNativeBufferAddedOrDisabled=[]}e.isNative=function(e){return ze(e)};var t=e.prototype;return t.getBufferTypes=function(){var e=this.getNativeBufferTypes();return null==y.Z.nativeTextTracksBuffer&&null==y.Z.htmlTextTracksBuffer||e.push("text"),e},t.getNativeBufferTypes=function(){return"AUDIO"===this._mediaElement.nodeName?["audio"]:["video","audio"]},t.getStatus=function(e){var t=this._initializedSegmentBuffers[e];return void 0===t?{type:"uninitialized"}:null===t?{type:"disabled"}:{type:"initialized",value:t}},t.waitForUsableBuffers=function(e){var t=this;return this._areNativeBuffersUsable()?Promise.resolve():new Promise((function(n,r){var i=function(){t._areNativeBuffersUsable()&&n()};t._onNativeBufferAddedOrDisabled.push(i),e.register((function(e){var n=t._onNativeBufferAddedOrDisabled.indexOf(i);n>=0&&t._onNativeBufferAddedOrDisabled.splice(n,1),r(e)}))}))},t.disableSegmentBuffer=function(t){var n=this._initializedSegmentBuffers[t];if(null!==n){if(void 0!==n)throw new Error("Cannot disable an active SegmentBuffer.");this._initializedSegmentBuffers[t]=null,e.isNative(t)&&this._onNativeBufferAddedOrDisabled.forEach((function(e){return e()}))}else f.Z.warn("SBS: The "+t+" SegmentBuffer was already disabled.")},t.createSegmentBuffer=function(e,t,n){void 0===n&&(n={});var r,i=this._initializedSegmentBuffers[e];if(ze(e)){if(null!=i)return i instanceof Be&&i.codec!==t?f.Z.warn("SB: Reusing native SegmentBuffer with codec",i.codec,"for codec",t):f.Z.info("SB: Reusing native SegmentBuffer with codec",t),i;f.Z.info("SB: Adding native SegmentBuffer with codec",t);var a=new Be(e,t,this._mediaSource);return this._initializedSegmentBuffers[e]=a,this._onNativeBufferAddedOrDisabled.forEach((function(e){return e()})),a}if(null!=i)return f.Z.info("SB: Reusing a previous custom SegmentBuffer for the type",e),i;if("text"===e){if(f.Z.info("SB: Creating a new text SegmentBuffer"),"html"===n.textTrackMode){if(null==y.Z.htmlTextTracksBuffer)throw new Error("HTML Text track feature not activated");r=new y.Z.htmlTextTracksBuffer(this._mediaElement,n.textTrackElement)}else{if(null==y.Z.nativeTextTracksBuffer)throw new Error("Native Text track feature not activated");r=new y.Z.nativeTextTracksBuffer(this._mediaElement)}return this._initializedSegmentBuffers.text=r,r}throw f.Z.error("SB: Unknown buffer type:",e),new h.Z("BUFFER_TYPE_UNKNOWN","The player wants to create a SegmentBuffer of an unknown type.")},t.disposeSegmentBuffer=function(e){var t=this._initializedSegmentBuffers[e];null!=t?(f.Z.info("SB: Aborting SegmentBuffer",e),t.dispose(),delete this._initializedSegmentBuffers[e]):f.Z.warn("SB: Trying to dispose a SegmentBuffer that does not exist")},t.disposeAll=function(){var e=this;Fe.forEach((function(t){"initialized"===e.getStatus(t).type&&e.disposeSegmentBuffer(t)}))},t._areNativeBuffersUsable=function(){var e=this,t=this.getNativeBufferTypes();return!t.some((function(t){return void 0===e._initializedSegmentBuffers[t]}))&&!t.every((function(t){return null===e._initializedSegmentBuffers[t]}))},e}(),Ke=n(1480),Ge=n(5987),We=n(7878),He=n(6267);function je(e){void 0===e&&(e={});var t=e.connector,n=void 0===t?function(){return new i.x}:t,r=e.resetOnError,a=void 0===r||r,s=e.resetOnComplete,u=void 0===s||s,l=e.resetOnRefCountZero,d=void 0===l||l;return function(e){var t,r,i,s=0,l=!1,c=!1,f=function(){null==r||r.unsubscribe(),r=void 0},v=function(){f(),t=i=void 0,l=c=!1},p=function(){var e=t;v(),null==e||e.unsubscribe()};return(0,o.e)((function(e,o){s++,c||l||f();var h=i=null!=i?i:n();o.add((function(){0!==--s||c||l||(r=qe(p,d))})),h.subscribe(o),!t&&s>0&&(t=new He.Hp({next:function(e){return h.next(e)},error:function(e){c=!0,f(),r=qe(v,a,e),h.error(e)},complete:function(){l=!0,f(),r=qe(v,u),h.complete()}}),(0,We.Xf)(e).subscribe(t))}))(e)}}function qe(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!0!==t){if(!1!==t){var i=new He.Hp({next:function(){i.unsubscribe(),e()}});return t.apply(void 0,(0,Ge.ev)([],(0,Ge.CR)(n))).subscribe(i)}}else e()}function Ye(e,t){return(0,o.e)((function(n,r){var i=0;n.subscribe((0,s.x)(r,(function(n){return e.call(t,n,i++)&&r.next(n)})))}))}var Xe=n(9127),$e=n(2034),Qe=n(2457);function Je(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,Qe.yG)(e);return(0,o.e)((function(t,r){(n?(0,$e.z)(e,t,n):(0,$e.z)(e,t)).subscribe(r)}))}var et=n(278);function tt(e,t){return void 0===t&&(t=et.y),e=null!=e?e:nt,(0,o.e)((function(n,r){var i,a=!0;n.subscribe((0,s.x)(r,(function(n){var o=t(n);!a&&e(i,o)||(a=!1,i=o,r.next(n))})))}))}function nt(e,t){return e===t}var rt=Array.isArray,it=Object.getPrototypeOf,at=Object.prototype,ot=Object.keys;function st(e){if(1===e.length){var t=e[0];if(rt(t))return{args:t,keys:null};if((r=t)&&"object"==typeof r&&it(r)===at){var n=ot(t);return{args:n.map((function(e){return t[e]})),keys:n}}}var r;return{args:e,keys:null}}var ut=n(3102),lt=n(3211);function dt(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})}var ct=n(7845);function ft(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,Qe.yG)(e),r=(0,Qe.jO)(e),i=st(e),a=i.args,o=i.keys;if(0===a.length)return(0,ut.D)([],n);var s=new Ke.y(vt(a,n,o?function(e){return dt(o,e)}:et.y));return r?s.pipe((0,lt.Z)(r)):s}function vt(e,t,n){return void 0===n&&(n=et.y),function(r){pt(t,(function(){for(var i=e.length,a=new Array(i),o=i,u=i,l=function(i){pt(t,(function(){var l=(0,ut.D)(e[i],t),d=!1;l.subscribe((0,s.x)(r,(function(e){a[i]=e,d||(d=!0,u--),u||r.next(n(a.slice()))}),(function(){--o||r.complete()})))}),r)},d=0;d<i;d++)l(d)}),r)}}function pt(e,t,n){e?(0,ct.f)(n,e,t):t()}var ht=n(3071),mt=n(7877),gt=n(533),yt=n(9917),_t=n(2817);function bt(e,t){return t?function(n){return n.pipe(bt((function(n,r){return(0,We.Xf)(e(n,r)).pipe((0,Xe.U)((function(e,i){return t(n,e,r,i)})))})))}:(0,o.e)((function(t,n){var r=0,i=null,a=!1;t.subscribe((0,s.x)(n,(function(t){i||(i=(0,s.x)(n,void 0,(function(){i=null,a&&n.complete()})),(0,We.Xf)(e(t,r++)).subscribe(i))}),(function(){a=!0,!i&&n.complete()})))}))}var St,Et=n(2006),Tt=n(3505),wt=n(8720),kt=n(8337),At=1,It={};function Rt(e){return e in It&&(delete It[e],!0)}var xt=function(e){var t=At++;return It[t]=!0,St||(St=Promise.resolve()),St.then((function(){return Rt(t)&&e()})),t},Zt=function(e){Rt(e)},Pt={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Pt.delegate;return((null==n?void 0:n.setImmediate)||xt).apply(void 0,(0,Ge.ev)([],(0,Ge.CR)(e)))},clearImmediate:function(e){var t=Pt.delegate;return((null==t?void 0:t.clearImmediate)||Zt)(e)},delegate:void 0},Mt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.scheduler=t,r.work=n,r}return(0,Ge.ZT)(t,e),t.prototype.requestAsyncId=function(t,n,r){return void 0===r&&(r=0),null!==r&&r>0?e.prototype.requestAsyncId.call(this,t,n,r):(t.actions.push(this),t._scheduled||(t._scheduled=Pt.setImmediate(t.flush.bind(t,void 0))))},t.prototype.recycleAsyncId=function(t,n,r){var i;if(void 0===r&&(r=0),null!=r?r>0:this.delay>0)return e.prototype.recycleAsyncId.call(this,t,n,r);var a=t.actions;null!=n&&(null===(i=a[a.length-1])||void 0===i?void 0:i.id)!==n&&(Pt.clearImmediate(n),t._scheduled=void 0)},t}(kt.o),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,Ge.ZT)(t,e),t.prototype.flush=function(e){this._active=!0;var t=this._scheduled;this._scheduled=void 0;var n,r=this.actions;e=e||r.shift();do{if(n=e.execute(e.state,e.delay))break}while((e=r[0])&&e.id===t&&r.shift());if(this._active=!1,n){for(;(e=r[0])&&e.id===t&&r.shift();)e.unsubscribe();throw n}},t}(n(9682).v),Dt=new Ct(Mt);function Ot(e,t){return new Ke.y((function(n){var r=!1,i=!1;return t().then((function(e){r||(i=!0,n.next(e),n.complete())}),(function(e){i=!0,r||n.error(e)})),function(){i||(r=!0,e.cancel())}}))}var Nt=n(7473),Lt=n.n(Nt);function Ut(){return new Ke.y((function(e){var t=!1;return Lt()((function(){t||(e.next(),e.complete())})),function(){t=!0}}))}var Bt=function(){function e(e){this._array=[],this._sortingFn=e}var t=e.prototype;return t.add=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.sort(this._sortingFn);for(var r=0,i=0;i<t.length;i++){for(var a=t[i],o=!1;!o&&r<this._array.length;)this._sortingFn(a,this._array[r])<0?(this._array.splice(r,0,a),o=!0):r++;o||this._array.push(a)}},t.length=function(){return this._array.length},t.get=function(e){if(e<0||e>=this._array.length)throw new Error("Invalid index.");return this._array[e]},t.findFirst=function(e){return(0,V.Z)(this._array,e)},t.has=function(e){return(0,Ae.Z)(this._array,e)},t.removeElement=function(e){var t=this._array.indexOf(e);if(t>=0)return this._array.splice(t,1),t},t.head=function(){return this._array[0]},t.last=function(){return this._array[this._array.length-1]},t.shift=function(){return this._array.shift()},t.pop=function(){return this._array.pop()},e}(),Ft=function(){function e(e){this._weakMap=new WeakMap,this._fn=e}var t=e.prototype;return t.get=function(e){var t=this._weakMap.get(e);if(void 0===t){var n=this._fn(e);return this._weakMap.set(e,n),n}return t},t.destroy=function(e){this._weakMap.delete(e)},e}();function zt(e,t){var n,r=e.segmentBuffer,i=e.playbackObserver,a=e.maxBufferBehind,o=e.maxBufferAhead;function s(){(function(e,t,n,r,i){return Vt.apply(this,arguments)})(r,n,a.getValue(),o.getValue(),t).catch((function(e){var t=e instanceof Error?e.message:"Unknown error";f.Z.error("Could not run BufferGarbageCollector:",t)}))}i.listen((function(e){var t;n=null!==(t=e.position.pending)&&void 0!==t?t:e.position.last,s()}),{includeLastObservation:!0,clearSignal:t}),a.onUpdate(s,{clearSignal:t}),o.onUpdate(s,{clearSignal:t}),s()}function Vt(){return(Vt=(0,A.Z)(R().mark((function e(t,n,r,i,a){var o,s,u,l,d,c,v,p;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isFinite(r)||isFinite(i)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:o=[],s=(0,T.F_)(t.getBufferedRanges(),n),u=s.innerRange,l=s.outerRanges,d=function(){if(isFinite(i)){for(var e=0;e<l.length;e++){var t=l[e];n+i<=t.start?o.push(t):n<=t.start&&n+i<t.end&&n+i>t.start&&o.push({start:n+i,end:t.end})}null!=u&&n+i<u.end&&o.push({start:n+i,end:u.end})}},function(){if(isFinite(r)){for(var e=0;e<l.length;e++){var t=l[e];n-r>=t.end?o.push(t):n>=t.end&&n-r>t.start&&n-r<t.end&&o.push({start:t.start,end:n-r})}null!=u&&n-r>u.start&&o.push({start:u.start,end:n-r})}}(),d(),c=0,v=o;case 9:if(!(c<v.length)){e.next=20;break}if(!((p=v[c]).start<p.end)){e.next=17;break}if(f.Z.debug("GC: cleaning range from SegmentBuffer",p.start,p.end),null===a.cancellationError){e.next=15;break}throw a.cancellationError;case 15:return e.next=17,t.removeBuffer(p.start,p.end,a);case 17:c++,e.next=9;break;case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Kt={activePeriodChanged:function(e){return{type:"activePeriodChanged",value:{period:e}}},adaptationChange:function(e,t,n){return{type:"adaptationChange",value:{type:e,adaptation:t,period:n}}},addedSegment:function(e,t,n,r){return{type:"added-segment",value:{content:e,segment:t,segmentData:r,buffered:n}}},bitrateEstimationChange:function(e,t){return{type:"bitrateEstimationChange",value:{type:e,bitrate:t}}},streamComplete:function(e){return{type:"complete-stream",value:{type:e}}},endOfStream:function(){return{type:"end-of-stream",value:void 0}},needsManifestRefresh:function(){return{type:"needs-manifest-refresh",value:void 0}},manifestMightBeOufOfSync:function(){return{type:"manifest-might-be-out-of-sync",value:void 0}},needsMediaSourceReload:function(e,t){return{type:"needs-media-source-reload",value:{position:e,autoPlay:t}}},lockedStream:function(e,t){return{type:"locked-stream",value:{bufferType:e,period:t}}},needsBufferFlush:function(){return{type:"needs-buffer-flush",value:void 0}},needsDecipherabilityFlush:function(e,t,n){return{type:"needs-decipherability-flush",value:{position:e,autoPlay:t,duration:n}}},periodStreamReady:function(e,t,n,r){return{type:"periodStreamReady",value:{type:e,manifest:t,period:n,adaptation$:r}}},periodStreamCleared:function(e,t,n){return{type:"periodStreamCleared",value:{type:e,manifest:t,period:n}}},encryptionDataEncountered:function(e,t){return{type:"encryption-data-encountered",value:(0,E.Z)({content:t},e)}},representationChange:function(e,t,n){return{type:"representationChange",value:{type:e,period:t,representation:n}}},streamTerminating:function(){return{type:"stream-terminating",value:void 0}},resumeStream:function(){return{type:"resume-stream",value:void 0}},warning:function(e){return{type:"warning",value:e}},waitingMediaSourceReload:function(e,t,n,r){return{type:"waiting-media-source-reload",value:{bufferType:e,period:t,position:n,autoPlay:r}}}},Gt=Kt,Wt=n(4318),Ht=function(e){function t(t,n,r){void 0===t&&(t=1/0),void 0===n&&(n=1/0),void 0===r&&(r=Wt.l);var i=e.call(this)||this;return i._bufferSize=t,i._windowTime=n,i._timestampProvider=r,i._buffer=[],i._infiniteTimeWindow=!0,i._infiniteTimeWindow=n===1/0,i._bufferSize=Math.max(1,t),i._windowTime=Math.max(1,n),i}return(0,Ge.ZT)(t,e),t.prototype.next=function(t){var n=this,r=n.isStopped,i=n._buffer,a=n._infiniteTimeWindow,o=n._timestampProvider,s=n._windowTime;r||(i.push(t),!a&&i.push(o.now()+s)),this._trimBuffer(),e.prototype.next.call(this,t)},t.prototype._subscribe=function(e){this._throwIfClosed(),this._trimBuffer();for(var t=this._innerSubscribe(e),n=this._infiniteTimeWindow,r=this._buffer.slice(),i=0;i<r.length&&!e.closed;i+=n?1:2)e.next(r[i]);return this._checkFinalizedStatuses(e),t},t.prototype._trimBuffer=function(){var e=this,t=e._bufferSize,n=e._timestampProvider,r=e._buffer,i=e._infiniteTimeWindow,a=(i?1:2)*t;if(t<1/0&&a<r.length&&r.splice(0,r.length-a),!i){for(var o=n.now(),s=0,u=1;u<r.length&&r[u]<=o;u+=2)s=u;s&&r.splice(0,s+1)}},t}(i.x);function jt(e,t){return(0,o.e)((function(n,r){var i=null,a=0,o=!1,u=function(){return o&&!i&&r.complete()};n.subscribe((0,s.x)(r,(function(n){null==i||i.unsubscribe();var o=0,l=a++;(0,We.Xf)(e(n,l)).subscribe(i=(0,s.x)(r,(function(e){return r.next(t?t(n,e,l,o++):e)}),(function(){i=null,u()})))}),(function(){o=!0,u()})))}))}var qt=n(9878);function Yt(e){return(0,o.e)((function(t,n){try{t.subscribe(n)}finally{n.add(e)}}))}function Xt(e,t,n,r){return Ut().pipe((0,mt.z)((function(){return n.getReference().asObservable()})),(0,Xe.U)((function(i){var a,o,s=n.getCurrentTime()+r,u=Math.min(Math.max(e.start,s),null!==(a=e.end)&&void 0!==a?a:1/0),l=!(null!==(o=i.paused.pending)&&void 0!==o?o:n.getIsPaused());return Gt.waitingMediaSourceReload(t,e,u,l)})))}var $t=n(2967);var Qt=function(){function e(e,t,n,r){this._content=e,this._currentObs$=null,this._downloadQueue=t,this._initSegmentRequest=null,this._mediaSegmentRequest=null,this._segmentFetcher=n,this._initSegmentInfoRef=(0,w.ZP)(void 0),this._mediaSegmentsAwaitingInitMetadata=new Set,r||this._initSegmentInfoRef.setValue(null)}var t=e.prototype;return t.getRequestedInitSegment=function(){return null===this._initSegmentRequest?null:this._initSegmentRequest.segment},t.getRequestedMediaSegment=function(){return null===this._mediaSegmentRequest?null:this._mediaSegmentRequest.segment},t.start=function(){var e=this;if(null!==this._currentObs$)return this._currentObs$;var t=(0,yt.P)((function(){var t=e._downloadQueue.asObservable().pipe(Ye((function(t){for(var n=t.segmentQueue,r=0;r<n.length;r++){var i=n[r].segment;if(!e._mediaSegmentsAwaitingInitMetadata.has(i.id))break}var a=e._mediaSegmentRequest;if(r>=n.length)return null!==a;if(null===a)return!0;var o=n[r];return a.segment.id!==o.segment.id||(a.priority!==o.priority&&e._segmentFetcher.updatePriority(a.request,o.priority),!1)})),jt((function(t){return t.segmentQueue.length>0?e._requestMediaSegments():a.E}))),n=e._downloadQueue.asObservable().pipe(Ye((function(t){var n=e._initSegmentRequest;return null!==t.initSegment&&null!==n?(t.initSegment.priority!==n.priority&&e._segmentFetcher.updatePriority(n.request,t.initSegment.priority),!1):null===t.initSegment||null===n})),jt((function(t){return null===t.initSegment?a.E:e._requestInitSegment(t.initSegment)})));return(0,ht.T)(n,t)})).pipe(je());return this._currentObs$=t,t},t._requestMediaSegments=function(){var e=this,t=this._downloadQueue.getValue().segmentQueue[0],n=this;return(0,yt.P)((function(){return r(t)})).pipe(Yt((function(){e._mediaSegmentRequest=null})));function r(e){if(void 0===e)return(0,_t.of)({type:"end-of-queue",value:null});var t=e.segment,i=e.priority,a=(0,E.Z)({segment:t},n._content);return new Ke.y((function(e){var o,s=new k.ZP,u=!1,l=!1,d=n._segmentFetcher.createRequest(a,i,{onRetry:function(n){e.next({type:"retry",value:{segment:t,error:n}})},beforeInterrupted:function(){f.Z.info("Stream: segment request interrupted temporarly.",t.id,t.time)},onChunk:function(e){var t=n._initSegmentInfoRef.getValue();void 0!==t?c(e(null!=t?t:void 0)):(l=!0,n._initSegmentInfoRef.waitUntilDefined((function(t){c(e(null!=t?t:void 0))}),{clearSignal:s.signal}))},onAllChunksReceived:function(){l?(n._mediaSegmentsAwaitingInitMetadata.add(t.id),n._initSegmentInfoRef.waitUntilDefined((function(){e.next({type:"end-of-segment",value:{segment:t}}),n._mediaSegmentsAwaitingInitMetadata.delete(t.id),l=!1}),{clearSignal:s.signal})):e.next({type:"end-of-segment",value:{segment:t}})},beforeEnded:function(){n._mediaSegmentRequest=null,l?n._initSegmentInfoRef.waitUntilDefined(v,{clearSignal:s.signal}):v()}},s.signal);return d.catch((function(t){u||(u=!0,e.error(t))})),n._mediaSegmentRequest={segment:t,priority:i,request:d},function(){n._mediaSegmentsAwaitingInitMetadata.delete(t.id),void 0!==o&&o.unsubscribe(),u||(u=!0,l=!1,s.cancel())};function c(n){(0,_.Z)("media"===n.segmentType,"Should have loaded a media segment."),e.next((0,E.Z)({},n,{type:"parsed-media",segment:t}))}function v(){var i=n._downloadQueue.getValue().segmentQueue;if(0===i.length)return e.next({type:"end-of-queue",value:null}),u=!0,void e.complete();i[0].segment.id===t.id&&i.shift(),u=!0,o=r(i[0]).subscribe(e)}}))}},t._requestInitSegment=function(e){var t=this;if(null===e)return this._initSegmentRequest=null,a.E;var n=this;return new Ke.y((function(r){var i=new k.ZP,a=e.segment,o=e.priority,s=(0,E.Z)({segment:a},t._content),u=!1,l=t._segmentFetcher.createRequest(s,o,{onRetry:function(e){r.next({type:"retry",value:{segment:a,error:e}})},beforeInterrupted:function(){f.Z.info("Stream: init segment request interrupted temporarly.",a.id)},beforeEnded:function(){n._initSegmentRequest=null,u=!0,r.complete()},onChunk:function(e){var t,i=e(void 0);(0,_.Z)("init"===i.segmentType,"Should have loaded an init segment."),r.next((0,E.Z)({},i,{type:"parsed-init",segment:a})),"init"===i.segmentType&&n._initSegmentInfoRef.setValue(null!==(t=i.initTimescale)&&void 0!==t?t:null)},onAllChunksReceived:function(){r.next({type:"end-of-segment",value:{segment:a}})}},i.signal);return l.catch((function(e){u||(u=!0,r.error(e))})),t._initSegmentRequest={segment:a,priority:o,request:l},function(){t._initSegmentRequest=null,u||(u=!0,i.cancel())}}))},e}();function Jt(e,t,n,r,i){var a=e.period,o=e.adaptation,s=e.representation,u=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(void 0===r.bufferedStart||void 0===r.bufferedEnd||r.bufferedStart>=t.end)return null;if(r.bufferedEnd>t.start)return n}return null}(i,t);if(null===u){if(null===n){if(r&&void 0!==a.end&&t.end>=a.end)return{start:void 0,end:null};var l=s.index.checkDiscontinuity(t.start);if(null!==l)return{start:void 0,end:l}}return null}var d=i[u];if(void 0!==d.bufferedStart&&d.bufferedStart>t.start&&(null===n||d.infos.segment.end<=n)){var c=d.bufferedStart;return r||!1===s.index.awaitSegmentBetween(t.start,c)?(f.Z.debug("RS: current discontinuity encountered",o.type,d.bufferedStart),{start:void 0,end:c}):null}var v=function(e,t,n){if(n<=0)return f.Z.error("RS: Asked to check a discontinuity before the first chunk."),null;for(var r=n;r<e.length;r++){var i=e[r],a=e[r-1];if(void 0===i.bufferedStart||void 0===a.bufferedEnd||i.bufferedStart>=t.end)return null;if(i.bufferedStart-a.bufferedEnd>0)return r}return null}(i,t,u+1);if(null!==v){var p=i[v-1],h=i[v];if(null===n||h.infos.segment.end<=n){if(!r&&!1!==s.index.awaitSegmentBetween(p.infos.segment.end,h.infos.segment.time))return null;var m=p.bufferedEnd,g=h.bufferedStart;return f.Z.debug("RS: future discontinuity encountered",o.type,m,g),{start:m,end:g}}}if(null===n){if(r&&void 0!==a.end){if(t.end<a.end)return null;var y=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(void 0===r.bufferedStart)return null;if(r.bufferedStart<t)return n}return null}(i,a.end);if(null!==y){var _=i[y];if(void 0!==_.bufferedEnd&&_.bufferedEnd<a.end)return f.Z.debug("RS: discontinuity encountered at the end of the current period",o.type,_.bufferedEnd,a.end),{start:_.bufferedEnd,end:null}}}if(void 0!==a.end&&t.end>=a.end)return null;for(var b=i.length-1;b>=0;b--){var S=i[b];if(void 0===S.bufferedStart)break;if(S.bufferedStart<t.end){if(void 0!==S.bufferedEnd&&S.bufferedEnd<t.end){var E=s.index.checkDiscontinuity(t.end);if(null!==E)return{start:S.bufferedEnd,end:E}}return null}}}return null}function en(e){var t=e.bufferedSegments,n=e.content,r=e.currentPlaybackTime,i=e.fastSwitchThreshold,a=e.getBufferedHistory,o=e.neededRange,s=e.segmentsBeingPushed,u=e.maxBufferSize,l=n.adaptation,d=n.representation,c=function(e,t,n){var r=8e3*n;return r-=t.reduce((function(e,t){return e+t.representation.bitrate*t.segment.duration}),0),e.reduce((function(e,t){return void 0!==t.chunkSize?e-8*t.chunkSize:e}),r)}(t,s,u),v=d.index.getSegments(o.start,o.end-o.start),h=t.filter((function(e){return!nn(e.infos,n,r,i)})).filter((function(e,t,n){var r=0===t?null:n[t-1],i=t>=n.length-1?null:n[t+1],s=null;if(function(e,t,n){var r=p.Z.getCurrent().MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT;if(void 0===e.bufferedStart)return f.Z.warn("Stream: Start of a segment unknown. Assuming it is garbage collected by default.",e.start),!0;if(null!==t&&void 0!==t.bufferedEnd&&e.bufferedStart-t.bufferedEnd<.1)return!1;if(n<e.bufferedStart&&e.bufferedStart-e.start>r)return f.Z.info("Stream: The start of the wanted segment has been garbage collected",e.start,e.bufferedStart),!0;return!1}(e,r,o.start)){if(function(e,t){var n,r;if(e.length<2)return!0;var i=e[e.length-1],a=null===(n=i.buffered)||void 0===n?void 0:n.start;if(void 0!==t&&void 0!==a&&t-a>.05)return!0;var o=e[e.length-2],s=null===(r=o.buffered)||void 0===r?void 0:r.start;if(void 0===s||void 0===a)return!0;return Math.abs(s-a)>.01}(s=a(e.infos),e.bufferedStart))return!1;f.Z.debug("Stream: skipping segment gc-ed at the start",e.start,e.bufferedStart)}if(function(e,t,n){var r=p.Z.getCurrent().MAX_TIME_MISSING_FROM_COMPLETE_SEGMENT;if(void 0===e.bufferedEnd)return f.Z.warn("Stream: End of a segment unknown. Assuming it is garbage collected by default.",e.end),!0;if(null!==t&&void 0!==t.bufferedStart&&t.bufferedStart-e.bufferedEnd<.1)return!1;if(n>e.bufferedEnd&&e.end-e.bufferedEnd>r)return f.Z.info("Stream: The end of the wanted segment has been garbage collected",e.start,e.bufferedStart),!0;return!1}(e,i,o.end)){if(function(e,t){var n,r;if(e.length<2)return!0;var i=e[e.length-1],a=null===(n=i.buffered)||void 0===n?void 0:n.end;if(void 0!==t&&void 0!==a&&a-t>.05)return!0;var o=e[e.length-2],s=null===(r=o.buffered)||void 0===r?void 0:r.end;if(void 0===s||void 0===a)return!0;return Math.abs(s-a)>.01}(s=null!=s?s:a(e.infos),e.bufferedEnd))return!1;f.Z.debug("Stream: skipping segment gc-ed at the end",e.end,e.bufferedEnd)}return!0})),m=p.Z.getCurrent(),g=m.MINIMUM_SEGMENT_SIZE,y=m.MIN_BUFFER_AHEAD,_=!1,b=Math.min(1/60,g),S=!1,T=[],w=v.filter((function(e){var t=(0,E.Z)({segment:e},n);if(s.length>0&&s.some((function(e){return(0,ke.z)(t,e)})))return!1;var u=e.duration,v=e.time,p=e.end;if(e.isInit)return!0;if(_)return T.push(e),!1;if(e.complete&&u<g)return!1;if(s.length>0&&s.some((function(e){if(e.period.id!==n.period.id||e.adaptation.id!==n.adaptation.id)return!1;var a=e.segment;return!(a.time-b>v)&&(!(a.end+b<p)&&!nn(e,t,r,i))})))return!1;for(var m=0;m<h.length;m++){var w=h[m];if(w.infos.period.id===n.period.id){var k=w.infos.segment;if(v-k.time>-b&&k.end-p>-b)return!1}}var A=u*n.representation.bitrate;if(c-A<0&&(S=!0,v>o.start+y))return _=!0,T.push(e),!1;var I=a(t);if(I.length>1){var R=I[I.length-1],x=I[I.length-2];if(null===R.buffered&&null===x.buffered)return f.Z.warn("Stream: Segment GCed multiple times in a row, ignoring it.","If this happens a lot and lead to unpleasant experience, please  check your device's available memory. If it's low when this message is emitted, you might want to update the RxPlayer's settings (`maxBufferAhead`, `maxVideoBufferSize` etc.) so less memory is used by regular media data buffering."+l.type,d.id,e.time),!1}for(var Z=0;Z<h.length;Z++){var P=h[Z];if(P.end+b>v){var M=P.start>v+b||tn(h,Z).end<p-b;return M&&(c-=A),M}}return c-=A,!0}));return{segmentsToLoad:w,segmentsOnHold:T,isBufferFull:S}}function tn(e,t){for(var n=t+1,r=p.Z.getCurrent().MINIMUM_SEGMENT_SIZE,i=Math.min(1/60,r);n<e.length-1&&e[n-1].end+i>e[n].start;)n++;return e[--n]}function nn(e,t,n,r){var i=p.Z.getCurrent().CONTENT_REPLACEMENT_PADDING;return e.period.id===t.period.id&&(!(e.segment.time<n+i)&&(e.adaptation.id!==t.adaptation.id||function(e,t,n){var r=e.bitrate,i=p.Z.getCurrent().BITRATE_REBUFFERING_RATIO;if(void 0===n){var a=r*i;return t.bitrate>a}return r<n&&t.bitrate>r}(e.representation,t.representation,r)))}function rn(e,t){for(var n=e-t,r=p.Z.getCurrent().SEGMENT_PRIORITIES_STEPS,i=0;i<r.length;i++)if(n<r[i])return i;return r.length}function an(e,t,n,r,i,a,o){o.synchronizeInventory();var s=e.representation,u=n.getIsPaused()||n.getPlaybackRate()<=0?t-.1:t,l=function(e,t,n){var r,i,a=e.manifest,o=e.period,s=e.representation,u=s.index.getLastAvailablePosition(),l=s.index;i=!(0,S.Z)(u)&&t>=u&&l.isInitialized()&&l.isFinished()&&function(e,t,n){var r;return t.containsTime(n)&&e.isLastPeriodKnown&&t.id===(null===(r=e.periods[e.periods.length-1])||void 0===r?void 0:r.id)}(a,o,t)?u-1:t-.1;var d,c=i+n;d=!(!s.index.isInitialized()||!s.index.isFinished()||void 0===o.end)&&(void 0===u?c>=o.end:null===u||c>=u);return{start:Math.max(i,o.start),end:Math.min(c,null!==(r=o.end)&&void 0!==r?r:1/0),hasReachedPeriodEnd:d}}(e,u,i),d=s.index.shouldRefresh(l.start,l.end),c=o.getPendingOperations().filter((function(e){return e.type===Ue.f.EndOfSegment})).map((function(e){return e.value})),f=function(e,t){for(var n=p.Z.getCurrent().MINIMUM_SEGMENT_SIZE,r=Math.max(1/60,n),i=e.start+r,a=e.end-r,o=[],s=t.length-1;s>=0;s--){var u=t[s],l=u.infos.representation;if(!u.partiallyPushed&&!1!==l.decipherable&&l.isSupported){var d=u.infos.segment,c=d.time/d.timescale;((d.complete?c+d.duration/d.timescale:u.end)>i&&c<a||u.end>i&&u.start<a)&&o.unshift(u)}}return o}({start:Math.max(l.start-.5,0),end:l.end+.5},o.getInventory()),v=en({content:e,bufferedSegments:f,currentPlaybackTime:n.getCurrentTime(),fastSwitchThreshold:r,getBufferedHistory:o.getSegmentHistory.bind(o),neededRange:l,segmentsBeingPushed:c,maxBufferSize:a}),h=v.segmentsToLoad,m=v.segmentsOnHold,g=v.isBufferFull,y=h.map((function(e){return{priority:rn(e.time,u),segment:e}})),_=s.index.isInitialized()&&s.index.isFinished()&&l.hasReachedPeriodEnd&&0===y.length&&0===m.length,b=null;return c.length>0&&(b=Math.min.apply(Math,c.map((function(e){return e.segment.time})))),m.length>0&&(b=null!==b?Math.min(b,m[0].time):m[0].time),y.length>0&&(b=null!==b?Math.min(b,y[0].segment.time):y[0].segment.time),{imminentDiscontinuity:Jt(e,l,b,_,f),hasFinishedLoading:_,neededSegments:y,isBufferFull:g,shouldRefreshManifest:d}}function on(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function un(e,t,n){return ln.apply(this,arguments)}function ln(){return(ln=(0,A.Z)(R().mark((function e(t,n,r){var i,a,o,s,u,l,d,c,v;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=p.Z.getCurrent().BUFFER_GC_GAPS.CALM,a=p.Z.getCurrent().BUFFER_GC_GAPS.BEEFY,f.Z.warn("Stream: Running garbage collector"),o=n.getBufferedRanges(),0===(s=dn(t,o,i)).length&&(s=dn(t,o,a)),f.Z.hasLevel("DEBUG")&&f.Z.debug("Stream: GC cleaning",s.map((function(e){return"start: "+e.start+" - end "+e.end})).join(", ")),u=on(s);case 8:if((l=u()).done){e.next=16;break}if(d=l.value,c=d.start,v=d.end,!(c<v)){e.next=14;break}return e.next=14,n.removeBuffer(c,v,r);case 14:e.next=8;break;case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dn(e,t,n){for(var r=(0,T.F_)(t,e),i=r.innerRange,a=r.outerRanges,o=[],s=0;s<a.length;s++){var u=a[s];(e-n>u.end||e+n<u.start)&&o.push(u)}return null!==i&&(f.Z.hasLevel("DEBUG")&&f.Z.debug("Stream: GC removing part of inner range",o.map((function(e){return"start: "+e.start+" - end "+e.end})).join(", ")),e-n>i.start&&o.push({start:i.start,end:e-n}),e+n<i.end&&o.push({start:e+n,end:i.end})),o}function cn(e,t,n,r){return fn.apply(this,arguments)}function fn(){return(fn=(0,A.Z)(R().mark((function e(t,n,r,i){var a,o,s,u,l,d;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.pushChunk(r,i);case 3:case 17:e.next=23;break;case 5:if(e.prev=5,e.t0=e.catch(0),e.t0 instanceof Error&&"QuotaExceededError"===e.t0.name){e.next=10;break}throw o=e.t0 instanceof Error?e.t0.toString():"An unknown error happened when pushing content",new h.Z("BUFFER_APPEND_ERROR",o);case 10:return s=t.getReference().getValue(),u=s.position,l=null!==(a=u.pending)&&void 0!==a?a:u.last,e.prev=12,e.next=15,un(l,n,i);case 15:return e.next=17,n.pushChunk(r,i);case 19:throw e.prev=19,e.t1=e.catch(12),d=e.t1 instanceof Error?e.t1.toString():"Could not clean the buffer",new h.Z("BUFFER_FULL_ERROR",d);case 23:case"end":return e.stop()}}),e,null,[[0,5],[12,19]])})))).apply(this,arguments)}function vn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hn=function(e){var t=e.content,n=e.options,r=e.playbackObserver,l=e.segmentBuffer,d=e.segmentFetcher,c=e.terminate$,v=t.period,h=t.adaptation,m=t.representation,g=n.bufferGoal$,y=n.maxBufferSize$,_=n.drmSystemId,b=n.fastSwitchThreshold$,S=h.type,T={segment:m.index.getInitSegment(),segmentData:null,isLoaded:!1},A=new i.x,I=(0,w.$l)({initSegment:null,segmentQueue:[]}),R=null!==T.segment,x=new Qt(t,I,d,R);R||(T.segmentData=null,T.isLoaded=!0);var Z=!1,P=a.E;if(void 0!==_){var M=m.getEncryptionData(_);M.length>0&&M.every((function(e){return void 0!==e.keyIds}))&&(P=_t.of.apply(void 0,M.map((function(e){return Gt.encryptionDataEncountered(e,t)}))),Z=!0)}var C,D,O=x.start().pipe((0,mt.z)((function(e){switch(e.type){case"retry":return(0,$e.z)((0,_t.of)({type:"warning",value:e.value.error}),(0,yt.P)((function(){var t=e.value.segment,n=m.index;if(!1===n.isSegmentStillAvailable(t))A.next();else if(n.canBeOutOfSyncError(e.value.error,t))return(0,_t.of)(Gt.manifestMightBeOufOfSync());return a.E})));case"parsed-init":case"parsed-media":return function(e){for(var n,i=vn(e.protectionData);!(n=i()).done;){var o=n.value;m.addProtectionData(o.initDataType,o.keyId,o.initData)}var s=a.E;if(!Z){var u=m.getAllEncryptionData().map((function(e){return Gt.encryptionDataEncountered(e,t)}));u.length>0&&(s=_t.of.apply(void 0,u),Z=!0)}if("init"===e.segmentType){m.index.isInitialized()||void 0===e.segmentList||(m.index.initialize(e.segmentList),Lt()((function(){A.next()}))),T.segmentData=e.initializationData,T.isLoaded=!0;var d=function(e){var t=e.playbackObserver,n=e.content,r=e.segment,i=e.segmentData,o=e.segmentBuffer;return(0,yt.P)((function(){if(null===i)return a.E;var e=n.representation.getMimeTypeString(),s={initSegment:i,chunk:null,timestampOffset:0,appendWindow:[void 0,void 0],codec:e},u=new k.ZP;return Ot(u,(function(){return cn(t,o,{data:s,inventoryInfos:null},u.signal)})).pipe((0,Xe.U)((function(){var e=o.getBufferedRanges();return Gt.addedSegment(n,r,e,i)})))}))}({playbackObserver:r,content:t,segment:e.segment,segmentData:e.initializationData,segmentBuffer:l});return(0,ht.T)(s,d)}var c=e.inbandEvents,f=e.predictedSegments,v=e.needsManifestRefresh;void 0!==f&&m.index.addPredictedSegments(f,e.segment);var h=!0===v?(0,_t.of)(Gt.needsManifestRefresh()):a.E,g=void 0!==c&&c.length>0?(0,_t.of)({type:"inband-events",value:c}):a.E,y=T.segmentData,_=function(e){var t=e.playbackObserver,n=e.content,r=e.initSegmentData,i=e.parsedSegment,o=e.segment,s=e.segmentBuffer;return(0,yt.P)((function(){var e,u;if(null===i.chunkData)return a.E;var l=i.chunkData,d=i.chunkInfos,c=i.chunkOffset,f=i.chunkSize,v=i.appendWindow,h=n.representation.getMimeTypeString(),m=p.Z.getCurrent().APPEND_WINDOW_SECURITIES,g=[void 0!==v[0]?Math.max(0,v[0]-m.START):void 0,void 0!==v[1]?v[1]+m.END:void 0],y={initSegment:r,chunk:l,timestampOffset:c,appendWindow:g,codec:h},_=null!==(e=null==d?void 0:d.time)&&void 0!==e?e:o.time,b=_+(null!==(u=null==d?void 0:d.duration)&&void 0!==u?u:o.duration);void 0!==g[0]&&(_=Math.max(_,g[0])),void 0!==g[1]&&(b=Math.min(b,g[1]));var S=(0,E.Z)({segment:o,chunkSize:f,start:_,end:b},n),T=new k.ZP;return Ot(T,(function(){return cn(t,s,{data:y,inventoryInfos:S},T.signal)})).pipe((0,Xe.U)((function(){var e=s.getBufferedRanges();return Gt.addedSegment(n,o,e,l)})))}))}({playbackObserver:r,content:t,initSegmentData:y,parsedSegment:e,segment:e.segment,segmentBuffer:l});return(0,$e.z)(s,h,g,_)}(e);case"end-of-segment":var n=e.value.segment,i=new k.ZP;return Ot(i,(function(){return l.endOfSegment((0,E.Z)({segment:n},t),i.signal)})).pipe((0,gt.l)());case"end-of-queue":return A.next(),a.E;default:(0,N.Z)(e)}}))),L=ft([r.getReference().asObservable(),g,y,c.pipe(u(1),Je(null)),A.pipe(Je(void 0))]).pipe(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=(0,Qe.jO)(e);return(0,o.e)((function(t,r){for(var i=e.length,a=new Array(i),o=e.map((function(){return!1})),u=!1,l=function(t){(0,We.Xf)(e[t]).subscribe((0,s.x)(r,(function(e){a[t]=e,u||o[t]||(o[t]=!0,(u=o.every(et.y))&&(o=null))}),$t.Z))},d=0;d<i;d++)l(d);t.subscribe((0,s.x)(r,(function(e){if(u){var t=(0,Ge.ev)([e],(0,Ge.CR)(a));r.next(n?n.apply(void 0,(0,Ge.ev)([],(0,Ge.CR)(t))):t)}})))}))}(b),(0,mt.z)((function(e){var n,i,o=e[0],s=o[0],u=o[1],d=o[2],c=o[3],h=e[1],g=null!==(n=s.position.pending)&&void 0!==n?n:s.position.last,y=an(t,g,r,h,u,d,l),_=y.neededSegments,b=null;if(m.index.isInitialized()){if(_.length>0&&!T.isLoaded&&null!==T.segment){var E=_[0].priority;b={segment:T.segment,priority:E}}}else if(null===T.segment)f.Z.warn("Stream: Uninitialized index without an initialization segment");else if(T.isLoaded)f.Z.warn("Stream: Uninitialized index with an already loaded initialization segment");else{var w=null!==(i=s.position.pending)&&void 0!==i?i:s.position.last;b={segment:T.segment,priority:rn(v.start,w)}}if(null===c)I.setValue({initSegment:b,segmentQueue:_});else{if(c.urgent)return f.Z.debug("Stream: Urgent switch, terminate now.",S),I.setValue({initSegment:null,segmentQueue:[]}),I.finish(),(0,_t.of)(Gt.streamTerminating());var A=_[0],R=x.getRequestedInitSegment(),Z=x.getRequestedMediaSegment(),P=null===Z||void 0===A||Z.id!==A.segment.id?[]:[A],M=null===R?null:b;if(I.setValue({initSegment:M,segmentQueue:P}),0===P.length&&null===M)return f.Z.debug("Stream: No request left, terminate",S),I.finish(),(0,_t.of)(Gt.streamTerminating())}var C=(0,_t.of)({type:"stream-status",value:{period:v,position:s.position.last,bufferType:S,imminentDiscontinuity:y.imminentDiscontinuity,hasFinishedLoading:y.hasFinishedLoading,neededSegments:y.neededSegments}}),D=a.E,O=p.Z.getCurrent().UPTO_CURRENT_POSITION_CLEANUP;if(y.isBufferFull){var N=Math.max(0,g-O);if(N>0){var L=new k.ZP;D=Ot(L,(function(){return l.removeBuffer(0,N,L.signal)})).pipe((0,gt.l)())}}return y.shouldRefreshManifest?(0,$e.z)((0,_t.of)(Gt.needsManifestRefresh()),C,D):(0,$e.z)(C,D)})),(C=function(e){return"stream-terminating"!==e.type},void 0===(D=!0)&&(D=!1),(0,o.e)((function(e,t){var n=0;e.subscribe((0,s.x)(t,(function(e){var r=C(e,n++);(r||D)&&t.next(e),!r&&t.complete()})))}))));return(0,ht.T)(L,O,P).pipe(je())};function mn(e,t){for(var n=0;n<e.length;n++)if(e[n].infos.period.start>=t.start)return n>0?e[n-1]:null;return e.length>0?e[e.length-1]:null}function gn(e,t){for(var n=0;n<e.length;n++)if(e[n].infos.period.start>t.start)return e[n];return null}function yn(e,t,n,r,i){if("lazy"===n.switchingMode)return{type:"continue",value:void 0};var a=r.getBufferedRanges();if(0===a.length)return{type:"continue",value:void 0};var o=(0,T.JN)(a),s=e.start,u=null==e.end?1/0:e.end,l=(0,T.tn)(o,[{start:s,end:u}]);if(0===l.length)return{type:"continue",value:void 0};r.synchronizeInventory();var d=r.getInventory(),c=function(e,t,n,r){return e.reduce((function(e,i){if(i.infos.period.id!==t.id||i.infos.adaptation.id!==n.id||!r.some((function(e){return e.id===i.infos.representation.id})))return e;var a=i.bufferedStart,o=i.bufferedEnd;return void 0===a||void 0===o||e.push({start:a,end:o}),e}),[])}(d,e,t,n.representations),f=(0,T.uH)(l,c);if(0===f.length)return{type:"continue",value:void 0};var v=i.getCurrentTime(),h=i.getReadyState();if("reload"===n.switchingMode&&(0,T.Ti)({start:s,end:u},v)&&h>1&&!(0,T.A1)(c,v))return{type:"needs-reload",value:void 0};var m="direct"===n.switchingMode,g=[],y=mn(d,e);if(null!==y&&(void 0===y.bufferedEnd||e.start-y.bufferedEnd<1)&&g.push({start:0,end:e.start+1}),!m){var _=p.Z.getCurrent().ADAP_REP_SWITCH_BUFFER_PADDINGS,b=t.type,S=_[b].before;null==S&&(S=0);var E=_[b].after;null==E&&(E=0),g.push({start:v-S,end:v+E})}if(void 0!==e.end){var w=gn(d,e);null!==w&&(void 0===w.bufferedStart||w.bufferedStart-e.end<1)&&g.push({start:e.end-1,end:Number.MAX_VALUE})}var k=(0,T.uH)(f,g);return 0===k.length?{type:"continue",value:void 0}:m?{type:"flush-buffer",value:k}:{type:"clean-buffer",value:k}}var _n=function(e){var t=e.playbackObserver,n=e.content,r=e.options,i=e.representationEstimator,o=e.segmentBuffer,s=e.segmentFetcherCreator,l=e.wantedBufferAhead,d=e.maxVideoBufferSize,c=n.manifest,v=n.period,h=n.adaptation,g={},y=(0,w.$l)(null),_=new k.ZP,b=(0,w.$l)(n.representations.getValue().representations),S=i({manifest:c,period:v,adaptation:h},y,b,t,_.signal),E=S.estimates,T=S.callbacks,A=s.createSegmentFetcher(h.type,{onRequestBegin:T.requestBegin,onRequestEnd:T.requestEnd,onProgress:T.requestProgress,onMetrics:T.metrics});return n.representations.asObservable().pipe(jt((function(e,n){n>0&&b.setValue(e.representations);var i,s,_,S,I,R,x,Z,P,M=(0,w.$l)(null),C=E.asObservable().pipe((0,Et.b)((function(e){M.setValue(e)})),(Z=!1,(i={refCount:!0})&&"object"==typeof i?(S=i.bufferSize,x=void 0===S?1/0:S,I=i.windowTime,s=void 0===I?1/0:I,Z=void 0!==(R=i.refCount)&&R,_=i.scheduler):x=null!=i?i:1/0,je({connector:function(){return new Ht(x,s,_)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Z}))),D=C.pipe(Ye((function(e){return void 0!==e.bitrate})),tt((function(e,t){return e.bitrate===t.bitrate})),(0,Xe.U)((function(e){var t=e.bitrate;return f.Z.debug("Stream: new "+h.type+" bitrate estimate",t),Gt.bitrateEstimationChange(h.type,t)}))),O=C.pipe(bt((function(e){return F(e)}))),N=p.Z.getCurrent().DELTA_POSITION_AFTER_RELOAD,L=yn(v,h,e,o,t);switch(L.type){case"continue":P=O;break;case"needs-reload":P=Xt(v,h.type,t,N.bitrateSwitch);break;default:var U="flush-buffer"===L.type?(0,_t.of)(Gt.needsBufferFlush()):a.E,B=$e.z.apply(void 0,L.value.map((function(e){var t=e.start,n=e.end,r=new k.ZP;return Ot(r,(function(){return o.removeBuffer(t,n,r.signal)})).pipe((0,gt.l)())})));P=(0,$e.z)(B,U,O)}return(0,ht.T)(P,D);function F(e){var t=e.representation,n=M.asObservable().pipe(Ye((function(n){return null===n||n.representation.id!==t.id||n.manual&&!e.manual})),u(1),(0,Xe.U)((function(e){return null===e?(f.Z.info("Stream: urgent Representation termination",h.type),{urgent:!0}):e.urgent?(f.Z.info("Stream: urgent Representation switch",h.type),{urgent:!0}):(f.Z.info("Stream: slow Representation switch",h.type),{urgent:!1})}))),i=r.enableFastSwitching?M.asObservable().pipe((0,Xe.U)((function(e){return null===e?void 0:e.knownStableBitrate})),tt()):(0,_t.of)(0),o=(0,_t.of)(Gt.representationChange(h.type,v,t));return(0,$e.z)(o,z(t,n,i)).pipe((0,mt.z)((function(e){if("added-segment"===e.type)return T.addedSegment(e.value),a.E;if("representationChange"===e.type&&y.setValue(e.value.representation),"stream-terminating"===e.type){var t=M.getValue();return null===t?a.E:F(t)}return(0,_t.of)(e)})))}function z(e,n,i){return(0,yt.P)((function(){var a=g[e.id],s=null!=a?a:1;g[e.id]=s;var u=l.asObservable().pipe((0,Xe.U)((function(e){return e*s}))),p="video"===h.type?d.asObservable():(0,_t.of)(1/0);return f.Z.info("Stream: changing representation",h.type,e.id,e.bitrate),hn({playbackObserver:t,content:{representation:e,adaptation:h,period:v,manifest:c},segmentBuffer:o,segmentFetcher:A,terminate$:n,options:{bufferGoal$:u,maxBufferSize$:p,drmSystemId:r.drmSystemId,fastSwitchThreshold$:i}}).pipe((0,qt.K)((function(t){var r=(0,m.Z)(t,{defaultCode:"NONE",defaultReason:"Unknown `RepresentationStream` error"});if("BUFFER_FULL_ERROR"===r.code){var a=l.getValue(),o=s;if(o<=.25||a*o<=2)throw r;return g[e.id]=o-.25,z(e,n,i)}throw r})))}))}})),Yt((function(){_.cancel()})))};function bn(e,t,n,r){var i=r.period,a=!1,o=t.asObservable();return ft([e.getReference().asObservable(),o]).pipe((0,mt.z)((function(e){var t=e[0],r=e[1],o=t.position.last;return void 0!==i.end&&o+r>=i.end&&(f.Z.debug('Stream: full "empty" AdaptationStream',n),a=!0),(0,_t.of)({type:"stream-status",value:{period:i,bufferType:n,position:o,imminentDiscontinuity:null,hasFinishedLoading:a,neededSegments:[],shouldRefreshManifest:!1}})})))}var Sn=n(9252);var En=function(e,t){var n=e.split(";"),r=n[0],i=n.slice(1),a=t.split(";"),o=a[0],s=a.slice(1);if(r!==o)return!1;var u=(0,V.Z)(i,(function(e){return(0,Sn.Z)(e,"codecs=")})),l=(0,V.Z)(s,(function(e){return(0,Sn.Z)(e,"codecs=")}));if(void 0===u||void 0===l)return!1;var d=u.substring(7),c=l.substring(7);return d.split(".")[0]===c.split(".")[0]};function Tn(e,t,n,r,i,a){if(void 0!==e.codec&&"reload"===a.onCodecSwitch&&!function(e,t){return e.getPlayableRepresentations().some((function(e){return En(e.getMimeTypeString(),t)}))}(n,e.codec))return{type:"needs-reload",value:void 0};var o=e.getBufferedRanges();if(0===o.length)return{type:"continue",value:void 0};var s=(0,T.JN)(o),u=t.start,l=null==t.end?1/0:t.end,d=(0,T.tn)(s,[{start:u,end:l}]);if(0===d.length)return{type:"continue",value:void 0};e.synchronizeInventory();var c=e.getInventory();if(!c.some((function(e){return e.infos.period.id===t.id&&e.infos.adaptation.id!==n.id})))return{type:"continue",value:void 0};var f=function(e,t,n){return e.reduce((function(e,r){if(r.infos.period.id!==t.id||r.infos.adaptation.id!==n.id)return e;var i=r.bufferedStart,a=r.bufferedEnd;return void 0===i||void 0===a||e.push({start:i,end:a}),e}),[])}(c,t,n),v=(0,T.uH)(d,f);if(0===v.length)return{type:"continue",value:void 0};var h=i.currentTime;if("reload"===r&&(0,T.Ti)({start:u,end:l},h)&&(i.readyState>1||!n.getPlayableRepresentations().some((function(t){var n;return En(t.getMimeTypeString(),null!==(n=e.codec)&&void 0!==n?n:"")})))&&!(0,T.A1)(f,h))return{type:"needs-reload",value:void 0};var m="direct"===r,g=[],y=mn(c,t);null!==y&&(void 0===y.bufferedEnd||t.start-y.bufferedEnd<1)&&g.push({start:0,end:t.start+1});var _=n.type,b=p.Z.getCurrent().ADAP_REP_SWITCH_BUFFER_PADDINGS,S=b[_].before;null==S&&(S=0);var E=b[_].after;if(null==E&&(E=0),m||g.push({start:h-S,end:h+E}),void 0!==t.end){var w=gn(c,t);null!==w&&(void 0===w.bufferedStart||w.bufferedStart-t.end<1)&&g.push({start:t.end-1,end:Number.MAX_VALUE})}var k=(0,T.uH)(v,g);return 0===k.length?{type:"continue",value:void 0}:m&&"text"!==n.type?{type:"flush-buffer",value:k}:{type:"clean-buffer",value:k}}var wn=function(e){var t=e.bufferType,n=e.content,r=e.garbageCollectors,i=e.playbackObserver,o=e.representationEstimator,s=e.segmentFetcherCreator,u=e.segmentBuffersStore,l=e.options,d=e.wantedBufferAhead,c=e.maxVideoBufferSize,v=n.manifest,g=n.period,y=new Ht(1);return y.pipe(jt((function(e,n){var y=p.Z.getCurrent().DELTA_POSITION_AFTER_RELOAD,_=0===n?0:"audio"===t?y.trackSwitch.audio:"video"===t?y.trackSwitch.video:y.trackSwitch.other;if(null===e){f.Z.info("Stream: Set no "+t+" Adaptation. P:",g.start);var b,S=u.getStatus(t);if("initialized"===S.type){if(f.Z.info("Stream: Clearing previous "+t+" SegmentBuffer"),Ve.isNative(t))return Xt(g,t,i,0);var A=new k.ZP;b=Ot(A,(function(){return void 0===g.end?S.value.removeBuffer(g.start,1/0,A.signal):g.end<=g.start?Promise.resolve():S.value.removeBuffer(g.start,g.end,A.signal)}))}else"uninitialized"===S.type&&u.disableSegmentBuffer(t),b=(0,_t.of)(null);return(0,$e.z)(b.pipe((0,Xe.U)((function(){return Gt.adaptationChange(t,null,g)}))),bn(i,d,t,{period:g}))}if(Ve.isNative(t)&&"disabled"===u.getStatus(t).type)return Xt(g,t,i,_);var I=e.adaptation,R=e.representations;f.Z.info("Stream: Updating "+t+" adaptation","A: "+I.id,"P: "+g.start);var x=(0,yt.P)((function(){var n=i.getReadyState(),p=function(e,t,n,r){var i=e.getStatus(t);if("initialized"===i.type)return f.Z.info("Stream: Reusing a previous SegmentBuffer for the type",t),i.value;var a=function(e){var t=e.getPlayableRepresentations();if(0===t.length){throw new h.Z("NO_PLAYABLE_REPRESENTATION","No Representation in the chosen "+e.type+" Adaptation can be played")}return t[0].getMimeTypeString()}(n),o="text"===t?r.textTrackOptions:void 0;return e.createSegmentBuffer(t,a,o)}(u,t,I,l),y={currentTime:i.getCurrentTime(),readyState:n},b=Tn(p,g,I,e.switchingMode,y,l);if("needs-reload"===b.type)return Xt(g,t,i,_);var S="flush-buffer"===b.type?(0,_t.of)(Gt.needsBufferFlush()):a.E,A="clean-buffer"===b.type||"flush-buffer"===b.type?$e.z.apply(void 0,b.value.map((function(e){var t=e.start,n=e.end,r=new k.ZP;return Ot(r,(function(){return p.removeBuffer(t,n,r.signal)}))}))).pipe((0,gt.l)()):a.E,x=r.get(p),Z=function(e,n,r){var a=function(e,t){return e.deriveReadOnlyObserver((function(e,n){var r=(0,w.ZP)(i());return e.onUpdate(a,{clearSignal:n,emitCurrentValue:!1}),n.register((function(){r.finish()})),r;function i(){var n=e.getValue(),r=t.getBufferedRanges(),i=(0,T.L7)(r,n.position.last);return(0,E.Z)({},n,{bufferGap:i})}function a(){r.setValue(i())}}))}(i,r);return _n({content:{manifest:v,period:g,adaptation:e,representations:n},options:l,playbackObserver:a,representationEstimator:o,segmentBuffer:r,segmentFetcherCreator:s,wantedBufferAhead:d,maxVideoBufferSize:c}).pipe((0,qt.K)((function(e){if(!Ve.isNative(t)){f.Z.error("Stream: "+t+" Stream crashed. Aborting it.",e instanceof Error?e:""),u.disposeSegmentBuffer(t);var n=(0,m.Z)(e,{defaultCode:"NONE",defaultReason:"Unknown `AdaptationStream` error"});return(0,$e.z)((0,_t.of)(Gt.warning(n)),bn(i,d,t,{period:g}))}throw f.Z.error("Stream: "+t+" Stream crashed. Stopping playback.",e instanceof Error?e:""),e})))}(I,R,p),P=new k.ZP;return Ot(P,(function(){return u.waitForUsableBuffers(P.signal)})).pipe((0,mt.z)((function(){return(0,$e.z)(A,S,(0,ht.T)(Z,x))})))}));return(0,$e.z)((0,_t.of)(Gt.adaptationChange(t,I,g)),x)})),Je(Gt.periodStreamReady(t,v,g,y)))};function kn(e,t,n,r,i){return function(a,o){var u=n,l=t,d=0;a.subscribe((0,s.x)(o,(function(t){var n=d++;l=u?e(l,t,n):(u=!0,t),r&&o.next(l)}),i&&function(){u&&o.next(l),o.complete()}))}}function An(e){var t=e.length;return ht.T.apply(void 0,e).pipe(Ye((function(e){var t=e.type;return"periodStreamCleared"===t||"adaptationChange"===t||"representationChange"===t})),function(e,t){return(0,o.e)(kn(e,t,arguments.length>=2,!0))}((function(e,t){switch(t.type){case"periodStreamCleared":var n=t.value,r=n.period,i=n.type,a=e[r.id];void 0!==a&&a.buffers.has(i)&&(a.buffers.delete(i),0===a.buffers.size&&delete e[r.id]);break;case"adaptationChange":if(null!==t.value.adaptation)return e;case"representationChange":var o=t.value,s=o.period,u=o.type,l=e[s.id];if(void 0===l){var d=new Set;d.add(u),e[s.id]={period:s,buffers:d}}else l.buffers.has(u)||l.buffers.add(u)}return e}),{}),(0,Xe.U)((function(e){for(var n=Object.keys(e),r=[],i=0;i<n.length;i++){var a=e[n[i]];void 0!==a&&a.buffers.size===t&&r.push(a.period)}return r.reduce((function(e,t){return null===e||t.start<e.start?t:e}),null)})),tt((function(e,t){return null===e&&null===t||null!==e&&null!==t&&e.id===t.id})))}function In(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e){return e.pipe(Ye((function(e){return"complete-stream"===e.type||"stream-status"===e.type&&!e.value.hasFinishedLoading})),(0,Xe.U)((function(e){return"complete-stream"===e.type})),Je(!1),tt())}));return ft(r).pipe((0,Xe.U)((function(e){return e.every((function(e){return e}))})),tt())}function Rn(e,t){if(0===t.length)return[];e.synchronizeInventory();for(var n=[],r=e.getInventory(),i=function(i){var a=r[i];if(t.some((function(e){return a.infos.period.id===e.period.id&&a.infos.adaptation.id===e.adaptation.id&&a.infos.representation.id===e.representation.id}))){var o=a.bufferedStart,s=a.bufferedEnd;if(void 0===o||void 0===s){f.Z.warn("SO: No buffered start or end found from a segment.");var u=e.getBufferedRanges(),l=u.length;return 0===l?{v:[]}:{v:[{start:u.start(0),end:u.end(l-1)}]}}var d=n[n.length-1];void 0!==d&&d.end===o?d.end=s:n.push({start:o,end:s})}},a=0;a<r.length;a++){var o=i(a);if("object"==typeof o)return o.v}return n}function xn(e,t){if(0===t.length)return!1;var n=e.position.last;return e.speed>=0?t[t.length-1].end>=n-5:t[0].start<=n+5}var Zn=function(e,t,n,r,o,s){var l=e.manifest,d=e.initialPeriod,c=s.maxBufferAhead,v=s.maxBufferBehind,m=s.wantedBufferAhead,g=s.maxVideoBufferSize,y=p.Z.getCurrent(),_=y.MAXIMUM_MAX_BUFFER_AHEAD,S=y.MAXIMUM_MAX_BUFFER_BEHIND,E=new Ft((function(e){var n=e.bufferType,r=null!=S[n]?S[n]:1/0,i=null!=_[n]?_[n]:1/0;return new Ke.y((function(){var n=new k.ZP;return zt({segmentBuffer:e,playbackObserver:t,maxBufferBehind:(0,w.lR)(v,(function(e){return Math.min(e,r)}),n.signal),maxBufferAhead:(0,w.lR)(c,(function(e){return Math.min(e,i)}),n.signal)},n.signal),function(){n.cancel()}}))})),T=r.getBufferTypes().map((function(e){return function(e,n){var o=new Bt((function(e,t){return e.start-t.start})),s=new i.x,d=!1;function c(t){return x(e,t,s).pipe((0,Xe.U)((function(e){switch(e.type){case"waiting-media-source-reload":var t=o.head();if(void 0===t||t.id!==e.value.period.id)return Gt.lockedStream(e.value.bufferType,e.value.period);var n=e.value,r=n.position,i=n.autoPlay;return Gt.needsMediaSourceReload(r,i);case"periodStreamReady":d=!0,o.add(e.value.period);break;case"periodStreamCleared":o.removeElement(e.value.period)}return e})),je())}function v(e){var t=o.head(),n=o.last();return null==t||null==n||(t.start>e||(null==n.end?1/0:n.end)<e)}var p=t.getReference().asObservable().pipe((g=function(t){var n,r,i=t.position,a=null!==(n=i.pending)&&void 0!==n?n:i.last;if(!d||!v(a))return null;var o=null!==(r=l.getPeriodForTime(a))&&void 0!==r?r:l.getNextPeriod(a);return void 0===o?null:(f.Z.info("SO: Current position out of the bounds of the active periods,re-creating Streams.",e,a),d=!1,s.next(),o)},y=null,function(e){return(0,yt.P)((function(){return e.pipe((0,Xe.U)(g),Ye((function(e){return e!==y})))}))}),(0,mt.z)((function(e){if(null==e)throw new h.Z("MEDIA_TIME_NOT_FOUND","The wanted position is not found in the Manifest.");return c(e)}))),m=(0,b.R)(l,"decipherabilityUpdate").pipe((0,mt.z)(_));var g,y;return(0,ht.T)(p,m,c(n));function _(n){var i=r.getStatus(e),o=n.filter((function(t){return t.adaptation.type===e}));if(0===o.length||"initialized"!==i.type)return a.E;var f=i.value,v=o.filter((function(e){return void 0===e.representation.decipherable})),p=o.filter((function(e){return!1===e.representation.decipherable})),m=Rn(f,p),g=Rn(f,v);d=!1,s.next();var y=[].concat(m,g).map((function(e){var t=e.start,n=e.end;if(t>=n)return a.E;var r=new k.ZP;return Ot(r,(function(){return f.removeBuffer(t,n,r.signal)})).pipe((0,gt.l)())}));return $e.z.apply(void 0,y.concat([Ut().pipe((0,gt.l)()),t.getReference().asObservable().pipe(u(1),(0,mt.z)((function(e){var n,r=(0,yt.P)((function(){var t,n=null!==(t=e.position.pending)&&void 0!==t?t:e.position.last,r=l.getPeriodForTime(n);if(null==r)throw new h.Z("MEDIA_TIME_NOT_FOUND","The wanted position is not found in the Manifest.");return c(r)}));if(xn(e,m)){var i=!(null!==(n=e.paused.pending)&&void 0!==n?n:t.getIsPaused());return(0,$e.z)((0,_t.of)(Gt.needsDecipherabilityFlush(e.position.last,i,e.duration)),r)}return xn(e,g)?(0,$e.z)((0,_t.of)(Gt.needsBufferFlush()),r):r})))]))}}(e,d).pipe((function(e){return e.pipe((0,wt.R)(Dt))}),je())})),A=An(T).pipe(Ye((function(e){return null!==e})),(0,Xe.U)((function(e){return f.Z.info("Stream: New active period",e.start),Gt.activePeriodChanged(e)}))),I=(0,b.R)(l,"manifestUpdate").pipe((0,Xe.U)((function(){return l.isLastPeriodKnown})),Je(l.isLastPeriodKnown),tt()),R=ft([In.apply(void 0,T),I]).pipe((0,Xe.U)((function(e){var t=e[0],n=e[1];return t&&n})),tt(),(0,Xe.U)((function(e){return e?Gt.endOfStream():Gt.resumeStream()})));return ht.T.apply(void 0,T.concat([A,R]));function x(e,a,d){f.Z.info("SO: Creating new Stream for",e,a.start);var c=new i.x,v=new i.x,p=t.getReference().asObservable().pipe(Ye((function(e){var t,n=e.position;return null!=a.end&&(null!==(t=n.pending)&&void 0!==t?t:n.last)>=a.end}))),h=c.pipe(bt((function(t){return x(e,t,v)}))),y=d.pipe(u(1),(0,Et.b)((function(){c.complete(),v.next(),v.complete()})),je()),_=(0,ht.T)(p,y),b=wn({bufferType:e,content:{manifest:l,period:a},garbageCollectors:E,maxVideoBufferSize:g,segmentFetcherCreator:o,segmentBuffersStore:r,options:s,playbackObserver:t,representationEstimator:n,wantedBufferAhead:m}).pipe((0,mt.z)((function(t){if("stream-status"===t.type)if(t.value.hasFinishedLoading){var n=l.getPeriodAfter(a);if(null===n)return(0,$e.z)((0,_t.of)(t),(0,_t.of)(Gt.streamComplete(e)));c.next(n)}else v.next();return(0,_t.of)(t)})),je()),S=(0,$e.z)(b.pipe((0,Tt.R)(_)),(0,_t.of)(Gt.periodStreamCleared(e,l,a)).pipe((0,Et.b)((function(){f.Z.info("SO: Destroying Stream for",e,a.start)}))));return(0,ht.T)(S,h,y.pipe((0,gt.l)()))}},Pn=Zn,Mn=n(379);var Cn=function(){function e(e){this._manifest=e,this._lastAudioAdaptation=void 0,this._lastVideoAdaptation=void 0}var t=e.prototype;return t.updateLastAudioAdaptation=function(e){this._lastAudioAdaptation=e},t.updateLastVideoAdaptation=function(e){this._lastVideoAdaptation=e},t.getMaximumAvailablePosition=function(){var e;if(this._manifest.isDynamic)return null!==(e=this._manifest.getLivePosition())&&void 0!==e?e:this._manifest.getMaximumSafePosition();if(void 0===this._lastVideoAdaptation||void 0===this._lastAudioAdaptation)return this._manifest.getMaximumSafePosition();if(null===this._lastAudioAdaptation){if(null===this._lastVideoAdaptation)return this._manifest.getMaximumSafePosition();var t=Dn(this._lastVideoAdaptation);return"number"!=typeof t?this._manifest.getMaximumSafePosition():t}if(null===this._lastVideoAdaptation){var n=Dn(this._lastAudioAdaptation);return"number"!=typeof n?this._manifest.getMaximumSafePosition():n}var r=Dn(this._lastAudioAdaptation),i=Dn(this._lastVideoAdaptation);return"number"!=typeof r||"number"!=typeof i?this._manifest.getMaximumSafePosition():Math.min(r,i)},t.getEndingPosition=function(){var e,t;if(!this._manifest.isDynamic)return this.getMaximumAvailablePosition();if(void 0!==this._lastVideoAdaptation&&void 0!==this._lastAudioAdaptation){if(null===this._lastAudioAdaptation)return null===this._lastVideoAdaptation?void 0:null!==(e=On(this._lastVideoAdaptation))&&void 0!==e?e:void 0;if(null===this._lastVideoAdaptation)return null!==(t=On(this._lastAudioAdaptation))&&void 0!==t?t:void 0;var n=On(this._lastAudioAdaptation),r=On(this._lastVideoAdaptation);return"number"!=typeof n||"number"!=typeof r?void 0:Math.min(n,r)}},e}();function Dn(e){for(var t,n=e.representations,r=null,i=0;i<n.length;i++)if(n[i].index!==t){t=n[i].index;var a=n[i].index.getLastAvailablePosition();if(void 0===a)return;null!==a&&(r=(0,S.Z)(r)?a:Math.min(r,a))}return r}function On(e){for(var t,n=e.representations,r=null,i=0;i<n.length;i++)if(n[i].index!==t){t=n[i].index;var a=n[i].index.getEnd();if(void 0===a)return;null!==a&&(r=(0,S.Z)(r)?a:Math.min(r,a))}return r}var Nn=n(5767),Ln=n(3774),Un=n(6923);function Bn(e,t,n){if(null!==t&&"closed"!==t.readyState){for(var r=t.readyState,i=t.sourceBuffers,a=i.length-1;a>=0;a--){var o=i[a];try{"open"===r&&(f.Z.info("Init: Removing SourceBuffer from mediaSource"),o.abort()),t.removeSourceBuffer(o)}catch(e){f.Z.warn("Init: Error while disposing SourceBuffer",e instanceof Error?e:"")}}i.length>0&&f.Z.warn("Init: Not all SourceBuffers could have been removed.")}if((0,Nn.Z)(e),null!==n)try{f.Z.debug("Init: Revoking previous URL"),URL.revokeObjectURL(n)}catch(e){f.Z.warn("Init: Error while revoking the media source URL",e instanceof Error?e:"")}}function Fn(e,t){return new Promise((function(n,r){var i=!1,a=function(e,t){if(null==Ln.J)throw new h.Z("MEDIA_SOURCE_NOT_SUPPORTED","No MediaSource Object was found in the current browser.");var n=(0,Un.Z)(e.src)?e.src:null;Bn(e,null,n),f.Z.info("Init: Creating MediaSource");var r=new Ln.J,i=URL.createObjectURL(r);return f.Z.info("Init: Attaching MediaSource URL to the media element",i),e.src=i,t.register((function(){Bn(e,r,i)})),r}(e,t),o=new k.ZP({cancelOn:t});l.u_(a,(function(){o.cancel(),i=!0,n(a)}),o.signal),t.register((function(e){i||r(e)}))}))}function zn(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Kn=l.x6,Gn=l.u_,Wn=l.y4;function Hn(e,t){if(f.Z.debug("Init: Trying to call endOfStream"),"open"===e.readyState){var n=e.sourceBuffers,r=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];r.updating&&t.push(r)}return t}(n);if(0===r.length)return f.Z.info("Init: Triggering end of stream"),void e.endOfStream();f.Z.debug("Init: Waiting SourceBuffers to be updated before calling endOfStream.");for(var i,a=new k.ZP({cancelOn:t}),o=zn(r);!(i=o()).done;){var s=i.value;Wn(s,(function(){a.cancel(),Hn(e,t)}),a.signal)}Kn(n,(function(){a.cancel(),Hn(e,t)}),a.signal)}else f.Z.debug("Init: MediaSource not open, cancel endOfStream")}function jn(e,t,n){if(!(0,S.Z)(n)){var r,i=e.getMinimumSafePosition();if(e.isLive&&(r=e.getLivePosition()),void 0===r&&(r=e.getMaximumSafePosition()),!(0,S.Z)(n.position))return f.Z.debug("Init: using startAt.minimumPosition"),Math.max(Math.min(n.position,r),i);if(!(0,S.Z)(n.wallClockTime)){f.Z.debug("Init: using startAt.wallClockTime");var a=void 0===e.availabilityStartTime?0:e.availabilityStartTime,o=n.wallClockTime-a;return Math.max(Math.min(o,r),i)}if(!(0,S.Z)(n.fromFirstPosition)){f.Z.debug("Init: using startAt.fromFirstPosition");var s=n.fromFirstPosition;return s<=0?i:Math.min(r,i+s)}if(!(0,S.Z)(n.fromLastPosition)){f.Z.debug("Init: using startAt.fromLastPosition");var u=n.fromLastPosition;return u>=0?r:Math.max(i,r+u)}if(!(0,S.Z)(n.percentage)){f.Z.debug("Init: using startAt.percentage");var l=n.percentage;return l>100?r:l<0?i:i+(r-i)*(+l/100)}}var d=e.getMinimumSafePosition();if(e.isLive){var c,v=e.suggestedPresentationDelay,h=e.clockOffset,m=e.getMaximumSafePosition(),g=p.Z.getCurrent().DEFAULT_LIVE_GAP;if(void 0===h)f.Z.info("Init: no clock offset found for a live content, starting close to maximum available position"),c=m;else{f.Z.info("Init: clock offset found for a live content, checking if we can start close to it");var y=void 0===e.availabilityStartTime?0:e.availabilityStartTime,_=(performance.now()+h)/1e3-y;c=Math.min(m,_)}var b=void 0!==v?v:t?g.LOW_LATENCY:g.DEFAULT;return f.Z.debug("Init: "+c+" defined as the live time, applying a live gap of "+b),Math.max(c-b,d)}return f.Z.info("Init: starting at the minimum available position:",d),d}var qn=n(1757),Yn=n(8833),Xn=n(8799);function $n(e,t,n,r,i){var a=new k.ZP,o=L.Z,s=!1,u=e.manifest,l=0;return d(e),{forceRefresh:function(e){o(e)},stop:function(){o=L.Z,a.cancel()}};function d(e){var t=e.sendingTime,r=e.parsingTime,i=e.updatingTime,s=p.Z.getCurrent(),d=s.MAX_CONSECUTIVE_MANIFEST_PARSING_IN_UNSAFE_MODE,v=s.MIN_MANIFEST_PARSING_TIME_TO_ENTER_UNSAFE_MODE,h=void 0!==r?r+(null!=i?i:0):void 0,m=l>0?l<d:void 0!==h&&h>=v,g=void 0===t?0:performance.now()-t,y=Math.max(n-g,0),_=new k.ZP({cancelOn:a.signal});if(o=function(e){var r=e.completeRefresh,i=e.delay,a=e.canUseUnsafeMode&&m,o=void 0===t?0:performance.now()-t,s=Math.max(n-o,0),u=setTimeout((function(){_.cancel(),c({completeRefresh:r,unsafeMode:a})}),Math.max((null!=i?i:0)-o,s));_.signal.register((function(){clearTimeout(u)}))},null!==u.expired){var b=setTimeout((function(){var e;null===(e=u.expired)||void 0===e||e.then((function(){_.cancel(),c({completeRefresh:!0,unsafeMode:m})}),L.Z)}),y);_.signal.register((function(){clearTimeout(b)}))}if(void 0!==u.lifetime&&u.lifetime>=0){var S,E=1e3*u.lifetime-g;void 0===h?S=E:u.lifetime<3&&h>=100?(S=Math.min(Math.max(3e3-g,Math.max(E,0)+h),6*E),f.Z.info("MUS: Manifest update rythm is too frequent. Postponing next request.",E,S)):h>=1e3*u.lifetime/10?(S=Math.min(Math.max(E,0)+h,6*E),f.Z.info("MUS: Manifest took too long to parse. Postponing next request",S,S)):S=E;var T=setTimeout((function(){_.cancel(),c({completeRefresh:!1,unsafeMode:m})}),Math.max(S,y));_.signal.register((function(){clearTimeout(T)}))}}function c(e){var o=e.completeRefresh,v=e.unsafeMode,h=u.updateUrl,m=o||void 0===h,g=m?u.getUrl():h,y=u.clockOffset;v?(l+=1,f.Z.info('Init: Refreshing the Manifest in "unsafeMode" for the '+String(l)+" consecutive time.")):l>0&&(f.Z.info('Init: Not parsing the Manifest in "unsafeMode" anymore after '+String(l)+" consecutive times."),l=0),s||(s=!0,t.fetch(g,r,a.signal).then((function(e){return e.parse({externalClockOffset:y,previousManifest:u,unsafeMode:v})})).then((function(e){s=!1;var t=e.manifest,r=e.sendingTime,i=e.parsingTime,o=performance.now();if(m)u.replace(t);else try{u.update(t)}catch(e){var l=e instanceof Error?e.message:"unknown error";f.Z.warn("MUS: Attempt to update Manifest failed: "+l,"Re-downloading the Manifest fully");var v=p.Z.getCurrent().FAILED_PARTIAL_UPDATE_MANIFEST_REFRESH_DELAY,h=void 0===r?0:performance.now()-r,g=Math.max(n-h,0),y=L.Z,_=setTimeout((function(){y(),c({completeRefresh:!0,unsafeMode:!1})}),Math.max(v-h,g));return void(y=a.signal.register((function(){clearTimeout(_)})))}d({sendingTime:r,parsingTime:i,updatingTime:performance.now()-o})})).catch((function(e){s=!1,i(e)})))}}var Qn=function(){function e(e,t){var n=new k.ZP,r=(0,w.ZP)(void 0);this._canceller=n,this._currentKnownDuration=r;var i=function(e,t){var n=(0,w.ZP)("open"===e.readyState);return(0,l.u_)(e,(function(){n.setValueIfChanged(!0)}),t),(0,l.N8)(e,(function(){n.setValueIfChanged(!1)}),t),(0,l.k6)(e,(function(){n.setValueIfChanged(!1)}),t),t.register((function(){n.finish()})),n}(t,this._canceller.signal),a=new k.ZP({cancelOn:this._canceller.signal});function o(n){var i=function(e,t){if(0===e.length){var n=(0,w.ZP)(!1);return n.finish(),n}var r=(0,w.ZP)(!1);o();for(var i=function(n){var r=e[n];r.addEventListener("updatestart",o),r.addEventListener("update",o),t.register((function(){r.removeEventListener("updatestart",o),r.removeEventListener("update",o)}))},a=0;a<e.length;a++)i(a);return r;function o(){for(var t=0;t<e.length;t++){if(e[t].updating)return void r.setValueIfChanged(!0)}r.setValueIfChanged(!1)}}(t.sourceBuffers,n),a=new k.ZP({cancelOn:n});return i.onUpdate((function(i){a.cancel(),a=new k.ZP({cancelOn:n}),i||Jn(t,e,r.getValue(),n)}),{clearSignal:n,emitCurrentValue:!0})}i.onUpdate((function(){if(a.cancel(),!i.getValue())return;a=new k.ZP({cancelOn:n.signal});var t=new k.ZP({cancelOn:a.signal}),s=function(){t.cancel(),o((t=new k.ZP({cancelOn:a.signal})).signal)};r.onUpdate(s,{emitCurrentValue:!1,clearSignal:a.signal}),e.addEventListener("manifestUpdate",s,a.signal),o(t.signal)}),{emitCurrentValue:!0,clearSignal:this._canceller.signal})}var t=e.prototype;return t.updateKnownDuration=function(e){this._currentKnownDuration.setValueIfChanged(e)},t.stop=function(){this._canceller.cancel()},e}();function Jn(e,t,n,r){var i=function(e,t,n){var r,i=n;if(void 0===i)if(t.isDynamic){var a=null!==(r=t.getLivePosition())&&void 0!==r?r:t.getMaximumSafePosition();i=Math.max(Math.pow(2,32),a+31536e3)}else i=t.getMaximumSafePosition();for(var o=0,s=0;s<e.sourceBuffers.length;s++){var u=e.sourceBuffers[s],l=u.buffered.length;l>0&&(o=Math.max(u.buffered.end(l-1)))}if(i===e.duration)return"success";if(o>i){if(o<e.duration)try{f.Z.info("Init: Updating duration to what is currently buffered",o),e.duration=i}catch(e){return f.Z.warn("Duration Updater: Can't update duration on the MediaSource.",e instanceof Error?e:""),"failed"}return"partial"}var d=e.duration;try{f.Z.info("Init: Updating duration",i),e.duration=i}catch(e){return f.Z.warn("Duration Updater: Can't update duration on the MediaSource.",e instanceof Error?e:""),"failed"}var c=Math.abs(e.duration-i);return c>=.1?c<Math.abs(e.duration-d)?"partial":"failed":"success"}(e,t,n);if("success"!==i)var a=setTimeout((function(){o(),Jn(e,t,n,r)}),2e3),o=r.register((function(){clearTimeout(a)}))}var er=n(6199);var tr=function(e,t){return e.id===t.id&&e.start===t.start&&e.end===t.end};var nr=function(e,t){for(var n=[],r=t.periods,i=0;i<r.length;i++){r[i].streamEvents.forEach((function(t){for(var r=t.start,i=t.end,a=t.id,o=t.data,s=0;s<e.length;s++){var u=e[s];if(tr(u,{id:a,start:r,end:i}))return void n.push(u)}if(void 0===i){var l={start:r,id:a,data:o,publicEvent:{start:r,data:o}};n.push(l)}else{var d={start:r,end:i,id:a,data:o,publicEvent:{start:r,end:i,data:o}};n.push(d)}}))}return n};function rr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ir(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ir(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ir(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ar(e){return void 0!==e.end}var or=function(e,t,n,r,i,a){var o=new WeakMap,s=(0,w.ZP)(nr([],e));e.addEventListener("manifestUpdate",(function(){var t=s.getValue();s.setValue(nr(t,e))}),a);var u=!1,l=new k.ZP({cancelOn:a});s.onUpdate((function(e){if(0!==e.length){if(!u){u=!0;var d=h(),c=p.Z.getCurrent().STREAM_EVENT_EMITTER_POLL_INTERVAL,f=setInterval(v,c);n.listen(v,{includeLastObservation:!1,clearSignal:l.signal}),l.signal.register((function(){clearInterval(f)}))}}else u&&(l.cancel(),l=new k.ZP({cancelOn:a}),u=!1);function v(){var e=h();!function(e,t,n,a){for(var s=t.currentTime,u=n.isSeeking,l=n.currentTime,d=[],c=[],f=0;f<e.length;f++){var v=e[f],p=v.start,h=ar(v)?v.end:void 0;o.has(v)?(p>l||void 0!==h&&l>=h)&&(ar(v)&&c.push(v.publicEvent),o.delete(v)):p<=l&&void 0!==h&&l<h?(d.push({type:"stream-event",value:v.publicEvent}),o.set(v,!0)):s<p&&l>=(null!=h?h:p)&&(u?d.push({type:"stream-event-skip",value:v.publicEvent}):(d.push({type:"stream-event",value:v.publicEvent}),ar(v)&&c.push(v.publicEvent)))}if(d.length>0)for(var m,g=rr(d);!(m=g()).done;){var y=m.value;if("stream-event"===y.type?r(y.value):i(y.value),a.isCancelled)return}if(c.length>0)for(var _,b=rr(c);!(_=b()).done;){var S=_.value;if("function"==typeof S.onExit&&S.onExit(),a.isCancelled)return}}(s.getValue(),d,e,l.signal),d=e}function h(){var e=n.getReference().getValue().seeking;return{currentTime:t.currentTime,isSeeking:e}}}),{emitCurrentValue:!0,clearSignal:a})},sr=n(4576),ur=function(e){function n(t){var n;return(n=e.call(this)||this)._settings=t,n._initCanceller=new k.ZP,n._initialManifestProm=null,n._manifestFetcher=new be(t.url,t.transport,t.manifestRequestSettings),n}(0,t.Z)(n,e);var r=n.prototype;return r.prepare=function(){var e=this;if(null===this._initialManifestProm){var t=this._settings.initialManifest;this._settings.initialManifest=void 0,t instanceof O.ZP?this._initialManifestProm=Promise.resolve({manifest:t}):this._initialManifestProm=void 0!==t?this._manifestFetcher.parse(t,{previousManifest:null,unsafeMode:!1},(function(t){return e.trigger("warning",t)}),this._initCanceller.signal):this._manifestFetcher.fetch(void 0,(function(t){e.trigger("warning",t)}),this._initCanceller.signal).then((function(e){return e.parse({previousManifest:null,unsafeMode:!1})}))}},r.start=function(e,t){var n=this;this.prepare(),(0,sr.Z)(e,(function(e){return n._onFatalError(e)}),this._initCanceller.signal);var r=(0,w.ZP)(null);this._initializeMediaSourceAndDecryption(e,r).then((function(i){return n._onInitialMediaSourceReady(e,i.mediaSource,t,i.drmSystemId,r,i.unlinkMediaSource)})).catch((function(e){e instanceof k.FU||n._onFatalError(e)}))},r.dispose=function(){this._initCanceller.cancel()},r._onFatalError=function(e){this._initCanceller.cancel(),this.trigger("error",e)},r._initializeMediaSourceAndDecryption=function(e,t){var n=this;return new Promise((function(r,i){var a=n._settings.keySystems,o=n._initCanceller,s=o.signal.register((function(e){i(e)})),u=(0,Xn.Z)(e,a,t,{onWarning:function(e){return n.trigger("warning",e)},onError:function(e){return n._onFatalError(e)}},o.signal);u.onUpdate((function(t,i){if("uninitialized"!==t.initializationState.type){i();var a=new k.ZP({cancelOn:o.signal});Fn(e,a.signal).then((function(e){var n=u.getValue();if("awaiting-media-link"===n.initializationState.type)n.initializationState.value.isMediaLinked.setValue(!0),u.onUpdate((function(t,n){if("initialized"===t.initializationState.type)return n(),s(),void r({mediaSource:e,drmSystemId:t.drmSystemId,unlinkMediaSource:a})}),{emitCurrentValue:!0,clearSignal:o.signal});else if("initialized"===t.initializationState.type)return s(),void r({mediaSource:e,drmSystemId:t.drmSystemId,unlinkMediaSource:a})})).catch((function(e){a.isUsed||n._onFatalError(e)}))}}),{emitCurrentValue:!0,clearSignal:o.signal})}))},r._onInitialMediaSourceReady=function(){var e=(0,A.Z)(R().mark((function e(t,n,r,i,a,o){var s,u,l,d,c,v,p,h,m,g,y,b,S,T,w,A,I,x,Z,P,M,C,D,O,N=this;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O=function(e,n,i,o){M({mediaElement:t,playbackObserver:r,mediaSource:e,manifestUpdater:Z,initialTime:n,autoPlay:i,manifest:w,representationEstimator:I,segmentFetcherCreator:P,speed:h,protectionRef:a,bufferOptions:x},(function(e){if(o.cancel(),C("reloadingMediaSource",null),b.isUsed)return;var n=new k.ZP({cancelOn:b.signal});Fn(t,n.signal).then((function(t){O(t,e.position,e.autoPlay,n)})).catch((function(e){n.isUsed||D(e)}))}),o.signal)},s=this._settings,u=s.adaptiveOptions,l=s.autoPlay,d=s.bufferOptions,c=s.lowLatencyMode,v=s.minimumManifestUpdateInterval,p=s.segmentRequestOptions,h=s.speed,m=s.startAt,g=s.textTrackOptions,y=s.transport,b=this._initCanceller,(0,_.Z)(null!==this._initialManifestProm),S=this._initialManifestProm,e.next=7,S;case 7:if(T=e.sent,(w=T.manifest).addEventListener("manifestUpdate",(function(){N.trigger("manifestUpdate",null)}),b.signal),w.addEventListener("decipherabilityUpdate",(function(e){N.trigger("decipherabilityUpdate",e)}),b.signal),f.Z.debug("Init: Calculating initial time"),A=jn(w,c,m),f.Z.debug("Init: Initial time calculated:",A),I=re(u),x=(0,E.Z)({textTrackOptions:g,drmSystemId:i},d),Z=$n(T,this._manifestFetcher,v,(function(e){return N.trigger("warning",e)}),(function(e){b.cancel(),N.trigger("error",e)})),b.signal.register((function(){Z.stop()})),P=new Ce(y,p,b.signal),this.trigger("manifestReady",w),!b.isUsed){e.next=22;break}return e.abrupt("return",void 0);case 22:M=this._startBufferingOnMediaSource.bind(this),C=this.trigger.bind(this),D=this._onFatalError.bind(this),O(n,A,l,o);case 26:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a,o){return e.apply(this,arguments)}}(),r._startBufferingOnMediaSource=function(e,t,n){var r,i=this,a=e.autoPlay,o=e.bufferOptions,s=e.initialTime,u=e.manifest,l=e.manifestUpdater,d=e.mediaElement,c=e.mediaSource,v=e.playbackObserver,m=e.protectionRef,g=e.representationEstimator,y=e.segmentFetcherCreator,_=e.speed,b=new Qn(u,c);n.register((function(){b.stop()}));var S=null!==(r=u.getPeriodForTime(s))&&void 0!==r?r:u.getNextPeriod(s);if(void 0===S){var E=new h.Z("MEDIA_STARTING_TIME_NOT_FOUND","Wanted starting time not found in the Manifest.");return this._onFatalError(E)}var T=new Ve(d,c);n.register((function(){T.disposeAll()}));var A=(0,Yn.Z)(d,v,s,a,(function(e){return i.trigger("warning",e)}),n),I=A.autoPlayResult,R=A.initialPlayPerformed,x=A.initialSeekPerformed;if(!n.isCancelled){var Z=new er.Z(v,u,_);Z.addEventListener("stalled",(function(e){return i.trigger("stalled",e)})),Z.addEventListener("unstalled",(function(){return i.trigger("unstalled",null)})),Z.addEventListener("warning",(function(e){return i.trigger("warning",e)})),n.register((function(){Z.destroy()})),Z.start(),R.onUpdate((function(e,t){e&&(t(),or(u,d,v,(function(e){return i.trigger("streamEvent",e)}),(function(e){return i.trigger("streamEventSkip",e)}),n))}),{clearSignal:n,emitCurrentValue:!0});var P=function(e,t,n){var r=n.autoPlay,i=n.initialPlayPerformed,a=n.initialSeekPerformed,o=n.speed,s=n.startTime;return t.deriveReadOnlyObserver((function(t,n){var u=(0,w.ZP)(l());return o.onUpdate(d,{clearSignal:n,emitCurrentValue:!1}),t.onUpdate(d,{clearSignal:n,emitCurrentValue:!1}),n.register((function(){u.finish()})),u;function l(){var n,u=t.getValue(),l=o.getValue();if(a.getValue()){if(!e.isDynamic||e.isLastPeriodKnown){var d=e.periods[e.periods.length-1];void 0!==d&&void 0!==d.end&&u.position>d.end&&(n=d.end-1)}}else n=s;return{maximumPosition:e.getMaximumSafePosition(),position:{last:u.position,pending:n},duration:u.duration,paused:{last:u.paused,pending:i.getValue()||!r===u.paused?void 0:!r},readyState:u.readyState,speed:l}}function d(){u.setValue(l())}}))}(u,v,{autoPlay:a,initialPlayPerformed:R,initialSeekPerformed:x,speed:_,startTime:s}),M=(0,w.ZP)(null),D=function(e,t,n,r,i){var a=new Cn(e);n.listen((function(t){var n,i=t.position,o=null!==(n=i.pending)&&void 0!==n?n:i.last;if(o<e.getMinimumSafePosition()){var s=new h.Z("MEDIA_TIME_BEFORE_MANIFEST","The current position is behind the earliest time announced in the Manifest.");r(s)}else if(o>a.getMaximumAvailablePosition()){var u=new h.Z("MEDIA_TIME_AFTER_MANIFEST","The current position is after the latest time announced in the Manifest.");r(u)}}),{includeLastObservation:!0,clearSignal:i});var o=(0,w.ZP)(s());return e.addEventListener("manifestUpdate",(function(){o.setValue(s())}),i),t.onUpdate((function(t){if(null!==t&&e.isLastPeriodKnown){var n=e.periods[e.periods.length-1];if(t.value.period.id===(null==n?void 0:n.id)&&("audio"===t.value.type||"video"===t.value.type)){"audio"===t.value.type?a.updateLastAudioAdaptation(t.value.adaptation):a.updateLastVideoAdaptation(t.value.adaptation);var r=e.isDynamic?a.getMaximumAvailablePosition():a.getEndingPosition();o.setValue(r)}}}),{emitCurrentValue:!0,clearSignal:i}),o;function s(){return e.isDynamic?a.getEndingPosition():a.getMaximumAvailablePosition()}}(u,M,P,(function(e){return i.trigger("warning",e)}),n);D.onUpdate((function(e){f.Z.debug("Init: Duration has to be updated.",e),b.updateKnownDuration(e)}),{emitCurrentValue:!0,clearSignal:n}),I.then((function(){(0,qn.Z)(v,d,!1,n).onUpdate((function(e,t){e&&(t(),i.trigger("loaded",{segmentBuffersStore:T}))}),{emitCurrentValue:!0,clearSignal:n})})).catch((function(e){n.isCancelled||i._onFatalError(e)}));var O=null,L=Pn({manifest:u,initialPeriod:S},P,g,T,y,o).subscribe({next:function(e){switch(e.type){case"needs-buffer-flush":v.setCurrentTime(d.currentTime+.001);break;case"end-of-stream":null===O&&(O=new k.ZP({cancelOn:n}),f.Z.debug("Init: end-of-stream order received."),function(e,t){var n=new k.ZP({cancelOn:t});Gn(e,(function(){n.cancel(),n=new k.ZP({cancelOn:t}),Hn(e,n.signal)}),t),Hn(e,n.signal)}(c,O.signal));break;case"resume-stream":null!==O&&(f.Z.debug("Init: resume-stream order received."),O.cancel());break;case"stream-status":var r=e.value,a=r.period,o=r.bufferType,s=r.imminentDiscontinuity,u=r.position;Z.updateDiscontinuityInfo({period:a,bufferType:o,discontinuity:s,position:u});break;case"needs-manifest-refresh":return l.forceRefresh({completeRefresh:!1,canUseUnsafeMode:!0});case"manifest-might-be-out-of-sync":var h=p.Z.getCurrent().OUT_OF_SYNC_MANIFEST_REFRESH_DELAY;return void l.forceRefresh({completeRefresh:!0,canUseUnsafeMode:!1,delay:h});case"locked-stream":Z.onLockedStream(e.value.bufferType,e.value.period);break;case"adaptationChange":M.setValue(e),i.trigger("adaptationChange",e.value);break;case"inband-events":return i.trigger("inbandEvents",e.value);case"warning":return i.trigger("warning",e.value);case"periodStreamReady":return i.trigger("periodStreamReady",e.value);case"activePeriodChanged":return i.trigger("activePeriodChanged",e.value);case"periodStreamCleared":return i.trigger("periodStreamCleared",e.value);case"representationChange":return i.trigger("representationChange",e.value);case"complete-stream":return i.trigger("completeStream",e.value);case"bitrateEstimationChange":return i.trigger("bitrateEstimationChange",e.value);case"needs-media-source-reload":t(e.value);break;case"needs-decipherability-flush":var g=C(d);null===(y=g)||y.indexOf("widevine")<0?t(e.value):e.value.position+.001<e.value.duration?v.setCurrentTime(d.currentTime+.001):v.setCurrentTime(e.value.position);break;case"encryption-data-encountered":m.setValue(e.value);break;default:(0,N.Z)(e)}var y},error:function(e){return i._onFatalError(e)}});n.register((function(){L.unsubscribe()}))}},n}(Mn.K);function lr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var cr=["canplay","ended","play","pause","seeking","seeked","loadedmetadata","ratechange"],fr=function(){function e(e,t){this._internalSeeksIncoming=[],this._mediaElement=e,this._withMediaSource=t.withMediaSource,this._lowLatencyMode=t.lowLatencyMode,this._canceller=new k.ZP,this._observationRef=this._createSharedReference()}var t=e.prototype;return t.stop=function(){this._canceller.cancel()},t.getCurrentTime=function(){return this._mediaElement.currentTime},t.getPlaybackRate=function(){return this._mediaElement.playbackRate},t.getIsPaused=function(){return this._mediaElement.paused},t.setCurrentTime=function(e){this._internalSeeksIncoming.push(e),this._mediaElement.currentTime=e},t.setPlaybackRate=function(e){this._mediaElement.playbackRate=e},t.getReadyState=function(){return this._mediaElement.readyState},t.getReference=function(){return this._observationRef},t.listen=function(e,t){var n;if(this._canceller.isUsed||!0===(null===(n=null==t?void 0:t.clearSignal)||void 0===n?void 0:n.isCancelled))return L.Z;this._observationRef.onUpdate(e,{clearSignal:null==t?void 0:t.clearSignal,emitCurrentValue:null==t?void 0:t.includeLastObservation})},t.deriveReadOnlyObserver=function(e){return hr(this,e,this._canceller.signal)},t._createSharedReference=function(){var e,t=this;if(void 0!==this._observationRef)return this._observationRef;var n=p.Z.getCurrent(),r=n.SAMPLING_INTERVAL_MEDIASOURCE,i=n.SAMPLING_INTERVAL_LOW_LATENCY,a=n.SAMPLING_INTERVAL_NO_MEDIASOURCE,o=function(n){var r,i=n;"seeking"===i&&t._internalSeeksIncoming.length>0&&(i="internal-seeking",r=t._internalSeeksIncoming.shift());var a=null!=e?e:t._generateInitialObservation(),o=pr(t._mediaElement,i,t._withMediaSource),s=null;o.seeking&&("number"==typeof r?s=r:null!==a.pendingInternalSeek&&"seeking"!==n&&(s=a.pendingInternalSeek));var u=function(e,t,n){var r,i,a=n.withMediaSource,o=n.lowLatencyMode,s=p.Z.getCurrent().REBUFFERING_GAP,u=t.event,l=t.position,d=t.bufferGap,c=t.currentRange,f=t.duration,v=t.paused,h=t.readyState,m=t.ended,g=e.rebuffering,y=e.event,_=e.position,b=function(e,t,n,r,i){var a=p.Z.getCurrent().REBUFFERING_GAP,o=i?"LOW_LATENCY":"DEFAULT";if(void 0===t)return n&&Math.abs(r-e)<=a[o];return null!==t&&r-t.end<=a[o]}(l,c,m,f,o),S=h>=1&&"loadedmetadata"!==u&&null===g&&!(b||m),E=null,T=o?s.LOW_LATENCY:s.DEFAULT;if(a){if(S)d===1/0?(r=!0,E=l):void 0===d?h<3&&(r=!0,E=void 0):d<=T&&(r=!0,E=l+d);else if(null!==g){var w=vr(g,o);!0!==r&&null!==g&&h>1&&(b||m||void 0!==d&&isFinite(d)&&d>w)||void 0===d&&h>=3?i=!0:void 0===d?E=void 0:d===1/0?E=l:d<=w&&(E=l+d)}}else S&&(!v&&"timeupdate"===u&&"timeupdate"===y&&l===_||"seeking"===u&&(d===1/0||void 0===d&&h<3))?r=!0:null!==g&&("seeking"!==u&&l!==_||"canplay"===u||void 0===d&&h>=3||void 0!==d&&d<1/0&&(d>vr(g,o)||b||m))&&(i=!0);if(!0===i)return null;var k;if(!0===r||null!==g)return k="seeking"===u||null!==g&&"seeking"===g.reason||t.seeking?"seeking":1===h?"not-ready":"buffering",null!==g&&g.reason===k?{reason:g.reason,timestamp:g.timestamp,position:E}:{reason:k,timestamp:performance.now(),position:E};return null}(a,o,{lowLatencyMode:t._lowLatencyMode,withMediaSource:t._withMediaSource}),l=function(e,t){var n=p.Z.getCurrent().MINIMUM_BUFFER_AMOUNT_BEFORE_FREEZING;if(e.freezing)return t.ended||t.paused||0===t.readyState||0===t.playbackRate||e.position!==t.position?null:e.freezing;return"timeupdate"===t.event&&void 0!==t.bufferGap&&t.bufferGap>n&&!t.ended&&!t.paused&&t.readyState>=1&&0!==t.playbackRate&&t.position===e.position?{timestamp:performance.now()}:null}(a,o),d=(0,E.Z)({},{rebuffering:u,freezing:l,pendingInternalSeek:s},o);return f.Z.hasLevel("DEBUG")&&f.Z.debug("API: current media element state tick","event",d.event,"position",d.position,"seeking",d.seeking,"internalSeek",d.pendingInternalSeek,"rebuffering",null!==d.rebuffering,"freezing",null!==d.freezing,"ended",d.ended,"paused",d.paused,"playbackRate",d.playbackRate,"readyState",d.readyState),d},s=(0,w.ZP)(o("init")),u=function(t){var n=o(t);f.Z.hasLevel("DEBUG")&&f.Z.debug("API: current playback timeline:\n"+function(e,t){for(var n="",r="",i=0;i<e.length;i++){var a=e.start(i),o=e.end(i),s=a.toFixed(2),u=o.toFixed(2),l=s+"|=="+(o-a).toFixed(2)+"==|"+u;if(n+=l,0===r.length&&o>t){var d=n.length-Math.floor(l.length/2);r=" ".repeat(d)+"^"+t}if(i<e.length-1){var c=e.start(i+1),f=" ~"+(c-o).toFixed(2)+"~ ";if(n+=f,0===r.length&&t<c){var v=n.length-Math.floor(f.length/2);r=" ".repeat(v)+"^"+t}}}0===r.length&&(r=" ".repeat(n.length)+"^"+t);return n+"\n"+r}(n.buffered,n.position),"\n"+t),e=n,s.setValue(n)},l=this._lowLatencyMode?i:this._withMediaSource?r:a,d=setInterval(v,l),c=cr.map((function(e){function n(){clearInterval(d),d=setInterval(v,l),u(e)}return t._mediaElement.addEventListener(e,n),function(){t._mediaElement.removeEventListener(e,n)}}));return this._canceller.signal.register((function(){clearInterval(d),c.forEach((function(e){return e()})),s.finish()})),s;function v(){u("timeupdate")}},t._generateInitialObservation=function(){return(0,E.Z)(pr(this._mediaElement,"init",this._withMediaSource),{rebuffering:null,freezing:null,pendingInternalSeek:null})},e}();function vr(e,t){if(null===e)return 0;var n=t?"LOW_LATENCY":"DEFAULT",r=p.Z.getCurrent(),i=r.RESUME_GAP_AFTER_SEEKING,a=r.RESUME_GAP_AFTER_NOT_ENOUGH_DATA,o=r.RESUME_GAP_AFTER_BUFFERING;switch(e.reason){case"seeking":return i[n];case"not-ready":return a[n];case"buffering":return o[n]}}function pr(e,t,n){var r,i,a=e.buffered,o=e.currentTime,s=e.duration,u=e.ended,l=e.paused,d=e.playbackRate,c=e.readyState,f=e.seeking;return!n&&0===a.length&&c>=3?(r=void 0,i=void 0):i=null!==(r=(0,T.rx)(a,o))?r.end-o:1/0,{bufferGap:i,buffered:a,currentRange:r,position:o,duration:s,ended:u,paused:l,playbackRate:d,readyState:c,seeking:f,event:t}}function hr(e,t,n){var r=t(e.getReference(),n);return{getCurrentTime:function(){return e.getCurrentTime()},getReadyState:function(){return e.getReadyState()},getPlaybackRate:function(){return e.getPlaybackRate()},getIsPaused:function(){return e.getIsPaused()},getReference:function(){return r},listen:function(e,t){var i;n.isCancelled||!0===(null===(i=null==t?void 0:t.clearSignal)||void 0===i?void 0:i.isCancelled)||r.onUpdate(e,{clearSignal:null==t?void 0:t.clearSignal,emitCurrentValue:null==t?void 0:t.includeLastObservation})},deriveReadOnlyObserver:function(e){return hr(this,e,n)}}}var mr=function(e){function n(t,n,r){var i;if((i=e.call(this)||this)._canceller=new k.ZP,i._manifest=t,i._trackSubject=n,null===r)return i._lastEmitted=r,n.next(null),(0,De.Z)(i);var a=i._constructLockedRepresentationsReference(r);return i._lastEmitted={adaptation:r.adaptation,switchingMode:r.switchingMode,lockedRepresentations:null},n.next({adaptation:r.adaptation,switchingMode:r.switchingMode,representations:a}),i}(0,t.Z)(n,e);var r=n.prototype;return r.updateTrack=function(e){if(null===e){if(null===this._lastEmitted)return;return this._canceller.cancel(),this._canceller=new k.ZP,this._lastEmitted=null,void this._trackSubject.next(null)}var t=e.adaptation,n=e.switchingMode;this._canceller.cancel(),this._canceller=new k.ZP;var r=this._constructLockedRepresentationsReference(e);this._lastEmitted={adaptation:t,switchingMode:n,lockedRepresentations:null},this._trackSubject.next({adaptation:t,switchingMode:n,representations:r})},r._constructLockedRepresentationsReference=function(e){var t=this._manifest,n=this;t.addEventListener("decipherabilityUpdate",a),t.addEventListener("manifestUpdate",a);var r=e.lockedRepresentations.asObservable(!0).subscribe(a);this._canceller.signal.register((function(){t.removeEventListener("decipherabilityUpdate",a),t.removeEventListener("manifestUpdate",a),r.unsubscribe()}));var i=(0,w.ZP)({representations:[],switchingMode:"lazy"});return a(),i;function a(){var t,r,a=e.lockedRepresentations.getValue();if(null===a)r=e.adaptation.getPlayableRepresentations(),t="lazy";else{var o=a.representations;if(t=a.switchingMode,0===(r=o.filter((function(e){return e.isPlayable()}))).length)return void n.trigger("noPlayableLockedRepresentation",null)}if(r.length<=0){var s=e.adaptation.type;throw new h.Z("NO_PLAYABLE_REPRESENTATION","No Representation in the chosen "+s+" Adaptation can be played")}var u=i.getValue(),l=r.slice().sort();if(l.length===u.representations.length){for(var d=0;d<l.length;d++)if(u.representations[d].id!==l[d].id)return void i.setValue({representations:l,switchingMode:t})}else i.setValue({representations:l,switchingMode:t})}},r.dispose=function(){this.removeEventListener(),this._canceller.cancel(),this._trackSubject.complete()},n}(b.Z),gr=function(e){function n(t){var n;return(n=e.call(this)||this)._storedPeriodInfo=[],n._isDisposed=!1,n._cachedPeriodInfo=new WeakMap,n._isTrickModeTrackEnabled=t.preferTrickModeTracks,n}(0,t.Z)(n,e);var r=n.prototype;return r.getAvailablePeriods=function(){return this._storedPeriodInfo.map((function(e){return wr(e.period)}))},r.updatePeriodList=function(e){for(var t,n,r,i=this,a=e.periods,o=[],s=0,u=0;u<this._storedPeriodInfo.length;u++){var l=this._storedPeriodInfo[u].period,d=a[s];if(void 0===d)for(var c=this._storedPeriodInfo.length-1;c>=u;c--)this._storedPeriodInfo[c].inManifest=!1,br(this._storedPeriodInfo[c])&&this._removePeriodObject(c);else if(l===d){var v=function(){s++;var e=i._storedPeriodInfo[u].text.storedSettings;if(null!==e&&!d.getSupportedAdaptations("text").some((function(t){return t.id===e.adaptation.id}))){f.Z.warn("TracksStore: Chosen text Adaptation not available anymore");var a=i._storedPeriodInfo[u];if(a.text.storedSettings=null,i.trigger("autoTrackSwitch",{period:wr(d),trackType:"text",reason:"missing"}),i._isDisposed)return{v:void 0};var o=yr(i._storedPeriodInfo,a.period.id);void 0!==o&&null===o.text.storedSettings&&(null===(t=o.text.dispatcher)||void 0===t||t.updateTrack(null))}var l=i._storedPeriodInfo[u].video.storedSettings;if(null!==l){var c=d.getSupportedAdaptations("video");if(!c.some((function(e){return e.id===l.adaptation.id}))){f.Z.warn("TracksStore: Chosen video Adaptation not available anymore");var v,p=i._storedPeriodInfo[u];if(0===c.length)v=null;else{var h=c[0];v={adaptationBase:h,adaptation:Er(h,i._isTrickModeTrackEnabled),switchingMode:"seamless",lockedRepresentations:(0,w.ZP)(null)}}if(p.video.storedSettings=v,i.trigger("autoTrackSwitch",{period:wr(d),trackType:"video",reason:"missing"}),i._isDisposed)return{v:void 0};var m=yr(i._storedPeriodInfo,p.period.id);void 0!==m&&m.video.storedSettings===v&&(null===(n=m.video.dispatcher)||void 0===n||n.updateTrack(v))}}var g=i._storedPeriodInfo[u].audio.storedSettings;if(null!==g){var y=d.getSupportedAdaptations("audio");if(!y.some((function(e){return e.id===g.adaptation.id}))){f.Z.warn("TracksStore: Chosen audio Adaptation not available anymore");var _=i._storedPeriodInfo[u],b=0===y.length?null:{adaptation:y[0],switchingMode:"seamless",lockedRepresentations:(0,w.ZP)(null)};if(_.audio.storedSettings=b,i.trigger("autoTrackSwitch",{period:wr(d),trackType:"audio",reason:"missing"}),i._isDisposed)return{v:void 0};var S=yr(i._storedPeriodInfo,_.period.id);void 0!==S&&S.audio.storedSettings===b&&(null===(r=S.audio.dispatcher)||void 0===r||r.updateTrack(b))}}}();if("object"==typeof v)return v.v}else if(l.start<=d.start)this._storedPeriodInfo[u].inManifest=!1,br(this._storedPeriodInfo[u])&&(this._removePeriodObject(u),u--);else{var p=Tr(d,!0,this._isTrickModeTrackEnabled);this._storedPeriodInfo.splice(u,0,p),o.push(p),s++}}if(s<a.length){var h,m=a.slice(s).map((function(e){return Tr(e,!0,i._isTrickModeTrackEnabled)}));(h=this._storedPeriodInfo).push.apply(h,m),o.push.apply(o,m)}var g=o.reduce((function(e,t){return t.isRemoved||e.push({id:t.period.id,start:t.period.start,end:t.period.end}),e}),[]);g.length>0&&this.trigger("newAvailablePeriods",g)},r.addTrackSubject=function(e,t,n,r){var i=this,a=yr(this._storedPeriodInfo,n.id);if(void 0===a&&(a=this._manuallyAddPeriod(n),this.trigger("newAvailablePeriods",[{id:n.id,start:n.start,end:n.end}])),null===a[e].dispatcher){var o=a[e].storedSettings,s=new mr(t,r,o);a[e].dispatcher=s,s.addEventListener("noPlayableLockedRepresentation",(function(){null==o||o.lockedRepresentations.setValue(null),i.trigger("brokenRepresentationsLock",{period:{id:n.id,start:n.start,end:n.end},trackType:e})}))}else f.Z.error("TracksStore: Subject already added for "+e+" and Period "+n.start)},r.removeTrackSubject=function(e,t){var n=function(e,t){for(var n=0;n<e.length;n++){if(e[n].period.id===t.id)return n}}(this._storedPeriodInfo,t);if(void 0!==n){var r=this._storedPeriodInfo[n],i=r[e];null!==(null==i?void 0:i.dispatcher)?(i.dispatcher.dispose(),i.dispatcher=null,br(r)&&this._removePeriodObject(n)):f.Z.warn("TracksStore: Subject already removed for "+e+" and Period "+t.start)}else f.Z.warn("TracksStore: "+e+" not found for period",t.start)},r.getPeriodObjectFromPeriod=function(e){var t=yr(this._storedPeriodInfo,e.id);return void 0===t&&void 0!==e?this._cachedPeriodInfo.get(e):t},r.getPeriodObjectFromId=function(e){return yr(this._storedPeriodInfo,e)},r.disableVideoTrickModeTracks=function(){this._isTrickModeTrackEnabled&&(this._isTrickModeTrackEnabled=!1,this._resetVideoTrackChoices())},r.enableVideoTrickModeTracks=function(){this._isTrickModeTrackEnabled||(this._isTrickModeTrackEnabled=!0,this._resetVideoTrackChoices())},r.resetPeriodObjects=function(){for(var e,t,n,r=this._storedPeriodInfo.length-1;r>=0;r--){var i=this._storedPeriodInfo[r];null===(e=i.audio.dispatcher)||void 0===e||e.dispose(),i.audio.dispatcher=null,null===(t=i.video.dispatcher)||void 0===t||t.dispose(),i.video.dispatcher=null,null===(n=i.text.dispatcher)||void 0===n||n.dispose(),i.text.dispatcher=null,i.inManifest||this._removePeriodObject(r)}},r.isTrickModeEnabled=function(){return this._isTrickModeTrackEnabled},r.setAudioTrack=function(e,t,n,r){var i=p.Z.getCurrent().DEFAULT_AUDIO_TRACK_SWITCHING_MODE;return this._setAudioOrTextTrack("audio",e,t,null!=n?n:i,r)},r.setTextTrack=function(e,t){return this._setAudioOrTextTrack("text",e,t,"direct",null)},r._setAudioOrTextTrack=function(e,t,n,r,i){var a=t.period,o=(0,V.Z)(a.getSupportedAdaptations(e),(function(e){return e.id===n}));if(void 0===o)throw new Error("Wanted "+e+" track not found.");var s,u=t[e];if(null===i)s=(0,w.ZP)(null);else{var l=p.Z.getCurrent().DEFAULT_AUDIO_TRACK_SWITCHING_MODE,d=this._getRepresentationsToLock(o,i),c="audio"===e?l:"direct";s=(0,w.ZP)({representations:d,switchingMode:c})}u.storedSettings={adaptation:o,switchingMode:r,lockedRepresentations:s},null!==u.dispatcher&&u.dispatcher.updateTrack(u.storedSettings)},r.setVideoTrack=function(e,t,n,r){var i=e.period,a=(0,V.Z)(i.getSupportedAdaptations("video"),(function(e){return e.id===t}));if(void 0===a)throw new Error("Wanted video track not found.");var o,s=p.Z.getCurrent().DEFAULT_VIDEO_TRACK_SWITCHING_MODE,u=e.video,l=Er(a,this._isTrickModeTrackEnabled);if(null===r)o=(0,w.ZP)(null);else{var d=this._getRepresentationsToLock(a,r),c=s;o=(0,w.ZP)({representations:d,switchingMode:c})}u.storedSettings={adaptationBase:a,switchingMode:null!=n?n:s,adaptation:l,lockedRepresentations:o},null!==u.dispatcher&&u.dispatcher.updateTrack(u.storedSettings)},r.disableTrack=function(e,t){var n,r=e[t];null!==r.storedSettings&&("text"!==t&&(null===(n=e[t].storedSettings)||void 0===n||n.lockedRepresentations.finish()),r.storedSettings=null,null!==r.dispatcher&&r.dispatcher.updateTrack(null))},r.getChosenAudioTrack=function(e){return null===e.audio.storedSettings?null:function(e){var t={language:(0,U.Z)(e.language,""),normalized:(0,U.Z)(e.normalizedLanguage,""),audioDescription:!0===e.isAudioDescription,id:e.id,representations:e.representations.map(Sr),label:e.label};!0===e.isDub&&(t.dub=!0);return t}(e.audio.storedSettings.adaptation)},r.getChosenTextTrack=function(e){return null===e.text.storedSettings?null:(t=e.text.storedSettings.adaptation,{language:null!==(n=t.language)&&void 0!==n?n:"",normalized:null!==(r=t.normalizedLanguage)&&void 0!==r?r:"",closedCaption:!0===t.isClosedCaption,id:t.id,label:t.label});var t,n,r},r.getChosenVideoTrack=function(e){return null===e.video.storedSettings?null:function(e){var t=void 0!==e.trickModeTracks?e.trickModeTracks.map((function(e){var t=e.representations.map(_r),n={id:e.id,representations:t,isTrickModeTrack:!0};return!0===e.isSignInterpreted&&(n.signInterpreted=!0),n})):void 0,n={id:e.id,representations:e.representations.map(_r),label:e.label};!0===e.isSignInterpreted&&(n.signInterpreted=!0);!0===e.isTrickModeTrack&&(n.isTrickModeTrack=!0);void 0!==t&&(n.trickModeTracks=t);return n}(e.video.storedSettings.adaptation)},r.getAvailableAudioTracks=function(e){var t=e.audio.storedSettings,n=null!==t?t.adaptation.id:null;return e.period.getSupportedAdaptations("audio").map((function(e){var t={language:(0,U.Z)(e.language,""),normalized:(0,U.Z)(e.normalizedLanguage,""),audioDescription:!0===e.isAudioDescription,id:e.id,active:null!==n&&n===e.id,representations:e.getPlayableRepresentations().map(Sr),label:e.label};return!0===e.isDub&&(t.dub=!0),t}))},r.getAvailableTextTracks=function(e){var t=e.text.storedSettings,n=null!==t?t.adaptation.id:null;return e.period.getSupportedAdaptations("text").map((function(e){return{language:(0,U.Z)(e.language,""),normalized:(0,U.Z)(e.normalizedLanguage,""),closedCaption:!0===e.isClosedCaption,id:e.id,active:null!==n&&n===e.id,label:e.label}}))},r.getAvailableVideoTracks=function(e){var t=e.video.storedSettings,n=null===t?void 0:t.adaptation.id;return e.period.getSupportedAdaptations("video").map((function(e){var t=void 0!==e.trickModeTracks?e.trickModeTracks.map((function(e){var t=null!==n&&n===e.id,r=e.getPlayableRepresentations().map(_r),i={id:e.id,representations:r,isTrickModeTrack:!0,active:t};return!0===e.isSignInterpreted&&(i.signInterpreted=!0),i})):void 0,r={id:e.id,active:null!==n&&n===e.id,representations:e.getPlayableRepresentations().map(_r),label:e.label};return!0===e.isSignInterpreted&&(r.signInterpreted=!0),void 0!==t&&(r.trickModeTracks=t),r}))},r.getLockedAudioRepresentations=function(e){var t=e.audio.storedSettings;if(null===t)return null;var n=t.lockedRepresentations.getValue();return null===n?null:n.representations.map((function(e){return e.id}))},r.getLockedVideoRepresentations=function(e){var t=e.video.storedSettings;if(null===t)return null;var n=t.lockedRepresentations.getValue();return null===n?null:n.representations.map((function(e){return e.id}))},r.lockAudioRepresentations=function(e,t){var n,r=e.audio.storedSettings;if(null!==r){var i=p.Z.getCurrent().DEFAULT_AUDIO_REPRESENTATIONS_SWITCHING_MODE,a=this._getRepresentationsToLock(r.adaptation,t.representations),o=null!==(n=t.switchingMode)&&void 0!==n?n:i;r.lockedRepresentations.setValue({representations:a,switchingMode:o})}},r.lockVideoRepresentations=function(e,t){var n,r=e.video.storedSettings;if(null!==r){var i=p.Z.getCurrent().DEFAULT_VIDEO_REPRESENTATIONS_SWITCHING_MODE,a=this._getRepresentationsToLock(r.adaptation,t.representations),o=null!==(n=t.switchingMode)&&void 0!==n?n:i;r.lockedRepresentations.setValue({representations:a,switchingMode:o})}},r.unlockAudioRepresentations=function(e){var t=e.audio.storedSettings;null!==t&&null!==t.lockedRepresentations.getValue()&&t.lockedRepresentations.setValue(null)},r.unlockVideoRepresentations=function(e){var t=e.video.storedSettings;null!==t&&null!==t.lockedRepresentations.getValue()&&t.lockedRepresentations.setValue(null)},r.dispose=function(){for(this._isDisposed=!0;;){var e=this._storedPeriodInfo.pop();if(void 0===e)return;e.isRemoved=!0}},r._manuallyAddPeriod=function(e){for(var t=Tr(e,!1,this._isTrickModeTrackEnabled),n=0;n<this._storedPeriodInfo.length;n++)if(this._storedPeriodInfo[n].period.start>e.start)return this._storedPeriodInfo.splice(n,0,t),t;return this._storedPeriodInfo.push(t),t},r._resetVideoTrackChoices=function(){for(var e=0;e<this._storedPeriodInfo.length;e++){var t=this._storedPeriodInfo[e];if(null!==t.video.storedSettings){var n=t.video.storedSettings.adaptationBase;if(null!==n){var r=Er(n,this._isTrickModeTrackEnabled);t.video.storedSettings.adaptationBase=n,t.video.storedSettings.adaptation=r}}}for(var i=this._storedPeriodInfo.slice(),a=0;a<i.length;a++){var o=i[a].video;null!==o.dispatcher&&o.dispatcher.updateTrack(o.storedSettings)}},r._removePeriodObject=function(e){var t=this._storedPeriodInfo[e];this._storedPeriodInfo[e].isRemoved=!0,this._storedPeriodInfo.splice(e,1),this._cachedPeriodInfo.set(t.period,t)},r._getRepresentationsToLock=function(e,t){var n=t.reduce((function(t,n){var r=(0,V.Z)(e.representations,(function(e){return e.id===n}));return void 0===r?f.Z.warn("API: Wanted locked Representation not found."):t.push(r),t}),[]);if(0===n.length)throw new Error("Cannot lock Representations: None of the given Representation id are found");return n},n}(b.Z);function yr(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(r.period.id===t)return r}}function _r(e){return{id:e.id,bitrate:e.bitrate,frameRate:e.frameRate,width:e.width,height:e.height,codec:e.codec,hdrInfo:e.hdrInfo}}function br(e){var t,n,r;return!e.inManifest&&null===(null===(t=e.text)||void 0===t?void 0:t.dispatcher)&&null===(null===(n=e.audio)||void 0===n?void 0:n.dispatcher)&&null===(null===(r=e.video)||void 0===r?void 0:r.dispatcher)}function Sr(e){return{id:e.id,bitrate:e.bitrate,codec:e.codec}}function Er(e,t){var n;return t&&void 0!==(null===(n=e.trickModeTracks)||void 0===n?void 0:n[0])?e.trickModeTracks[0]:e}function Tr(e,t,n){var r=e.getSupportedAdaptations("audio")[0],i=e.getSupportedAdaptations("video")[0],a=Er(i,n),o=p.Z.getCurrent(),s=o.DEFAULT_AUDIO_TRACK_SWITCHING_MODE,u=o.DEFAULT_VIDEO_TRACK_SWITCHING_MODE;return{period:e,inManifest:t,isRemoved:!1,audio:{storedSettings:void 0!==r?{adaptation:r,switchingMode:s,lockedRepresentations:(0,w.ZP)(null)}:null,dispatcher:null},video:{storedSettings:void 0!==a?{adaptation:a,adaptationBase:i,switchingMode:u,lockedRepresentations:(0,w.ZP)(null)}:null,dispatcher:null},text:{storedSettings:null,dispatcher:null}}}function wr(e){return{start:e.start,end:e.end,id:e.id}}function kr(e,t){var n=p.Z.getCurrent().FORCED_ENDED_THRESHOLD;if(e.ended)return"ENDED";if(null!==t){var r=Math.abs(e.duration-e.currentTime);return null!=n&&r<n?"ENDED":"seeking"===t?"SEEKING":"BUFFERING"}return e.paused?"PAUSED":"PLAYING"}function Ar(e){return"LOADING"!==e&&"RELOADING"!==e&&"STOPPED"!==e}var Ir=l.w0,Rr=l.it,xr=l.O0,Zr=function(n){function r(e){var t;void 0===e&&(e={}),t=n.call(this)||this;var r=function(e){var t,n,r,i,a,o,s,u,l,d,c,f=p.Z.getCurrent(),v=f.DEFAULT_INITIAL_BITRATES,h=f.DEFAULT_LIMIT_VIDEO_WIDTH,m=f.DEFAULT_MIN_BITRATES,g=f.DEFAULT_MAX_BITRATES,y=f.DEFAULT_MAX_BUFFER_AHEAD,_=f.DEFAULT_MAX_BUFFER_BEHIND,b=f.DEFAULT_MAX_VIDEO_BUFFER_SIZE,E=f.DEFAULT_THROTTLE_VIDEO_BITRATE_WHEN_HIDDEN,T=f.DEFAULT_WANTED_BUFFER_AHEAD;if((0,S.Z)(e.maxBufferAhead))t=y;else if(t=Number(e.maxBufferAhead),isNaN(t))throw new Error("Invalid maxBufferAhead parameter. Should be a number.");if((0,S.Z)(e.maxBufferBehind))n=_;else if(n=Number(e.maxBufferBehind),isNaN(n))throw new Error("Invalid maxBufferBehind parameter. Should be a number.");if((0,S.Z)(e.wantedBufferAhead))r=T;else if(r=Number(e.wantedBufferAhead),isNaN(r))throw new Error("Invalid wantedBufferAhead parameter. Should be a number.");if((0,S.Z)(e.maxVideoBufferSize))i=b;else if(i=Number(e.maxVideoBufferSize),isNaN(i))throw new Error("Invalid maxVideoBufferSize parameter. Should be a number.");var w=(0,S.Z)(e.limitVideoWidth)?h:!!e.limitVideoWidth,k=(0,S.Z)(e.throttleVideoBitrateWhenHidden)?E:!!e.throttleVideoBitrateWhenHidden;if((0,S.Z)(e.videoElement))a=document.createElement("video");else{if(!(e.videoElement instanceof HTMLMediaElement))throw new Error("Invalid videoElement parameter. Should be a HTMLMediaElement.");a=e.videoElement}if((0,S.Z)(e.initialVideoBitrate))o=v.video;else if(o=Number(e.initialVideoBitrate),isNaN(o))throw new Error("Invalid initialVideoBitrate parameter. Should be a number.");if((0,S.Z)(e.initialAudioBitrate))s=v.audio;else if(s=Number(e.initialAudioBitrate),isNaN(s))throw new Error("Invalid initialAudioBitrate parameter. Should be a number.");if((0,S.Z)(e.minVideoBitrate))l=m.video;else if(l=Number(e.minVideoBitrate),isNaN(l))throw new Error("Invalid maxVideoBitrate parameter. Should be a number.");if((0,S.Z)(e.minAudioBitrate))u=m.audio;else if(u=Number(e.minAudioBitrate),isNaN(u))throw new Error("Invalid minAudioBitrate parameter. Should be a number.");if((0,S.Z)(e.maxVideoBitrate))c=g.video;else{if(c=Number(e.maxVideoBitrate),isNaN(c))throw new Error("Invalid maxVideoBitrate parameter. Should be a number.");if(l>c)throw new Error('Invalid maxVideoBitrate parameter. Its value, "'+c+'", is inferior to the set minVideoBitrate, "'+l+'"')}if((0,S.Z)(e.maxAudioBitrate))d=g.audio;else{if(d=Number(e.maxAudioBitrate),isNaN(d))throw new Error("Invalid maxAudioBitrate parameter. Should be a number.");if(u>d)throw new Error('Invalid maxAudioBitrate parameter. Its value, "'+d+'", is inferior to the set minAudioBitrate, "'+u+'"')}return{maxBufferAhead:t,maxBufferBehind:n,limitVideoWidth:w,videoElement:a,wantedBufferAhead:r,maxVideoBufferSize:i,throttleVideoBitrateWhenHidden:k,initialAudioBitrate:s,initialVideoBitrate:o,minAudioBitrate:u,minVideoBitrate:l,maxAudioBitrate:d,maxVideoBitrate:c}}(e),a=r.initialAudioBitrate,o=r.initialVideoBitrate,s=r.limitVideoWidth,l=r.minAudioBitrate,d=r.minVideoBitrate,c=r.maxAudioBitrate,v=r.maxBufferAhead,h=r.maxBufferBehind,m=r.maxVideoBitrate,g=r.throttleVideoBitrateWhenHidden,y=r.videoElement,_=r.wantedBufferAhead,b=r.maxVideoBufferSize,E=p.Z.getCurrent().DEFAULT_UNMUTED_VOLUME;y.preload="auto",t.version="3.29.0",t.log=f.Z,t.state="STOPPED",t.videoElement=y;var T=new k.ZP;return t._priv_destroy$=new i.x,t._priv_destroy$.pipe(u(1)).subscribe((function(){T.cancel()})),t._priv_pictureInPictureRef=Ir(y,T.signal),t._priv_speed=(0,w.ZP)(y.playbackRate),t._priv_preferTrickModeTracks=!1,t._priv_contentLock=(0,w.ZP)(!1),t._priv_bufferOptions={wantedBufferAhead:(0,w.ZP)(_),maxBufferAhead:(0,w.ZP)(v),maxBufferBehind:(0,w.ZP)(h),maxVideoBufferSize:(0,w.ZP)(b)},t._priv_bitrateInfos={lastBitrates:{audio:a,video:o},minAutoBitrates:{audio:(0,w.ZP)(l),video:(0,w.ZP)(d)},maxAutoBitrates:{audio:(0,w.ZP)(c),video:(0,w.ZP)(m)},manualBitrates:{audio:(0,w.ZP)(-1),video:(0,w.ZP)(-1)}},t._priv_throttleVideoBitrateWhenHidden=g,t._priv_limitVideoWidth=s,t._priv_mutedMemory=E,t._priv_tracksStore=null,t._priv_mediaElementTracksStore=null,t._priv_currentError=null,t._priv_contentInfos=null,t._priv_contentEventsMemory={},t._priv_setPlayerState("STOPPED"),t._priv_reloadingMetadata={},t}(0,t.Z)(r,n);var a=r.prototype;return a.addEventListener=function(e,t){return n.prototype.addEventListener.call(this,e,t)},a.stop=function(){null!==this._priv_contentInfos&&this._priv_contentInfos.currentContentCanceller.cancel(),this._priv_cleanUpCurrentContentState(),"STOPPED"!==this.state&&this._priv_setPlayerState("STOPPED")},a.dispose=function(){this.stop(),null!==this.videoElement&&P(this.videoElement).catch((function(e){var t=e instanceof Error?e.message:"Unknown error";f.Z.error("API: Could not dispose decryption resources: "+t)})),this._priv_destroy$.next(),this._priv_destroy$.complete(),this._priv_speed.finish(),this._priv_contentLock.finish(),this._priv_bufferOptions.wantedBufferAhead.finish(),this._priv_bufferOptions.maxVideoBufferSize.finish(),this._priv_bufferOptions.maxBufferAhead.finish(),this._priv_bufferOptions.maxBufferBehind.finish(),this._priv_bitrateInfos.manualBitrates.video.finish(),this._priv_bitrateInfos.manualBitrates.audio.finish(),this._priv_bitrateInfos.minAutoBitrates.video.finish(),this._priv_bitrateInfos.minAutoBitrates.audio.finish(),this._priv_bitrateInfos.maxAutoBitrates.video.finish(),this._priv_bitrateInfos.maxAutoBitrates.audio.finish(),this._priv_reloadingMetadata={},this.videoElement=null},a.loadVideo=function(e){var t=function(e){var t,n,r,i,a,o,s,u,l,d,c,v,h,m=p.Z.getCurrent(),g=m.DEFAULT_AUTO_PLAY,y=m.DEFAULT_CODEC_SWITCHING_BEHAVIOR,_=m.DEFAULT_ENABLE_FAST_SWITCHING,b=m.DEFAULT_MANUAL_BITRATE_SWITCHING_MODE,T=m.DEFAULT_TEXT_TRACK_MODE;if((0,S.Z)(e))throw new Error("No option set on loadVideo");if((0,S.Z)(e.url)){if((0,S.Z)(null===(t=e.transportOptions)||void 0===t?void 0:t.initialManifest)&&(0,S.Z)(null===(n=e.transportOptions)||void 0===n?void 0:n.manifestLoader))throw new Error("Unable to load a content: no url set on loadVideo.\nPlease provide at least either an `url` argument, a `transportOptions.initialManifest` option or a `transportOptions.manifestLoader` option so the RxPlayer can load the content.")}else u=String(e.url);if((0,S.Z)(e.transport))throw new Error("No transport set on loadVideo");l=String(e.transport);var w=(0,S.Z)(e.autoPlay)?g:!!e.autoPlay;if((0,S.Z)(e.keySystems))d=[];else for(var k,A=lr(d=Array.isArray(e.keySystems)?e.keySystems:[e.keySystems]);!(k=A()).done;){var I=k.value;if("string"!=typeof I.type||"function"!=typeof I.getLicense)throw new Error("Invalid key system given: Missing type string or getLicense callback")}var R=void 0!==e.lowLatencyMode&&!!e.lowLatencyMode,x="object"==typeof e.transportOptions&&null!==e.transportOptions?e.transportOptions:{},Z=null===(r=e.transportOptions)||void 0===r?void 0:r.initialManifest,P=null!==(a=null===(i=e.transportOptions)||void 0===i?void 0:i.minimumManifestUpdateInterval)&&void 0!==a?a:0,M=(0,S.Z)(e.onCodecSwitch)?y:e.onCodecSwitch;(0,Ae.Z)(["continue","reload"],M)||(f.Z.warn("The `onCodecSwitch` loadVideo option must match one of the following string:\n- `continue`\n- `reload`\nIf badly set, "+y+" will be used as default"),M=y);var C=(0,E.Z)({},x,{lowLatencyMode:R});if(delete C.initialManifest,delete C.minimumManifestUpdateInterval,(0,S.Z)(e.textTrackMode))c=T;else{if("native"!==e.textTrackMode&&"html"!==e.textTrackMode)throw new Error("Invalid textTrackMode.");c=e.textTrackMode}var D=null!==(o=e.manualBitrateSwitchingMode)&&void 0!==o?o:b,O=(0,S.Z)(e.enableFastSwitching)?_:e.enableFastSwitching;if("html"===c){if((0,S.Z)(e.textTrackElement))throw new Error('You have to provide a textTrackElement in "html" textTrackMode.');if(!(e.textTrackElement instanceof HTMLElement))throw new Error("textTrackElement should be an HTMLElement.");v=e.textTrackElement}else(0,S.Z)(e.textTrackElement)||f.Z.warn('API: You have set a textTrackElement without being in an "html" textTrackMode. It will be ignored.');if(!(0,S.Z)(e.startAt))if(e.startAt.wallClockTime instanceof Date){var N=e.startAt.wallClockTime.getTime()/1e3;h=(0,E.Z)({},e.startAt,{wallClockTime:N})}else h=e.startAt;return{autoPlay:w,enableFastSwitching:O,keySystems:d,initialManifest:Z,lowLatencyMode:R,manualBitrateSwitchingMode:D,minimumManifestUpdateInterval:P,networkConfig:null!==(s=e.networkConfig)&&void 0!==s?s:{},onCodecSwitch:M,startAt:h,textTrackElement:v,textTrackMode:c,transport:l,transportOptions:C,url:u}}(e);f.Z.info("API: Calling loadvideo",t.url,t.transport),this._priv_reloadingMetadata={options:t},this._priv_initializeContentPlayback(t)},a.reload=function(e){var t,n,r,i,a=this._priv_reloadingMetadata,o=a.options,s=a.manifest,u=a.reloadPosition,l=a.reloadInPause;if(void 0===o)throw new Error("API: Can't reload without having previously loaded a content.");if(function(e){var t,n,r,i;if(null===e||"object"!=typeof e&&void 0!==e)throw new Error("API: reload - Invalid options format.");if(null===(null==e?void 0:e.reloadAt)||"object"!=typeof(null==e?void 0:e.reloadAt)&&void 0!==(null==e?void 0:e.reloadAt))throw new Error("API: reload - Invalid 'reloadAt' option format.");if("number"!=typeof(null===(t=null==e?void 0:e.reloadAt)||void 0===t?void 0:t.position)&&void 0!==(null===(n=null==e?void 0:e.reloadAt)||void 0===n?void 0:n.position))throw new Error("API: reload - Invalid 'reloadAt.position' option format.");if("number"!=typeof(null===(r=null==e?void 0:e.reloadAt)||void 0===r?void 0:r.relative)&&void 0!==(null===(i=null==e?void 0:e.reloadAt)||void 0===i?void 0:i.relative))throw new Error("API: reload - Invalid 'reloadAt.relative' option format.")}(e),void 0!==(null===(t=null==e?void 0:e.reloadAt)||void 0===t?void 0:t.position))r={position:e.reloadAt.position};else if(void 0!==(null===(n=null==e?void 0:e.reloadAt)||void 0===n?void 0:n.relative)){if(void 0===u)throw new Error("Can't reload to a relative position when previous content was not loaded.");r={position:e.reloadAt.relative+u}}else void 0!==u&&(r={position:u});void 0!==(null==e?void 0:e.autoPlay)?i=e.autoPlay:void 0!==l&&(i=!l);var d=Object.assign(Object.assign({},o),{initialManifest:s});void 0!==r&&(d.startAt=r),void 0!==i&&(d.autoPlay=i),this._priv_initializeContentPlayback(d)},a._priv_initializeContentPlayback=function(e){var t=this,n=e.autoPlay,r=e.enableFastSwitching,i=e.initialManifest,a=e.keySystems,o=e.lowLatencyMode,s=e.manualBitrateSwitchingMode,u=e.minimumManifestUpdateInterval,l=e.networkConfig,d=e.onCodecSwitch,c=e.startAt,p=e.transport,h=e.transportOptions,m=e.url;if(null===this.videoElement)throw new Error("the attached video element is disposed");var g,_="directfile"===p,b=new k.ZP,S={url:m,currentContentCanceller:b,isDirectFile:_,segmentBuffersStore:null,manifest:null,currentPeriod:null,activeAdaptations:null,activeRepresentations:null},T=this.videoElement,A=new fr(T,{withMediaSource:!_,lowLatencyMode:o});if(b.signal.register((function(){A.stop()})),_){if(null===y.Z.directfile)throw this.stop(),this._priv_currentError=null,new Error("DirectFile feature not activated in your build.");this._priv_initializeMediaElementTracksStore(),g=new y.Z.directfile.initDirectFile({autoPlay:n,keySystems:a,speed:this._priv_speed,startAt:c,url:m})}else{var I=y.Z.transports[p];if("function"!=typeof I)throw this.stop(),this._priv_currentError=null,new Error('transport "'+p+'" not supported');var R=I(h),x=l.offlineRetry,Z=l.segmentRetry,P=l.manifestRetry,M=l.manifestRequestTimeout,C=l.segmentRequestTimeout,D={lowLatencyMode:o,maxRetryRegular:P,maxRetryOffline:x,requestTimeout:M},O=v(),N={throttleBitrate:{},limitWidth:{}};this._priv_throttleVideoBitrateWhenHidden&&(O?N.throttleBitrate={video:(0,w.lR)(Rr(this._priv_pictureInPictureRef,b.signal),(function(e){return e?1/0:0}),b.signal)}:f.Z.warn("API: Can't apply throttleVideoBitrateWhenHidden because browser can't be trusted for visibility.")),this._priv_limitVideoWidth&&(O?N.limitWidth={video:xr(T,this._priv_pictureInPictureRef,b.signal)}:f.Z.warn("API: Can't apply limitVideoWidth because browser can't be trusted for video size."));var L={initialBitrates:this._priv_bitrateInfos.lastBitrates,lowLatencyMode:o,manualBitrates:this._priv_bitrateInfos.manualBitrates,minAutoBitrates:this._priv_bitrateInfos.minAutoBitrates,maxAutoBitrates:this._priv_bitrateInfos.maxAutoBitrates,throttlers:N},U="native"===e.textTrackMode?{textTrackMode:"native"}:{textTrackMode:"html",textTrackElement:e.textTrackElement},B=(0,E.Z)({enableFastSwitching:r,manualBitrateSwitchingMode:s,onCodecSwitch:d},this._priv_bufferOptions);g=new ur({adaptiveOptions:L,autoPlay:n,bufferOptions:B,initialManifest:i,keySystems:a,lowLatencyMode:o,manifestRequestSettings:D,minimumManifestUpdateInterval:u,transport:R,segmentRequestOptions:{lowLatencyMode:o,maxRetryRegular:Z,requestTimeout:C,maxRetryOffline:x},speed:this._priv_speed,startAt:c,textTrackOptions:U,url:m})}g.addEventListener("error",(function(e){return t._priv_onPlaybackError(e)})),g.addEventListener("inbandEvents",(function(e){return t.trigger("inbandEvents",e)})),g.addEventListener("streamEvent",(function(e){return t.trigger("streamEvent",e)})),g.addEventListener("streamEventSkip",(function(e){return t.trigger("streamEventSkip",e)})),g.addEventListener("decipherabilityUpdate",(function(e){return t.trigger("decipherabilityUpdate",e.map((function(e){return{periodInfo:{start:e.period.start,end:e.period.end,id:e.period.id},trackType:e.adaptation.type,trackId:e.adaptation.id,representationId:e.representation.id,isDecipherable:e.representation.decipherable}})))})),g.addEventListener("activePeriodChanged",(function(e){return t._priv_onActivePeriodChanged(e)})),g.addEventListener("periodStreamReady",(function(e){return t._priv_onPeriodStreamReady(e)})),g.addEventListener("periodStreamCleared",(function(e){return t._priv_onPeriodStreamCleared(e)})),g.addEventListener("reloadingMediaSource",(function(){return t._priv_onReloadingMediaSource()})),g.addEventListener("representationChange",(function(e){return t._priv_onRepresentationChange(e)})),g.addEventListener("adaptationChange",(function(e){return t._priv_onAdaptationChange(e)})),g.addEventListener("bitrateEstimationChange",(function(e){return t._priv_onBitrateEstimationChange(e)})),g.addEventListener("manifestReady",(function(e){return t._priv_onManifestReady(e)})),g.addEventListener("warning",(function(e){return t._priv_onPlaybackWarning(e)})),g.addEventListener("loaded",(function(e){null!==t._priv_contentInfos?t._priv_contentInfos.segmentBuffersStore=e.segmentBuffersStore:f.Z.error("API: Loaded event while no content is loaded")})),g.prepare(),this.stop();var F=function(e,t,n,r){var i=(0,w.ZP)("LOADING");e.addEventListener("loaded",(function(){if("LOADING"===i.getValue()){if(i.setValue("LOADED"),!r.isCancelled){var e=kr(t,null);"PAUSED"!==e&&i.setValue(e)}}else i.setValueIfChanged(kr(t,null))}),r),e.addEventListener("reloadingMediaSource",(function(){Ar(i.getValue())&&i.setValueIfChanged("RELOADING")}),r);var a=null;return e.addEventListener("stalled",(function(e){e!==a&&(Ar(i.getValue())&&i.setValueIfChanged(kr(t,e)),a=e)}),r),e.addEventListener("unstalled",(function(){null!==a&&(Ar(i.getValue())&&i.setValueIfChanged(kr(t,null)),a=null)}),r),n.listen((function(e){Ar(i.getValue())&&(0,Ae.Z)(["seeking","ended","play","pause"],e.event)&&i.setValueIfChanged(kr(t,a))}),{clearSignal:r}),i}(g,T,A,b.signal);b.signal.register((function(){g.dispose()}));var z=function(e){switch(e){case"STOPPED":case"RELOADING":case"LOADING":break;case"ENDED":t._priv_reloadingMetadata.reloadInPause=!0,t._priv_reloadingMetadata.reloadPosition=A.getReference().getValue().position;break;default:var n=A.getReference().getValue();t._priv_reloadingMetadata.reloadInPause=n.paused,t._priv_reloadingMetadata.reloadPosition=n.position}},V=null;F.onUpdate((function(e){z(e),t._priv_setPlayerState(e),b.isUsed||(null!==V?Ar(t.state)||(V.cancel(),V=null):Ar(t.state)&&(V=new k.ZP({cancelOn:b.signal}),function(e,t,n,r,i){if(!i.isCancelled&&null!==e){var a=t.getReference().getValue().seeking;a&&(n(),i.isCancelled)||t.listen((function(e){"seeking"===e.event?(a=!0,n()):a&&"seeked"===e.event&&(a=!1,r())}),{includeLastObservation:!0,clearSignal:i})}}(T,A,(function(){return t.trigger("seeking",null)}),(function(){return t.trigger("seeked",null)}),V.signal)))}),{emitCurrentValue:!0,clearSignal:b.signal}),A.listen((function(e){z(t.state),t._priv_triggerPositionUpdate(e)}),{clearSignal:b.signal}),this._priv_currentError=null,this._priv_contentInfos=S,b.signal.register((function(){g.removeEventListener()})),this._priv_contentLock.onUpdate((function(e,t){e||(t(),g.start(T,A))}),{emitCurrentValue:!0,clearSignal:b.signal})},a.getError=function(){return this._priv_currentError},a.getVideoElement=function(){return this.videoElement},a.getPlayerState=function(){return this.state},a.isLive=function(){if(null===this._priv_contentInfos)return!1;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;return!t&&null!==n&&n.isLive},a.areTrickModeTracksEnabled=function(){return this._priv_preferTrickModeTracks},a.getUrl=function(){if(null!==this._priv_contentInfos){var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest,r=e.url;return t?r:null!==n?n.getUrl():void 0}},a.getMediaDuration=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration},a.getCurrentBufferGap=function(){if(null===this.videoElement)throw new Error("Disposed player");var e=this.videoElement;return(0,T.L7)(e.buffered,e.currentTime)},a.getWallClockTime=function(){if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)return this.videoElement.currentTime;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;if(t){var r=d(this.videoElement);return(null!=r?r:0)+this.videoElement.currentTime}return null!==n?this.videoElement.currentTime+(void 0!==n.availabilityStartTime?n.availabilityStartTime:0):0},a.getPosition=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.currentTime},a.getPlaybackRate=function(){return this._priv_speed.getValue()},a.setPlaybackRate=function(e,t){e!==this._priv_speed.getValue()&&this._priv_speed.setValue(e);var n=null==t?void 0:t.preferTrickModeTracks;"boolean"==typeof n&&(this._priv_preferTrickModeTracks=n,null!==this._priv_tracksStore&&(n&&!this._priv_tracksStore.isTrickModeEnabled()?this._priv_tracksStore.enableVideoTrickModeTracks():!n&&this._priv_tracksStore.isTrickModeEnabled()&&this._priv_tracksStore.disableVideoTrickModeTracks()))},a.getVideoBitrate=function(){var e=this._priv_getCurrentRepresentations();if(null!==e&&!(0,S.Z)(e.video))return e.video.bitrate},a.getAudioBitrate=function(){var e=this._priv_getCurrentRepresentations();if(null!==e&&!(0,S.Z)(e.audio))return e.audio.bitrate},a.getMinVideoBitrate=function(){return this._priv_bitrateInfos.minAutoBitrates.video.getValue()},a.getMinAudioBitrate=function(){return this._priv_bitrateInfos.minAutoBitrates.audio.getValue()},a.getMaxVideoBitrate=function(){return this._priv_bitrateInfos.maxAutoBitrates.video.getValue()},a.getMaxAudioBitrate=function(){return this._priv_bitrateInfos.maxAutoBitrates.audio.getValue()},a.play=function(){var e=this;if(null===this.videoElement)throw new Error("Disposed player");var t=this.videoElement.play();return(0,S.Z)(t)||"function"!=typeof t.catch?Promise.resolve():t.catch((function(t){if("NotAllowedError"===t.name){var n=new h.Z("MEDIA_ERR_PLAY_NOT_ALLOWED",t.toString());e.trigger("warning",n)}throw t}))},a.pause=function(){if(null===this.videoElement)throw new Error("Disposed player");this.videoElement.pause()},a.seekTo=function(e){var t;if(null===this.videoElement)throw new Error("Disposed player");if(null===this._priv_contentInfos)throw new Error("player: no content loaded");var n,r=this._priv_contentInfos,i=r.isDirectFile,a=r.manifest;if(!i&&null===a)throw new Error("player: the content did not load yet");if("number"==typeof e)n=e;else if("object"==typeof e){var o=e,s=this.videoElement.currentTime;if((0,S.Z)(o.relative))if((0,S.Z)(o.position)){if((0,S.Z)(o.wallClockTime))throw new Error('invalid time object. You must set one of the following properties: "relative", "position" or "wallClockTime"');if(null!==a)n=o.wallClockTime-(null!==(t=a.availabilityStartTime)&&void 0!==t?t:0);else if(i&&null!==this.videoElement){var u=d(this.videoElement);void 0!==u&&(n=o.wallClockTime-u)}void 0===n&&(n=o.wallClockTime)}else n=o.position;else n=s+o.relative}if(void 0===n)throw new Error("invalid time given");return this.videoElement.currentTime=n,n},a.getVolume=function(){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.volume},a.setVolume=function(e){if(null===this.videoElement)throw new Error("Disposed player");var t=this.videoElement;e!==t.volume&&(t.volume=e,this.trigger("volumeChange",e))},a.isMute=function(){return 0===this.getVolume()},a.mute=function(){this._priv_mutedMemory=this.getVolume(),this.setVolume(0)},a.unMute=function(){var e=p.Z.getCurrent().DEFAULT_UNMUTED_VOLUME;0===this.getVolume()&&this.setVolume(0===this._priv_mutedMemory?e:this._priv_mutedMemory)},a.setMinVideoBitrate=function(e){var t=this._priv_bitrateInfos.maxAutoBitrates.video.getValue();if(e>t)throw new Error('Invalid minimum video bitrate given. Its value, "'+e+'" is superior the current maximum video birate, "'+t+'".');this._priv_bitrateInfos.minAutoBitrates.video.setValue(e)},a.setMinAudioBitrate=function(e){var t=this._priv_bitrateInfos.maxAutoBitrates.audio.getValue();if(e>t)throw new Error('Invalid minimum audio bitrate given. Its value, "'+e+'" is superior the current maximum audio birate, "'+t+'".');this._priv_bitrateInfos.minAutoBitrates.audio.setValue(e)},a.setMaxVideoBitrate=function(e){var t=this._priv_bitrateInfos.minAutoBitrates.video.getValue();if(e<t)throw new Error('Invalid maximum video bitrate given. Its value, "'+e+'" is inferior the current minimum video birate, "'+t+'".');this._priv_bitrateInfos.maxAutoBitrates.video.setValue(e)},a.setMaxAudioBitrate=function(e){var t=this._priv_bitrateInfos.minAutoBitrates.audio.getValue();if(e<t)throw new Error('Invalid maximum audio bitrate given. Its value, "'+e+'" is inferior the current minimum audio birate, "'+t+'".');this._priv_bitrateInfos.maxAutoBitrates.audio.setValue(e)},a.setMaxBufferBehind=function(e){this._priv_bufferOptions.maxBufferBehind.setValue(e)},a.setMaxBufferAhead=function(e){this._priv_bufferOptions.maxBufferAhead.setValue(e)},a.setWantedBufferAhead=function(e){this._priv_bufferOptions.wantedBufferAhead.setValue(e)},a.setMaxVideoBufferSize=function(e){this._priv_bufferOptions.maxVideoBufferSize.setValue(e)},a.getMaxBufferBehind=function(){return this._priv_bufferOptions.maxBufferBehind.getValue()},a.getMaxBufferAhead=function(){return this._priv_bufferOptions.maxBufferAhead.getValue()},a.getWantedBufferAhead=function(){return this._priv_bufferOptions.wantedBufferAhead.getValue()},a.getMaxVideoBufferSize=function(){return this._priv_bufferOptions.maxVideoBufferSize.getValue()},a.getCurrentKeySystem=function(){if(null===this.videoElement)throw new Error("Disposed player");return C(this.videoElement)},a.getCurrentPeriod=function(){var e,t=null===(e=this._priv_contentInfos)||void 0===e?void 0:e.currentPeriod;return(0,S.Z)(t)?null:{id:t.id,start:t.start,end:t.end}},a.getAvailablePeriods=function(){return null===this._priv_contentInfos||this._priv_contentInfos.isDirectFile||null===this._priv_tracksStore?[]:this._priv_tracksStore.getAvailablePeriods().slice()},a.getAvailableAudioTracks=function(e){var t,n;return null===this._priv_contentInfos?[]:this._priv_contentInfos.isDirectFile?null!==(n=null===(t=this._priv_mediaElementTracksStore)||void 0===t?void 0:t.getAvailableAudioTracks())&&void 0!==n?n:[]:this._priv_callTracksStoreGetterSetter(e,[],(function(e,t){var n;return null!==(n=e.getAvailableAudioTracks(t))&&void 0!==n?n:[]}))},a.getAvailableTextTracks=function(e){var t,n;return null===this._priv_contentInfos?[]:this._priv_contentInfos.isDirectFile?null!==(n=null===(t=this._priv_mediaElementTracksStore)||void 0===t?void 0:t.getAvailableTextTracks())&&void 0!==n?n:[]:this._priv_callTracksStoreGetterSetter(e,[],(function(e,t){var n;return null!==(n=e.getAvailableTextTracks(t))&&void 0!==n?n:[]}))},a.getAvailableVideoTracks=function(e){var t,n;return null===this._priv_contentInfos?[]:this._priv_contentInfos.isDirectFile?null!==(n=null===(t=this._priv_mediaElementTracksStore)||void 0===t?void 0:t.getAvailableVideoTracks())&&void 0!==n?n:[]:this._priv_callTracksStoreGetterSetter(e,[],(function(e,t){var n;return null!==(n=e.getAvailableVideoTracks(t))&&void 0!==n?n:[]}))},a.getAudioTrack=function(e){if(null!==this._priv_contentInfos){if(this._priv_contentInfos.isDirectFile){if(null===this._priv_mediaElementTracksStore)return;return this._priv_mediaElementTracksStore.getChosenAudioTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.getChosenAudioTrack(t)}))}},a.getTextTrack=function(e){if(null!==this._priv_contentInfos){if(this._priv_contentInfos.isDirectFile){if(null===this._priv_mediaElementTracksStore)return;return this._priv_mediaElementTracksStore.getChosenTextTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.getChosenTextTrack(t)}))}},a.getVideoTrack=function(e){if(null!==this._priv_contentInfos){if(this._priv_contentInfos.isDirectFile){if(null===this._priv_mediaElementTracksStore)return;return this._priv_mediaElementTracksStore.getChosenVideoTrack()}return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.getChosenVideoTrack(t)}))}},a.setAudioTrack=function(e){var t,n,r,i,a;if(null===this._priv_contentInfos)throw new Error("No content loaded");if(this._priv_contentInfos.isDirectFile)try{var o="string"==typeof e?e:e.trackId;return void(null===(t=this._priv_mediaElementTracksStore)||void 0===t||t.setAudioTrackById(o))}catch(e){throw new Error("player: unknown audio track")}var s=null;return"string"==typeof e?i=e:(i=e.trackId,r=e.periodId,a=e.switchingMode,s=null!==(n=e.lockedRepresentations)&&void 0!==n?n:null),this._priv_callTracksStoreGetterSetter(r,void 0,(function(e,t){return e.setAudioTrack(t,i,a,s)}))},a.setTextTrack=function(e){var t,n,r;if(null===this._priv_contentInfos)throw new Error("No content loaded");if(this._priv_contentInfos.isDirectFile)try{var i="string"==typeof e?e:e.trackId;return void(null===(t=this._priv_mediaElementTracksStore)||void 0===t||t.setTextTrackById(i))}catch(e){throw new Error("player: unknown text track")}return"string"==typeof e?r=e:(r=e.trackId,n=e.periodId),this._priv_callTracksStoreGetterSetter(n,void 0,(function(e,t){return e.setTextTrack(t,r)}))},a.disableTextTrack=function(e){var t;if(null!==this._priv_contentInfos)if(this._priv_contentInfos.isDirectFile)null===(t=this._priv_mediaElementTracksStore)||void 0===t||t.disableTextTrack();else if(null!==this._priv_tracksStore)return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.disableTrack(t,"text")}))},a.setVideoTrack=function(e){var t,n,r,i,a;if(null===this._priv_contentInfos)throw new Error("No content loaded");if(this._priv_contentInfos.isDirectFile)try{var o="string"==typeof e?e:e.trackId;return void(null===(t=this._priv_mediaElementTracksStore)||void 0===t||t.setVideoTrackById(o))}catch(e){throw new Error("player: unknown video track")}var s=null;return"string"==typeof e?i=e:(i=e.trackId,r=e.periodId,a=e.switchingMode,s=null!==(n=e.lockedRepresentations)&&void 0!==n?n:null),this._priv_callTracksStoreGetterSetter(r,void 0,(function(e,t){return e.setVideoTrack(t,i,a,s)}))},a.disableVideoTrack=function(e){if(null!==this._priv_contentInfos)return this._priv_contentInfos.isDirectFile&&null!==this._priv_mediaElementTracksStore?this._priv_mediaElementTracksStore.disableVideoTrack():this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.disableTrack(t,"video")}))},a.lockVideoRepresentations=function(e){if(null===this._priv_contentInfos)throw new Error("No content loaded");var t,n,r;if(this._priv_contentInfos.isDirectFile)throw new Error("Cannot lock video Representations in directfile mode.");return Array.isArray(e)?(t=e,n=void 0):(t=e.representations,n=e.periodId,r=e.switchingMode),this._priv_callTracksStoreGetterSetter(n,void 0,(function(e,n){return e.lockVideoRepresentations(n,{representations:t,switchingMode:r})}))},a.lockAudioRepresentations=function(e){if(null===this._priv_contentInfos)throw new Error("No content loaded");var t,n,r;if(this._priv_contentInfos.isDirectFile)throw new Error("Cannot lock audio Representations in directfile mode.");return Array.isArray(e)?(t=e,n=void 0):(t=e.representations,n=e.periodId,r=e.switchingMode),this._priv_callTracksStoreGetterSetter(n,void 0,(function(e,n){return e.lockAudioRepresentations(n,{representations:t,switchingMode:r})}))},a.getLockedVideoRepresentations=function(e){return null===this._priv_contentInfos||this._priv_contentInfos.isDirectFile?null:this._priv_callTracksStoreGetterSetter(e,null,(function(e,t){return e.getLockedVideoRepresentations(t)}))},a.getLockedAudioRepresentations=function(e){return null===this._priv_contentInfos||this._priv_contentInfos.isDirectFile?null:this._priv_callTracksStoreGetterSetter(e,null,(function(e,t){return e.getLockedAudioRepresentations(t)}))},a.unlockVideoRepresentations=function(e){if(null!==this._priv_contentInfos&&!this._priv_contentInfos.isDirectFile)return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.unlockVideoRepresentations(t)}))},a.unlockAudioRepresentations=function(e){if(null!==this._priv_contentInfos&&!this._priv_contentInfos.isDirectFile)return this._priv_callTracksStoreGetterSetter(e,void 0,(function(e,t){return e.unlockAudioRepresentations(t)}))},a.getMinimumPosition=function(){if(null===this._priv_contentInfos)return null;if(this._priv_contentInfos.isDirectFile)return 0;var e=this._priv_contentInfos.manifest;return null!==e?e.getMinimumSafePosition():null},a.getMaximumPosition=function(){if(null===this._priv_contentInfos)return null;var e=this._priv_contentInfos,t=e.isDirectFile,n=e.manifest;if(t){if(null===this.videoElement)throw new Error("Disposed player");return this.videoElement.duration}return null!==n?n.isDynamic||null===this.videoElement?n.getMaximumSafePosition():this.videoElement.duration:null},a.__priv_getSegmentBufferContent=function(e){if(null===this._priv_contentInfos||null===this._priv_contentInfos.segmentBuffersStore)return null;var t=this._priv_contentInfos.segmentBuffersStore.getStatus(e);return"initialized"===t.type?t.value.getInventory():null},a.__priv_getManifest=function(){return null===this._priv_contentInfos?null:this._priv_contentInfos.manifest},a._priv_cleanUpCurrentContentState=function(){var e,t,n=this;f.Z.debug("Locking `contentLock` to clean-up the current content."),this._priv_contentLock.setValue(!0),this._priv_contentInfos=null,null===(e=this._priv_tracksStore)||void 0===e||e.dispose(),this._priv_tracksStore=null,null===(t=this._priv_mediaElementTracksStore)||void 0===t||t.dispose(),this._priv_mediaElementTracksStore=null,this._priv_contentEventsMemory={};var r=function(){null!==n.videoElement&&(f.Z.debug("Unlocking `contentLock`. Next content can begin."),n._priv_contentLock.setValue(!1))};(0,S.Z)(this.videoElement)?r():D(this.videoElement).then((function(){f.Z.debug("API: DRM session cleaned-up with success!"),r()}),(function(e){f.Z.error("API: An error arised when trying to clean-up the DRM session:"+(e instanceof Error?e.toString():"Unknown Error")),r()}))},a._priv_onPlaybackError=function(e){var t=(0,m.Z)(e,{defaultCode:"NONE",defaultReason:"An unknown error stopped content playback."});t.fatal=!0,null!==this._priv_contentInfos&&this._priv_contentInfos.currentContentCanceller.cancel(),this._priv_cleanUpCurrentContentState(),this._priv_currentError=t,f.Z.error("API: The player stopped because of an error",e instanceof Error?e:""),this._priv_setPlayerState("STOPPED"),this._priv_currentError===t&&this.trigger("error",t)},a._priv_onPlaybackWarning=function(e){var t=(0,m.Z)(e,{defaultCode:"NONE",defaultReason:"An unknown error happened."});f.Z.warn("API: Sending warning:",t),this.trigger("warning",t)},a._priv_onManifestReady=function(e){var t=this,n=this._priv_contentInfos;null!==n?(n.manifest=e,this._priv_reloadingMetadata.manifest=e,this._priv_tracksStore=new gr({preferTrickModeTracks:this._priv_preferTrickModeTracks}),this._priv_tracksStore.addEventListener("newAvailablePeriods",(function(e){t.trigger("newAvailablePeriods",e)})),this._priv_tracksStore.addEventListener("brokenRepresentationsLock",(function(e){t.trigger("brokenRepresentationsLock",e)})),this._priv_tracksStore.addEventListener("autoTrackSwitch",(function(e){t.trigger("autoTrackSwitch",e)})),this._priv_tracksStore.updatePeriodList(e),e.addEventListener("manifestUpdate",(function(){null!==t._priv_tracksStore&&t._priv_tracksStore.updatePeriodList(e)}),n.currentContentCanceller.signal)):f.Z.error("API: The manifest is loaded but no content is.")},a._priv_onActivePeriodChanged=function(e){var t,n,r,i,a=e.period;if(null!==this._priv_contentInfos){if(this._priv_contentInfos.currentPeriod=a,this._priv_contentEventsMemory.periodChange!==a&&(this._priv_contentEventsMemory.periodChange=a,this.trigger("periodChange",{start:a.start,end:a.end,id:a.id})),this.trigger("availableAudioTracksChange",this.getAvailableAudioTracks()),this.trigger("availableTextTracksChange",this.getAvailableTextTracks()),this.trigger("availableVideoTracksChange",this.getAvailableVideoTracks()),null!==this._priv_tracksStore){var o=this._priv_tracksStore.getPeriodObjectFromPeriod(a);if(o){var s=this._priv_tracksStore.getChosenAudioTrack(o),u=this._priv_tracksStore.getChosenTextTrack(o),l=this._priv_tracksStore.getChosenVideoTrack(o);this.trigger("audioTrackChange",s),this.trigger("textTrackChange",u),this.trigger("videoTrackChange",l)}}else this.trigger("audioTrackChange",null),this.trigger("textTrackChange",null),this.trigger("videoTrackChange",null);var d=null!==(n=null===(t=this._priv_getCurrentRepresentations())||void 0===t?void 0:t.audio)&&void 0!==n?n:null;this.trigger("audioRepresentationChange",d);var c=null!==(i=null===(r=this._priv_getCurrentRepresentations())||void 0===r?void 0:r.video)&&void 0!==i?i:null;this.trigger("videoRepresentationChange",c)}else f.Z.error("API: The active period changed but no content is loaded")},a._priv_onPeriodStreamReady=function(e){var t=e.type,n=e.manifest,r=e.period,i=e.adaptation$;switch(t){case"video":case"audio":case"text":null===this._priv_tracksStore?(f.Z.error("API: TracksStore not instanciated for a new "+t+" period"),i.next(null)):this._priv_tracksStore.addTrackSubject(t,n,r,i)}},a._priv_onPeriodStreamCleared=function(e){var t=e.type,n=e.period;switch(t){case"audio":case"text":case"video":null!==this._priv_tracksStore&&this._priv_tracksStore.removeTrackSubject(t,n)}if(null!==this._priv_contentInfos){var r=this._priv_contentInfos,i=r.activeAdaptations,a=r.activeRepresentations;if(!(0,S.Z)(i)&&!(0,S.Z)(i[n.id])){var o=i[n.id];delete o[t],0===Object.keys(o).length&&delete i[n.id]}if(!(0,S.Z)(a)&&!(0,S.Z)(a[n.id])){var s=a[n.id];delete s[t],0===Object.keys(s).length&&delete a[n.id]}}},a._priv_onReloadingMediaSource=function(){null!==this._priv_contentInfos&&(this._priv_contentInfos.segmentBuffersStore=null),this._priv_tracksStore&&this._priv_tracksStore.resetPeriodObjects()},a._priv_onAdaptationChange=function(e){var t=e.type,n=e.adaptation,r=e.period;if(null!==this._priv_contentInfos){null===this._priv_contentInfos.activeAdaptations&&(this._priv_contentInfos.activeAdaptations={});var i,a=this._priv_contentInfos,o=a.activeAdaptations,s=a.currentPeriod,u=o[r.id];if((0,S.Z)(u))o[r.id]=((i={})[t]=n,i);else u[t]=n;if(null!==this._priv_tracksStore&&null!==s&&!(0,S.Z)(r)&&r.id===s.id){var l=this._priv_tracksStore.getPeriodObjectFromPeriod(r);if(void 0===l)return;switch(t){case"audio":var d=this._priv_tracksStore.getChosenAudioTrack(l);this.trigger("audioTrackChange",d);break;case"text":var c=this._priv_tracksStore.getChosenTextTrack(l);this.trigger("textTrackChange",c);break;case"video":var v=this._priv_tracksStore.getChosenVideoTrack(l);this.trigger("videoTrackChange",v)}}}else f.Z.error("API: The adaptations changed but no content is loaded")},a._priv_onRepresentationChange=function(e){var t=e.type,n=e.period,r=e.representation;if(null!==this._priv_contentInfos){null===this._priv_contentInfos.activeRepresentations&&(this._priv_contentInfos.activeRepresentations={});var i,a=this._priv_contentInfos,o=a.activeRepresentations,s=a.currentPeriod,u=o[n.id];if((0,S.Z)(u))o[n.id]=((i={})[t]=r,i);else u[t]=r;(0,S.Z)(n)||null===s||s.id!==n.id||("video"===t?this.trigger("videoRepresentationChange",r):"audio"===t&&this.trigger("audioRepresentationChange",r))}else f.Z.error("API: The representations changed but no content is loaded")},a._priv_onBitrateEstimationChange=function(e){var t=e.type,n=e.bitrate;void 0!==n&&(this._priv_bitrateInfos.lastBitrates[t]=n),this.trigger("bitrateEstimationChange",{type:t,bitrate:n})},a._priv_setPlayerState=function(e){this.state!==e&&(this.state=e,f.Z.info("API: playerStateChange event",e),this.trigger("playerStateChange",e))},a._priv_triggerPositionUpdate=function(e){var t;if(null!==this._priv_contentInfos){var n=this._priv_contentInfos,r=n.isDirectFile,i=n.manifest;if((r||null!==i)&&!(0,S.Z)(e)){var a=null!==i?i.getMaximumSafePosition():void 0,o={position:e.position,duration:e.duration,playbackRate:e.playbackRate,maximumPosition:a,bufferGap:void 0!==e.bufferGap&&isFinite(e.bufferGap)?e.bufferGap:0};if(null!==i&&i.isLive&&e.position>0){var s=null!==(t=i.availabilityStartTime)&&void 0!==t?t:0;o.wallClockTime=e.position+s;var u=i.getLivePosition();void 0!==u&&(o.liveGap=u-e.position)}else if(r&&null!==this.videoElement){var l=d(this.videoElement);void 0!==l&&(o.wallClockTime=l+e.position)}this.trigger("positionUpdate",o)}}else f.Z.warn("API: Cannot perform time update: no content loaded.")},a._priv_getCurrentRepresentations=function(){if(null===this._priv_contentInfos)return null;var e=this._priv_contentInfos,t=e.currentPeriod,n=e.activeRepresentations;return null===t||null===n||(0,S.Z)(n[t.id])?null:n[t.id]},a._priv_initializeMediaElementTracksStore=function(){var e,t,n,r=this;(0,_.Z)(null!==y.Z.directfile,"Initializing `MediaElementTracksStore` without Directfile feature"),(0,_.Z)(null!==this.videoElement,"Initializing `MediaElementTracksStore` on a disposed RxPlayer"),this._priv_mediaElementTracksStore=new y.Z.directfile.mediaElementTracksStore(this.videoElement),this.trigger("availableAudioTracksChange",this._priv_mediaElementTracksStore.getAvailableAudioTracks()),this.trigger("availableVideoTracksChange",this._priv_mediaElementTracksStore.getAvailableVideoTracks()),this.trigger("availableTextTracksChange",this._priv_mediaElementTracksStore.getAvailableTextTracks()),this.trigger("audioTrackChange",null!==(e=this._priv_mediaElementTracksStore.getChosenAudioTrack())&&void 0!==e?e:null),this.trigger("textTrackChange",null!==(t=this._priv_mediaElementTracksStore.getChosenTextTrack())&&void 0!==t?t:null),this.trigger("videoTrackChange",null!==(n=this._priv_mediaElementTracksStore.getChosenVideoTrack())&&void 0!==n?n:null),this._priv_mediaElementTracksStore.addEventListener("availableVideoTracksChange",(function(e){return r.trigger("availableVideoTracksChange",e)})),this._priv_mediaElementTracksStore.addEventListener("availableAudioTracksChange",(function(e){return r.trigger("availableAudioTracksChange",e)})),this._priv_mediaElementTracksStore.addEventListener("availableTextTracksChange",(function(e){return r.trigger("availableTextTracksChange",e)})),this._priv_mediaElementTracksStore.addEventListener("audioTrackChange",(function(e){return r.trigger("audioTrackChange",e)})),this._priv_mediaElementTracksStore.addEventListener("videoTrackChange",(function(e){return r.trigger("videoTrackChange",e)})),this._priv_mediaElementTracksStore.addEventListener("textTrackChange",(function(e){return r.trigger("textTrackChange",e)}))},a._priv_callTracksStoreGetterSetter=function(e,t,n){var r,i;if(null===this._priv_tracksStore)return f.Z.warn("API: Trying to call track API too soon"),t;var a=null!==(i=null===(r=this._priv_contentInfos)||void 0===r?void 0:r.currentPeriod)&&void 0!==i?i:void 0,o=null!=e?e:null==a?void 0:a.id;if(void 0===o)return t;var s=o===(null==a?void 0:a.id)?this._priv_tracksStore.getPeriodObjectFromPeriod(a):this._priv_tracksStore.getPeriodObjectFromId(o);return void 0===s?t:n(this._priv_tracksStore,s)},(0,e.Z)(r,null,[{key:"ErrorTypes",get:function(){return g.ZB}},{key:"ErrorCodes",get:function(){return g.SM}},{key:"LogLevel",get:function(){return f.Z.getLevel()},set:function(e){f.Z.setLevel(e)}}]),r}(b.Z);Zr.version="3.29.0";var Pr=Zr,Mr=n(7273);!function(){Mr.Z.ContentDecryptor=n(1266).ZP,Mr.Z.transports.smooth=n(5418).Z,Mr.Z.transports.dash=n(2047).Z,Mr.Z.dashParsers.js=n(5904).Z,Mr.Z.nativeTextTracksBuffer=n(9059).Z,Mr.Z.nativeTextTracksParsers.vtt=n(9405).Z,Mr.Z.nativeTextTracksParsers.ttml=n(1570).Z,Mr.Z.nativeTextTracksParsers.sami=n(1812).Z,Mr.Z.nativeTextTracksParsers.srt=n(8057).Z,Mr.Z.htmlTextTracksBuffer=n(5192).Z,Mr.Z.htmlTextTracksParsers.sami=n(5734).Z,Mr.Z.htmlTextTracksParsers.ttml=n(7439).Z,Mr.Z.htmlTextTracksParsers.srt=n(8675).Z,Mr.Z.htmlTextTracksParsers.vtt=n(4099).Z;var e=n(9372).Z,t=n(1932).Z;Mr.Z.directfile={initDirectFile:e,mediaElementTracksStore:t}}(),"boolean"==typeof __RX_PLAYER_DEBUG_MODE__&&__RX_PLAYER_DEBUG_MODE__&&f.Z.setLevel("DEBUG");var Cr=Pr}(),r=r.default}()}));